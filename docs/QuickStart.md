# scala-glm - Quickstart Guide

## PCA

This library contains code for principal components analysis based on a thin SVD of the centred data matrix. This is more numerically stable than a construction from the spectral decomposition of the covariance matrix. It is analogous to the R function `prcomp` rather than the R function `princomp`. First create some synthetic data.

```scala
import breeze.linalg._
import breeze.numerics._
import breeze.stats.distributions._
val X = DenseMatrix.tabulate(100, 3)((i, j) => 
	Gaussian(j, j+1).sample())
```
Now we can do PCA.
```scala
import scalaglm.Pca
val pca = Pca(X, List("V1", "V2", "V3"))
```
```scala
pca.sdev
// res0: DenseVector[Double] = DenseVector(3.0886125374847393, 2.3416770117407575, 1.0023984098789702)
pca.loadings
// res1: DenseMatrix[Double] = -0.028668145332051035  0.012548188253401888   -0.9995102202652947    
// 0.006495894638319344   -0.9998977506756463    -0.012739369946416813  
// -0.9995678770329048    -0.006857927189829138  0.028583702324764464   
pca.scores
// res2: DenseMatrix[Double] = -5.118785507518323     4.419853649448706     -0.7605917106832127    
// 2.694880469570418      -1.8302560557626557   0.4028251801801102     
// -4.109947447970388     -3.5904304030275735   -0.15477010435502853   
// -1.03326128636484      1.155389745090221     -0.7541908515735601    
// -3.536611118943178     4.206307232197259     1.0292042312389178     
// 5.2352541260324985     1.892284211529357     -0.8017178319728829    
// -1.0590627503653238    -1.7109481273204634   0.5211970421600283     
// 4.527149620442017      -2.377789964517776    0.19333893972723304    
// 1.081343700027226      -2.574757219747158    -0.017836846981859594  
// -3.0733062855007156    -1.2290956855097566   -0.03652118077485524   
// 0.20429929848809328    -0.34719156493255243  0.5911027086902206     
// -3.6163675893809186    -2.197010578591236    -1.3161812790154979    
// 0.43895039034140443    3.04079392148625      0.4649539447490546     
// 6.825383386712497      -2.4848831771417608   -0.3432304645032907    
// -2.7990183611574624    -0.7207439855662666   -1.1300332013862564    
// 0.3476861273328723     3.3284585249934797    -0.32448974618390536   
// 2.7819286200415885     4.789840983151523     1.2953192792970734     
// 5.308261318897817      -1.6961863472315004   -0.8996623481616007    
// -2.5337824021539603    -1.2230581777052116   0.7262500231057784     
// 3.006493794659875      -2.1552728378922916   0.9890162196992063     
// -3.774793938851742     -2.0826477762079385   -1.7528207627621986    
// -0.004916375782115198  1.228379549200319     0.677137328317295      
// 1.2287419109267248     1.9374479265669198    -0.5816436714653713    
// -2.7499841870739914    -3.6640719399793253   0.7554076135850439     
// -2.855935470732389     3.951823975912876     1.718341004819116      
// 1.205524049078041      -0.20472656628156205  0.13315459984395372    
// -1.0475361197706075    -0.6739831422832512   0.8181436861185603     
// -0.6064711662284731    1.9903372796530194    0.19893948678659923    
// -3.8008788009300365    -1.0937070645805533   -1.197652301586985     
// 1.5377995931991295     -0.8565131215843225   -0.3277924506086593    
// 0.20829525913047003    0.11504543437724057   -0.4695822778803459    
// 1.2659628486538574     -0.39379895138310916  1.8864400124069354     
// 3.1777687890072457     1.7435779663113466    -0.13202362793449215   
// -2.7858850951590317    3.262782551753628     1.4708356073128224     
// 2.282899099002346      0.1854831231422975    1.4375715424292823     
// -0.7673285982152023    -1.4384477672243827   0.002057392826608063   
// 4.897507990575489      1.3474648810093324    -1.7950685759328278    
// -0.3380245531221713    -2.933156960862857    -2.081110810125689     
// 2.9517092667695954     0.5507028841062945    -0.14471585650781144   
// -0.28310845862033085   4.263555167513773     0.38543975984801876    
// -2.865041919143037     2.4327176761883322    0.5054312973044129     
// 6.6248861264065        2.675192431176967     -0.4688515246447829    
// 0.8401935860604551     1.0398909931790485    1.7780387043525663     
// -3.3122906073860827    3.9569818386374433    -1.815437315609366     
// -0.7474844657164157    0.9858176337836483    1.2290643171156574     
// -4.7398298483760675    0.9676044119037535    -0.3502066173397195    
// 3.0904608695721287     -4.340081206451272    0.2712366648905162     
// 0.2052318326138179     -1.423854493207425    0.37942687492139915    
// -3.538843619506233     -0.9453155143657602   -0.6555744360867869    
// ...
pca.plots
// res3: Figure = breeze.plot.Figure@5459d412
pca.summary
// Standard deviations:
// V1	V2	V3
//  3.089	 2.342	 1.002
// Cumulative proportion of variance explained:
// V1	V2	V3
//  0.595	 0.937	 1.000
// Loadings:
// PC01	PC02	PC03	
// -0.029	 0.013	-1.000	V1
//  0.006	-1.000	-0.013	V2
// -1.000	-0.007	 0.029	V3
```
The final line prints a readable summary of the PCA to the console. `plots` produces some diagnostic plots, including a "scree plot".

![PCA Plots](pca-plots.png)

Note that there is also a utility function `pairs` for producing a "scatterplot matrix":
```scala
import scalaglm.Utils.pairs
pairs(X, List("V1", "V2", "V3"))
// res6: Figure = breeze.plot.Figure@59cfe
```

![Pairs plots](pairs-plots.png)


## Linear regression

This code computes regression coefficients and associated diagnostics via the QR decomposition of the covariate matrix. The diagnostics are analogous to those produced by the R function `lm`. We start by creating a synthetic response variable.

```scala
val y = DenseVector.tabulate(100)(i => 
	Gaussian(2.0 + 1.5*X(i,0) + 0.5*X(i,1), 3.0).sample())
```
So we can now do linear regression and generate all of the usual diagnostics.
```scala
import scalaglm.Lm
val lm = Lm(y,X,List("V1", "V2", "V3"))
```
```scala
lm.coefficients
// res8: DenseVector[Double] = DenseVector(2.0610200103001053, 1.4800684240389381, 0.6180753402720732, 0.0029751274014501784)
lm.se
// res9: DenseVector[Double] = DenseVector(0.37860382749034965, 0.2851348449869905, 0.12215309442734114, 0.09290180639583738)
lm.fitted
// res10: DenseVector[Double] = DenseVector(1.4890059930309325, 3.182138806573632, 5.348161392636765, 3.2673051561940873, -1.1101306012130727, 2.6367930275960605, 3.089958411425571, 3.74606037205844, 4.32080167752794, 3.713876738053327, 2.1161912367080578, 6.21960445488652, 0.2631159787537437, 4.5130850165098115, 5.0239844634033535, 1.2684571151011232, -2.117206763075894, 4.930573624943525, 2.5535850106582862, 2.4923322346025554, 6.806946416176745, 1.0524133038368808, 2.4482681265187813, 3.982463351870071, -2.0105885408351343, 2.6703781728505143, 2.0262629501036953, 1.3316915058602579, 5.389586309928621, 3.732834872421788, 3.4163120576234984, 0.17385054511610587, 1.8151713150365711, -1.232361591688938, 0.4520300367976078, 3.686559829714251, 4.454613880437801, 7.662756845470216, 2.5584842124874094, -0.32174700677091894, 0.7041896786062859, 1.6149378581378844, -0.506760198852839, 3.260404047217439, 0.40776574494797924, 2.9325107745173886, 4.865996099886314, 3.07635937876971, 4.4836443582923495, 2.7483942865949142, 1.8858903968615792, 2.7563717937021126, 3.1626410302467054, 0.6213205517827722, 3.1058046663490924, 2.966020458639727, 4.208022389371935, 4.789524195125644, 2.9725167055421946, 0.465267155239922, 3.478984193428616, 5.293245237229721, 5.136148435604629, 6.091783693016442, 6.53099326650902, 0.9418187568641214, 1.3805048404638547, 2.9492051397854877, 4.114738187621181, 0.07599103542227614, 3.03819833387654, 2.5720731795422678, 8.705215122865928, 2.4846094902233347, 3.9834483943521803, 3.180375973169789, 3.0172221328850437, 2.848221803406714, 1.2309016628002127, 2.0970288931146843, 3.961500015196195, 5.87411810486108, 1.0728109493376838, 3.1568935314392257, -0.5008258265213201, 1.0554778697547622, 4.18307823843347, 3.367102164918856, 1.8298194912614487, 4.083307670114814, -0.7290822588674718, 2.6138999352831176, 0.9723488431176048, 5.392405269403773, 0.37646835709136584, 4.47687666156941, 4.271045285249889, 2.605628395712896, 3.9916229219463615, 0.7871064361149256)
lm.residuals
// res11: DenseVector[Double] = DenseVector(0.7091223481792295, 5.173841154400777, 5.12557161203155, -1.5778438516783866, -1.8569810243867655, 4.310936548435028, -0.9280255283861925, -3.2712470875074526, 2.823295727164516, 0.2279418615574409, -2.0840703897509343, 2.5027703099051894, -1.6887693769264773, -0.5782793538430959, 1.0302975175864528, -3.133083707330022, 2.9493030506614737, 1.3627255345126095, 0.9161249500966977, 0.7800448171924028, 0.8427811255159581, -2.98618350739498, 5.450274087722514, -3.2671089932552855, -0.7543055296295154, -2.4405634105874308, -1.761430774041965, 0.9060419959028501, 0.9768514423043673, -0.6107715200669457, -1.7249319389694087, 2.4942783604315313, -0.7359004265716635, 1.6410077506867575, 1.3416887239441588, 1.317459624769186, -1.2425597704562374, -2.614292638235005, -0.8871009690920721, 0.1779996497584027, -1.0225927210477659, 1.3686778873336503, 0.4483896766014326, -0.4694079923621044, -1.0228230512460117, -1.7049209694163145, 1.3107938271915076, 1.2192253045527623, -3.102096572732954, -5.945654326538646, 5.711501357013224, -2.3290557062973556, -6.733218358302916, -3.466402858991694, -0.805713314137932, 1.0288692424284425, -2.601398458753315, -4.131140037711644, 3.046580434354326, 0.29540651911076565, -3.790004260409794, -3.5027396683720933, -0.8250477875529398, 1.4311918119057605, 2.0492901319837173, -0.15864694958914294, -2.7624245137197576, 2.3070004742526122, 4.185346914472285, 2.717158006259381, -1.7230666756134831, -3.7211249592213127, -0.9982314303244655, -1.344797592381884, 4.882833964270629, 0.4346535369448472, -3.2635717594487765, 0.13056340049485282, -1.912201153859403, 1.8522740328549947, 3.707573158674539, 1.2581209654561905, -1.9903504983600133, -0.5081957248462916, -2.412678110411782, 8.360096170202837, 2.088607718309369, -0.2368811153126198, -4.158032004427586, 1.621573245858782, 0.058374085542571064, -4.442969806059029, -3.400872456629767, -3.3640819844562704, 1.3825974662744833, 0.3058536852521909, 2.1567729079416136, 3.857921423959344, 3.096178571129733, 6.620008503258937)
lm.studentised
// res12: DenseVector[Double] = DenseVector(0.2597909276929286, 1.842147502433902, 1.850176711743018, -0.5600175948842018, -0.6755394906133575, 1.5562863748139513, -0.32938081739084457, -1.1750226501611492, 1.0041854223911326, 0.0810467937878524, -0.7376141817507108, 0.9026065343733943, -0.6024992384224279, -0.21097994597081735, 0.368085871522204, -1.119044617167925, 1.0791922943296848, 0.49226614317747674, 0.3260801218645515, 0.27952926690015, 0.3061769348856527, -1.0588385093651822, 1.9370192922206764, -1.177219791474822, -0.27597576176539257, -0.8629198865471185, -0.6249925625466469, 0.32137742590188956, 0.3507774471836336, -0.21629701187610154, -0.6100432830089081, 0.898410999498933, -0.2621488617288868, 0.5947752060802295, 0.48039415566733235, 0.46644318058824663, -0.4531531010340832, -0.9525809820793505, -0.3149654247159939, 0.06402299776972452, -0.3653467843307896, 0.4993439921559865, 0.16123115212777867, -0.17234951744558977, -0.3645648847574739, -0.6105734028145229, 0.4740773007118275, 0.4318369889484053, -1.1066252020083127, -2.1950372719252695, 2.039911442152485, -0.8318138828893082, -2.3949748881921953, -1.2603173219991548, -0.2877342306132963, 0.37305655619167416, -0.9280464774443711, -1.4709046349941348, 1.086662776418133, 0.10552906047835525, -1.3440195340972545, -1.2645332898073205, -0.2940187451371481, 0.5255828069999182, 0.7460063023713, -0.05701259507388132, -1.0014399589874985, 0.8162639184792851, 1.493552668304258, 0.9726259390775505, -0.6314902473188319, -1.3917404688423545, -0.36919448770562396, -0.4791340529915671, 1.7343571786324803, 0.15391033614690894, -1.167614187542244, 0.046326443939423756, -0.6796135740013112, 0.6655018935159508, 1.3198343723695756, 0.4500777145865783, -0.7142409285297328, -0.1826349658662491, -0.8647700709727423, 2.9775524187280937, 0.7455254625983264, -0.08414742872281115, -1.4760302283202789, 0.5892259299405113, 0.020991603874166147, -1.5721818117948019, -1.228350464871065, -1.2363209727806213, 0.49385280218036254, 0.1090019585587788, 0.7674384308446569, 1.3653469001515472, 1.098151239611052, 2.360070954653758)
val pred = lm.predict()
// pred: PredictLm = PredictLm(
//   Lm(
//     DenseVector(2.198128341210162, 8.355979960974409, 10.473733004668315, 1.6894613045157008, -2.967111625599838, 6.947729576031088, 2.1619328830393787, 0.47481328455098737, 7.144097404692456, 3.9418185996107677, 0.03212084695712347, 8.72237476479171, -1.4256533981727337, 3.9348056626667156, 6.054281980989806, -1.864626592228899, 0.8320962875855797, 6.293299159456135, 3.469709960754984, 3.272377051794958, 7.649727541692703, -1.9337702035580993, 7.898542214241296, 0.7153543586147855, -2.7648940704646496, 0.2298147622630835, 0.26483217606173026, 2.237733501763108, 6.366437752232988, 3.1220633523548424, 1.6913801186540898, 2.668128905547637, 1.0792708884649076, 0.4086461589978194, 1.7937187607417666, 5.004019454483437, 3.2120541099815636, 5.048464207235211, 1.6713832433953373, -0.14374735701251623, -0.3184030424414799, 2.9836157454715346, -0.058370522251406376, 2.7909960548553348, -0.6150573062980325, 1.227589805101074, 6.176789927077822, 4.295584683322472, 1.3815477855593956, -3.1972600399437314, 7.597391753874803, 0.427316087404757, -3.5705773280562108, -2.845082307208922, 2.3000913522111603, 3.9948897010681694, 1.6066239306186203, 0.6583841574139999, 6.0190971398965205, 0.7606736743506877, -0.311020066981178, 1.7905055688576277, 4.311100648051689, 7.5229755049222025, 8.580283398492737, 0.7831718072749785, -1.3819196732559027, 5.2562056140381, 8.300085102093465, 2.793149041681657, 1.315131658263057, -1.149051779679045, 7.7069836925414625, 1.1398118978414506, 8.86628235862281, 3.615029510114636, -0.24634962656373283, 2.978785203901567, -0.6812994910591903, 3.949302925969679, 7.669073173870734, 7.1322390703172704, -0.9175395490223295, 2.648697806592934, -2.913503936933102, 9.4155740399576, 6.271685956742839, 3.130221049606236, -2.328212513166137, 5.704880915973596, -0.6707081733249007, -1.829069870775911, -2.428523613512162, 2.028323284947503, 1.7590658233658492, 4.782730346821601, 6.427818193191502, 6.46354981967224, 7.087801493076094, 7.407114939373862),
//     0.9637606839469512     -3.2682992310604098   7.263347925488084      
// -0.5015172538929015    3.0171069574080223    -0.47082402769992004   
// 0.22879972840307367    4.740001295461019     6.3271963772946895     
// 0.799275450100407      0.02228847604021611   3.2021595692045155     
// -0.8731962781503994    -3.067297883290956    5.734480711011326      
// 0.6763191323768383     -0.6732055639942502   -3.070059139371093     
// -0.5107154515900609    2.87191802554496      3.284062328133352      
// -0.35153193242209874   3.579155831259828     -2.3045343576475608    
// -0.044146292619677736  3.7564096009879453    1.1350971521585187     
// 0.1105206138111609     2.3841355178085375    5.278189301748242      
// -0.5996924524883175    1.5156170189562608    2.013891826590406      
// 1.392976942560567      3.3647258366311683    5.7910764029042126     
// -0.43781940557548665   -1.8688907236940566   1.7525017763599486     
// 0.11754474557683336    3.708002734217521     -4.616377706996284     
// 1.2020126211471382     1.8915481961114204    4.969277042485948      
// 0.35746367859016326    -2.147061741496025    1.819188595614625      
// -1.3129995126152831    -3.61311753794649     -0.5777239204927391    
// 0.7270938923979317     2.9166200745351514    -3.1212249312318647    
// -0.6672683895049795    2.3718860930854544    4.760659979307472      
// -1.100432936778921     3.3366470096072502    -0.7633182459083776    
// 1.8353794047213041     3.2549081188097113    5.936169227912212      
// -0.6599165457997326    -0.06224806391909099  2.214671129936609      
// ...
pred.fitted
// res13: DenseVector[Double] = DenseVector(1.4890059930309265, 3.1821388065736342, 5.348161392636762, 3.2673051561940865, -1.1101306012130727, 2.6367930275960596, 3.089958411425571, 3.74606037205844, 4.320801677527939, 3.713876738053326, 2.1161912367080573, 6.21960445488652, 0.2631159787537435, 4.513085016509811, 5.0239844634033535, 1.2684571151011228, -2.117206763075894, 4.930573624943525, 2.5535850106582854, 2.492332234602555, 6.806946416176743, 1.0524133038368806, 2.448268126518781, 3.982463351870071, -2.0105885408351343, 2.670378172850514, 2.0262629501036944, 1.3316915058602572, 5.38958630992862, 3.7328348724217872, 3.4163120576234975, 0.17385054511610498, 1.8151713150365705, -1.232361591688938, 0.4520300367976078, 3.68655982971425, 4.4546138804378, 7.662756845470215, 2.5584842124874085, -0.32174700677091966, 0.7041896786062857, 1.6149378581378842, -0.5067601988528394, 3.2604040472174387, 0.40776574494797924, 2.932510774517388, 4.865996099886314, 3.076359378769709, 4.483644358292349, 2.7483942865949142, 1.8858903968615786, 2.756371793702113, 3.1626410302467045, 0.6213205517827713, 3.1058046663490915, 2.9660204586397265, 4.208022389371935, 4.789524195125644, 2.9725167055421937, 0.4652671552399217, 3.4789841934286154, 5.293245237229719, 5.136148435604628, 6.091783693016442, 6.530993266509018, 0.941818756864121, 1.380504840463854, 2.949205139785487, 4.11473818762118, 0.07599103542227592, 3.0381983338765393, 2.572073179542268, 8.705215122865926, 2.4846094902233347, 3.983448394352179, 3.180375973169788, 3.0172221328850437, 2.848221803406714, 1.2309016628002127, 2.0970288931146834, 3.961500015196194, 5.874118104861078, 1.0728109493376836, 3.1568935314392252, -0.5008258265213208, 1.055477869754762, 4.1830782384334695, 3.3671021649188546, 1.8298194912614483, 4.083307670114814, -0.7290822588674718, 2.6138999352831167, 0.9723488431176053, 5.392405269403772, 0.37646835709136545, 4.476876661569408, 4.271045285249888, 2.6056283957128956, 3.9916229219463606, 0.7871064361149256)
pred.se
// res14: DenseVector[Double] = DenseVector(0.8024216682335517, 0.4542510671190049, 0.6479901050728277, 0.3953297970879966, 0.7335940815179887, 0.6492699099936351, 0.3953635327461309, 0.5864759176769077, 0.4357097399156254, 0.4295741531588281, 0.3339642190657436, 0.6371606671770434, 0.48791410786598993, 0.7628149658229489, 0.5096573622221153, 0.5057088199997819, 0.7911391544791798, 0.6566705599375952, 0.44854765837624816, 0.55432548388222, 0.7195516884389195, 0.37517349438155334, 0.421171908935561, 0.6264035533200015, 0.7899254282127685, 0.30898078832301995, 0.38934695617417875, 0.38260525503173765, 0.5825131308906313, 0.3477014484770009, 0.31536921165642523, 0.6217472366611395, 0.4628661914719381, 0.6944352659762769, 0.5424866288988862, 0.341825615633276, 0.7588157159799493, 0.7500890685891136, 0.40230195756409143, 0.6039614474142797, 0.5102268272953956, 0.7627035793764312, 0.6003097301775281, 0.8225794957141929, 0.4723831911549951, 0.5453813831044775, 0.6705655854319666, 0.35107090981571104, 0.4863946269145642, 0.8703936372873426, 0.5051954893040109, 0.5046684866306457, 0.43657454298843706, 0.7278188385787862, 0.5034042214140112, 0.6987681838482331, 0.4870490724080939, 0.4543825543063234, 0.48404128281240083, 0.5084346754440408, 0.3777344399429918, 0.6493929369687155, 0.4693644713192453, 0.8243156210863977, 0.7405711604509854, 0.5927142159952876, 0.6967599123422058, 0.326505490518079, 0.4917144528685622, 0.5386649968816564, 0.8058713126097714, 0.972498459449679, 0.8854097682530897, 0.4656482655914765, 0.41024556795051703, 0.3452012674236744, 0.5311100969869402, 0.389264384513854, 0.4217283855778961, 0.5898481752822171, 0.45097564923777467, 0.5297165095772695, 0.5736114980444664, 0.5931302903892706, 0.5573422655321135, 0.4596880280675787, 0.49597961713761424, 0.41219043915982345, 0.39854228803951824, 0.7216723159164248, 0.6012635391980143, 0.32911369211177743, 0.6550662274530754, 0.830940257583063, 0.5066487641904462, 0.47031635564437885, 0.44322709171653696, 0.33246121306110565, 0.38112499239988806, 0.47590629336164364)
val predNew = lm.predict(DenseMatrix((1.1, 1.6, 1.0), (1.4, 2.2, 3.0)))
// predNew: PredictLm = PredictLm(
//   Lm(
//     DenseVector(2.198128341210162, 8.355979960974409, 10.473733004668315, 1.6894613045157008, -2.967111625599838, 6.947729576031088, 2.1619328830393787, 0.47481328455098737, 7.144097404692456, 3.9418185996107677, 0.03212084695712347, 8.72237476479171, -1.4256533981727337, 3.9348056626667156, 6.054281980989806, -1.864626592228899, 0.8320962875855797, 6.293299159456135, 3.469709960754984, 3.272377051794958, 7.649727541692703, -1.9337702035580993, 7.898542214241296, 0.7153543586147855, -2.7648940704646496, 0.2298147622630835, 0.26483217606173026, 2.237733501763108, 6.366437752232988, 3.1220633523548424, 1.6913801186540898, 2.668128905547637, 1.0792708884649076, 0.4086461589978194, 1.7937187607417666, 5.004019454483437, 3.2120541099815636, 5.048464207235211, 1.6713832433953373, -0.14374735701251623, -0.3184030424414799, 2.9836157454715346, -0.058370522251406376, 2.7909960548553348, -0.6150573062980325, 1.227589805101074, 6.176789927077822, 4.295584683322472, 1.3815477855593956, -3.1972600399437314, 7.597391753874803, 0.427316087404757, -3.5705773280562108, -2.845082307208922, 2.3000913522111603, 3.9948897010681694, 1.6066239306186203, 0.6583841574139999, 6.0190971398965205, 0.7606736743506877, -0.311020066981178, 1.7905055688576277, 4.311100648051689, 7.5229755049222025, 8.580283398492737, 0.7831718072749785, -1.3819196732559027, 5.2562056140381, 8.300085102093465, 2.793149041681657, 1.315131658263057, -1.149051779679045, 7.7069836925414625, 1.1398118978414506, 8.86628235862281, 3.615029510114636, -0.24634962656373283, 2.978785203901567, -0.6812994910591903, 3.949302925969679, 7.669073173870734, 7.1322390703172704, -0.9175395490223295, 2.648697806592934, -2.913503936933102, 9.4155740399576, 6.271685956742839, 3.130221049606236, -2.328212513166137, 5.704880915973596, -0.6707081733249007, -1.829069870775911, -2.428523613512162, 2.028323284947503, 1.7590658233658492, 4.782730346821601, 6.427818193191502, 6.46354981967224, 7.087801493076094, 7.407114939373862),
//     0.9637606839469512     -3.2682992310604098   7.263347925488084      
// -0.5015172538929015    3.0171069574080223    -0.47082402769992004   
// 0.22879972840307367    4.740001295461019     6.3271963772946895     
// 0.799275450100407      0.02228847604021611   3.2021595692045155     
// -0.8731962781503994    -3.067297883290956    5.734480711011326      
// 0.6763191323768383     -0.6732055639942502   -3.070059139371093     
// -0.5107154515900609    2.87191802554496      3.284062328133352      
// -0.35153193242209874   3.579155831259828     -2.3045343576475608    
// -0.044146292619677736  3.7564096009879453    1.1350971521585187     
// 0.1105206138111609     2.3841355178085375    5.278189301748242      
// -0.5996924524883175    1.5156170189562608    2.013891826590406      
// 1.392976942560567      3.3647258366311683    5.7910764029042126     
// -0.43781940557548665   -1.8688907236940566   1.7525017763599486     
// 0.11754474557683336    3.708002734217521     -4.616377706996284     
// 1.2020126211471382     1.8915481961114204    4.969277042485948      
// 0.35746367859016326    -2.147061741496025    1.819188595614625      
// -1.3129995126152831    -3.61311753794649     -0.5777239204927391    
// 0.7270938923979317     2.9166200745351514    -3.1212249312318647    
// -0.6672683895049795    2.3718860930854544    4.760659979307472      
// -1.100432936778921     3.3366470096072502    -0.7633182459083776    
// 1.8353794047213041     3.2549081188097113    5.936169227912212      
// -0.6599165457997326    -0.06224806391909099  2.214671129936609      
// ...
predNew.fitted
// res15: DenseVector[Double] = DenseVector(4.680990948579704, 5.50180693475753)
predNew.se
// res16: DenseVector[Double] = DenseVector(0.44770593741236264, 0.5089364242249554)
lm.plots
// res17: Figure = breeze.plot.Figure@6271e058
lm.summary
// Estimate	 S.E.	 t-stat	p-value		Variable
// ---------------------------------------------------------
//   2.0610	 0.379	 5.444	0.0000 *	(Intercept)
//   1.4801	 0.285	 5.191	0.0000 *	V1
//   0.6181	 0.122	 5.060	0.0000 *	V2
//   0.0030	 0.093	 0.032	0.9745  	V3
// 
// Residual standard error:   2.8451 on 96 degrees of freedom
// Multiple R-squared: 0.3491, Adjusted R-squared: 0.3287
// F-statistic: 17.1594 on 3 and 96 DF, p-value: 0.00000
//
```
The plots include a plot of studentised residuals against fitted values and a normal Q-Q plot for the studentised residuals.

![Linear model plots](lm-plots.png)


## Generalised linear models

The current implementation supports only simple one-parameter exponential family observation models. This includes the most commonly used cases of **logistic regression** (`LogisticGlm`) and **Poisson regression** (`PoissonGlm`).

### Logistic regression

Again, we start by creating an appropriate response variable.
```scala
val ylb = (0 until 100) map (i => Bernoulli(sigmoid(1.0 + X(i,0))).sample())
val yl = DenseVector(ylb.toArray map {b => if (b) 1.0 else 0.0})
```

Then we can do logistic regression in a typical way.
```scala
import scalaglm.{Glm, LogisticGlm}
val glm = Glm(yl, X, List("V1","V2","V3"), LogisticGlm)
```
```scala
glm.coefficients
// res20: DenseVector[Double] = DenseVector(1.1550235845217225, 0.5783657263305534, 0.10764405001364456, -0.06504304136034522)
glm.fitted
// res21: DenseVector[Double] = DenseVector(0.7085157936979153, 0.7721270078446493, 0.799960314704059, 0.8039895244448876, 0.4867112182597032, 0.8420289757050308, 0.722156276937364, 0.8156092625035383, 0.8115350995823691, 0.7562582098589882, 0.6985367198060298, 0.875031392808093, 0.6425940263855939, 0.8724075083559024, 0.8494921558286197, 0.7334747806750335, 0.511067187991809, 0.8901740857548585, 0.6714543060562086, 0.7165453975626821, 0.8985128774009546, 0.6508098496297886, 0.7931639768257669, 0.7173038708663799, 0.4025389099809852, 0.7579563859025291, 0.6636285976478347, 0.6888792507380054, 0.852956046765467, 0.8162164682649491, 0.8039133196458556, 0.5359786828468782, 0.768145575069279, 0.4554380783607606, 0.598008782611788, 0.7762713911777646, 0.9079367886269072, 0.9324847875479255, 0.788072204993208, 0.6166128888549626, 0.6133791771266139, 0.8130490477562574, 0.5107462110449597, 0.8370439337508313, 0.5718768338806574, 0.7336509029075176, 0.8273693212515211, 0.7447919231033796, 0.8085948501091358, 0.8693037096200776, 0.6812000990067414, 0.7081960886254421, 0.7305538327579051, 0.5264546369943253, 0.7696860580794501, 0.8496002378692834, 0.8661857951138712, 0.8563397190604783, 0.7136372846124591, 0.6530039930512829, 0.7725883247390984, 0.8287532086331821, 0.8581137106907792, 0.9364687812021738, 0.933622405754555, 0.7408038697594742, 0.6677321258257878, 0.7599608932559051, 0.7632632359894781, 0.6264277028431432, 0.7658933564548946, 0.5340159579554796, 0.9505030382384853, 0.7044088559446687, 0.7786817750949319, 0.7920535844797334, 0.8371276565752996, 0.7479903373490966, 0.7137417604844634, 0.6079781984051275, 0.8540972688162671, 0.8744593073478213, 0.7357004136020275, 0.709773024430461, 0.548529396553472, 0.6779059970533837, 0.7804631141005407, 0.8142932341256746, 0.716341813718518, 0.7476861514319667, 0.5871356063846939, 0.7448665830878564, 0.5873674883130353, 0.7873082177869875, 0.6687248936711273, 0.8684287043326409, 0.8028350577977942, 0.7231376520451983, 0.7834690959895153, 0.5781865654917253)
glm.predict(response=true).fitted
// res22: DenseVector[Double] = DenseVector(0.7085157936979153, 0.7721270078446493, 0.799960314704059, 0.8039895244448876, 0.4867112182597032, 0.8420289757050308, 0.722156276937364, 0.8156092625035383, 0.8115350995823691, 0.7562582098589882, 0.6985367198060298, 0.875031392808093, 0.6425940263855939, 0.8724075083559024, 0.8494921558286197, 0.7334747806750335, 0.511067187991809, 0.8901740857548585, 0.6714543060562086, 0.7165453975626821, 0.8985128774009546, 0.6508098496297886, 0.7931639768257669, 0.7173038708663799, 0.4025389099809852, 0.7579563859025291, 0.6636285976478347, 0.6888792507380054, 0.852956046765467, 0.8162164682649491, 0.8039133196458556, 0.5359786828468782, 0.768145575069279, 0.4554380783607606, 0.598008782611788, 0.7762713911777646, 0.9079367886269072, 0.9324847875479255, 0.788072204993208, 0.6166128888549626, 0.6133791771266139, 0.8130490477562574, 0.5107462110449597, 0.8370439337508313, 0.5718768338806574, 0.7336509029075176, 0.8273693212515211, 0.7447919231033796, 0.8085948501091358, 0.8693037096200776, 0.6812000990067414, 0.7081960886254421, 0.7305538327579051, 0.5264546369943253, 0.7696860580794501, 0.8496002378692834, 0.8661857951138712, 0.8563397190604783, 0.7136372846124591, 0.6530039930512829, 0.7725883247390984, 0.8287532086331821, 0.8581137106907792, 0.9364687812021738, 0.933622405754555, 0.7408038697594742, 0.6677321258257878, 0.7599608932559051, 0.7632632359894781, 0.6264277028431432, 0.7658933564548946, 0.5340159579554796, 0.9505030382384853, 0.7044088559446687, 0.7786817750949319, 0.7920535844797334, 0.8371276565752996, 0.7479903373490966, 0.7137417604844634, 0.6079781984051275, 0.8540972688162671, 0.8744593073478213, 0.7357004136020275, 0.709773024430461, 0.548529396553472, 0.6779059970533837, 0.7804631141005407, 0.8142932341256746, 0.716341813718518, 0.7476861514319667, 0.5871356063846939, 0.7448665830878564, 0.5873674883130353, 0.7873082177869875, 0.6687248936711273, 0.8684287043326409, 0.8028350577977942, 0.7231376520451983, 0.7834690959895153, 0.5781865654917253)
glm.summary
// Estimate	 S.E.	 z-stat	p-value		Variable
// ---------------------------------------------------------
//   1.1550	 0.332	 3.484	0.0005 *	(Intercept)
//   0.5784	 0.255	 2.264	0.0235 *	V1
//   0.1076	 0.100	 1.077	0.2814  	V2
//  -0.0650	 0.082	-0.793	0.4278  	V3
glm.plots
// res24: Figure = breeze.plot.Figure@4ea61d9d
```

![Logistic regression plots](glm-plots.png)


### Poisson regression

We first create an appropriate response, and then do Poisson regression.
```scala
val yp = DenseVector.tabulate(100)(i => Poisson(math.exp(-0.5 + X(i,0))).sample().toDouble)

import scalaglm.PoissonGlm
val pglm = Glm(yp, X, List("V1","V2","V3"), PoissonGlm)
```
```scala
pglm.coefficients
// res26: DenseVector[Double] = DenseVector(-0.21180358125230062, 1.0279896465359901, -0.006644079941943639, -0.04126543570795027)
pglm.summary
// Estimate	 S.E.	 z-stat	p-value		Variable
// ---------------------------------------------------------
//  -0.2118	 0.144	-1.467	0.1424  	(Intercept)
//   1.0280	 0.097	10.625	0.0000 *	V1
//  -0.0066	 0.039	-0.170	0.8653  	V2
//  -0.0413	 0.026	-1.585	0.1130  	V3
pglm.plots
// res28: Figure = breeze.plot.Figure@654265b1
```
![Poisson regression plots](pglm-plots.png)


## Non-linear response

The above covers the main functionality of the library based on a linear reponse to variation in covariate values. For flexible modelling of a nonlinear response, see the documentation on [flexible regression modelling](FlexibleRegression.md).


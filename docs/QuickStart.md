# scala-glm - Quickstart Guide

## PCA

This library contains code for principal components analysis based on a thin SVD of the centred data matrix. This is more numerically stable than a construction from the spectral decomposition of the covariance matrix. It is analogous to the R function `prcomp` rather than the R function `princomp`. First create some synthetic data.

```scala
import breeze.linalg._
import breeze.numerics._
import breeze.stats.distributions._
val X = DenseMatrix.tabulate(100, 3)((i, j) => 
	Gaussian(j, j+1).sample())
```
Now we can do PCA.
```scala
import scalaglm.Pca
val pca = Pca(X, List("V1", "V2", "V3"))
```
```scala
pca.sdev
// res0: DenseVector[Double] = DenseVector(3.180911760995804, 1.9850118349266768, 1.033010973911513)
pca.loadings
// res1: DenseMatrix[Double] = 0.005352553471200841   -0.04404631019467599  0.9990151514014052    
// -0.015017671960385837  0.9989132564708931    0.044122279809709224  
// -0.9998729017731343    -0.0152390486891541   0.004685263580782778  
pca.scores
// res2: DenseMatrix[Double] = 0.9396947313883746     1.6201653494235724     -0.700486770450087     
// -3.6128030271464593    -1.89915017978363      0.8767802686914198     
// -5.919219817026025     -1.1749899542590954    1.7694236757090285     
// 0.0021573276590510573  -3.7921023447333337    -0.2501671431910632    
// 1.4805507366686206     -0.8808621676495219    0.03028543674591419    
// -1.4582025417295532    -2.678163140703104     1.7272503144825249     
// -1.0425144844636578    0.7989235560858654     1.403041052638804      
// 4.435985000752574      -0.1297800799903101    -0.2662823270032302    
// 4.948990745192359      1.120232535793215      0.7916706411123443     
// -0.8351017532878735    0.8170167907549901     0.22120301369420628    
// 0.09294716265208285    0.5056492092235854     0.9883039878383643     
// -7.900064441429062     0.8118788809016264     -0.14877745218387212   
// -4.678829374738343     -0.562367452952324     -0.06688737309624587   
// -2.3726383722418602    2.3875004115996563     -0.6207267253682307    
// 1.4443588997222727     3.362385581021047      0.47577914571644847    
// 3.429414874756374      0.9151692845022209     0.08029211823406704    
// 0.946429270621384      -0.9807819918461484    -0.22615114572385428   
// -0.34385875393585313   0.6963199847870445     -0.24741936941270626   
// 1.2680770776238426     -0.041879915217655564  -0.32576487919456026   
// 0.03722634927791214    0.8320274159509848     -0.9971693208650922    
// -1.545555944661474     0.3141769609391166     -1.111939654344508     
// -3.616089119003165     2.094237685081125      0.6191573029606173     
// -3.4311176113204325    -0.14371453321299743   -0.8537594725279154    
// 3.004168448699288      -2.7547560856733253    1.0154489086030174     
// -0.9025691919189537    1.290256385164371      -0.5793171320571037    
// 0.8722891606973772     -0.3754925963784569    -0.8849323519954674    
// 2.0713211117957138     0.8658073762476891     0.11865269750455468    
// -4.382336020641834     -0.3351190712810763    1.585851536693138      
// 2.41562879752868       1.4273174768787256     0.5493850377597106     
// -1.4696005988045804    0.18173225947240051    -0.5402071496841379    
// -2.66429512326852      0.2635418386706175     -0.6097783681288936    
// 4.137473005602301      1.4778198038432828     -0.5158451725100881    
// -5.382692341962625     1.9895221830128298     1.1504602568268563     
// 1.618274388524739      0.8316377209803358     0.4943360035159993     
// 3.1160103409408446     -2.7442863305801724    0.856856651394816      
// -0.21181871540915323   0.3047518179409178     -0.3490674149375211    
// 6.905932046300504      1.0792449009689493     -0.6402182594251818    
// -2.299423284680622     -4.073993329982164     -1.474642508882203     
// 0.2934575287837925     -1.5184478859762078    0.28098656334713784    
// 7.590297238330904      2.5014839617669193     -1.5625978221503083    
// -1.1344536586177116    0.5428260875628247     -2.040180849916773     
// -1.6143624121218374    -1.6828230485072329    0.6835748750989724     
// -2.2408843800479405    3.7733960545742886     -0.4231031496145369    
// 7.360735081049813      -3.6716639420021804    -0.5108556268170178    
// -5.064351281804167     -2.223721236375604     -1.1777714135697457    
// -3.4357651221120404    -1.6437284846808566    -0.6279364252119526    
// -0.4904816192334755    -1.5210067055744037    -0.49347003249397553   
// 0.9620694788625113     -1.2676396031193176    -1.7703108599762034    
// 0.13321452097901013    -3.6842492301286094    2.3849234210978665     
// ...
pca.plots
// res3: breeze.plot.Figure = breeze.plot.Figure@3bce213d
pca.summary
// Standard deviations:
// V1	V2	V3
//  3.181	 1.985	 1.033
// Cumulative proportion of variance explained:
// V1	V2	V3
//  0.669	 0.929	 1.000
// Loadings:
// PC01	PC02	PC03	
//  0.005	-0.044	 0.999	V1
// -0.015	 0.999	 0.044	V2
// -1.000	-0.015	 0.005	V3
```
The final line prints a readable summary of the PCA to the console. `plots` produces some diagnostic plots, including a "scree plot".

![PCA Plots](pca-plots.png)

Note that there is also a utility function `pairs` for producing a "scatterplot matrix":
```scala
import scalaglm.Utils.pairs
pairs(X, List("V1", "V2", "V3"))
// res6: breeze.plot.Figure = breeze.plot.Figure@4435024f
```

![Pairs plots](pairs-plots.png)


## Linear regression

This code computes regression coefficients and associated diagnostics via the QR decomposition of the covariate matrix. The diagnostics are analogous to those produced by the R function `lm`. We start by creating a synthetic response variable.

```scala
val y = DenseVector.tabulate(100)(i => 
	Gaussian(2.0 + 1.5*X(i,0) + 0.5*X(i,1), 3.0).sample())
```
So we can now do linear regression and generate all of the usual diagnostics.
```scala
import scalaglm.Lm
val lm = Lm(y,X,List("V1", "V2", "V3"))
```
```scala
lm.coefficients
// res8: DenseVector[Double] = DenseVector(1.8705671023604222, 1.2383905470681076, 0.30832707918268226, 0.04905414888050152)
lm.se
// res9: DenseVector[Double] = DenseVector(0.3533193492511125, 0.2708705580914014, 0.14142366940691317, 0.0880536898932226)
lm.fitted
// res10: DenseVector[Double] = DenseVector(1.7675658442234483, 3.065604522459254, 4.4738158008837665, 1.0073598853015047, 2.024313807474263, 3.831318360475156, 4.284825621963621, 1.7040506427101527, 3.3192937618765765, 2.8011539216731687, 3.638454573168506, 2.6694127256361715, 2.2730302021218436, 2.2170943687314715, 3.6555913510518834, 2.4490323384991664, 1.7033911312779035, 2.161292372012576, 1.8008990445863562, 1.2397145911271457, 1.0397460675577106, 3.7525924168455207, 1.3357376351081274, 2.711543179523418, 1.9224603324111125, 1.0356963012611111, 2.5484458846755578, 4.384089854038008, 3.2129869922928798, 1.7179440210257708, 1.7077932411810703, 1.812128388168269, 4.473911777913389, 3.031108639789432, 2.5105270533997297, 1.9289692612745863, 1.4255627835747726, -0.4874092819236589, 2.232677937850722, 0.598859164882104, -0.08305125008734313, 2.7845429917355107, 2.808336397099582, 0.3654528602876151, 0.4816269132182027, 1.2394115990353636, 1.3000664911161268, -0.301584346034364, 4.324959003951861, 2.537259789193407, -0.6866451551587587, 1.788428427067744, 0.459741239228662, 0.16930337340464155, 3.8970865185607657, 4.448317250347403, 1.3414689120802914, 3.6955539039928387, 3.332395229256138, 1.0499421601750296, 2.364475778013605, 1.6372856521597892, 2.744475389453966, 3.9649100065662943, 2.614486345229664, 1.108782846208913, 2.7111156479849305, 4.839460454520149, 2.7720335628467705, -0.8235718506101433, 1.723250816649923, 0.5427393282617131, 2.500923362442225, 2.225731024723614, 3.687088673312709, 2.699437318207703, 5.211107732108961, -0.2890599908944841, 2.3960597152102237, 1.8101203633356004, 3.4434577377829783, 4.332761843508897, 2.0994540301240288, 2.7442846703300874, 2.1212767041117258, 2.5260325355944597, 1.8694000121624585, 2.338499383530335, 3.815331551438578, 4.317304663744325, 6.085851439324869, 1.3514510748716781, 0.6749456168218406, 3.5140650819663293, 2.7013966376757983, 3.5804135656631617, -0.40177572717672005, 1.3242460878692643, 0.9530757452016296, 2.100288658581182)
lm.residuals
// res11: DenseVector[Double] = DenseVector(0.7201870600197369, 3.40219420884309, -0.8477023970514139, 3.031760712586028, -0.9226710589645268, -2.721583788019526, -3.789268910963105, 1.4974954949503347, 2.299620370510183, -1.8957893849725438, -3.0688443359068716, 0.580820443451779, 1.5984654925707966, -1.0206109390337128, 0.8151305730012042, 1.0484861484874486, -2.7548614496599955, 5.199844619403723, 2.9139820592239056, 2.460963260689174, 3.812995311147705, -1.0306158588323457, -1.2845950060390876, 0.769239402920677, -5.413997375020973, 2.1991251079950587, 0.6676068777372284, 0.30677298007070686, -3.2520347124148756, -0.8965678250666487, -0.2794063785559424, 0.0029998914339772753, 0.8466896682897938, -6.331714844971595, -7.651780226895743, 4.225554998178513, -1.166219268392939, 2.429152576218722, -1.1203826091556994, 2.2706450607392243, -0.20126120849804632, -1.4389259912264674, 0.7951021421085214, -4.511394991783015, 1.3051383206740255, -1.0183302227862008, 5.19850155144591, -0.7525086780699203, 2.4501364441444657, -2.2281777390516977, 1.6258411684912235, -4.619245418167248, -4.012677664525666, -1.8579784996757254, 2.0399543686301254, 1.2266926114148085, 2.554066752775995, -0.06825647249446787, 3.2653948353088693, 0.6375268785564447, 2.8993201508807855, -5.852954648281539, -2.6593982777542817, 1.1742084156917003, 2.84806387283468, -1.7766956959284332, -5.175244409294783, 2.3454000921916967, -2.542369808244845, 1.3354978999333948, 4.200268056412326, 0.1376308021721966, -0.15191275324440756, 2.2961080170151655, -0.01884964452556037, -1.0533315858425907, 3.9010577419975077, 0.023023763135796238, 2.3024919936820147, 2.5624038968389105, -4.601261129705257, 0.19885247377189952, 4.628662016518168, 2.20617579785068, -3.197580132069916, -0.3456106878038212, 2.3846103405974723, 3.4748356450797786, 0.6669455206611188, 3.272980835647397, 1.0684333965266077, -4.5587266326989475, -0.14963507801123033, -2.867285928170109, -3.2800982775408696, -1.1976354264329192, -0.9474905220645983, -1.379068487946528, 2.450377006493003, -2.662882746195116)
lm.studentised
// res12: DenseVector[Double] = DenseVector(0.26141786482999385, 1.2460201852247859, -0.31689590138264323, 1.114949256207801, -0.33354321425838496, -1.006866448315875, -1.3818972224998782, 0.5458366579054729, 0.843993621751332, -0.6848661838909484, -1.1126139395887251, 0.21666411569043695, 0.583347046037296, -0.3726895933239701, 0.2991031809237572, 0.3809159176993403, -0.9957027244070928, 1.8775931476847532, 1.0525582625487997, 0.8928083281782732, 1.3855429333298388, -0.37713360518382427, -0.46783571195564927, 0.28300677382031175, -1.9612004007602828, 0.7967368958242798, 0.24160201116459362, 0.11316333906980229, -1.1814402990264044, -0.32424134434246893, -0.1013444040543889, 0.001096203430196998, 0.3137132423182816, -2.2918232407427293, -2.811767360695795, 1.5254012729284376, -0.43276843079618377, 0.9082150084439374, -0.4055419122352909, 0.8622746199825637, -0.0741703475084486, -0.522852919392577, 0.2932907856013513, -1.7078989934436422, 0.48352783959407625, -0.3715806191588422, 1.8833470740343585, -0.27634165902017704, 0.9262905256128838, -0.8225848565801392, 0.6032487832590162, -1.679191174990757, -1.4715955499545323, -0.7014520054737982, 0.7443134777870909, 0.45061726451874884, 0.9290021057978285, -0.024819144211107515, 1.1818008650828502, 0.23180854392511466, 1.0818333377216025, -2.1187744491119016, -0.9656530672742555, 0.42715165894585205, 1.0414405187348317, -0.644016806802939, -1.9406439143389995, 0.8676246036463839, -0.9178460575256564, 0.51309657696548, 1.5256527365740225, 0.050360847362414946, -0.05530202575053312, 0.8416888956660411, -0.006856125959677291, -0.382204892381853, 1.4429897189438619, 0.008721276009125246, 0.8357851893446142, 0.9349341451268409, -1.6688724980784477, 0.07339481441647161, 1.702946427098906, 0.7980903220241057, -1.1538171957782304, -0.12550277476866736, 0.8612479792527441, 1.2672852818740075, 0.2443963862791547, 1.2118623446009347, 0.4067815520729642, -1.6855672458167534, -0.054994467211381286, -1.0428475692949548, -1.1932962212163285, -0.43471596379567773, -0.35304248991732606, -0.505299661589595, 0.8982669667407399, -0.96476433676638)
val pred = lm.predict()
// pred: scalaglm.PredictLm = PredictLm(
//   mod = Lm(
//     y = DenseVector(2.487752904243185, 6.467798731302344, 3.6261134038323526, 4.039120597887533, 1.101642748509736, 1.10973457245563, 0.4955567110005159, 3.2015461376604875, 5.6189141323867595, 0.9053645367006249, 0.5696102372616343, 3.2502331690879505, 3.87149569469264, 1.1964834296977587, 4.4707219240530875, 3.497518486986615, -1.0514703183820922, 7.3611369914162985, 4.714881103810262, 3.7006778518163195, 4.852741378705415, 2.721976558013175, 0.05114262906903977, 3.480782582444095, -3.4915370426098598, 3.2348214092561696, 3.216052762412786, 4.690862834108715, -0.039047720121995866, 0.8213761959591221, 1.428386862625128, 1.8151282796022463, 5.320601446203183, -3.3006062051821625, -5.141253173496013, 6.154524259453099, 0.2593435151818335, 1.9417432942950628, 1.1122953286950228, 2.8695042256213283, -0.28431245858538945, 1.3456170005090433, 3.603438539208103, -4.1459421314954, 1.7867652338922282, 0.2210813762491628, 6.498568042562036, -1.0540930241042843, 6.775095448096327, 0.3090820501417091, 0.9391960133324649, -2.8308169910995042, -3.5529364252970037, -1.6886751262710837, 5.937040887190891, 5.675009861762211, 3.8955356648562867, 3.627297431498371, 6.597790064565007, 1.6874690387314744, 5.263795928894391, -4.21566899612175, 0.08507711169968424, 5.139118422257995, 5.462550218064344, -0.6679128497195201, -2.4641287613098526, 7.184860546711846, 0.22966375460192534, 0.5119260493232516, 5.923518873062249, 0.6803701304339097, 2.3490106091978173, 4.5218390417387795, 3.6682390287871485, 1.6461057323651123, 9.112165474106469, -0.26603622775868785, 4.698551708892238, 4.372524260174511, -1.1578033919222794, 4.5316143172807966, 6.728116046642198, 4.950460468180768, -1.0763034279581905, 2.1804218477906385, 4.254010352759931, 5.813335028610114, 4.482277072099697, 7.590285499391722, 7.154284835851477, -3.2072755578272694, 0.5253105388106103, 0.6467791537962202, -0.5787016398650713, 2.3827781392302425, -1.3492662492413183, -0.05482240007726369, 3.4034527516946325, -0.5625940876139341),
//     Xmat = -0.7770989003201118   2.6591090178693353    0.8047302491101178     
// 0.9292601453806075    -0.7184213823859145   5.417670325769778      
// 1.776782628670964     0.07897433962855516   7.716940730874944      
// -0.09385056708616689  -2.713328171615624    1.8267361705571095     
// 0.06600960140264477   0.18492041400449677   0.3054801261829474     
// 1.8247378677685695    -1.4914201619765262   3.2791997790271967     
// 1.3499200562953342    1.9613403146947261    2.8090580556604627     
// -0.24752936268555684  0.8777172799319403    -2.6624137820925418    
// 0.7570691291880772    2.165346597494878     -3.189446539014126     
// 0.16955919639472214   1.9241536416568765    2.595858739868722      
// 0.9545867167466703    1.6330335464705859    1.676266793292548      
// -0.23764617932918966  2.008796225817069     9.658268324635413      
// -0.07806443632859508  0.5912810707181246    6.458768554607657      
// -0.7489451250303464   3.478872910632524     4.105322601537121      
// 0.32397144120493576   4.443756555857366     0.27909155961896515    
// 0.04728987492696402   1.951939047069354     -1.6702718309914744    
// -0.18863224399422177  0.08181587134916635   0.8398549164242368     
// -0.2906560112383617   1.77553398803216      2.10432186174894       
// -0.3277814080428472   1.0104720159479932    0.5034732992300577     
// -1.043605205718503    1.872290251809079     1.717704365482857      
// -1.143925032881505    1.373708343935696     3.3076393096331906     
// ...
pred.fitted
// res13: DenseVector[Double] = DenseVector(1.7675658442234479, 3.065604522459254, 4.4738158008837665, 1.0073598853015044, 2.024313807474263, 3.8313183604751555, 4.28482562196362, 1.7040506427101525, 3.3192937618765765, 2.8011539216731682, 3.6384545731685063, 2.6694127256361715, 2.273030202121844, 2.2170943687314715, 3.655591351051884, 2.449032338499166, 1.7033911312779033, 2.1612923720125754, 1.800899044586356, 1.2397145911271459, 1.0397460675577108, 3.7525924168455207, 1.3357376351081276, 2.7115431795234186, 1.9224603324111122, 1.035696301261111, 2.5484458846755573, 4.384089854038008, 3.2129869922928793, 1.7179440210257708, 1.7077932411810703, 1.8121283881682695, 4.473911777913389, 3.0311086397894313, 2.5105270533997297, 1.9289692612745863, 1.4255627835747728, -0.4874092819236582, 2.2326779378507227, 0.5988591648821042, -0.08305125008734263, 2.7845429917355107, 2.8083363970995823, 0.36545286028761514, 0.4816269132182029, 1.2394115990353636, 1.300066491116127, -0.3015843460343635, 4.324959003951859, 2.5372597891934072, -0.6866451551587587, 1.788428427067744, 0.4597412392286622, 0.16930337340464177, 3.8970865185607653, 4.4483172503474036, 1.3414689120802918, 3.6955539039928382, 3.3323952292561376, 1.0499421601750298, 2.364475778013605, 1.6372856521597892, 2.744475389453967, 3.964910006566294, 2.614486345229664, 1.108782846208913, 2.7111156479849305, 4.839460454520149, 2.77203356284677, -0.8235718506101435, 1.723250816649923, 0.5427393282617137, 2.500923362442225, 2.225731024723614, 3.687088673312709, 2.699437318207703, 5.21110773210896, -0.28905999089448386, 2.396059715210223, 1.8101203633356004, 3.4434577377829783, 4.332761843508896, 2.0994540301240283, 2.7442846703300874, 2.1212767041117258, 2.52603253559446, 1.8694000121624588, 2.3384993835303356, 3.815331551438578, 4.317304663744324, 6.085851439324868, 1.3514510748716784, 0.6749456168218406, 3.5140650819663293, 2.7013966376757983, 3.5804135656631617, -0.40177572717671983, 1.3242460878692646, 0.9530757452016301, 2.100288658581182)
pred.se
// res14: DenseVector[Double] = DenseVector(0.4156368486947491, 0.5540984024026927, 0.7788782046072459, 0.6069365291420535, 0.3318398220796257, 0.6753062526722617, 0.4933433458740271, 0.48544526032744345, 0.5817590146533357, 0.3160794802225638, 0.3931240140931703, 0.7589474811417345, 0.5038716369827148, 0.5128213982255695, 0.5791324534292586, 0.43116231687293083, 0.3278176850706162, 0.30444422264557536, 0.3129169973809733, 0.4055506440435974, 0.43467924971489996, 0.5425814990107278, 0.47203827109023505, 0.6118273760651354, 0.3764613020901386, 0.3792962771655103, 0.3561206082514452, 0.6430155661253617, 0.43076495596759595, 0.3412613617936301, 0.40166404777174175, 0.5227716133072527, 0.6914905362899121, 0.3600491781149561, 0.5972216256070022, 0.2979471925482716, 0.7074543550699833, 0.7801603944335709, 0.3605181608598121, 0.9099453964443075, 0.6318980217667441, 0.4341719898333624, 0.6426693303449222, 0.8859545338407897, 0.6904309026825075, 0.5018319340879711, 0.378703412255, 0.5891080169622009, 0.8750945647285047, 0.6519524503777644, 0.706105147654458, 0.44165670512125804, 0.5720078408226139, 0.8639687485697339, 0.5008318269292542, 0.593070825409707, 0.45161265242555476, 0.4461248094840182, 0.3575424329335039, 0.44565520977228607, 0.7615388921297687, 0.3624714664207194, 0.4218030111464849, 0.45362933883199924, 0.5325406045394286, 0.3892953503219885, 0.8066789980916473, 0.6744277296643192, 0.29976676463400614, 0.9938332838156408, 0.42759680349106677, 0.5419147566442224, 0.46535588596508753, 0.5661415436522813, 0.45127217877020953, 0.40890236754039416, 0.673577296340596, 0.8905171054212847, 0.41591395575209633, 0.5007629171759123, 0.4009147235545372, 0.6494463446351487, 0.6121111151252264, 0.34773371880710446, 0.28677536515449953, 0.4229780657104966, 0.3101705403113912, 0.4940378833669068, 0.5614330320528479, 0.6842004595909957, 0.92929724646621, 0.6691053026886753, 0.5991793044219185, 0.45027622460132494, 0.4545680726552344, 0.4152584863056467, 0.7481092504777552, 0.5601716848485445, 0.5665420620967649, 0.3794907117633405)
val predNew = lm.predict(DenseMatrix((1.1, 1.6, 1.0), (1.4, 2.2, 3.0)))
// predNew: scalaglm.PredictLm = PredictLm(
//   mod = Lm(
//     y = DenseVector(2.487752904243185, 6.467798731302344, 3.6261134038323526, 4.039120597887533, 1.101642748509736, 1.10973457245563, 0.4955567110005159, 3.2015461376604875, 5.6189141323867595, 0.9053645367006249, 0.5696102372616343, 3.2502331690879505, 3.87149569469264, 1.1964834296977587, 4.4707219240530875, 3.497518486986615, -1.0514703183820922, 7.3611369914162985, 4.714881103810262, 3.7006778518163195, 4.852741378705415, 2.721976558013175, 0.05114262906903977, 3.480782582444095, -3.4915370426098598, 3.2348214092561696, 3.216052762412786, 4.690862834108715, -0.039047720121995866, 0.8213761959591221, 1.428386862625128, 1.8151282796022463, 5.320601446203183, -3.3006062051821625, -5.141253173496013, 6.154524259453099, 0.2593435151818335, 1.9417432942950628, 1.1122953286950228, 2.8695042256213283, -0.28431245858538945, 1.3456170005090433, 3.603438539208103, -4.1459421314954, 1.7867652338922282, 0.2210813762491628, 6.498568042562036, -1.0540930241042843, 6.775095448096327, 0.3090820501417091, 0.9391960133324649, -2.8308169910995042, -3.5529364252970037, -1.6886751262710837, 5.937040887190891, 5.675009861762211, 3.8955356648562867, 3.627297431498371, 6.597790064565007, 1.6874690387314744, 5.263795928894391, -4.21566899612175, 0.08507711169968424, 5.139118422257995, 5.462550218064344, -0.6679128497195201, -2.4641287613098526, 7.184860546711846, 0.22966375460192534, 0.5119260493232516, 5.923518873062249, 0.6803701304339097, 2.3490106091978173, 4.5218390417387795, 3.6682390287871485, 1.6461057323651123, 9.112165474106469, -0.26603622775868785, 4.698551708892238, 4.372524260174511, -1.1578033919222794, 4.5316143172807966, 6.728116046642198, 4.950460468180768, -1.0763034279581905, 2.1804218477906385, 4.254010352759931, 5.813335028610114, 4.482277072099697, 7.590285499391722, 7.154284835851477, -3.2072755578272694, 0.5253105388106103, 0.6467791537962202, -0.5787016398650713, 2.3827781392302425, -1.3492662492413183, -0.05482240007726369, 3.4034527516946325, -0.5625940876139341),
//     Xmat = -0.7770989003201118   2.6591090178693353    0.8047302491101178     
// 0.9292601453806075    -0.7184213823859145   5.417670325769778      
// 1.776782628670964     0.07897433962855516   7.716940730874944      
// -0.09385056708616689  -2.713328171615624    1.8267361705571095     
// 0.06600960140264477   0.18492041400449677   0.3054801261829474     
// 1.8247378677685695    -1.4914201619765262   3.2791997790271967     
// 1.3499200562953342    1.9613403146947261    2.8090580556604627     
// -0.24752936268555684  0.8777172799319403    -2.6624137820925418    
// 0.7570691291880772    2.165346597494878     -3.189446539014126     
// 0.16955919639472214   1.9241536416568765    2.595858739868722      
// 0.9545867167466703    1.6330335464705859    1.676266793292548      
// -0.23764617932918966  2.008796225817069     9.658268324635413      
// -0.07806443632859508  0.5912810707181246    6.458768554607657      
// -0.7489451250303464   3.478872910632524     4.105322601537121      
// 0.32397144120493576   4.443756555857366     0.27909155961896515    
// 0.04728987492696402   1.951939047069354     -1.6702718309914744    
// -0.18863224399422177  0.08181587134916635   0.8398549164242368     
// -0.2906560112383617   1.77553398803216      2.10432186174894       
// -0.3277814080428472   1.0104720159479932    0.5034732992300577     
// -1.043605205718503    1.872290251809079     1.717704365482857      
// -1.143925032881505    1.373708343935696     3.3076393096331906     
// ...
predNew.fitted
// res15: DenseVector[Double] = DenseVector(3.775174179708134, 4.429795889099179)
predNew.se
// res16: DenseVector[Double] = DenseVector(0.424723386164213, 0.5179451522442468)
lm.plots
// res17: breeze.plot.Figure = breeze.plot.Figure@170fa260
lm.summary
// Estimate	 S.E.	 t-stat	p-value		Variable
// ---------------------------------------------------------
//   1.8706	 0.353	 5.294	0.0000 *	(Intercept)
//   1.2384	 0.271	 4.572	0.0000 *	V1
//   0.3083	 0.141	 2.180	0.0317 *	V2
//   0.0491	 0.088	 0.557	0.5788  	V3
// 
// Residual standard error:   2.7861 on 96 degrees of freedom
// Multiple R-squared: 0.2053, Adjusted R-squared: 0.1804
// F-statistic: 8.2647 on 3 and 96 DF, p-value: 0.00006
//
```
The plots include a plot of studentised residuals against fitted values and a normal Q-Q plot for the studentised residuals.

![Linear model plots](lm-plots.png)


## Generalised linear models

The current implementation supports only simple one-parameter exponential family observation models. This includes the most commonly used cases of **logistic regression** (`LogisticGlm`) and **Poisson regression** (`PoissonGlm`).

### Logistic regression

Again, we start by creating an appropriate response variable.
```scala
val ylb = (0 until 100) map (i => Bernoulli(sigmoid(1.0 + X(i,0))).sample())
val yl = DenseVector(ylb.toArray map {b => if (b) 1.0 else 0.0})
```

Then we can do logistic regression in a typical way.
```scala
import scalaglm.{Glm, LogisticGlm}
val glm = Glm(yl, X, List("V1","V2","V3"), LogisticGlm)
```
```scala
glm.coefficients
// res20: DenseVector[Double] = DenseVector(1.0860424490504432, 0.7546633859745069, 0.0013641428218772289, 0.10158924183197963)
glm.fitted
// res21: DenseVector[Double] = DenseVector(0.6422110503449221, 0.9118727009175228, 0.9612454319327228, 0.7680071049203937, 0.7626282531106904, 0.9423617175033451, 0.9162784058353658, 0.6524817156233763, 0.7918833223050764, 0.8146237350966555, 0.878569449066456, 0.8688257528305786, 0.8434437799285187, 0.7196332773298745, 0.7965624497987829, 0.7220617030439715, 0.7367453380558552, 0.7470411690015628, 0.7091385157873814, 0.6166908890650996, 0.6366049172760325, 0.8817588026694518, 0.7220594333996128, 0.8610934729954633, 0.704151255460472, 0.6269371864570589, 0.7535794722945213, 0.9475727060645492, 0.8006569058184442, 0.7288948736540423, 0.7408423353488567, 0.6027815900225121, 0.9299474435851438, 0.8094702711910503, 0.8446825678649746, 0.7323172765958414, 0.5166122364302674, 0.6241587156577978, 0.8165892048357879, 0.32218995438918385, 0.45328473601154134, 0.8796118265886249, 0.7374126116763101, 0.5691795268409068, 0.7189192129979471, 0.7641676521599378, 0.7282335391048184, 0.4680889212282956, 0.9596416764452428, 0.7456175566569917, 0.34067412637416433, 0.6259877560294722, 0.4847280680796389, 0.7098820731476759, 0.9204393543204452, 0.877426848817996, 0.6102075074336125, 0.8850357784868764, 0.8706594030146251, 0.5627524410880651, 0.9111328040201789, 0.7086983207665011, 0.8493898845320654, 0.8803807178426242, 0.6991888968848308, 0.6129315811204842, 0.7458250996768011, 0.902594387282721, 0.8169124722600808, 0.6684034291710332, 0.7370971653592747, 0.5798635242136633, 0.6981962161613529, 0.6235877784182352, 0.873268136862713, 0.7564193781261013, 0.9441967156897801, 0.5920711128547335, 0.7130162256006454, 0.7346951852121095, 0.8716056146672273, 0.9471506209562606, 0.7678520818428379, 0.8298681344357557, 0.7490111822785666, 0.8635168842291259, 0.7386570951804318, 0.6650171827966213, 0.9208244815206467, 0.9146177347531926, 0.9506302903589902, 0.7499558083765105, 0.7076706998103504, 0.8361522911759722, 0.8748517507938355, 0.8576598073562881, 0.4329634199123759, 0.6020896523619418, 0.5528174259955653, 0.8020618091291685)
glm.predict(response=true).fitted
// res22: DenseVector[Double] = DenseVector(0.6422110503449221, 0.9118727009175228, 0.9612454319327228, 0.7680071049203937, 0.7626282531106904, 0.9423617175033451, 0.9162784058353658, 0.6524817156233763, 0.7918833223050764, 0.8146237350966555, 0.878569449066456, 0.8688257528305786, 0.8434437799285187, 0.7196332773298745, 0.7965624497987829, 0.7220617030439715, 0.7367453380558552, 0.7470411690015628, 0.7091385157873814, 0.6166908890650996, 0.6366049172760325, 0.8817588026694518, 0.7220594333996128, 0.8610934729954633, 0.704151255460472, 0.6269371864570589, 0.7535794722945213, 0.9475727060645492, 0.8006569058184442, 0.7288948736540423, 0.7408423353488567, 0.6027815900225121, 0.9299474435851438, 0.8094702711910503, 0.8446825678649746, 0.7323172765958414, 0.5166122364302674, 0.6241587156577978, 0.8165892048357879, 0.32218995438918385, 0.45328473601154134, 0.8796118265886249, 0.7374126116763101, 0.5691795268409068, 0.7189192129979471, 0.7641676521599378, 0.7282335391048184, 0.4680889212282956, 0.9596416764452428, 0.7456175566569917, 0.34067412637416433, 0.6259877560294722, 0.4847280680796389, 0.7098820731476759, 0.9204393543204452, 0.877426848817996, 0.6102075074336125, 0.8850357784868764, 0.8706594030146251, 0.5627524410880651, 0.9111328040201789, 0.7086983207665011, 0.8493898845320654, 0.8803807178426242, 0.6991888968848308, 0.6129315811204842, 0.7458250996768011, 0.902594387282721, 0.8169124722600808, 0.6684034291710332, 0.7370971653592747, 0.5798635242136633, 0.6981962161613529, 0.6235877784182352, 0.873268136862713, 0.7564193781261013, 0.9441967156897801, 0.5920711128547335, 0.7130162256006454, 0.7346951852121095, 0.8716056146672273, 0.9471506209562606, 0.7678520818428379, 0.8298681344357557, 0.7490111822785666, 0.8635168842291259, 0.7386570951804318, 0.6650171827966213, 0.9208244815206467, 0.9146177347531926, 0.9506302903589902, 0.7499558083765105, 0.7076706998103504, 0.8361522911759722, 0.8748517507938355, 0.8576598073562881, 0.4329634199123759, 0.6020896523619418, 0.5528174259955653, 0.8020618091291685)
glm.summary
// Estimate	 S.E.	 z-stat	p-value		Variable
// ---------------------------------------------------------
//   1.0860	 0.307	 3.539	0.0004 *	(Intercept)
//   0.7547	 0.274	 2.757	0.0058 *	V1
//   0.0014	 0.122	 0.011	0.9911  	V2
//   0.1016	 0.078	 1.306	0.1917  	V3
glm.plots
// res24: breeze.plot.Figure = breeze.plot.Figure@4214c970
```

![Logistic regression plots](glm-plots.png)


### Poisson regression

We first create an appropriate response, and then do Poisson regression.
```scala
val yp = DenseVector.tabulate(100)(i => Poisson(math.exp(-0.5 + X(i,0))).sample().toDouble)

import scalaglm.PoissonGlm
val pglm = Glm(yp, X, List("V1","V2","V3"), PoissonGlm)
```
```scala
pglm.coefficients
// res26: DenseVector[Double] = DenseVector(-0.570631545199787, 1.0026364142141726, -0.03238158736173639, 0.048788357462738054)
pglm.summary
// Estimate	 S.E.	 z-stat	p-value		Variable
// ---------------------------------------------------------
//  -0.5706	 0.175	-3.254	0.0011 *	(Intercept)
//   1.0026	 0.096	10.469	0.0000 *	V1
//  -0.0324	 0.050	-0.643	0.5200  	V2
//   0.0488	 0.033	 1.494	0.1351  	V3
pglm.plots
// res28: breeze.plot.Figure = breeze.plot.Figure@6c7b938c
```
![Poisson regression plots](pglm-plots.png)


## Non-linear response

The above covers the main functionality of the library based on a linear reponse to variation in covariate values. For flexible modelling of a nonlinear response, see the documentation on [flexible regression modelling](FlexibleRegression.md).


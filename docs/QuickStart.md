# scala-glm - Quickstart Guide

## PCA

This library contains code for principal components analysis based on a thin SVD of the centred data matrix. This is more numerically stable than a construction from the spectral decomposition of the covariance matrix. It is analogous to the R function `prcomp` rather than the R function `princomp`. First create some synthetic data.

```scala
import breeze.linalg.*
import breeze.numerics.*
import breeze.stats.distributions.*
import breeze.stats.distributions.Rand.VariableSeed.randBasis

val X = DenseMatrix.tabulate(100, 3)((i, j) => 
	Gaussian(j, j+1).sample())
```
Now we can do PCA.
```scala
import scalaglm.Pca
val pca = Pca(X, List("V1", "V2", "V3"))
```
```scala
pca.sdev
// res0: DenseVector[Double] = DenseVector(2.963331161860426, 1.7629058543673977, 1.0421475814988885)
pca.loadings
// res1: DenseMatrix[Double] = 0.04905857692460703  -0.018414052207403022  0.998626145617786     
// 0.0470034126017691   0.9987648507538419     0.01610751695461208   
// 0.9976892979449662   -0.0461486248978048    -0.04986350555387611  
pca.scores
// res2: DenseMatrix[Double] = -5.975652398508929      2.079528635556266      0.08186386030230569   
// 3.874138772259561       0.6924702066169729     -2.138486074587648    
// 0.21760606260340887     -2.572081135433297     0.19029375211446292   
// 3.7802357536554445      0.2584775587328398     1.4985259412806988    
// -1.5998006132792308     0.3960329157238823     -1.6130770547812499   
// -1.1807265275046988     1.7356502719935043     -0.5957685854788836   
// 0.7689056236089015      -0.00733400367911531   1.152630235997285     
// 4.2306437293738925      0.2502980467129819     0.43832469738567204   
// 1.4829511646700209      -1.6428702393530938    1.15352651359094      
// -0.5292013280634555     0.903845911667473      0.12807277073357598   
// 4.262675205982714       -1.4860238999697823    1.0787428597992597    
// -4.614076859211911      -2.6251567550413215    1.815317492490591     
// 4.239901899740183       0.4911562820391822     2.291006151054646     
// -1.8941273500912401     -0.6353317514705664    -0.169886888845654    
// 2.004306830787401       2.1984503320413022     -0.7212711652636037   
// -0.01647692509089899    -0.4526604352572719    -1.6887172878265018   
// 3.2353220766448847      0.03931012714881469    -1.0900151733076113   
// 5.357808474576601       0.3945227402538084     -0.3393690189179517   
// -1.3931951247916599     -4.013418743519396     -1.5275323954985385   
// -3.304674373371469      1.8805734504478377     -0.4126652719290056   
// -0.09498008509049281    -1.4905971771305255    -1.1229756555888757   
// -2.5964837005783026     -1.4450751173782355    -0.04791289221745147  
// 3.666907865381302       -0.958860386785358     -0.3851856255491286   
// -0.23538930937433022    -1.3066765818484691    1.1675318779782358    
// -3.156974888542743      0.240755797291328      0.23157059946791703   
// -0.0017596949112525077  -0.8794098634955361    1.0842998703606441    
// 1.0762521320008198      0.41369420008217783    0.11420353678799987   
// -0.9775411082998215     -0.11299936076210508   -1.4786104823745245   
// -1.2832991886144272     1.2857792426601549     2.059553379535216     
// 3.7905365495305916      0.56203384016966       0.8222771447871635    
// 3.0728562949560043      -1.520479899751402     -0.5610061402189601   
// 1.391915495108524       -2.6751407518275765    1.2068522336406713    
// 2.3224523147108984      -0.22696727285459684   -2.193677995781161    
// -1.2961776000086465     1.04674373877832       -1.1379535913455507   
// -1.364012839009519      -0.3392281140079507    -0.8789562639510149   
// -3.6697189315982683     0.8229960153804216     0.020106630278943185  
// 2.9783081952287405      -0.9500520161718176    -0.9472271432916419   
// 0.22389780945910623     1.8044410462052909     -0.5014370894541085   
// 3.3711414376320463      -1.0715674236973736    -0.49335443916802607  
// -5.8276045644817644     0.19767981298348578    -0.2820276613651846   
// 3.7964165143995956      -1.6322388581608354    1.2733169592895401    
// 1.6055440464032635      -2.9485743542332696    0.9554264071912388    
// -0.43661656128763365    2.0512766218563967     -1.0239645822759023   
// -5.863290551671721      -0.8565840606827103    -1.3550557053451984   
// -4.273276459961205      -1.5602570923419254    -0.4423635854387079   
// 0.5677403061885083      -1.964380926220723     0.08535488491226206   
// -4.136207769985193      0.3985643082134605     0.5259938354278809    
// 3.7397688469495067      -0.5610485556001985    -1.1377600747905785   
// -2.7604858165223582     -3.941026864813883     -0.7713366217412785   
// ...
pca.plots
// res3: Figure = breeze.plot.Figure@8f9260b
pca.summary
// Standard deviations:
// V1	V2	V3
//  2.963	 1.763	 1.042
// Cumulative proportion of variance explained:
// V1	V2	V3
//  0.677	 0.916	 1.000
// Loadings:
// PC01	PC02	PC03	
//  0.049	-0.018	 0.999	V1
//  0.047	 0.999	 0.016	V2
//  0.998	-0.046	-0.050	V3
```
The final line prints a readable summary of the PCA to the console. `plots` produces some diagnostic plots, including a "scree plot".

![PCA Plots](pca-plots.png)

Note that there is also a utility function `pairs` for producing a "scatterplot matrix":
```scala
import scalaglm.Utils.pairs
pairs(X, List("V1", "V2", "V3"))
// res6: Figure = breeze.plot.Figure@224c6005
```

![Pairs plots](pairs-plots.png)


## Linear regression

This code computes regression coefficients and associated diagnostics via the QR decomposition of the covariate matrix. The diagnostics are analogous to those produced by the R function `lm`. We start by creating a synthetic response variable.

```scala
val y = DenseVector.tabulate(100)(i => 
	Gaussian(2.0 + 1.5*X(i,0) + 0.5*X(i,1), 3.0).sample())
```
So we can now do linear regression and generate all of the usual diagnostics.
```scala
import scalaglm.Lm
val lm = Lm(y,X,List("V1", "V2", "V3"))
```
```scala
lm.coefficients
// res8: DenseVector[Double] = DenseVector(2.3241276291235056, 1.5745150880785665, 0.5132626457167948, -0.10055418273754527)
lm.se
// res9: DenseVector[Double] = DenseVector(0.29800063299418605, 0.21428194051059893, 0.1267613827543493, 0.07625376326661568)
lm.fitted
// res10: DenseVector[Double] = DenseVector(3.7037860240455935, -0.48383190987957825, 1.6109297038829224, 5.071129018559635, 0.19880118255690427, 2.4664209336621563, 4.389723822043247, 3.386516215154451, 3.593299438363683, 3.2086998258509576, 3.5542139078326724, 4.156648435570431, 6.441804598852586, 1.9832729568246343, 2.496727871400429, -0.33387570229701113, 0.859067457789787, 2.2249804445211216, -1.8183691789206922, 2.825294937291063, 0.056301377935987995, 1.780565618064912, 1.4897377879968086, 3.7778634347972906, 3.046287913147641, 3.854756591153836, 2.949059508651073, 0.16411899283234366, 6.457019316648571, 4.1470764107353615, 0.9361038240391094, 3.1737263477029103, -1.0219094452770001, 1.2702170106480493, 1.0040841062873684, 2.9947407750098045, 0.6021261739446693, 2.651055241599339, 1.2628799934069899, 2.208081002089911, 3.790855787766268, 2.6417697509877742, 1.9423507327485319, -0.008157021791124874, 1.0971157215346583, 1.7416270195105041, 3.589164302311346, 0.49074888267715067, -0.5854039528756168, 3.88148348984058, 3.090366886489396, 2.0823341266551045, 3.2701180833168353, 4.175704793327487, 3.3187403859984412, 3.6336967138377556, 1.3560373923311897, 2.334664286206352, 1.1045656822043883, 1.4933056919466001, 4.746865978504555, 0.6391617404546373, 4.742371886728597, 5.846197427578558, 5.3447391390463705, 1.7880510072641504, 5.5734490430039285, 4.0661230131335575, 3.418972949359371, 1.7721198676561332, 2.4796513902812585, 3.374510562567597, 0.5047587441411245, 2.0106723366566652, -0.7674040533915292, 4.940142115178789, -1.2258579455721992, 5.23878851293217, 4.607493108914823, 3.6542750339399612, 1.1203908512225915, 4.934480205233857, -1.4262562573111073, 3.582068102225317, 1.178721521815223, 4.239834627148039, 3.7068824050367346, 2.371679706781577, 1.2648419899974277, 4.098684503492039, 0.5142443227149307, 4.2699295422355945, 3.311080308526318, 1.0956133385203128, 5.16603088057321, 3.483392443666832, 4.749371571157825, 6.162282967239543, 1.8401527034784266, 1.2863827173004088)
lm.residuals
// res11: DenseVector[Double] = DenseVector(2.4102441123921126, -1.6201182769223608, 1.5030672846889053, -1.1982115808563658, -0.5089516953247046, 1.3891869362586018, -3.220152389821844, -1.233613463932416, 3.1728959936765957, 4.5718811335454435, 1.5285088770398123, -0.715892194965182, 0.46815345168222766, -1.2560805857199333, -1.60336681725287, 1.3596516757095776, 0.4075650545312519, -0.820434667748609, -2.1967746911057358, 1.4076459883219137, -0.9805809191430542, -3.63570675182568, -1.9399047084811207, 0.7954672999393599, -4.285294833016669, 2.347511050750776, 0.2397014416224712, 2.0733644121609007, -2.680740843841913, -0.3151894507382087, -3.102546363482834, 4.355612174141463, 0.8762253349324465, 0.9645173564657492, 0.880779831491117, -0.7089035666931371, 1.4950072374337566, 1.567667703466217, 3.8246377866604866, -0.9380058218442531, 0.855716394800325, 2.5326682982324984, 0.5871798683024303, -0.1504738681924268, 5.600768640052728, -2.089088189204938, -1.9197366743958266, -3.9639063046068523, -0.5372488423456823, 1.2879391834496658, -0.20734062562488775, 3.881783952868811, 1.2024011974020894, -0.9683021886999321, 0.8225974833127436, -1.8248245185823948, 2.2921238371793855, -0.39918688377419587, 3.016647141314551, 0.2871896344121405, -2.3965874285221216, -1.7533253192702207, -3.6390278390490924, 2.3238183275729023, -0.543015747080049, 2.639175379640717, -3.2441020094245374, -1.8633564231244275, -2.0339172600828843, 3.4253171084741267, -0.43646156885216225, -3.7306951468650644, -4.4594073765542825, 1.158323008084468, 2.4793635294275935, 0.1921045764407383, -1.5961850895415424, -1.2507927242026167, 0.33086740350707977, 0.12880071888843103, -1.1941738527839665, -0.157586157089197, -5.433766612663452, 0.4841474176816871, -1.9051197161445166, 2.522333094689386, -0.22086902270881925, -2.865779326956885, 3.031069080666102, -0.7305817986650891, -0.6203080820267073, -2.6935855964398536, 0.43526979436448876, -0.31363247301111974, 2.1139501221739483, 2.0092504286770905, 0.3741346656035427, 0.3864526461572453, 1.79664107808561, 2.2655281408288666)
lm.studentised
// res12: DenseVector[Double] = DenseVector(1.1206268428503787, -0.7557585743446529, 0.686717166160336, -0.5519138041107118, -0.2332233554731145, 0.6323416511936715, -1.464530391608851, -0.5638095231444057, 1.450961549594577, 2.0688360172024858, 0.7045572478372948, -0.33689995404250195, 0.21944267495485786, -0.5691365729050254, -0.7337839285664065, 0.6228999665998167, 0.18632293307196535, -0.3773217831359615, -1.0330981720219599, 0.644369626920518, -0.44732804441590907, -1.6548188461836637, -0.8853576683907921, 0.36275660772973967, -1.9480766326934924, 1.0678767837545249, 0.10840654302783971, 0.9470680764819243, -1.2407812547689465, -0.14414807895803117, -1.4170505370169881, 2.0078343701227643, 0.4065123319504984, 0.43967796422917527, 0.39989765853070464, -0.32318204647966287, 0.6828896460118213, 0.7129566871866446, 1.7448459844968327, -0.4326026801164028, 0.39473141103421305, 1.1679168003139646, 0.2685123970387313, -0.07010499341675563, 2.5706325971855706, -0.9500932766875702, -0.8774808304883691, -1.8178446991045238, -0.2510811020283776, 0.5838196835842354, -0.09628771076339095, 1.756134919242533, 0.5531349292504671, -0.44544140775736635, 0.38106271289001886, -0.8351846212142761, 1.0456223474342237, -0.18240586681173462, 1.3760304661439273, 0.13039679807422863, -1.095377893006039, -0.8020300854185551, -1.6587725984597308, 1.0771708447519188, -0.2532277965130422, 1.193538330757759, -1.541548381784501, -0.866477665786426, -0.922900500809104, 1.55450330207901, -0.19826495367219055, -1.6932621983173313, -2.046238151650271, 0.5237380158208103, 1.1389914552697098, 0.08773935917546971, -0.7514241382990902, -0.5755403905110955, 0.15231305639551024, 0.05950107742316124, -0.5489031913153491, -0.07221820763164961, -2.6138178334291196, 0.21949695720798038, -0.8664229774669527, 1.1507917767600186, -0.10211405195719618, -1.3151470160993544, 1.4030735317330498, -0.3312985825338739, -0.2843994877479291, -1.230743480510369, 0.19957732702245018, -0.14343983795672105, 0.9770071111564496, 0.911684544918704, 0.173592068116086, 0.1786166589375216, 0.8151064759758376, 1.0374773535543371)
val pred = lm.predict()
// pred: PredictLm = PredictLm(
//   mod = Lm(
//     y = DenseVector(6.114030136437706, -2.103950186801939, 3.1139969885718277, 3.872917437703269, -0.3101505127678004, 3.855607869920758, 1.169571432221403, 2.152902751222035, 6.766195432040279, 7.780580959396401, 5.082722784872485, 3.440756240605249, 6.909958050534813, 0.7271923711047011, 0.8933610541475592, 1.0257759734125664, 1.266632512321039, 1.4045457767725127, -4.015143870026428, 4.232940925612977, -0.9242795412070662, -1.8551411337607677, -0.45016692048431217, 4.5733307347366505, -1.2390069198690283, 6.202267641904612, 3.188760950273544, 2.2374834049932444, 3.7762784728066583, 3.831886959997153, -2.1664425394437243, 7.529338521844373, -0.14568411034455364, 2.2347343671137985, 1.8848639377784855, 2.2858372083166674, 2.097133411378426, 4.218722945065556, 5.0875177800674765, 1.2700751802456578, 4.646572182566593, 5.174438049220273, 2.529530601050962, -0.15863088998355168, 6.697884361587386, -0.3474611696944341, 1.6694276279155194, -3.4731574219297014, -1.122652795221299, 5.169422673290246, 2.8830262608645083, 5.9641180795239155, 4.472519280718925, 3.2074026046275548, 4.141337869311185, 1.8088721952553608, 3.648161229510575, 1.9354774024321562, 4.121212823518939, 1.7804953263587406, 2.3502785499824337, -1.1141635788155835, 1.1033440476795042, 8.17001575515146, 4.801723391966322, 4.427226386904867, 2.329347033579391, 2.20276659000913, 1.3850556892764865, 5.19743697613026, 2.043189821429096, -0.3561845842974676, -3.954648632413158, 3.168995344741133, 1.7119594760360646, 5.132246691619527, -2.8220430351137415, 3.9879957887295534, 4.9383605124219025, 3.7830757528283923, -0.07378300156137496, 4.77689404814466, -6.860022869974559, 4.066215519907004, -0.7263981943292936, 6.762167721837425, 3.4860133823279154, -0.49409962017530784, 4.2959110706635295, 3.3681027048269496, -0.10606375931177658, 1.5763439457957409, 3.7463501028908066, 0.7819808655091931, 7.279981002747158, 5.4926428723439225, 5.123506236761368, 6.548735613396788, 3.6367937815640365, 3.551910858129275),
//     Xmat = -0.2802589376250726   2.7732261127422926     -3.953460096455899   
// -1.9888003308592612   1.8150903821953612     6.048296412071042    
// 0.21750941910497645   -1.5797874068274025    2.434746289582776    
// 1.6465997749270445    1.4358032503848266     5.793284370427832    
// -1.7271982112125435   1.270188438797734      0.5744871072855147   
// -0.7153959812710043   2.644235393281348      0.8800447723186968   
// 1.1583423771314332    1.023205691403708      2.818426937609881    
// 0.6101020854425764    1.4317273436935558     6.295894411356422    
// 1.224384331104808     -0.5767333989322294    3.6062555888760004   
// 0.054730710354692076  1.855741630171352      1.5323578510701048   
// 1.2831845481915813    -0.2906288511252699    6.376047248387394    
// 1.6042424624294023    -1.83372795860913      -2.464352066018754   
// 2.4562572411207966    1.7025653466800947     6.20163472053922     
// -0.28143842644305755  0.24950950991091392    0.2564740121738853   
// -0.692994959238605    3.254149728342328      4.042618879694736    
// -1.709431034965572    0.49574659103110674    2.197089924462006    
// -0.9610819901209898   1.1495987510048886     5.388817836404254    
// -0.11388185561810867  1.616227773080953      7.452577378324933    
// -1.5504394335255234   -3.122727814481718     0.9798397660804301   
// -0.6394107067652741   2.692096112764599      -1.2548134413894605  
// -1.1292052813094253   -0.5354853675446691    2.1384576542227687   
// -0.17917795075907256  -0.5902821492054788    -0.412972910252281   
// ...
pred.fitted
// res13: DenseVector[Double] = DenseVector(3.70378602404559, -0.4838319098795778, 1.6109297038829216, 5.071129018559633, 0.19880118255690338, 2.4664209336621563, 4.389723822043246, 3.3865162151544506, 3.5932994383636823, 3.2086998258509567, 3.554213907832672, 4.15664843557043, 6.441804598852585, 1.9832729568246337, 2.496727871400428, -0.33387570229701113, 0.8590674577897865, 2.2249804445211203, -1.818369178920693, 2.8252949372910625, 0.05630137793598755, 1.7805656180649112, 1.4897377879968077, 3.7778634347972897, 3.0462879131476406, 3.8547565911538344, 2.949059508651072, 0.16411899283234277, 6.45701931664857, 4.147076410735361, 0.9361038240391086, 3.1737263477029094, -1.0219094452770014, 1.2702170106480484, 1.0040841062873682, 2.9947407750098036, 0.6021261739446684, 2.6510552415993383, 1.2628799934069888, 2.208081002089911, 3.790855787766267, 2.6417697509877733, 1.9423507327485316, -0.00815702179112554, 1.0971157215346574, 1.7416270195105032, 3.5891643023113455, 0.49074888267714956, -0.5854039528756174, 3.88148348984058, 3.0903668864893947, 2.0823341266551036, 3.2701180833168344, 4.175704793327487, 3.3187403859984403, 3.633696713837755, 1.356037392331189, 2.334664286206351, 1.1045656822043879, 1.493305691946599, 4.746865978504554, 0.6391617404546368, 4.742371886728597, 5.8461974275785575, 5.34473913904637, 1.7880510072641496, 5.573449043003928, 4.0661230131335575, 3.4189729493593704, 1.7721198676561323, 2.4796513902812576, 3.374510562567596, 0.5047587441411241, 2.010672336656665, -0.7674040533915298, 4.940142115178788, -1.2258579455721983, 5.238788512932169, 4.607493108914822, 3.6542750339399594, 1.1203908512225906, 4.934480205233856, -1.4262562573111082, 3.582068102225316, 1.1787215218152225, 4.239834627148039, 3.7068824050367337, 2.3716797067815762, 1.2648419899974273, 4.098684503492038, 0.5142443227149299, 4.269929542235593, 3.311080308526317, 1.0956133385203124, 5.166030880573209, 3.4833924436668315, 4.749371571157823, 6.162282967239543, 1.840152703478426, 1.2863827173004077)
pred.se
// res14: DenseVector[Double] = DenseVector(0.5679850735187146, 0.5942267477161531, 0.39727139095785236, 0.4850293698345407, 0.43166157076890593, 0.34958334804256047, 0.33763458884518077, 0.40151843553283373, 0.4082329906505491, 0.2548996749118022, 0.49192471508694685, 0.6581619922946711, 0.6302853865006613, 0.2787974254801431, 0.4171700752192646, 0.4289897162890688, 0.40469151105245327, 0.4697778056746165, 0.6534462456919853, 0.41996165171131444, 0.3785662210713952, 0.34864465662689803, 0.38423996934879134, 0.3741641587386125, 0.33108501323797734, 0.3406385591778703, 0.24378628006410427, 0.3946542232669411, 0.5297851653128264, 0.40923281680855955, 0.39357609604454924, 0.49259304585312175, 0.5499947875227272, 0.3691469251132352, 0.3122232221817715, 0.37020828165801367, 0.3947010587409548, 0.3372113575353387, 0.3792698678467953, 0.49707973212665213, 0.4989956710723453, 0.49598774624224706, 0.40804729693550923, 0.5843655415494118, 0.4489887187686122, 0.33722243266626567, 0.4026880603288574, 0.44015552613261205, 0.6083176769516336, 0.2861157074682282, 0.558259946255506, 0.25024070807053, 0.4724070889682866, 0.47236075966987445, 0.5372066700049847, 0.41785668005261145, 0.37839346805804985, 0.3990182289598769, 0.37742007294392205, 0.3128188916701987, 0.4019955128459421, 0.411672223701865, 0.368450482948971, 0.5426353659469162, 0.5917740562485095, 0.24301248359032585, 0.7210155221393487, 0.5691360939280375, 0.3027766573731086, 0.3053239199007213, 0.3199389183681564, 0.30691554973134927, 0.4462201058184286, 0.23910236018205402, 0.45832583169919067, 0.39328679193168653, 0.6605039627221114, 0.4749052285987768, 0.4792954756705854, 0.512555492232566, 0.4641873787134169, 0.43250320947732124, 0.7917575452632521, 0.28874717385616755, 0.3371636181491938, 0.38007186432598733, 0.5197440160461951, 0.447505473061591, 0.530681141892143, 0.2925943281796497, 0.43735937262954516, 0.39830514686885055, 0.4381425806737979, 0.40954414762874675, 0.5166723649223908, 0.3023672336340185, 0.5508500464963498, 0.5171454718785424, 0.3002324462113561, 0.42432130318497924)
val predNew = lm.predict(DenseMatrix((1.1, 1.6, 1.0), (1.4, 2.2, 3.0)))
// predNew: PredictLm = PredictLm(
//   mod = Lm(
//     y = DenseVector(6.114030136437706, -2.103950186801939, 3.1139969885718277, 3.872917437703269, -0.3101505127678004, 3.855607869920758, 1.169571432221403, 2.152902751222035, 6.766195432040279, 7.780580959396401, 5.082722784872485, 3.440756240605249, 6.909958050534813, 0.7271923711047011, 0.8933610541475592, 1.0257759734125664, 1.266632512321039, 1.4045457767725127, -4.015143870026428, 4.232940925612977, -0.9242795412070662, -1.8551411337607677, -0.45016692048431217, 4.5733307347366505, -1.2390069198690283, 6.202267641904612, 3.188760950273544, 2.2374834049932444, 3.7762784728066583, 3.831886959997153, -2.1664425394437243, 7.529338521844373, -0.14568411034455364, 2.2347343671137985, 1.8848639377784855, 2.2858372083166674, 2.097133411378426, 4.218722945065556, 5.0875177800674765, 1.2700751802456578, 4.646572182566593, 5.174438049220273, 2.529530601050962, -0.15863088998355168, 6.697884361587386, -0.3474611696944341, 1.6694276279155194, -3.4731574219297014, -1.122652795221299, 5.169422673290246, 2.8830262608645083, 5.9641180795239155, 4.472519280718925, 3.2074026046275548, 4.141337869311185, 1.8088721952553608, 3.648161229510575, 1.9354774024321562, 4.121212823518939, 1.7804953263587406, 2.3502785499824337, -1.1141635788155835, 1.1033440476795042, 8.17001575515146, 4.801723391966322, 4.427226386904867, 2.329347033579391, 2.20276659000913, 1.3850556892764865, 5.19743697613026, 2.043189821429096, -0.3561845842974676, -3.954648632413158, 3.168995344741133, 1.7119594760360646, 5.132246691619527, -2.8220430351137415, 3.9879957887295534, 4.9383605124219025, 3.7830757528283923, -0.07378300156137496, 4.77689404814466, -6.860022869974559, 4.066215519907004, -0.7263981943292936, 6.762167721837425, 3.4860133823279154, -0.49409962017530784, 4.2959110706635295, 3.3681027048269496, -0.10606375931177658, 1.5763439457957409, 3.7463501028908066, 0.7819808655091931, 7.279981002747158, 5.4926428723439225, 5.123506236761368, 6.548735613396788, 3.6367937815640365, 3.551910858129275),
//     Xmat = -0.2802589376250726   2.7732261127422926     -3.953460096455899   
// -1.9888003308592612   1.8150903821953612     6.048296412071042    
// 0.21750941910497645   -1.5797874068274025    2.434746289582776    
// 1.6465997749270445    1.4358032503848266     5.793284370427832    
// -1.7271982112125435   1.270188438797734      0.5744871072855147   
// -0.7153959812710043   2.644235393281348      0.8800447723186968   
// 1.1583423771314332    1.023205691403708      2.818426937609881    
// 0.6101020854425764    1.4317273436935558     6.295894411356422    
// 1.224384331104808     -0.5767333989322294    3.6062555888760004   
// 0.054730710354692076  1.855741630171352      1.5323578510701048   
// 1.2831845481915813    -0.2906288511252699    6.376047248387394    
// 1.6042424624294023    -1.83372795860913      -2.464352066018754   
// 2.4562572411207966    1.7025653466800947     6.20163472053922     
// -0.28143842644305755  0.24950950991091392    0.2564740121738853   
// -0.692994959238605    3.254149728342328      4.042618879694736    
// -1.709431034965572    0.49574659103110674    2.197089924462006    
// -0.9610819901209898   1.1495987510048886     5.388817836404254    
// -0.11388185561810867  1.616227773080953      7.452577378324933    
// -1.5504394335255234   -3.122727814481718     0.9798397660804301   
// -0.6394107067652741   2.692096112764599      -1.2548134413894605  
// -1.1292052813094253   -0.5354853675446691    2.1384576542227687   
// -0.17917795075907256  -0.5902821492054788    -0.412972910252281   
// ...
predNew.fitted
// res15: DenseVector[Double] = DenseVector(4.776760276419255, 5.355964024797812)
predNew.se
// res16: DenseVector[Double] = DenseVector(0.35769228798232233, 0.40931995549760986)
lm.plots
// res17: Figure = breeze.plot.Figure@682ce13b
lm.summary
// Estimate	 S.E.	 t-stat	p-value		Variable
// ---------------------------------------------------------
//   2.3241	 0.298	 7.799	0.0000 *	(Intercept)
//   1.5745	 0.214	 7.348	0.0000 *	V1
//   0.5133	 0.127	 4.049	0.0001 *	V2
//  -0.1006	 0.076	-1.319	0.1904  	V3
// 
// Residual standard error:   2.2245 on 96 degrees of freedom
// Multiple R-squared: 0.4198, Adjusted R-squared: 0.4016
// F-statistic: 23.1508 on 3 and 96 DF, p-value: 0.00000
//
```
The plots include a plot of studentised residuals against fitted values and a normal Q-Q plot for the studentised residuals.

![Linear model plots](lm-plots.png)


## Generalised linear models

The current implementation supports only simple one-parameter exponential family observation models. This includes the most commonly used cases of **logistic regression** (`LogisticGlm`) and **Poisson regression** (`PoissonGlm`).

### Logistic regression

Again, we start by creating an appropriate response variable.
```scala
val ylb = (0 until 100) map (i => Bernoulli(sigmoid(1.0 + X(i,0))).sample())
val yl = DenseVector(ylb.toArray map {b => if (b) 1.0 else 0.0})
```

Then we can do logistic regression in a typical way.
```scala
import scalaglm.{Glm, LogisticGlm}
val glm = Glm(yl, X, List("V1","V2","V3"), LogisticGlm)
```
```scala
glm.coefficients
// res20: DenseVector[Double] = DenseVector(1.0579832722323825, 0.9524272922722135, 0.09188464837531397, -0.04620674922469011)
glm.fitted
// res21: DenseVector[Double] = DenseVector(0.7735647695811785, 0.2791065743815138, 0.732527721826335, 0.9234723875065367, 0.3782737350760311, 0.6408191473260011, 0.8933100459928378, 0.8145275802763068, 0.8812681156456754, 0.7702669546557928, 0.8764032982048626, 0.9263061759296305, 0.963288820017029, 0.6901902526078703, 0.6248454081930903, 0.34839665151387367, 0.49981331934726775, 0.6799770273349439, 0.32062446091067065, 0.6801223694359899, 0.45871503045216605, 0.7010228994644653, 0.6452454977194474, 0.8844279115215695, 0.7764368851451288, 0.8796745083567747, 0.7626170825764677, 0.4002855245350966, 0.9560448101020106, 0.8662231584075423, 0.5949551481444968, 0.8782685501079712, 0.253603523598324, 0.5020019394105592, 0.5372183598020172, 0.7474432258452323, 0.5146903376201157, 0.6640055487346502, 0.6188913089849594, 0.6765787052560255, 0.893892338011638, 0.8476416943924311, 0.5492936687109177, 0.4092104353560283, 0.6126407337253409, 0.722203293548379, 0.8224999205779709, 0.4775921830324369, 0.49249027423207137, 0.8294377620520881, 0.857638978512466, 0.6700592964103852, 0.8643520192572979, 0.7825385142847447, 0.8118255603494232, 0.751450577867484, 0.65800511719994, 0.601491306913922, 0.5685838403811228, 0.6757445052772534, 0.8660991140890025, 0.464747302412322, 0.8761795008746721, 0.9034982440508248, 0.9248528759418038, 0.6579162222946036, 0.953658132991992, 0.8652085138843725, 0.7946785236182392, 0.6875483178488601, 0.7901660668100641, 0.8398974112684178, 0.3895992486869836, 0.6649829251753012, 0.3369370811201761, 0.912400790596481, 0.17982934633923442, 0.8883129602192924, 0.863811080713252, 0.7377367574877658, 0.49180281002299037, 0.8900697277442111, 0.46895509305489635, 0.8515086339629306, 0.6238623456438086, 0.8417575751038036, 0.7321233797037097, 0.7256443871030057, 0.42682674963187817, 0.8511898076284214, 0.5987937817513792, 0.8211824333634883, 0.8501383586416027, 0.45764656139801974, 0.8800649814778257, 0.7818766933361411, 0.935403554439043, 0.9304227792132413, 0.637058858262235, 0.6915642804519089)
glm.predict(response=true).fitted
// res22: DenseVector[Double] = DenseVector(0.7735647695811785, 0.2791065743815138, 0.732527721826335, 0.9234723875065367, 0.3782737350760311, 0.6408191473260011, 0.8933100459928378, 0.8145275802763068, 0.8812681156456754, 0.7702669546557928, 0.8764032982048626, 0.9263061759296305, 0.963288820017029, 0.6901902526078703, 0.6248454081930903, 0.34839665151387367, 0.49981331934726775, 0.6799770273349439, 0.32062446091067065, 0.6801223694359899, 0.45871503045216605, 0.7010228994644653, 0.6452454977194474, 0.8844279115215695, 0.7764368851451288, 0.8796745083567747, 0.7626170825764677, 0.4002855245350966, 0.9560448101020106, 0.8662231584075423, 0.5949551481444968, 0.8782685501079712, 0.253603523598324, 0.5020019394105592, 0.5372183598020172, 0.7474432258452323, 0.5146903376201157, 0.6640055487346502, 0.6188913089849594, 0.6765787052560255, 0.893892338011638, 0.8476416943924311, 0.5492936687109177, 0.4092104353560283, 0.6126407337253409, 0.722203293548379, 0.8224999205779709, 0.4775921830324369, 0.49249027423207137, 0.8294377620520881, 0.857638978512466, 0.6700592964103852, 0.8643520192572979, 0.7825385142847447, 0.8118255603494232, 0.751450577867484, 0.65800511719994, 0.601491306913922, 0.5685838403811228, 0.6757445052772534, 0.8660991140890025, 0.464747302412322, 0.8761795008746721, 0.9034982440508248, 0.9248528759418038, 0.6579162222946036, 0.953658132991992, 0.8652085138843725, 0.7946785236182392, 0.6875483178488601, 0.7901660668100641, 0.8398974112684178, 0.3895992486869836, 0.6649829251753012, 0.3369370811201761, 0.912400790596481, 0.17982934633923442, 0.8883129602192924, 0.863811080713252, 0.7377367574877658, 0.49180281002299037, 0.8900697277442111, 0.46895509305489635, 0.8515086339629306, 0.6238623456438086, 0.8417575751038036, 0.7321233797037097, 0.7256443871030057, 0.42682674963187817, 0.8511898076284214, 0.5987937817513792, 0.8211824333634883, 0.8501383586416027, 0.45764656139801974, 0.8800649814778257, 0.7818766933361411, 0.935403554439043, 0.9304227792132413, 0.637058858262235, 0.6915642804519089)
glm.summary
// Estimate	 S.E.	 z-stat	p-value		Variable
// ---------------------------------------------------------
//   1.0580	 0.338	 3.134	0.0017 *	(Intercept)
//   0.9524	 0.263	 3.623	0.0003 *	V1
//   0.0919	 0.135	 0.683	0.4948  	V2
//  -0.0462	 0.086	-0.540	0.5889  	V3
glm.plots
// res24: Figure = breeze.plot.Figure@64c1ff9b
```

![Logistic regression plots](glm-plots.png)


### Poisson regression

We first create an appropriate response, and then do Poisson regression.
```scala
val yp = DenseVector.tabulate(100)(i => Poisson(math.exp(-0.5 + X(i,0))).sample().toDouble)

import scalaglm.PoissonGlm
val pglm = Glm(yp, X, List("V1","V2","V3"), PoissonGlm)
```
```scala
pglm.coefficients
// res26: DenseVector[Double] = DenseVector(-0.24434220784293603, 0.8334909868927085, 0.012155382822568188, 0.01768306323559477)
pglm.summary
// Estimate	 S.E.	 z-stat	p-value		Variable
// ---------------------------------------------------------
//  -0.2443	 0.149	-1.644	0.1001  	(Intercept)
//   0.8335	 0.101	 8.261	0.0000 *	V1
//   0.0122	 0.056	 0.218	0.8273  	V2
//   0.0177	 0.030	 0.593	0.5535  	V3
pglm.plots
// res28: Figure = breeze.plot.Figure@606b3174
```
![Poisson regression plots](pglm-plots.png)


## Non-linear response

The above covers the main functionality of the library based on a linear reponse to variation in covariate values. For flexible modelling of a nonlinear response, see the documentation on [flexible regression modelling](FlexibleRegression.md).


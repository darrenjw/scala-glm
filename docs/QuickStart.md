# scala-glm - Quickstart Guide

## PCA

This library contains code for principal components analysis based on a thin SVD of the centred data matrix. This is more numerically stable than a construction from the spectral decomposition of the covariance matrix. It is analogous to the R function `prcomp` rather than the R function `princomp`. First create some synthetic data.

```scala
import breeze.linalg._
import breeze.numerics._
import breeze.stats.distributions._
val X = DenseMatrix.tabulate(100, 3)((i, j) => 
	Gaussian(j, j+1).sample())
```
Now we can do PCA.
```scala
import scalaglm.Pca
val pca = Pca(X, List("V1", "V2", "V3"))
```
```scala
pca.sdev
// res0: DenseVector[Double] = DenseVector(3.290657846433166, 1.9212270354069343, 0.9973100970381931)
pca.loadings
// res1: DenseMatrix[Double] = -0.0132397477281067   0.006969092731505831  0.9998880641484805     
// 0.004657829951849046  -0.9999644320848491   0.0070313004035277345  
// 0.9999015019991898    0.00475040121723036   0.013206815969020867   
pca.scores
// res2: DenseMatrix[Double] = 2.1417888579969246    3.269295130847344      -0.5818737649620817    
// 1.9850771348819685    -0.1444064882179683    -0.10012560640422716   
// -3.1662794251482596   2.5473741579311975     1.490446055721429      
// -1.7676085685055154   -2.0985713894623514    1.5579265717659976     
// -1.6254975128978493   0.5876334243499975     0.4529201086468985     
// 0.3440955847325068    0.5113281260347623     -0.23818897249640442   
// -3.895899906144139    0.046806498660561385   0.5423180156714411     
// 0.025154394416591102  1.9998921864527892     -0.4266557879449587    
// -8.777431813765377    1.3313470470185444     -1.2871624116404723    
// 1.8276452585186493    0.5259615087167059     1.4842144911128856     
// 2.1545679346907876    -3.185234802791192     -1.0032879949928883    
// 1.9327264193082636    -2.119733512122482     -0.9074802603874411    
// 6.515971104806625     2.0439539281058967     -0.3845915528880123    
// -1.7884988578027456   2.691928154169968      -0.4823038149967308    
// -3.24252590714142     1.8819981571215578     -0.7595781327711815    
// 2.9976934679535523    0.0445743398496124     -0.6329091680795141    
// 1.417277815015535     -0.8142215251424116    -0.13645434759004715   
// -0.1344474701793963   1.8717834334751235     0.9585172786717369     
// -3.425365549159857    -1.7275768303205323    0.5201282015416238     
// -1.2167747653039045   -1.798136097221547     -0.36351001453421466   
// -2.365315352892401    -0.7027122026694947    -0.5994235516294536    
// -0.16629875262370997  -0.5566403923018869    -1.0914896776710792    
// -2.2683571320042257   1.6758510938669122     0.6986575949435799     
// 2.072956180034832     -1.28682181759375      -0.10649729876029486   
// 2.026454151909929     -0.18948345809697506   -0.8153947429901439    
// -1.9286721294068332   0.12477291889528852    0.19527561433146992    
// -1.9960608946761988   4.061010449768597      -0.06526949730805721   
// -3.6621008711951957   -3.0276828837015017    -2.0564372985250516    
// 6.471734696765343     0.5878917596504136     0.2917650044364324     
// 3.074660228245512     -1.2990967056365046    -0.1385807937159228    
// 3.3614476803150573    2.006617386372536      0.27222184347922107    
// -0.8789253200568073   1.706806045330591      0.6980730732568727     
// 6.443163156768564     -0.5865306231940096    2.1908913242930894     
// -4.566496970752407    -0.8681208745436982    0.16272437928066236    
// 6.919609876999934     1.4821026230565912     -2.9854832842026666    
// 3.134336465963312     -1.0991848469300183    0.30804785574625637    
// -2.5381697135654604   0.5807910129381925     -0.31310202915492497   
// -3.1829638541357226   0.4078667405000561     0.6375109134261534     
// 0.18091036686878267   -2.492611330007728     -1.8635067838555253    
// -0.5195795884110023   2.1376672590983135     2.0149428497222024     
// -2.5869431250635304   1.4941471153837762     -0.7730416388615917    
// 6.605359291723285     1.2799365493041013     -0.13766727607522627   
// 2.018063140229243     -2.6742256983948596    0.8088422079581287     
// 2.250909594937991     -3.7674555588497944    -0.5697356895740292    
// 1.5885501632982615    -2.005659347563321     -0.30218496259642386   
// 1.8521537270711586    -1.3060968100446795    0.23636383456084128    
// -0.7733826803537059   1.4503754982073114     -0.5580983871603487    
// -0.38301946328206987  1.11487313879748       0.1750888022223208     
// -1.2088264384457317   -1.0375409574018908    -0.5738278075362641    
// ...
pca.plots
// res3: breeze.plot.Figure = breeze.plot.Figure@5aef42ed
pca.summary
// Standard deviations:
// V1	V2	V3
//  3.291	 1.921	 0.997
// Cumulative proportion of variance explained:
// V1	V2	V3
//  0.698	 0.936	 1.000
// Loadings:
// PC01	PC02	PC03	
// -0.013	 0.007	 1.000	V1
//  0.005	-1.000	 0.007	V2
//  1.000	 0.005	 0.013	V3
```
The final line prints a readable summary of the PCA to the console. `plots` produces some diagnostic plots, including a "scree plot".

![PCA Plots](pca-plots.png)

Note that there is also a utility function `pairs` for producing a "scatterplot matrix":
```scala
import scalaglm.Utils.pairs
pairs(X, List("V1", "V2", "V3"))
// res6: breeze.plot.Figure = breeze.plot.Figure@1c3cc3cb
```

![Pairs plots](pairs-plots.png)


## Linear regression

This code computes regression coefficients and associated diagnostics via the QR decomposition of the covariate matrix. The diagnostics are analogous to those produced by the R function `lm`. We start by creating a synthetic response variable.

```scala
val y = DenseVector.tabulate(100)(i => 
	Gaussian(2.0 + 1.5*X(i,0) + 0.5*X(i,1), 3.0).sample())
```
So we can now do linear regression and generate all of the usual diagnostics.
```scala
import scalaglm.Lm
val lm = Lm(y,X,List("V1", "V2", "V3"))
```
```scala
lm.coefficients
// res8: DenseVector[Double] = DenseVector(1.592414566093868, 1.3606929048511722, 0.4234739193755229, 0.03418385918297579)
lm.se
// res9: DenseVector[Double] = DenseVector(0.4271713511063528, 0.3249398411547269, 0.1687029841075724, 0.09857716630498772)
lm.fitted
// res10: DenseVector[Double] = DenseVector(0.12418717529843205, 2.191071049349723, 3.153232924902901, 5.193198816536961, 2.576992849116282, 1.701641179049248, 2.8815505092389406, 0.8228051330188121, -0.23390558361315283, 4.07179991934308, 2.2205955022881825, 1.9063316355713258, 0.9796748072581649, 0.4276334126026596, 0.35822702233579146, 1.4045341650585055, 2.4083997806927346, 2.7622574619920144, 3.594082788864687, 2.4580843158030974, 1.6621721088833619, 0.970447517120201, 2.4501919485939627, 2.656721267040398, 1.2348696238234191, 2.411612691632788, 0.42614587449854546, 0.6134335278485817, 2.5039406975448775, 2.6362085093516323, 1.8337828051025136, 2.46178623677685, 5.579765134897714, 2.730242668461845, -2.328039671999539, 3.1637525522492718, 1.5184396003734368, 2.87491010704123, 0.7248684673007472, 4.086178068126906, 0.5122520580262389, 1.6342541592759843, 4.478347616159181, 3.054626008465359, 2.6784880114292635, 3.12834483910669, 0.8564352898364272, 2.0023961142753905, 1.8566167286269022, 5.714272460815051, 3.3750033505418844, 1.8943125554382487, 3.3788132864526066, 0.6244894948558116, -0.18102175451118754, 1.3796181179247164, 1.2829832655056579, 1.782200811062239, 1.0378287836920421, 3.3178409719733573, 1.6055871324577602, 1.1540808081763034, 3.2830991695431435, 2.309792507010036, 2.8328895117910164, 3.1666361402025167, 2.0987014194424227, 1.5100362275208516, 1.9692887872723717, 2.45188052570988, 1.685515738072111, 6.591493036147614, -1.9527382687034158, -0.5351024141723639, 2.5863488127450105, 6.224656056175295, 2.2154055591607893, 2.365979292091706, 2.835421110844374, 1.2501148779641549, 3.7879513128616207, 1.6777487482618554, 2.9158996335453664, 2.2213531627012513, -1.1047488856576895, 0.4362217208519304, 2.3285652721308807, 1.7975447009791161, 5.613054959071252, 3.3765991633058388, 2.179884944485303, 1.968599001461593, 5.7972365147411, 1.861145270586175, 4.126112485936522, 1.4614949086276352, 2.1505117225804287, 4.253949642412522, 2.332916090571328, 3.3346629273725)
lm.residuals
// res11: DenseVector[Double] = DenseVector(1.66309315803133, -1.7888262132743535, -3.933630101940362, -6.942083142763318, -4.832323175616354, -2.4088845529283534, -0.4147033605401669, -0.02024253863515757, 3.5256607881610784, 4.023888611310136, -0.6343596736519563, 0.7481527201328555, -0.5857737488884669, 8.473475635862878, 0.9135042076623112, 2.8673621142385226, 0.3512616535646398, -2.925519951626822, 4.885761524825133, -0.7035777058905928, 3.0995334681698186, -5.413975907732789, -0.4966228991360784, -2.4428812584650372, 2.5475352143571923, 3.7559279596313897, 0.10813182531604448, 4.042507902233443, -3.843192079107807, 1.4272551064078898, 5.857552554794787, -1.7722966354980687, -1.5956494259245662, 2.4553968350275714, -3.38743239872041, -2.85416805913735, -2.0261243854349837, 3.2465589817860545, 1.5933191619774134, -1.6593726665585509, -0.8882712485332674, 5.237847258515478, 1.1539744330821762, 0.19223198425022492, -1.802180243113349, 0.43548935952818457, -1.1052090643448826, -1.5167172135645188, -5.21240975649012, -5.908304503575166, -1.6093298150045356, 0.9450280280613541, 0.1257355126753339, 2.6720457276782743, -2.5999262983965115, -0.7678728713133551, -1.2652396567089716, -1.9284353683091882, -2.9899555122004053, 4.212592451080599, 2.011174578611283, -0.5214700754672595, 2.661738154142777, -1.6315326357318853, -7.046698221066394, 3.792908651927914, -1.5311079667905574, 2.1849734798850724, 0.8140958454413545, -1.5946344536120423, 1.5892371735635362, -4.339073207759468, -4.967161707409996, -2.423432194325886, 2.9334729704619567, 7.529445586639014, 2.804445056794461, 0.5842814999159542, 1.276177185680412, 2.0785077116163384, 0.7443773726219112, 0.739456767334747, -1.4559919218319166, -2.784292120564975, -8.111982622367623, -0.022773997039124805, 0.5904781938436319, 3.2108481652570626, -2.4793468375742256, 0.17201830356928038, 2.074972940093417, 2.2197214924334006, -2.508112018067847, 7.327122808506227, -1.3602943815769475, -0.4321759036977304, 0.9314662847411004, 5.64383922112871, -2.029576843317546, -0.9604350813444644)
lm.studentised
// res12: DenseVector[Double] = DenseVector(0.5282865113391075, -0.5585991077316144, -1.2579409324346345, -2.208243991122773, -1.5102662371812228, -0.7512994891397635, -0.13038326180444762, -0.006350076336301912, 1.1547367031561446, 1.2710700239384354, -0.20207427999979907, 0.2360701156223573, -0.18761199541446405, 2.6751285027769165, 0.2884262671052657, 0.8993346615696198, 0.1096912936379112, -0.9206316296792822, 1.5398203966625588, -0.2205740408606103, 0.9710437876456253, -1.698516947557992, -0.15616224988806796, -0.7647130258466781, 0.7982980319354401, 1.1729072399114748, 0.03456531384625925, 1.3145187088711938, -1.2233155404348877, 0.44792134758522356, 1.8465258757371918, -0.5562099266137455, -0.521123662069691, 0.7738243032449047, -1.1401795046487355, -0.8956446267981859, -0.6340177722088911, 1.019090502908492, 0.5102438369829103, -0.5318758704782097, -0.27945602724106156, 1.6712066583958323, 0.3652334910228149, 0.061382651468517825, -0.5657762596517686, 0.13630918310427265, -0.3461167855031726, -0.47363084852776266, -1.6308463116709258, -1.9094352415276417, -0.5070024810934192, 0.29800321323708795, 0.039450178507782326, 0.8511031470509953, -0.8218471734050833, -0.2449137842028749, -0.40006290066768296, -0.6017914849199831, -0.9434037066758526, 1.31843241123697, 0.6330526540285508, -0.16351159089343698, 0.8371559104619128, -0.5125844302532572, -2.212174675371696, 1.1862919040258124, -0.4919093594837723, 0.687372095690451, 0.25629524043045765, -0.5106884628591007, 0.5173166808970929, -1.436002379410446, -1.6126984867379106, -0.7756006963503046, 0.9227851986936574, 2.4609513168964154, 0.8835794795560707, 0.18394303286989466, 0.40994261660438613, 0.6554467584692043, 0.23535531652185301, 0.23073554667623528, -0.454446295882678, -0.8683403309595062, -2.5880940401224097, -0.007171297286012664, 0.18817580676456216, 1.018057173174127, -0.7951026957469903, 0.05443499262060302, 0.6469723748339526, 0.6988099227472815, -0.8043061632289581, 2.289544243905346, -0.43076865127147607, -0.13489538922248953, 0.29941888092711394, 1.7801557178288105, -0.649507552286067, -0.30119089699697177)
val pred = lm.predict()
// pred: scalaglm.PredictLm = PredictLm(
//   mod = Lm(
//     y = DenseVector(1.787280333329762, 0.4022448360753694, -0.7803971770374609, -1.7488843262263565, -2.2553303265000717, -0.7072433738791055, 2.4668471486987738, 0.8025625943836545, 3.2917552045479255, 8.095688530653216, 1.5862358286362261, 2.6544843557041813, 0.393901058369698, 8.901109048465537, 1.2717312299981027, 4.271896279297028, 2.7596614342573744, -0.16326248963480783, 8.47984431368982, 1.7545066099125046, 4.76170557705318, -4.443528390612588, 1.9535690494578843, 0.21384000857536067, 3.7824048381806117, 6.1675406512641775, 0.53427769981459, 4.6559414300820245, -1.3392513815629297, 4.063463615759522, 7.691335359897301, 0.6894896012787814, 3.9841157089731483, 5.1856395034894165, -5.715472070719949, 0.3095844931119216, -0.5076847850615467, 6.1214690888272845, 2.3181876292781607, 2.4268054015683553, -0.3760191905070286, 6.8721014177914626, 5.632322049241357, 3.246857992715584, 0.8763077683159146, 3.5638341986348747, -0.24877377450845528, 0.4856789007108717, -3.355793027863218, -0.19403204276011454, 1.7656735355373487, 2.839340583499603, 3.5045487991279405, 3.296535222534086, -2.780948052907699, 0.6117452466113613, 0.01774360879668624, -0.14623455724694923, -1.9521267285083632, 7.530433423053957, 3.616761711069043, 0.6326107327090439, 5.94483732368592, 0.6782598712781507, -4.213808709275377, 6.959544792130431, 0.5675934526518653, 3.695009707405924, 2.783384632713726, 0.8572460720978379, 3.2747529116356473, 2.2524198283881454, -6.919899976113412, -2.9585346084982502, 5.519821783206967, 13.754101642814309, 5.01985061595525, 2.9502607920076604, 4.111598296524786, 3.328622589580493, 4.532328685483532, 2.4172055155966023, 1.4599077117134498, -0.5629389578637238, -9.216731508025314, 0.4134477238128056, 2.9190434659745126, 5.0083928662361785, 3.133708121497026, 3.548617466875119, 4.25485788457872, 4.188320493894993, 3.2891244966732534, 9.188268079092403, 2.7658181043595746, 1.0293190049299048, 3.081978007321529, 9.897788863541232, 0.30333924725378214, 2.3742278460280355),
//     Xmat = -0.544270222456705    -2.047920871315183    4.083749480206974     
// -0.08429156825007543  1.3683167089645287    3.9171990998304667    
// 1.5930639821303914    -1.3361785518672296   -1.19985663659192     
// 1.6096408700440188    3.316590995717838     0.17749755114102372   
// 0.5215969926819588    0.6233740213516528    0.3177615427080911    
// -0.1960434230173637   0.7039912398084851    2.2776708081247445    
// 0.6372753748067       1.1542351462246088    -1.9538057036214456   
// -0.3698925003987226   -0.7873306161139912   1.9633432628550898    
// -1.118417934873249    -0.16586068570117174  -6.852916318446825    
// 1.5066273998714095    0.7083792358797857    3.783891335241113     
// -1.0107886905242627   4.40347592087085      4.06030015115118      
// -0.9046289772396757   3.337652880769719     3.844807360461914     
// -0.41346267926919716  -0.8008619038242637   8.454285486337982     
// -0.3966991240829987   -1.4881809359901093   0.15242116710635867   
// -0.6603359308529559   -0.687001956226776    -1.308972066806465    
// -0.6291052522236592   1.1803130359647178    4.923577052522976     
// -0.1177667262973775   2.035207770993299     3.345794029895949     
// 1.0163458023362264    -0.6502302501006103   1.8214422765236586    
// 0.5964924463678365    2.9305910098623027    -1.4920397828480643   
// -0.3167797777988247   3.0052218816764547    0.7043282271007896    
// -0.5298264093748003   1.9028284633701784    -0.44201119520293375  
// ...
pred.fitted
// res13: DenseVector[Double] = DenseVector(0.12418717529842963, 2.1910710493497216, 3.1532329249029027, 5.193198816536961, 2.5769928491162815, 1.701641179049248, 2.8815505092389406, 0.8228051330188122, -0.23390558361315242, 4.07179991934308, 2.220595502288183, 1.9063316355713253, 0.9796748072581651, 0.4276334126026597, 0.35822702233579135, 1.4045341650585057, 2.4083997806927346, 2.762257461992015, 3.5940827888646867, 2.4580843158030965, 1.6621721088833619, 0.9704475171202012, 2.4501919485939627, 2.656721267040398, 1.2348696238234191, 2.411612691632788, 0.4261458744985459, 0.6134335278485818, 2.503940697544877, 2.6362085093516323, 1.8337828051025136, 2.46178623677685, 5.579765134897714, 2.730242668461845, -2.3280396719995387, 3.1637525522492718, 1.5184396003734366, 2.8749101070412304, 0.724868467300747, 4.086178068126905, 0.5122520580262393, 1.6342541592759843, 4.478347616159181, 3.054626008465359, 2.678488011429264, 3.1283448391066897, 0.8564352898364274, 2.0023961142753905, 1.856616728626902, 5.7142724608150495, 3.3750033505418844, 1.894312555438249, 3.378813286452606, 0.6244894948558116, -0.18102175451118718, 1.3796181179247164, 1.2829832655056577, 1.7822008110622385, 1.0378287836920423, 3.317840971973357, 1.6055871324577604, 1.1540808081763039, 3.2830991695431435, 2.3097925070100365, 2.832889511791016, 3.1666361402025167, 2.0987014194424236, 1.5100362275208516, 1.9692887872723714, 2.4518805257098806, 1.685515738072111, 6.591493036147614, -1.952738268703415, -0.5351024141723635, 2.58634881274501, 6.224656056175294, 2.2154055591607897, 2.3659792920917058, 2.8354211108443734, 1.2501148779641553, 3.7879513128616207, 1.6777487482618554, 2.915899633545367, 2.2213531627012513, -1.1047488856576888, 0.43622172085193045, 2.328565272130881, 1.7975447009791163, 5.613054959071253, 3.3765991633058396, 2.179884944485303, 1.968599001461593, 5.797236514741099, 1.8611452705861753, 4.126112485936522, 1.4614949086276352, 2.150511722580428, 4.253949642412522, 2.3329160905713286, 3.3346629273725)
pred.se
// res14: DenseVector[Double] = DenseVector(0.6988577979793982, 0.3792956582028909, 0.787716537746474, 0.7182922989545458, 0.40138469636581026, 0.3443385554813183, 0.531359040079229, 0.4868632281057489, 1.0376608002622931, 0.613923846088434, 0.737591265343879, 0.5958681778564696, 0.8064433208453159, 0.6048126055309972, 0.606383882355235, 0.48323596694472554, 0.37987601560453693, 0.5485369022871724, 0.5755910925687544, 0.4736200428105986, 0.4585376767830831, 0.48876234368624194, 0.5342018312294465, 0.4404461506336484, 0.4637448705195158, 0.3801864480296497, 0.7825594001658057, 0.9703330404947147, 0.7273893582770947, 0.49572676379412034, 0.5796596012763952, 0.4958289384587262, 1.0116283687553358, 0.5749007848604549, 1.2538904212719755, 0.493648460494277, 0.431778988395246, 0.49991961461011286, 0.8048910098855862, 0.8157255127381376, 0.5436411784208249, 0.758842426780643, 0.6450552219419919, 0.7689803441870983, 0.5025784852294054, 0.4378473643556138, 0.4500519243108112, 0.3794996804923258, 0.4284522338231626, 0.9079504883041284, 0.5685873307632984, 0.5851106567137747, 0.4905514302100236, 0.7364469879379135, 0.6253306860093581, 0.7542539462404713, 0.6299355014523563, 0.3607031062233002, 0.5951729481235333, 0.4357410775169869, 0.553062627911607, 0.47740431391740573, 0.5381836350438644, 0.5173713935484642, 0.5019853046347412, 0.41983655231823974, 0.8430334886609782, 0.542692531466809, 0.5562021771087152, 0.8054463215904527, 0.9804111386227039, 1.1263208555194553, 0.9551317182977788, 0.7973846753600551, 0.5415251529949761, 1.018782799975075, 0.5699588989754543, 0.5560436281703962, 0.8412537329760973, 0.5854873691477115, 0.629034190458451, 0.3581219173718226, 0.36607998718381113, 0.3428274362268912, 0.758118147735455, 0.5600916255498555, 0.7432417045571449, 0.6721594762254277, 0.8217334529434205, 0.6425233755075566, 0.33571717907623605, 0.5560172459787003, 0.8214207656858358, 0.3965403014289962, 0.6534336851500853, 0.36691539332864886, 0.8491673761194127, 0.5893330020013232, 0.79657759535555, 0.48007858735560166)
val predNew = lm.predict(DenseMatrix((1.1, 1.6, 1.0), (1.4, 2.2, 3.0)))
// predNew: scalaglm.PredictLm = PredictLm(
//   mod = Lm(
//     y = DenseVector(1.787280333329762, 0.4022448360753694, -0.7803971770374609, -1.7488843262263565, -2.2553303265000717, -0.7072433738791055, 2.4668471486987738, 0.8025625943836545, 3.2917552045479255, 8.095688530653216, 1.5862358286362261, 2.6544843557041813, 0.393901058369698, 8.901109048465537, 1.2717312299981027, 4.271896279297028, 2.7596614342573744, -0.16326248963480783, 8.47984431368982, 1.7545066099125046, 4.76170557705318, -4.443528390612588, 1.9535690494578843, 0.21384000857536067, 3.7824048381806117, 6.1675406512641775, 0.53427769981459, 4.6559414300820245, -1.3392513815629297, 4.063463615759522, 7.691335359897301, 0.6894896012787814, 3.9841157089731483, 5.1856395034894165, -5.715472070719949, 0.3095844931119216, -0.5076847850615467, 6.1214690888272845, 2.3181876292781607, 2.4268054015683553, -0.3760191905070286, 6.8721014177914626, 5.632322049241357, 3.246857992715584, 0.8763077683159146, 3.5638341986348747, -0.24877377450845528, 0.4856789007108717, -3.355793027863218, -0.19403204276011454, 1.7656735355373487, 2.839340583499603, 3.5045487991279405, 3.296535222534086, -2.780948052907699, 0.6117452466113613, 0.01774360879668624, -0.14623455724694923, -1.9521267285083632, 7.530433423053957, 3.616761711069043, 0.6326107327090439, 5.94483732368592, 0.6782598712781507, -4.213808709275377, 6.959544792130431, 0.5675934526518653, 3.695009707405924, 2.783384632713726, 0.8572460720978379, 3.2747529116356473, 2.2524198283881454, -6.919899976113412, -2.9585346084982502, 5.519821783206967, 13.754101642814309, 5.01985061595525, 2.9502607920076604, 4.111598296524786, 3.328622589580493, 4.532328685483532, 2.4172055155966023, 1.4599077117134498, -0.5629389578637238, -9.216731508025314, 0.4134477238128056, 2.9190434659745126, 5.0083928662361785, 3.133708121497026, 3.548617466875119, 4.25485788457872, 4.188320493894993, 3.2891244966732534, 9.188268079092403, 2.7658181043595746, 1.0293190049299048, 3.081978007321529, 9.897788863541232, 0.30333924725378214, 2.3742278460280355),
//     Xmat = -0.544270222456705    -2.047920871315183    4.083749480206974     
// -0.08429156825007543  1.3683167089645287    3.9171990998304667    
// 1.5930639821303914    -1.3361785518672296   -1.19985663659192     
// 1.6096408700440188    3.316590995717838     0.17749755114102372   
// 0.5215969926819588    0.6233740213516528    0.3177615427080911    
// -0.1960434230173637   0.7039912398084851    2.2776708081247445    
// 0.6372753748067       1.1542351462246088    -1.9538057036214456   
// -0.3698925003987226   -0.7873306161139912   1.9633432628550898    
// -1.118417934873249    -0.16586068570117174  -6.852916318446825    
// 1.5066273998714095    0.7083792358797857    3.783891335241113     
// -1.0107886905242627   4.40347592087085      4.06030015115118      
// -0.9046289772396757   3.337652880769719     3.844807360461914     
// -0.41346267926919716  -0.8008619038242637   8.454285486337982     
// -0.3966991240829987   -1.4881809359901093   0.15242116710635867   
// -0.6603359308529559   -0.687001956226776    -1.308972066806465    
// -0.6291052522236592   1.1803130359647178    4.923577052522976     
// -0.1177667262973775   2.035207770993299     3.345794029895949     
// 1.0163458023362264    -0.6502302501006103   1.8214422765236586    
// 0.5964924463678365    2.9305910098623027    -1.4920397828480643   
// -0.3167797777988247   3.0052218816764547    0.7043282271007896    
// -0.5298264093748003   1.9028284633701784    -0.44201119520293375  
// ...
predNew.fitted
// res15: DenseVector[Double] = DenseVector(3.80091889161397, 4.531578833060586)
predNew.se
// res16: DenseVector[Double] = DenseVector(0.4823070981700843, 0.5847773526924216)
lm.plots
// res17: breeze.plot.Figure = breeze.plot.Figure@130f1960
lm.summary
// Estimate	 S.E.	 t-stat	p-value		Variable
// ---------------------------------------------------------
//   1.5924	 0.427	 3.728	0.0003 *	(Intercept)
//   1.3607	 0.325	 4.188	0.0001 *	V1
//   0.4235	 0.169	 2.510	0.0137 *	V2
//   0.0342	 0.099	 0.347	0.7295  	V3
// 
// Residual standard error:   3.2247 on 96 degrees of freedom
// Multiple R-squared: 0.1978, Adjusted R-squared: 0.1727
// F-statistic: 7.8893 on 3 and 96 DF, p-value: 0.00009
//
```
The plots include a plot of studentised residuals against fitted values and a normal Q-Q plot for the studentised residuals.

![Linear model plots](lm-plots.png)


## Generalised linear models

The current implementation supports only simple one-parameter exponential family observation models. This includes the most commonly used cases of **logistic regression** (`LogisticGlm`) and **Poisson regression** (`PoissonGlm`).

### Logistic regression

Again, we start by creating an appropriate response variable.
```scala
val ylb = (0 until 100) map (i => Bernoulli(sigmoid(1.0 + X(i,0))).sample())
val yl = DenseVector(ylb.toArray map {b => if (b) 1.0 else 0.0})
```

Then we can do logistic regression in a typical way.
```scala
import scalaglm.{Glm, LogisticGlm}
val glm = Glm(yl, X, List("V1","V2","V3"), LogisticGlm)
```
```scala
glm.coefficients
// res20: DenseVector[Double] = DenseVector(1.1770607095489278, 1.2809071374051377, 0.11189907160527562, -0.07376436741627622)
glm.fitted
// res21: DenseVector[Double] = DenseVector(0.48737904542528643, 0.7177351255578408, 0.9591686699719074, 0.9733224139101668, 0.8689257264626684, 0.6977723389267196, 0.9060754149683616, 0.6154633810397242, 0.5575963405573152, 0.9481943918744957, 0.5188844270126339, 0.5270200193509454, 0.4835591012769077, 0.6203788725931826, 0.5868387961628744, 0.5349744623363821, 0.7324620194340248, 0.9065133916528961, 0.9152197763708692, 0.7418531002266889, 0.6778550106689923, 0.47511349808949244, 0.8958301821720894, 0.7379231563441656, 0.5045556864785959, 0.8370890875621892, 0.7114568435780741, 0.31762469276576094, 0.7220729114367813, 0.7119833673664373, 0.743395366476444, 0.88313536427865, 0.9709895734919284, 0.8738619238364376, 0.033092885259323204, 0.8101432562420281, 0.7297922689417883, 0.9077883469222602, 0.28504968326529506, 0.9742162120582091, 0.5780109398093948, 0.5796393450234536, 0.9133830612103779, 0.6642374084750441, 0.7114771929271285, 0.8170023257165039, 0.6060678821071797, 0.7972461073223593, 0.6697365638341718, 0.9548464199217804, 0.8612874583653697, 0.5941940983312789, 0.92498061185787, 0.7394304131501528, 0.30881142161759123, 0.8542396028960004, 0.8046169180645424, 0.7475928101006684, 0.7404124755631386, 0.9158434510972432, 0.5250394118574354, 0.5210032040262078, 0.8098967653042852, 0.6764561934446885, 0.8136219456013492, 0.8311266947110164, 0.5007899861037577, 0.7705630161238074, 0.6103725057441353, 0.8254268020031825, 0.6033044395072483, 0.9957665961623061, 0.1840314601000718, 0.30595390040513326, 0.9030156584671071, 0.9811511482485855, 0.6566189221114312, 0.8755986461907551, 0.6155061818078669, 0.4535361577261526, 0.9188456923594972, 0.6703965577586933, 0.8581283302965016, 0.7350204764382189, 0.21814636787840203, 0.5521125040697927, 0.8366913179367143, 0.846132125692032, 0.9867964589677263, 0.9518150343861039, 0.7392356302414448, 0.602911163549063, 0.9847308201036051, 0.7909128449298074, 0.9357264228261023, 0.6723151933925892, 0.8117766643982826, 0.9319970863357538, 0.7737450941972367, 0.8384219388578245)
glm.predict(response=true).fitted
// res22: DenseVector[Double] = DenseVector(0.48737904542528643, 0.7177351255578408, 0.9591686699719074, 0.9733224139101668, 0.8689257264626684, 0.6977723389267196, 0.9060754149683616, 0.6154633810397242, 0.5575963405573152, 0.9481943918744957, 0.5188844270126339, 0.5270200193509454, 0.4835591012769077, 0.6203788725931826, 0.5868387961628744, 0.5349744623363821, 0.7324620194340248, 0.9065133916528961, 0.9152197763708692, 0.7418531002266889, 0.6778550106689923, 0.47511349808949244, 0.8958301821720894, 0.7379231563441656, 0.5045556864785959, 0.8370890875621892, 0.7114568435780741, 0.31762469276576094, 0.7220729114367813, 0.7119833673664373, 0.743395366476444, 0.88313536427865, 0.9709895734919284, 0.8738619238364376, 0.033092885259323204, 0.8101432562420281, 0.7297922689417883, 0.9077883469222602, 0.28504968326529506, 0.9742162120582091, 0.5780109398093948, 0.5796393450234536, 0.9133830612103779, 0.6642374084750441, 0.7114771929271285, 0.8170023257165039, 0.6060678821071797, 0.7972461073223593, 0.6697365638341718, 0.9548464199217804, 0.8612874583653697, 0.5941940983312789, 0.92498061185787, 0.7394304131501528, 0.30881142161759123, 0.8542396028960004, 0.8046169180645424, 0.7475928101006684, 0.7404124755631386, 0.9158434510972432, 0.5250394118574354, 0.5210032040262078, 0.8098967653042852, 0.6764561934446885, 0.8136219456013492, 0.8311266947110164, 0.5007899861037577, 0.7705630161238074, 0.6103725057441353, 0.8254268020031825, 0.6033044395072483, 0.9957665961623061, 0.1840314601000718, 0.30595390040513326, 0.9030156584671071, 0.9811511482485855, 0.6566189221114312, 0.8755986461907551, 0.6155061818078669, 0.4535361577261526, 0.9188456923594972, 0.6703965577586933, 0.8581283302965016, 0.7350204764382189, 0.21814636787840203, 0.5521125040697927, 0.8366913179367143, 0.846132125692032, 0.9867964589677263, 0.9518150343861039, 0.7392356302414448, 0.602911163549063, 0.9847308201036051, 0.7909128449298074, 0.9357264228261023, 0.6723151933925892, 0.8117766643982826, 0.9319970863357538, 0.7737450941972367, 0.8384219388578245)
glm.summary
// Estimate	 S.E.	 z-stat	p-value		Variable
// ---------------------------------------------------------
//   1.1771	 0.345	 3.414	0.0006 *	(Intercept)
//   1.2809	 0.357	 3.590	0.0003 *	V1
//   0.1119	 0.133	 0.844	0.3989  	V2
//  -0.0738	 0.075	-0.978	0.3281  	V3
glm.plots
// res24: breeze.plot.Figure = breeze.plot.Figure@7767acba
```

![Logistic regression plots](glm-plots.png)


### Poisson regression

We first create an appropriate response, and then do Poisson regression.
```scala
val yp = DenseVector.tabulate(100)(i => Poisson(math.exp(-0.5 + X(i,0))).sample().toDouble)

import scalaglm.PoissonGlm
val pglm = Glm(yp, X, List("V1","V2","V3"), PoissonGlm)
```
```scala
pglm.coefficients
// res26: DenseVector[Double] = DenseVector(-0.3381337089648056, 0.9295577767116523, -0.07287840887593981, -0.013468876744464306)
pglm.summary
// Estimate	 S.E.	 z-stat	p-value		Variable
// ---------------------------------------------------------
//  -0.3381	 0.155	-2.175	0.0296 *	(Intercept)
//   0.9296	 0.094	 9.843	0.0000 *	V1
//  -0.0729	 0.055	-1.336	0.1815  	V2
//  -0.0135	 0.031	-0.441	0.6595  	V3
pglm.plots
// res28: breeze.plot.Figure = breeze.plot.Figure@1e8daa04
```
![Poisson regression plots](pglm-plots.png)


## Non-linear response

The above covers the main functionality of the library based on a linear reponse to variation in covariate values. For flexible modelling of a nonlinear response, see the documentation on [flexible regression modelling](FlexibleRegression.md).


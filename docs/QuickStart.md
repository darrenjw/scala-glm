# scala-glm - Quickstart Guide

## PCA

This library contains code for principal components analysis based on a thin SVD of the centred data matrix. This is more numerically stable than a construction from the spectral decomposition of the covariance matrix. It is analogous to the R function `prcomp` rather than the R function `princomp`. First create some synthetic data.

```scala
import breeze.linalg._
import breeze.numerics._
import breeze.stats.distributions._
val X = DenseMatrix.tabulate(100, 3)((i, j) => 
	Gaussian(j, j+1).sample())
```
Now we can do PCA.
```scala
import scalaglm.Pca
val pca = Pca(X, List("V1", "V2", "V3"))
```
```scala
pca.sdev
// res0: DenseVector[Double] = DenseVector(2.809956930587743, 2.3033785611202706, 1.0502389694217111)
pca.loadings
// res1: DenseMatrix[Double] = 0.04832851812767043  0.08675718617578065   0.9950565536603658   
// 0.1150595208115186   -0.9900723573356232   0.08073434158093115  
// -0.9921822720680951  -0.11058895915390343  0.05783097013754107  
pca.scores
// res2: DenseMatrix[Double] = -0.7558062733319475   -2.4897244610860145   -1.1050982869864807    
// -1.1314654819137215   -3.081730017876803    0.45794013933737965    
// -0.11699093358388626  -0.07055683320371023  0.31826706775511143    
// -0.2008021653782171   -0.19026333217207042  0.058370726814954144   
// -3.275177352888229    1.6422326696518446    -0.8113060784533449    
// 5.148226490028678     -1.3602855779185639   -0.18784895263635487   
// 3.304529426734035     0.08423167988352837   -0.8393518024803265    
// 0.7296771508552999    2.4660215444145157    -1.5294599493148497    
// -1.850660174713517    -0.9195263091492364   1.1038084690092687     
// -2.6266248063001054   -0.3863370524401396   0.32164806942234825    
// 2.346622861456007     2.634359089146433     -1.7562622278925457    
// -1.294092166098321    -2.716450800287292    -1.8972939925929149    
// 3.1282207949453325    -2.245757002852835    -0.324466806530076     
// 2.768303732204084     -1.9515740989163446   0.5775616518861907     
// -4.69001325859678     -0.16956356171185855  -1.0749641106970282    
// 2.538482960674447     -2.842009069325315    -1.4286629386065381    
// 5.6153002484268235    1.919608258540773     -0.6591587625149193    
// -0.05890601386061112  -2.3520787994952763   0.6321922774736017     
// -1.2252752806730225   0.9197982282634918    -0.520121354410184     
// 1.3609894032233318    -1.8592655757078356   -0.9280394943589749    
// -0.4193717928685551   0.832609689096577     -0.6762065265290226    
// 6.756611283667783     4.5713666031165925    1.9248666014265963     
// 0.7891992481911236    0.045146387396539214  0.11895283892755179    
// 0.5716789825422984    2.0930737843934053    -1.1984284231247568    
// -2.8763109326279834   -0.8120521356569488   -0.7587834178980006    
// -2.653087630615334    -0.3751254696254482   0.2625188139409415     
// -0.20919741103408337  -0.9826615397608666   0.34527848528491517    
// 5.36609471402425      0.18144035293381217   -0.44687126438391556   
// -1.1252900497991107   -2.8440075087210053   0.5570154491329803     
// -1.3748157921878459   2.8627823488582824    1.8564013592479973     
// 0.7440371079394594    -0.5398100460908173   1.6293339217995089     
// -2.044276735009232    -0.45215878368397566  0.7725634306953563     
// -2.787070378383604    1.8890252264639502    -1.0229782937965044    
// -0.18853878343582692  -0.7353315627202269   0.0810242831514674     
// 2.3427427097230114    -1.3755591936809042   -0.4563911509781923    
// -4.4532975854995      4.691451011144089     -1.5163956719457565    
// 1.1860180589262783    0.5359546668799491    -0.37042801075443377   
// -3.1743974504732675   5.347461312665977     -0.8400768888680967    
// -2.2142043487845116   -0.5640082026938773   -0.5053860644344847    
// 0.21246815126890972   3.475014407531195     0.18528671645717004    
// 2.4416481790705116    0.8961147514725385    0.6977783241162901     
// 1.86796675528133      -6.450696846724721    -0.3601965406056187    
// 1.3704031609886131    2.022862248875287     -0.6529597511213366    
// -1.1439849207607469   0.9033495044226005    0.3676808557802676     
// -1.8459286104620825   -0.5660568675979791   0.35766830269855776    
// 1.2895284526559774    -0.20616979419159343  -0.005336379524109161  
// -0.402289647700384    -0.9259320645974443   -2.6082908950231736    
// -3.1902593230925254   0.5892512620362889    -0.07184377923432247   
// 0.6703791427879318    4.894776604158355     -0.01380705791147209   
// ...
pca.plots
// res3: breeze.plot.Figure = breeze.plot.Figure@44768a2a
pca.summary
// Standard deviations:
// V1	V2	V3
//  2.810	 2.303	 1.050
// Cumulative proportion of variance explained:
// V1	V2	V3
//  0.552	 0.923	 1.000
// Loadings:
// PC01	PC02	PC03	
//  0.048	 0.087	 0.995	V1
//  0.115	-0.990	 0.081	V2
// -0.992	-0.111	 0.058	V3
```
The final line prints a readable summary of the PCA to the console. `plots` produces some diagnostic plots, including a "scree plot".

![PCA Plots](pca-plots.png)

Note that there is also a utility function `pairs` for producing a "scatterplot matrix":
```scala
import scalaglm.Utils.pairs
pairs(X, List("V1", "V2", "V3"))
// res6: breeze.plot.Figure = breeze.plot.Figure@1cb4d2e1
```

![Pairs plots](pairs-plots.png)


## Linear regression

This code computes regression coefficients and associated diagnostics via the QR decomposition of the covariate matrix. The diagnostics are analogous to those produced by the R function `lm`. We start by creating a synthetic response variable.

```scala
val y = DenseVector.tabulate(100)(i => 
	Gaussian(2.0 + 1.5*X(i,0) + 0.5*X(i,1), 3.0).sample())
```
So we can now do linear regression and generate all of the usual diagnostics.
```scala
import scalaglm.Lm
val lm = Lm(y,X,List("V1", "V2", "V3"))
```
```scala
lm.coefficients
// res8: DenseVector[Double] = DenseVector(2.488491081776062, 1.5110022787373367, 0.20057971240776304, -0.0313119268874821)
lm.se
// res9: DenseVector[Double] = DenseVector(0.3843061696531556, 0.2677733083353422, 0.1238319322748578, 0.10180929586044656)
lm.fitted
// res10: DenseVector[Double] = DenseVector(1.190914406534279, 3.553611425399574, 3.2777888826434727, 2.8802953293917857, 1.0518857415475389, 3.2617147321100717, 1.9458247941465625, 0.4183354886644205, 4.304067354847809, 2.983991305347379, 0.2689165996530635, -0.06550725109733288, 2.8541572313289483, 4.158751440676436, 0.5877691149097578, 1.1412648220402721, 2.395674894481331, 3.9077856283222, 1.8008274800705268, 1.688496466609396, 1.6719734582332801, 6.293341763979848, 3.083078036320797, 0.9246025854026384, 1.3394956813111776, 2.8901548648038515, 3.3654709758215717, 2.797522092629073, 3.689562065472722, 5.264751552559586, 5.407423652590664, 3.7467150288650584, 0.7768544166981302, 2.9511446984878664, 2.4982943330360032, -0.3634604077348179, 2.3592736702874215, 0.7837646003030532, 1.792448146980522, 2.89079136291824, 4.117336527878884, 2.90892057114452, 1.8586479589275386, 3.1598273126175154, 3.1494567305830246, 2.9741376059159395, -1.1459863184928898, 2.2525541951719217, 2.555901475135071, 3.458672080720424, 2.9774149105095735, 2.4257963371387, -0.466953101631455, -0.5690070259887482, 1.6934901604178292, 0.9415304218179513, -0.6684644713963246, -0.13975421323699966, 2.6647494456515806, 5.56146124284319, 2.223209921346615, 4.71859814917012, 3.3253457227442764, 3.7478383070280246, 3.317759201256631, 5.946160777828413, 1.704261519748416, 3.174402693400073, 4.716179533159734, 2.450056512887612, 1.839841688891344, 1.4442118323697224, 5.249794838341527, 3.938514597614917, 4.248358732930399, 1.9984967458564187, 2.636807599483246, 3.482958937347023, 3.0241185296344595, 4.045168730666047, 2.502859323958543, 1.8460512909794038, 1.6129176138828765, 4.7701039436221215, 5.45906156799592, 5.108975937653572, 4.3930683390438094, 2.834657565783676, 5.515357244752018, 4.012512357693049, 5.477942808533983, 3.3066250417696037, 6.101367342577613, 1.8091955190293028, 3.666337111913312, 4.677213108858255, 1.697147433003057, 4.661316742759118, 2.380613497650252, 3.9596884196379514)
lm.residuals
// res11: DenseVector[Double] = DenseVector(0.6963253857336595, 1.4961999377657889, 4.0091580217511265, 4.412607569374844, -0.8102244210028723, 2.5773615915856896, -2.11993422970561, -1.4728205520086433, 0.4020561428445424, -3.3945028490353226, 2.160344467638338, 3.8650647407915866, -0.7390786156187081, 1.8472028444830002, -1.6298798534009324, 0.16133148455881918, -2.7970909596845317, 3.8180336714820378, 0.7195022395280035, -2.364936858879676, 0.2380040034279336, 2.698488068670473, 1.852267578006264, 3.7280870989560873, 2.670493722998473, -2.208412998972808, -2.4058194943715616, 2.1026276401734254, -1.5940447158063313, 0.6243168136167352, 0.863534713321112, 3.1587059485007445, 1.100083085885421, -1.8149140374801234, 1.1218247802680956, 3.7830302462010104, -6.25701837801002, 1.8742774236472153, 0.40951133488416924, -0.4824139044630358, -3.664611318854393, 2.7540330311908607, -2.9750756829690417, 1.4136401366446738, -6.187600399992302, -2.9056099713731536, -4.402975132624345, -4.292259387630538, -1.5615206859546753, 0.662054191370018, 0.4256905432770748, -2.9849799764862346, -1.1877206392970971, 2.6845576710215147, 0.0572136839252122, 0.36882570992698016, 2.378826244650795, -0.5198472815389422, 0.8971640633305911, 2.611701765251059, -1.1107140405185358, 1.3384021227206873, -2.7313937455991213, 5.4140265133740915, -2.905630716442095, -0.38932874888327174, 3.429699074803247, -3.202574870717555, -2.3531579048805273, 3.644249414848962, 3.1285759960720405, -2.4937294117243143, -2.111480785488104, 2.151545648245122, 0.982474120713186, 3.3640284293248133, 0.16110673425238975, 3.294412859207511, -0.33007436790218936, -6.0620375420617245, 0.4608458129513493, 2.0959080372206964, -3.826498150365115, -1.9267539079704061, 3.9230558368740107, -2.9010846194055393, 1.7896399650859518, 3.169145166844226, -1.6447915917022131, -0.7713427928919145, 2.2353798880115034, -4.076280347275285, 1.9675709630716467, -1.300837036413382, 4.28640302675718, 1.871305792806072, -2.7951577098048714, -1.7436616161945793, -1.9447510136407686, -7.957349734825638)
lm.studentised
// res12: DenseVector[Double] = DenseVector(0.2521441771866117, 0.5412029215299242, 1.4349413535661497, 1.5787016915936738, -0.2935653981650455, 0.940133399623061, -0.7663426236887587, -0.5360898437853878, 0.14509505664776978, -1.2205764345806143, 0.7925064015727626, 1.418362253650737, -0.2675380342600602, 0.667640028470514, -0.5948443526702948, 0.05898963193630533, -1.027636961460571, 1.375776225722652, 0.2581817923016364, -0.8533282080188839, 0.08539190886887668, 1.0370404321079723, 0.6629478275875096, 1.3487069468165955, 0.9637162207559752, -0.7940265265889622, -0.8619667353259538, 0.7673599987431461, -0.5760662955090656, 0.22915712437991076, 0.31299291178942085, 1.1364532868091348, 0.3988842378493226, -0.6496458264460501, 0.40388958591923513, 1.4180955370698651, -2.242490639391233, 0.696990273879314, 0.14718666244178485, -0.17465342485938917, -1.3200983965286326, 1.030395059403703, -1.0719731008642515, 0.5068647817262815, -2.2204696227785954, -1.0406238107562522, -1.6287818453284115, -1.5462857194081225, -0.5721300232188548, 0.23732587770261487, 0.15354934010111368, -1.072921738414188, -0.4489264811935652, 1.011976695457872, 0.020581053494072733, 0.13398473078612774, 0.8766237909562427, -0.1902144857577978, 0.32527049518539314, 0.9619573446311871, -0.42208302608143006, 0.48953788386613706, -0.9790786877177223, 1.954791409686196, -1.0441822163343806, -0.14590659211700782, 1.2471231106253498, -1.1666159081434035, -0.8491817789911069, 1.3082408822581602, 1.145984549594707, -0.9126154660828661, -0.7680923656677733, 0.7772554642952805, 0.35383794738156354, 1.21756112685625, 0.057686541775116784, 1.18091089735371, -0.12040384460167647, -2.198684080338314, 0.16559466325366898, 0.7512676981606841, -1.3802252480569306, -0.699896054251713, 1.445957425429381, -1.057621574739895, 0.6436222569683658, 1.1475165028207768, -0.5997155572543246, -0.2783051145422201, 0.8168985063369554, -1.4712475701478378, 0.7274197775547526, -0.48137659279478934, 1.5359262492665062, 0.7044742349704949, -1.0077807527280036, -0.6313632928524764, -0.7067006653009039, -2.865188722823531)
val pred = lm.predict()
// pred: scalaglm.PredictLm = PredictLm(
//   mod = Lm(
//     y = DenseVector(1.8872397922679385, 5.049811363165363, 7.286946904394599, 7.292902898766629, 0.24166132054466663, 5.839076323695761, -0.17410943555904757, -1.0544850633442227, 4.706123497692351, -0.4105115436879436, 2.4292610672914017, 3.7995574896942537, 2.11507861571024, 6.0059542851594365, -1.0421107384911747, 1.3025963065990913, -0.40141606520320083, 7.725819299804238, 2.5203297195985304, -0.6764403922702802, 1.9099774616612137, 8.991829832650321, 4.935345614327061, 4.652689684358726, 4.009989404309651, 0.6817418658310435, 0.9596514814500101, 4.9001497328024985, 2.0955173496663906, 5.889068366176321, 6.270958365911776, 6.905420977365803, 1.876937502583551, 1.136230661007743, 3.620119113304099, 3.4195698384661926, -3.897744707722598, 2.6580420239502685, 2.2019594818646913, 2.4083774584552042, 0.45272520902449065, 5.662953602335381, -1.1164277240415028, 4.573467449262189, -3.038143669409277, 0.06852763454278588, -5.5489614511172345, -2.0397051924586163, 0.9943807891803955, 4.120726272090442, 3.4031054537866483, -0.5591836393475345, -1.6546737409285521, 2.1155506450327666, 1.7507038443430414, 1.3103561317449315, 1.71036177325447, -0.6596014947759419, 3.5619135089821716, 8.17316300809425, 1.1124958808280794, 6.057000271890807, 0.5939519771451551, 9.161864820402116, 0.4121284848145361, 5.556832028945141, 5.133960594551663, -0.028172177317482117, 2.3630216282792063, 6.094305927736574, 4.968417684963384, -1.0495175793545921, 3.1383140528534232, 6.090060245860039, 5.230832853643585, 5.362525175181232, 2.7979143337356356, 6.777371796554534, 2.69404416173227, -2.0168688113956774, 2.9637051369098923, 3.9419593282001, -2.2135805364822385, 2.8433500356517154, 9.38211740486993, 2.2078913182480324, 6.182708304129761, 6.003802732627902, 3.8705656530498045, 3.241169564801134, 7.713322696545487, -0.769655305505681, 8.06893830564926, 0.5083584826159205, 7.952740138670492, 6.548518901664327, -1.0980102768018147, 2.9176551265645383, 0.43586248400948335, -3.997661315187687),
//     Xmat = -1.2312064358610963    3.2850695743941496     3.070371742899714     
// 0.25458940469607977    3.9541656212488916     3.5989554568890654    
// 0.4258757636374908     1.0783348298893212     2.251331857015081     
// 0.1528283346601149     1.1662270853773442     2.3326960349947083    
// -0.7021470701727425    -1.0720254710878314    5.130088514877988     
// 0.0648286195161625     2.9202120585521243     -2.8593629502698574   
// -0.5472344552255903    1.2253018976634784     -1.2275041108789377   
// -1.151732497649869     -1.4848191040681864    1.023909384769071     
// 1.0500940148975082     1.7828210559294682     4.1107630157096295    
// 0.28055696212210623    1.1024957880850967     4.776463427278912     
// -1.2846645095388034    -1.483751187799074     -0.6121279538434776   
// -2.065170663253844     3.3836527399405583     3.5837094466778874    
// -0.24555876246698813   3.5534421997949925     -0.7651264899163506   
// 0.6601387893436762     3.293592627513355      -0.38839136115498984  
// -1.1900649887557289    0.5377072957367526     6.718980678043687     
// -1.424526667368879     3.986773388498602      -0.1779169037004924   
// -0.09702395280172202   -0.31142976827800406   -3.712761602150673    
// 0.5431178330291794     3.3692344295106302     2.4641667683587514    
// -0.3760094520621338    -0.09739374356835073   3.1929447873611263    
// -0.8980244867519994    2.9187218807888287     0.9106422888569046    
// -0.49993913651357774   0.06905465446283887    2.3939571666325885    
// 2.7594443838623914     -2.5969241163786267    -4.988968679830004    
// ...
pred.fitted
// res13: DenseVector[Double] = DenseVector(1.1909144065342754, 3.553611425399572, 3.277788882643473, 2.8802953293917857, 1.0518857415475384, 3.2617147321100712, 1.9458247941465616, 0.4183354886644205, 4.304067354847808, 2.983991305347379, 0.26891659965306314, -0.06550725109733359, 2.8541572313289474, 4.158751440676435, 0.5877691149097577, 1.1412648220402715, 2.395674894481331, 3.9077856283222, 1.8008274800705266, 1.6884964666093958, 1.67197345823328, 6.293341763979847, 3.0830780363207966, 0.9246025854026382, 1.3394956813111771, 2.8901548648038515, 3.3654709758215713, 2.7975220926290727, 3.6895620654727215, 5.264751552559587, 5.407423652590663, 3.746715028865058, 0.7768544166981298, 2.9511446984878655, 2.498294333036003, -0.36346040773481786, 2.3592736702874215, 0.7837646003030534, 1.7924481469805216, 2.8907913629182396, 4.1173365278788845, 2.9089205711445194, 1.8586479589275384, 3.159827312617516, 3.149456730583024, 2.974137605915939, -1.1459863184928902, 2.2525541951719217, 2.555901475135071, 3.4586720807204236, 2.9774149105095735, 2.4257963371387, -0.46695310163145565, -0.5690070259887487, 1.6934901604178287, 0.9415304218179508, -0.6684644713963254, -0.13975421323700032, 2.6647494456515806, 5.5614612428431895, 2.2232099213466148, 4.71859814917012, 3.3253457227442764, 3.747838307028024, 3.317759201256631, 5.946160777828412, 1.7042615197484157, 3.1744026934000726, 4.7161795331597345, 2.4500565128876115, 1.8398416888913436, 1.444211832369722, 5.249794838341527, 3.938514597614917, 4.248358732930399, 1.998496745856419, 2.636807599483246, 3.482958937347023, 3.0241185296344595, 4.045168730666047, 2.502859323958543, 1.8460512909794033, 1.6129176138828758, 4.7701039436221215, 5.459061567995919, 5.108975937653572, 4.3930683390438094, 2.834657565783676, 5.5153572447520185, 4.012512357693049, 5.477942808533983, 3.3066250417696037, 6.101367342577613, 1.8091955190293023, 3.6663371119133115, 4.677213108858256, 1.6971474330030567, 4.661316742759118, 2.380613497650251, 3.959688419637952)
pred.se
// res14: DenseVector[Double] = DenseVector(0.5158572335103473, 0.4997168768720175, 0.2940420186278278, 0.28306122785781473, 0.524722546187638, 0.6139149413712582, 0.4901134546107332, 0.5871623994919899, 0.4629003388962101, 0.39787795114459235, 0.6795203761785286, 0.6833010935763817, 0.5110050311802656, 0.4874881374487281, 0.6204620430381893, 0.6425611195551775, 0.6957531096752404, 0.4370116023856778, 0.3554586360307261, 0.4602430525495958, 0.35237594891025986, 1.0590944855022548, 0.2937147684364143, 0.5018617587628204, 0.46258294095229685, 0.3963491807541811, 0.3201483093490261, 0.6201564847871676, 0.48546567052522577, 0.6857469465238901, 0.5298819360800203, 0.40906458915378047, 0.5353649400628661, 0.29645356100889153, 0.42169905178877065, 0.8809628254238027, 0.32766316082267627, 0.8132440279755321, 0.38944751705439484, 0.5131458262378253, 0.4317163608131622, 0.865336527934528, 0.43611070933055984, 0.3378958400422807, 0.3569203099916343, 0.31041428233747487, 0.7649630256663869, 0.43275906621364485, 0.6659531982637945, 0.332460522761129, 0.4547285351800275, 0.39054854364360947, 0.9449613133870676, 0.9248554231150858, 0.40580262521943894, 0.5612753413098089, 0.7272435048363984, 0.6508443855405206, 0.5337729821686811, 0.7221333487072358, 0.9837719740029451, 0.6463849185208332, 0.3314743093862362, 0.47100384868199974, 0.3863842952422632, 0.8789653991324661, 0.574146335862253, 0.5971585887722612, 0.4622766288922063, 0.36470001721217976, 0.6629853297816966, 0.6527092544485442, 0.5793678791763747, 0.4796636294884699, 0.42778897356557605, 0.5088067951910752, 0.30483240727008276, 0.33178876511210675, 0.6143214092695015, 0.5393667593700896, 0.38429339973290205, 0.33089025776999414, 0.4545147384411579, 0.560440795520202, 0.7291172407668758, 0.6069875420150151, 0.4012904635881219, 0.5151790508846491, 0.6088264306426665, 0.45936640640087356, 0.636097808530444, 0.4650263767556042, 0.7591750024612207, 0.768153243736833, 0.3229313434448968, 0.9146691630846884, 0.44710289414124765, 0.515189765953384, 0.5655283109630183, 0.42368081293514126)
val predNew = lm.predict(DenseMatrix((1.1, 1.6, 1.0), (1.4, 2.2, 3.0)))
// predNew: scalaglm.PredictLm = PredictLm(
//   mod = Lm(
//     y = DenseVector(1.8872397922679385, 5.049811363165363, 7.286946904394599, 7.292902898766629, 0.24166132054466663, 5.839076323695761, -0.17410943555904757, -1.0544850633442227, 4.706123497692351, -0.4105115436879436, 2.4292610672914017, 3.7995574896942537, 2.11507861571024, 6.0059542851594365, -1.0421107384911747, 1.3025963065990913, -0.40141606520320083, 7.725819299804238, 2.5203297195985304, -0.6764403922702802, 1.9099774616612137, 8.991829832650321, 4.935345614327061, 4.652689684358726, 4.009989404309651, 0.6817418658310435, 0.9596514814500101, 4.9001497328024985, 2.0955173496663906, 5.889068366176321, 6.270958365911776, 6.905420977365803, 1.876937502583551, 1.136230661007743, 3.620119113304099, 3.4195698384661926, -3.897744707722598, 2.6580420239502685, 2.2019594818646913, 2.4083774584552042, 0.45272520902449065, 5.662953602335381, -1.1164277240415028, 4.573467449262189, -3.038143669409277, 0.06852763454278588, -5.5489614511172345, -2.0397051924586163, 0.9943807891803955, 4.120726272090442, 3.4031054537866483, -0.5591836393475345, -1.6546737409285521, 2.1155506450327666, 1.7507038443430414, 1.3103561317449315, 1.71036177325447, -0.6596014947759419, 3.5619135089821716, 8.17316300809425, 1.1124958808280794, 6.057000271890807, 0.5939519771451551, 9.161864820402116, 0.4121284848145361, 5.556832028945141, 5.133960594551663, -0.028172177317482117, 2.3630216282792063, 6.094305927736574, 4.968417684963384, -1.0495175793545921, 3.1383140528534232, 6.090060245860039, 5.230832853643585, 5.362525175181232, 2.7979143337356356, 6.777371796554534, 2.69404416173227, -2.0168688113956774, 2.9637051369098923, 3.9419593282001, -2.2135805364822385, 2.8433500356517154, 9.38211740486993, 2.2078913182480324, 6.182708304129761, 6.003802732627902, 3.8705656530498045, 3.241169564801134, 7.713322696545487, -0.769655305505681, 8.06893830564926, 0.5083584826159205, 7.952740138670492, 6.548518901664327, -1.0980102768018147, 2.9176551265645383, 0.43586248400948335, -3.997661315187687),
//     Xmat = -1.2312064358610963    3.2850695743941496     3.070371742899714     
// 0.25458940469607977    3.9541656212488916     3.5989554568890654    
// 0.4258757636374908     1.0783348298893212     2.251331857015081     
// 0.1528283346601149     1.1662270853773442     2.3326960349947083    
// -0.7021470701727425    -1.0720254710878314    5.130088514877988     
// 0.0648286195161625     2.9202120585521243     -2.8593629502698574   
// -0.5472344552255903    1.2253018976634784     -1.2275041108789377   
// -1.151732497649869     -1.4848191040681864    1.023909384769071     
// 1.0500940148975082     1.7828210559294682     4.1107630157096295    
// 0.28055696212210623    1.1024957880850967     4.776463427278912     
// -1.2846645095388034    -1.483751187799074     -0.6121279538434776   
// -2.065170663253844     3.3836527399405583     3.5837094466778874    
// -0.24555876246698813   3.5534421997949925     -0.7651264899163506   
// 0.6601387893436762     3.293592627513355      -0.38839136115498984  
// -1.1900649887557289    0.5377072957367526     6.718980678043687     
// -1.424526667368879     3.986773388498602      -0.1779169037004924   
// -0.09702395280172202   -0.31142976827800406   -3.712761602150673    
// 0.5431178330291794     3.3692344295106302     2.4641667683587514    
// -0.3760094520621338    -0.09739374356835073   3.1929447873611263    
// -0.8980244867519994    2.9187218807888287     0.9106422888569046    
// -0.49993913651357774   0.06905465446283887    2.3939571666325885    
// 2.7594443838623914     -2.5969241163786267    -4.988968679830004    
// ...
predNew.fitted
// res15: DenseVector[Double] = DenseVector(4.440209201352071, 4.951233858642967)
predNew.se
// res16: DenseVector[Double] = DenseVector(0.4032606235506848, 0.5005819707127874)
lm.plots
// res17: breeze.plot.Figure = breeze.plot.Figure@7b58a081
lm.summary
// Estimate	 S.E.	 t-stat	p-value		Variable
// ---------------------------------------------------------
//   2.4885	 0.384	 6.475	0.0000 *	(Intercept)
//   1.5110	 0.268	 5.643	0.0000 *	V1
//   0.2006	 0.124	 1.620	0.1086  	V2
//  -0.0313	 0.102	-0.308	0.7591  	V3
// 
// Residual standard error:   2.8094 on 96 degrees of freedom
// Multiple R-squared: 0.2601, Adjusted R-squared: 0.2370
// F-statistic: 11.2507 on 3 and 96 DF, p-value: 0.00000
//
```
The plots include a plot of studentised residuals against fitted values and a normal Q-Q plot for the studentised residuals.

![Linear model plots](lm-plots.png)


## Generalised linear models

The current implementation supports only simple one-parameter exponential family observation models. This includes the most commonly used cases of **logistic regression** (`LogisticGlm`) and **Poisson regression** (`PoissonGlm`).

### Logistic regression

Again, we start by creating an appropriate response variable.
```scala
val ylb = (0 until 100) map (i => Bernoulli(sigmoid(1.0 + X(i,0))).sample())
val yl = DenseVector(ylb.toArray map {b => if (b) 1.0 else 0.0})
```

Then we can do logistic regression in a typical way.
```scala
import scalaglm.{Glm, LogisticGlm}
val glm = Glm(yl, X, List("V1","V2","V3"), LogisticGlm)
```
```scala
glm.coefficients
// res20: DenseVector[Double] = DenseVector(0.7643229354546173, 1.2347042467862501, 0.3232648303998054, 0.026430700484794845)
glm.fitted
// res21: DenseVector[Double] = DenseVector(0.5956197122404954, 0.9207098578652558, 0.845305455162177, 0.8008596276325854, 0.42224179347790997, 0.8471983274515804, 0.6111867591512714, 0.24774912744793073, 0.9396786679375619, 0.8310898782459708, 0.2112043172640312, 0.3550266427521279, 0.8305613030636604, 0.9330077338885786, 0.412498522614021, 0.5718822807260556, 0.6096215895555134, 0.9301631036958098, 0.5873376742862431, 0.6509272053956638, 0.557899810686943, 0.9608367030267685, 0.815612682317001, 0.3485408082662377, 0.5769729874531088, 0.8197717554257924, 0.8724225714191871, 0.7445965684623946, 0.9259180610453425, 0.9482625353335316, 0.9708964966507089, 0.9016035358203403, 0.35473790784161785, 0.8232695481299682, 0.7650477029976602, 0.12556476267587888, 0.6887354393818539, 0.24187854994620672, 0.6506537808166432, 0.6876427728163967, 0.8953956721573894, 0.913991352048487, 0.5327910403195748, 0.8142014903508111, 0.8497402099323125, 0.8053946364165502, 0.14019262068943644, 0.700283871530631, 0.5658389959583335, 0.8663537722138943, 0.8661424293098107, 0.7175561207310487, 0.36532169756486754, 0.2902265341922978, 0.660289501298733, 0.37064356113354174, 0.198064700400676, 0.18863745927294917, 0.7084274597685398, 0.9760461568100407, 0.8078744330185345, 0.9201664387885573, 0.8409332118188665, 0.9103239165875951, 0.8087445138317908, 0.9916978233524666, 0.7039038434554505, 0.7905790388369405, 0.9566884624487355, 0.6654460779202754, 0.4299601394598484, 0.4384051168529276, 0.9554804392689492, 0.9358313410053101, 0.9411161191387242, 0.5217977108031044, 0.7631018263361887, 0.8543714091797099, 0.782330958419625, 0.9336769664420389, 0.7800469435570073, 0.6138970997788845, 0.5354691480823067, 0.9520547424477384, 0.9562790286697413, 0.9509833657263063, 0.9281742055616907, 0.7512496723049576, 0.9804512673771884, 0.9342836666404397, 0.9806129139387039, 0.86549012910569, 0.990222669008325, 0.5360511103121649, 0.8769165221144193, 0.8617981054416433, 0.6806357961933137, 0.9331739227750333, 0.7033776386415728, 0.8761284228892814)
glm.predict(response=true).fitted
// res22: DenseVector[Double] = DenseVector(0.5956197122404954, 0.9207098578652558, 0.845305455162177, 0.8008596276325854, 0.42224179347790997, 0.8471983274515804, 0.6111867591512714, 0.24774912744793073, 0.9396786679375619, 0.8310898782459708, 0.2112043172640312, 0.3550266427521279, 0.8305613030636604, 0.9330077338885786, 0.412498522614021, 0.5718822807260556, 0.6096215895555134, 0.9301631036958098, 0.5873376742862431, 0.6509272053956638, 0.557899810686943, 0.9608367030267685, 0.815612682317001, 0.3485408082662377, 0.5769729874531088, 0.8197717554257924, 0.8724225714191871, 0.7445965684623946, 0.9259180610453425, 0.9482625353335316, 0.9708964966507089, 0.9016035358203403, 0.35473790784161785, 0.8232695481299682, 0.7650477029976602, 0.12556476267587888, 0.6887354393818539, 0.24187854994620672, 0.6506537808166432, 0.6876427728163967, 0.8953956721573894, 0.913991352048487, 0.5327910403195748, 0.8142014903508111, 0.8497402099323125, 0.8053946364165502, 0.14019262068943644, 0.700283871530631, 0.5658389959583335, 0.8663537722138943, 0.8661424293098107, 0.7175561207310487, 0.36532169756486754, 0.2902265341922978, 0.660289501298733, 0.37064356113354174, 0.198064700400676, 0.18863745927294917, 0.7084274597685398, 0.9760461568100407, 0.8078744330185345, 0.9201664387885573, 0.8409332118188665, 0.9103239165875951, 0.8087445138317908, 0.9916978233524666, 0.7039038434554505, 0.7905790388369405, 0.9566884624487355, 0.6654460779202754, 0.4299601394598484, 0.4384051168529276, 0.9554804392689492, 0.9358313410053101, 0.9411161191387242, 0.5217977108031044, 0.7631018263361887, 0.8543714091797099, 0.782330958419625, 0.9336769664420389, 0.7800469435570073, 0.6138970997788845, 0.5354691480823067, 0.9520547424477384, 0.9562790286697413, 0.9509833657263063, 0.9281742055616907, 0.7512496723049576, 0.9804512673771884, 0.9342836666404397, 0.9806129139387039, 0.86549012910569, 0.990222669008325, 0.5360511103121649, 0.8769165221144193, 0.8617981054416433, 0.6806357961933137, 0.9331739227750333, 0.7033776386415728, 0.8761284228892814)
glm.summary
// Estimate	 S.E.	 z-stat	p-value		Variable
// ---------------------------------------------------------
//   0.7643	 0.332	 2.299	0.0215 *	(Intercept)
//   1.2347	 0.307	 4.018	0.0001 *	V1
//   0.3233	 0.126	 2.564	0.0104 *	V2
//   0.0264	 0.090	 0.293	0.7696  	V3
glm.plots
// res24: breeze.plot.Figure = breeze.plot.Figure@635bd26
```

![Logistic regression plots](glm-plots.png)


### Poisson regression

We first create an appropriate response, and then do Poisson regression.
```scala
val yp = DenseVector.tabulate(100)(i => Poisson(math.exp(-0.5 + X(i,0))).sample().toDouble)

import scalaglm.PoissonGlm
val pglm = Glm(yp, X, List("V1","V2","V3"), PoissonGlm)
```
```scala
pglm.coefficients
// res26: DenseVector[Double] = DenseVector(-0.40198005817851706, 0.9079031330425911, 0.03553312267096753, 0.0029387296767127103)
pglm.summary
// Estimate	 S.E.	 z-stat	p-value		Variable
// ---------------------------------------------------------
//  -0.4020	 0.166	-2.424	0.0154 *	(Intercept)
//   0.9079	 0.099	 9.195	0.0000 *	V1
//   0.0355	 0.037	 0.966	0.3343  	V2
//   0.0029	 0.033	 0.088	0.9300  	V3
pglm.plots
// res28: breeze.plot.Figure = breeze.plot.Figure@6a20e647
```
![Poisson regression plots](pglm-plots.png)


## Non-linear response

The above covers the main functionality of the library based on a linear reponse to variation in covariate values. For flexible modelling of a nonlinear response, see the documentation on [flexible regression modelling](FlexibleRegression.md).


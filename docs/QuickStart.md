# scala-glm - Quickstart Guide

## PCA

This library contains code for principal components analysis based on a thin SVD of the centred data matrix. This is more numerically stable than a construction from the spectral decomposition of the covariance matrix. It is analogous to the R function `prcomp` rather than the R function `princomp`. First create some synthetic data.

```scala
import breeze.linalg.*
import breeze.numerics.*
import breeze.stats.distributions.*
import breeze.stats.distributions.Rand.VariableSeed.randBasis

val X = DenseMatrix.tabulate(100, 3)((i, j) => 
	Gaussian(j, j+1).sample())
```
Now we can do PCA.
```scala
import scalaglm.Pca
val pca = Pca(X, List("V1", "V2", "V3"))
```
```scala
pca.sdev
// res0: DenseVector[Double] = DenseVector(3.010847848849103, 2.216983372623755, 1.0259766571123348)
pca.loadings
// res1: DenseMatrix[Double] = -0.0393737577233826   -0.02833261284163336  -0.9988227922170712    
// -0.03540617456866302  0.9990097700674643    -0.026942199467855088  
// 0.9985970708975437    0.03430367851001481   -0.04033791808618572   
pca.scores
// res2: DenseMatrix[Double] = -2.600996761536257    -4.439017889471264    -0.08415505623071047  
// -1.328505216367483    -4.085599205980388    -1.5026185048016012   
// -5.240921538189829    3.687678455749981     -0.7722134431348329   
// 2.0090589803453023    1.119133205188879     -0.9593599088906873   
// 0.2537424720283441    -1.965518451316242    0.36670435940677637   
// 3.894535089067457     -4.844483759067289    -0.8830514284390271   
// -0.2783590132461784   1.770239183016184     1.3957453172649452    
// 1.8634694003094021    -3.1854760929940196   -1.1214800960468045   
// -1.5079593830912827   1.2091708994596264    -0.7440474216854187   
// 2.6754287589949683    -0.685410493444836    0.7177490786977727    
// -2.4455778820380467   0.6876824710000535    -0.9500952252001263   
// 6.200454192646621     -0.3714363822157125   -0.8255381719051491   
// -0.8894522357665064   -3.3489025726551263   1.1561320292609787    
// 4.9010903070906595    2.441402637484918     -1.2695278613644674   
// 2.5924183235520832    -2.4372873598610845   -1.1500555241083938   
// -0.35904321149805096  -2.4101096010026812   0.7541746651896102    
// 1.675937054152691     -1.0128146038388488   -2.5197960645944555   
// -0.47483713299574326  1.073841124344603     -1.5890886026780249   
// 2.565970616277938     0.5934252549745511    1.9917292229303514    
// 2.0901637934672057    -1.0475183115353897   0.13571816876960136   
// -4.490647676555931    2.351705870802643     -0.08971873446231102  
// 2.2969790868861217    4.173315755620431     0.5379286472127588    
// 1.5018241542856812    3.3117766857140425    -1.139618074324823    
// -0.5426564922094559   -0.8897279007716686   1.3918037681837772    
// -1.2380616524114791   -0.9868233914706386   -1.7508271592606448   
// 1.3616819680476664    1.7814833342679126    0.7568406536614858    
// -1.1360713226235213   0.827673244495858     0.14820839654345205   
// -4.511812592166953    -0.13051863863994556  -0.2767409302041417   
// -2.462286311290754    1.725087204938146     0.4818482717648586    
// 1.2984139572385403    -1.4879462197922968   -0.8529630158044347   
// 1.5692572192519467    5.5835905005459345    -0.20720516009021156  
// 0.9589783804788624    -2.978283594607143    -0.8594759414894075   
// 2.241164650624547     1.0951018730860795    0.15481142827032995   
// -3.498317159471565    0.11341765305647424   0.015814012061222626  
// -0.43836549327431285  1.984655553548657     -0.45263027519047183  
// 5.4396675464994235    0.32513327668496994   0.7487007029761987    
// 5.024332811961344     -1.5078224250801837   0.8797469677315212    
// -5.587317838312454    -3.0775651870567198   1.0182514844768793    
// -0.8224245259687766   0.5851973616810605    0.7658934633476545    
// -4.087019667732685    -1.541394072967614    -0.7426786002808259   
// 2.193049646856036     3.149012005493992     -1.3687851530014157   
// 0.6082608436789735    -0.4835012271113033   0.6320356826641397    
// -5.117646968353419    1.1091294134301886    -0.4753196029472896   
// 1.6970324906198835    -1.4604942526933449   0.48540847164819584   
// -2.210981559537325    0.7959695565209127    0.6976403034289468    
// -0.10414274220693176  -0.24299118243330745  0.5974068754326987    
// -2.794157635939858    2.643673128994718     0.4324426282813302    
// 0.045401256369311443  1.464075911603471     -0.750545171400924    
// 2.2797726801144784    1.3493242255126479    0.6576390094270873    
// ...
pca.plots
// res3: Figure = breeze.plot.Figure@60d1b915
pca.summary
// Standard deviations:
// V1	V2	V3
//  3.011	 2.217	 1.026
// Cumulative proportion of variance explained:
// V1	V2	V3
//  0.603	 0.930	 1.000
// Loadings:
// PC01	PC02	PC03	
// -0.039	-0.028	-0.999	V1
// -0.035	 0.999	-0.027	V2
//  0.999	 0.034	-0.040	V3
```
The final line prints a readable summary of the PCA to the console. `plots` produces some diagnostic plots, including a "scree plot".

![PCA Plots](pca-plots.png)

Note that there is also a utility function `pairs` for producing a "scatterplot matrix":
```scala
import scalaglm.Utils.pairs
pairs(X, List("V1", "V2", "V3"))
// res6: Figure = breeze.plot.Figure@519531
```

![Pairs plots](pairs-plots.png)


## Linear regression

This code computes regression coefficients and associated diagnostics via the QR decomposition of the covariate matrix. The diagnostics are analogous to those produced by the R function `lm`. We start by creating a synthetic response variable.

```scala
val y = DenseVector.tabulate(100)(i => 
	Gaussian(2.0 + 1.5*X(i,0) + 0.5*X(i,1), 3.0).sample())
```
So we can now do linear regression and generate all of the usual diagnostics.
```scala
import scalaglm.Lm
val lm = Lm(y,X,List("V1", "V2", "V3"))
```
```scala
lm.coefficients
// res8: DenseVector[Double] = DenseVector(2.094259612844115, 1.2727087154620167, 0.21500482396449172, 0.1776436825037515)
lm.se
// res9: DenseVector[Double] = DenseVector(0.3458774614733966, 0.2607696706393839, 0.12092618624670252, 0.08954199363499026)
lm.fitted
// res10: DenseVector[Double] = DenseVector(1.7267045360965514, 3.765852300962996, 3.7963958303439482, 4.429597850392247, 1.9465218005455849, 3.455006020991104, 1.25184976585497, 3.8247585130462443, 3.748857767541173, 2.0221238008381603, 3.8048676283817953, 4.483838178733004, 0.5402702895747633, 5.418387686944252, 4.086973144213549, 1.293439744928439, 5.999555959872672, 4.93265527360237, 0.609381976627076, 2.6325836400342624, 2.7628198124466135, 3.1057760979154425, 5.00563748821943, 0.7336500919584411, 4.6681537491383365, 2.270654266957506, 2.57704372000936, 2.5416740032988097, 2.1557507177252218, 3.7260653249794133, 4.236223127695317, 3.418354577577874, 3.022148216512986, 2.332355587328289, 3.6459580820317066, 2.499950262684213, 1.943182396778112, 0.2052859933080038, 1.776550057224786, 2.930084640157389, 5.352562890695962, 1.9221331802097, 2.9533019030799847, 2.0601470021725543, 1.736985445537518, 1.9258012786113328, 2.349259760305043, 3.990206858572588, 2.428039946144719, 1.3034742128486505, 2.7124460773414287, -0.07766067079438639, 1.4451458031920599, 1.89544832398566, 2.9353725059597173, 2.2430298688234536, 2.1285997820313614, 0.9704530954041887, 3.9449385174763103, 3.809822696505348, 4.581043781801845, 2.039454447645722, 1.578718543621222, 2.6029271167605588, 4.977800777141486, 1.6103302444814944, -1.167630608606721, 2.0049372784879798, 2.5679345453521862, 4.892385285612915, 3.323732036528298, 2.362798245902062, 1.587607907239784, 1.9665788543867924, 5.542435869623219, 3.577134660386843, 4.661823455153168, 1.2311125823147577, 4.088229788451918, 1.2134294750894798, 3.2374248347721895, 0.7132658087958305, 2.904693578899802, 4.69057961057978, 0.2312996613388587, 0.2640567156352448, 3.9550604676312506, 2.135962507186122, 3.1446091035384103, 3.7621170754468922, 3.6087756370482627, 4.380781354109828, 4.074588677038234, 3.5019243162715266, 2.026553362322003, 1.2182317378612282, 0.2701242338296265, 1.9844004895672591, 3.235333915228602, 3.0956541636300776)
lm.residuals
// res11: DenseVector[Double] = DenseVector(-0.48734142487091203, -3.996432874013482, -0.6950320633958982, 1.6218369836076567, 1.310557134616279, 3.144169198994006, -3.4589058151307692, 0.2047270796489813, -0.6473065179667623, -3.3671043595113535, 0.7567098948464697, 0.7317735940983177, 3.5710046638839814, -3.71408439661057, 1.0527804270039356, -0.10613362389565073, -0.41193057121331655, 3.2833148628102524, -0.24286626432912395, -3.1724820557835174, -2.1953164410555965, -1.1303807345393921, -4.248077804751632, 0.6809728149934792, -0.14194933079618277, -1.0234942655770332, -1.1720021078367153, 1.40639223840977, 1.1041688590919678, -1.548124911520726, 0.7016912259852264, 0.1807965522410937, 3.9465473564703055, 4.455193794679717, -2.2247145737982317, 0.6834484323289516, 1.1965855521759325, -0.9969179958940478, -1.2148597218962025, -0.9740753215242477, 2.8758813467114788, 2.624971604988154, -3.666087106543716, -2.4159458462226637, -0.34085403545838866, 2.2303068009311673, 1.7354186601942896, -0.8988821778450942, 2.137705827542889, -0.8677263344692776, 3.609971064269438, -3.6617795920720493, -0.9503978842757828, 0.3015290720924728, 4.000725415222666, -1.4752150991622, -1.2181763888045185, -2.876755896058725, 3.8005467429375814, -3.513413529761935, 1.1934566756188323, -0.26667962279820934, -0.7150790643032086, 2.870781620297933, 3.013022065044816, 4.734071189921654, -0.9146255459487382, -1.4238787380136375, 2.0077630208477086, 0.4827714403323622, 1.571125998157021, 2.7001411677801013, 1.598722686943571, 3.2800035996140453, -3.1499597201454232, 0.7789448162908403, -1.797047907939188, -4.222379771645529, -4.0909174582769685, -3.3138846454430357, 0.8250328414738628, 0.18358237152894674, -1.9395723889203595, 2.5188174044433698, -0.5983939196617831, 2.01425634307143, 2.5899861718045036, 6.36233483177943, -8.836973820338638, -2.086889192651967, 0.5336273475028399, 0.6460549659766954, -4.613175607236279, -0.3525288651186407, 1.4665395065618054, -0.013019800218774913, -3.3882892743311612, 7.149626577881298, -1.935290732152062, 0.8429632980798503)
lm.studentised
// res12: DenseVector[Double] = DenseVector(-0.1884448772031469, -1.553470077939034, -0.2710921041186579, 0.6166788500758936, 0.496639335713742, 1.2319214323918033, -1.321531753672446, 0.07869269131043294, -0.2454926293103344, -1.2789657396736414, 0.2877857673986777, 0.28319630143965924, 1.372591727266633, -1.4410474170146164, 0.4037346758860225, -0.040389623653413906, -0.1608347969155047, 1.2555068853488927, -0.09381307714323918, -1.2009959162325385, -0.8425610321655336, -0.43624972462813805, -1.6334902317048834, 0.2595484875587987, -0.05445760929352502, -0.3888054127653251, -0.44272615839973467, 0.5368435017139406, 0.41967029078738555, -0.5878990440768505, 0.2741269044798068, 0.06911649440798426, 1.4947855208588041, 1.692077071894943, -0.8434805536921807, 0.26294782949194867, 0.4607728259756575, -0.3888245130656097, -0.4598554498855895, -0.3728514370832311, 1.1094643082302444, 0.9924279203496357, -1.4070166418142267, -0.9157873030342323, -0.1293072953778367, 0.8427169901951703, 0.6629203681833229, -0.34072280396594884, 0.8119053773477409, -0.33536281569372167, 1.3734438374075615, -1.4157496901206952, -0.3604072148685317, 0.11662258534272193, 1.5278345304881453, -0.5573224433247083, -0.4648592385616007, -1.0960926315276909, 1.442986693578972, -1.341986840710748, 0.4635848687918101, -0.10307272840169766, -0.2715885069886542, 1.0960367950242842, 1.1558760875995453, 1.8239736438488365, -0.35934847448588697, -0.543541029345946, 0.7696743622316863, 0.18489292134869456, 0.5979409318551043, 1.020465774419364, 0.6051768980669537, 1.24781015048804, -1.2321340915499088, 0.29458469394129716, -0.6957421650010903, -1.617288348350421, -1.5516496275794134, -1.272249331223643, 0.31577399122061145, 0.07315298695818838, -0.7412589708320205, 0.9793441480254105, -0.23565714216251907, 0.7795437547611499, 1.0060908781585816, 2.414487445365407, -3.3437550951413475, -0.7896672495148214, 0.20594836498376246, 0.24808218137386157, -1.7535616614356455, -0.13319008713275612, 0.5690606985760897, -0.004974994690945872, -1.3010133176655723, 2.73318709185292, -0.7368723213172184, 0.3181791780807835)
val pred = lm.predict()
// pred: PredictLm = PredictLm(
//   mod = Lm(
//     y = DenseVector(1.2393631112256394, -0.23058057305048596, 3.10136376694805, 6.051434833999903, 3.257078935161864, 6.59917521998511, -2.207056049275799, 4.0294855926952255, 3.1015512495744106, -1.344980558673193, 4.561577523228265, 5.215611772831322, 4.111274953458745, 1.7043032903336819, 5.139753571217485, 1.1873061210327882, 5.587625388659355, 8.215970136412622, 0.3665157122979521, -0.539898415749255, 0.5675033713910169, 1.9753953633760504, 0.7575596834677985, 1.4146229069519203, 4.526204418342154, 1.2471600013804727, 1.4050416121726446, 3.9480662417085797, 3.2599195768171896, 2.1779404134586873, 4.937914353680544, 3.5991511298189676, 6.968695572983291, 6.787549382008006, 1.421243508233475, 3.1833986950131647, 3.1397679489540447, -0.791632002586044, 0.5616903353285836, 1.956009318633141, 8.228444237407441, 4.547104785197854, -0.7127852034637314, -0.3557988440501094, 1.3961314100791293, 4.1561080795425, 4.0846784204993325, 3.0913246807274937, 4.565745773687608, 0.4357478783793729, 6.322417141610867, -3.739440262866436, 0.49474791891627706, 2.196977396078133, 6.936097921182383, 0.7678147696612536, 0.9104233932268427, -1.9063028006545364, 7.745485260413892, 0.296409166743413, 5.774500457420677, 1.7727748248475126, 0.8636394793180135, 5.473708737058492, 7.990822842186302, 6.344401434403148, -2.082256154555459, 0.5810585404743422, 4.575697566199895, 5.375156725945277, 4.894858034685319, 5.062939413682163, 3.186330594183355, 5.246582454000838, 2.3924761494777957, 4.356079476677683, 2.8647755472139798, -2.991267189330771, -0.0026876698250504205, -2.100455170353556, 4.062457676246052, 0.8968481803247772, 0.9651211899794423, 7.20939701502315, -0.3670942583229244, 2.278313058706675, 6.545046639435754, 8.498297338965552, -5.692364716800228, 1.6752278827949252, 4.142402984551103, 5.026836320086524, -0.5385869301980453, 3.149395451152886, 3.4930928688838083, 1.2052119376424533, -3.118165040501535, 9.134027067448557, 1.30004318307654, 3.938617461709928),
//     Xmat = 0.37777692175912353    -3.2117579474157285   -0.8883603584766173   
// 1.7344544955836816     -2.8655267623000973   0.4516873945654145    
// 0.9387185383083152     5.018898543627686     -3.218051086208293    
// 0.912959315502452      2.2012448050081987    3.941196771957248     
// -0.2550342515563196    -0.8539303824021436   2.029037277682093     
// 0.9314672370738977     -3.825280221775662    5.616375567042036     
// -1.3677567541482112    2.8692430442287344    1.5843231520807821    
// 1.2025818910437729     -2.0895792956935115   3.654687101133729     
// 0.8338275216505966     2.409916515417848     0.42351590258282945   
// -0.7372854105825367    0.32970940997634757   4.477078109193296     
// 1.0913254574467794     1.9276933456843306    -0.5223646160613153   
// 0.6564958659285679     0.5601445017215841    8.070181643747526     
// -0.9593258428369847    -2.216737401732383    0.8081473581767666    
// 1.0714286471632903     3.4281657273647963    6.887041018758048     
// 1.181224079884242      -1.3671708493845651   4.409431659760422     
// -0.6053243203231237    -1.2868241900065818   1.3862304317019472    
// 2.5450784275049676     0.12524426975082326   3.5983532857960423    
// 1.6410302545384243     2.260909109216109     1.4846336482472697    
// -2.0416887952298435    1.5768304839038527    4.360252592169596     
// -0.12263613039787577   0.004363348296212544  3.9036905139088898    
// 0.26533776048083973    3.639296642826884     -2.542188995314609    
// -0.6804360891271369    5.201868615965397     4.273085140194835     
// ...
pred.fitted
// res13: DenseVector[Double] = DenseVector(1.7267045360965492, 3.7658523009629956, 3.7963958303439487, 4.429597850392247, 1.9465218005455847, 3.455006020991104, 1.2518497658549705, 3.8247585130462443, 3.7488577675411725, 2.02212380083816, 3.804867628381795, 4.483838178733003, 0.5402702895747631, 5.418387686944252, 4.086973144213548, 1.2934397449284385, 5.999555959872672, 4.93265527360237, 0.6093819766270758, 2.632583640034263, 2.7628198124466135, 3.1057760979154425, 5.005637488219429, 0.7336500919584413, 4.668153749138336, 2.2706542669575054, 2.5770437200093594, 2.54167400329881, 2.1557507177252218, 3.726065324979413, 4.236223127695318, 3.4183545775778734, 3.022148216512986, 2.3323555873282893, 3.6459580820317066, 2.499950262684213, 1.9431823967781119, 0.20528599330800346, 1.776550057224786, 2.930084640157389, 5.352562890695962, 1.9221331802097, 2.9533019030799847, 2.060147002172554, 1.736985445537518, 1.925801278611333, 2.3492597603050425, 3.9902068585725883, 2.428039946144719, 1.3034742128486507, 2.7124460773414287, -0.07766067079438693, 1.4451458031920594, 1.89544832398566, 2.935372505959717, 2.2430298688234536, 2.128599782031361, 0.9704530954041888, 3.9449385174763103, 3.809822696505348, 4.581043781801846, 2.0394544476457224, 1.5787185436212223, 2.6029271167605588, 4.977800777141484, 1.6103302444814944, -1.1676306086067214, 2.0049372784879793, 2.567934545352186, 4.892385285612914, 3.323732036528298, 2.3627982459020616, 1.5876079072397837, 1.9665788543867921, 5.542435869623218, 3.5771346603868426, 4.661823455153167, 1.2311125823147575, 4.088229788451917, 1.2134294750894798, 3.237424834772189, 0.7132658087958299, 2.904693578899801, 4.69057961057978, 0.23129966133885882, 0.26405671563524485, 3.95506046763125, 2.135962507186122, 3.1446091035384107, 3.762117075446892, 3.608775637048262, 4.380781354109828, 4.074588677038234, 3.501924316271527, 2.0265533623220033, 1.218231737861228, 0.2701242338296266, 1.9844004895672587, 3.235333915228602, 3.0956541636300776)
pred.se
// res14: DenseVector[Double] = DenseVector(0.642308636857588, 0.6945476559119012, 0.7262234961208448, 0.4288695184598294, 0.37020679384962735, 0.7659087840551211, 0.5000869381586838, 0.5764137690699949, 0.38477799916317884, 0.41182027315357816, 0.4321260571119809, 0.6508717061483739, 0.5761934370765233, 0.6766467909230188, 0.5486207884846109, 0.4422036999957973, 0.7354086405242168, 0.511543957763033, 0.631298284991057, 0.35048365398278847, 0.5583997135451386, 0.6217881547356049, 0.580855364861705, 0.4657007939895964, 0.5533635627365366, 0.4135431120040094, 0.3044843463164313, 0.4873717644164995, 0.4221625456241794, 0.4077072556944271, 0.7405149617136332, 0.5079903193727582, 0.360387559135525, 0.40992482489738147, 0.37942611272512666, 0.5872446622289289, 0.5971979809111142, 0.7258518438227054, 0.348315169943746, 0.5248022875661511, 0.6175942454815007, 0.3233623297481058, 0.5581817357500397, 0.37546353755745454, 0.3899880722113156, 0.3102758639125417, 0.4975006719451068, 0.375079576336598, 0.4100780627817157, 0.6370366242183899, 0.43824325703028016, 0.6409468358555287, 0.3830907222500539, 0.6447600775252668, 0.4936939895525181, 0.3068277274847291, 0.48313853909571974, 0.4607554163636748, 0.40454150408999967, 0.49629024758276435, 0.6877568224961438, 0.6375641651221647, 0.4100721386184332, 0.49007886510732845, 0.5529037904756597, 0.6034200695114894, 0.7889084707632387, 0.4879578797658722, 0.543927814864814, 0.5318019852625927, 0.44329730355122254, 0.31516558412129253, 0.34896041501412367, 0.4370440307125812, 0.7515701223222078, 0.32973020746497633, 0.6550569600184999, 0.5333184568057389, 0.3866234614120084, 0.562042859301866, 0.5236581864257591, 0.8959112509858569, 0.5040163909048705, 0.6969187091657885, 0.8079378342806304, 0.6512238707435404, 0.6881377250673739, 0.3962470974795467, 0.340646987518303, 0.34129993093734884, 0.6220330348269936, 0.5645732160776268, 0.4239829421910852, 0.30819360264149137, 0.6775124387802626, 0.5016436289608166, 0.5638856502058357, 0.5078179457338095, 0.4503654176507613, 0.2856744019075943)
val predNew = lm.predict(DenseMatrix((1.1, 1.6, 1.0), (1.4, 2.2, 3.0)))
// predNew: PredictLm = PredictLm(
//   mod = Lm(
//     y = DenseVector(1.2393631112256394, -0.23058057305048596, 3.10136376694805, 6.051434833999903, 3.257078935161864, 6.59917521998511, -2.207056049275799, 4.0294855926952255, 3.1015512495744106, -1.344980558673193, 4.561577523228265, 5.215611772831322, 4.111274953458745, 1.7043032903336819, 5.139753571217485, 1.1873061210327882, 5.587625388659355, 8.215970136412622, 0.3665157122979521, -0.539898415749255, 0.5675033713910169, 1.9753953633760504, 0.7575596834677985, 1.4146229069519203, 4.526204418342154, 1.2471600013804727, 1.4050416121726446, 3.9480662417085797, 3.2599195768171896, 2.1779404134586873, 4.937914353680544, 3.5991511298189676, 6.968695572983291, 6.787549382008006, 1.421243508233475, 3.1833986950131647, 3.1397679489540447, -0.791632002586044, 0.5616903353285836, 1.956009318633141, 8.228444237407441, 4.547104785197854, -0.7127852034637314, -0.3557988440501094, 1.3961314100791293, 4.1561080795425, 4.0846784204993325, 3.0913246807274937, 4.565745773687608, 0.4357478783793729, 6.322417141610867, -3.739440262866436, 0.49474791891627706, 2.196977396078133, 6.936097921182383, 0.7678147696612536, 0.9104233932268427, -1.9063028006545364, 7.745485260413892, 0.296409166743413, 5.774500457420677, 1.7727748248475126, 0.8636394793180135, 5.473708737058492, 7.990822842186302, 6.344401434403148, -2.082256154555459, 0.5810585404743422, 4.575697566199895, 5.375156725945277, 4.894858034685319, 5.062939413682163, 3.186330594183355, 5.246582454000838, 2.3924761494777957, 4.356079476677683, 2.8647755472139798, -2.991267189330771, -0.0026876698250504205, -2.100455170353556, 4.062457676246052, 0.8968481803247772, 0.9651211899794423, 7.20939701502315, -0.3670942583229244, 2.278313058706675, 6.545046639435754, 8.498297338965552, -5.692364716800228, 1.6752278827949252, 4.142402984551103, 5.026836320086524, -0.5385869301980453, 3.149395451152886, 3.4930928688838083, 1.2052119376424533, -3.118165040501535, 9.134027067448557, 1.30004318307654, 3.938617461709928),
//     Xmat = 0.37777692175912353    -3.2117579474157285   -0.8883603584766173   
// 1.7344544955836816     -2.8655267623000973   0.4516873945654145    
// 0.9387185383083152     5.018898543627686     -3.218051086208293    
// 0.912959315502452      2.2012448050081987    3.941196771957248     
// -0.2550342515563196    -0.8539303824021436   2.029037277682093     
// 0.9314672370738977     -3.825280221775662    5.616375567042036     
// -1.3677567541482112    2.8692430442287344    1.5843231520807821    
// 1.2025818910437729     -2.0895792956935115   3.654687101133729     
// 0.8338275216505966     2.409916515417848     0.42351590258282945   
// -0.7372854105825367    0.32970940997634757   4.477078109193296     
// 1.0913254574467794     1.9276933456843306    -0.5223646160613153   
// 0.6564958659285679     0.5601445017215841    8.070181643747526     
// -0.9593258428369847    -2.216737401732383    0.8081473581767666    
// 1.0714286471632903     3.4281657273647963    6.887041018758048     
// 1.181224079884242      -1.3671708493845651   4.409431659760422     
// -0.6053243203231237    -1.2868241900065818   1.3862304317019472    
// 2.5450784275049676     0.12524426975082326   3.5983532857960423    
// 1.6410302545384243     2.260909109216109     1.4846336482472697    
// -2.0416887952298435    1.5768304839038527    4.360252592169596     
// -0.12263613039787577   0.004363348296212544  3.9036905139088898    
// 0.26533776048083973    3.639296642826884     -2.542188995314609    
// -0.6804360891271369    5.201868615965397     4.273085140194835     
// ...
predNew.fitted
// res15: DenseVector[Double] = DenseVector(4.015890600699272, 4.881993474724075)
predNew.se
// res16: DenseVector[Double] = DenseVector(0.387025178958342, 0.4811855549037868)
lm.plots
// res17: Figure = breeze.plot.Figure@3d7b8a43
lm.summary
// Estimate	 S.E.	 t-stat	p-value		Variable
// ---------------------------------------------------------
//   2.0943	 0.346	 6.055	0.0000 *	(Intercept)
//   1.2727	 0.261	 4.881	0.0000 *	V1
//   0.2150	 0.121	 1.778	0.0786  	V2
//   0.1776	 0.090	 1.984	0.0501  	V3
// 
// Residual standard error:   2.6647 on 96 degrees of freedom
// Multiple R-squared: 0.2280, Adjusted R-squared: 0.2039
// F-statistic: 9.4512 on 3 and 96 DF, p-value: 0.00002
//
```
The plots include a plot of studentised residuals against fitted values and a normal Q-Q plot for the studentised residuals.

![Linear model plots](lm-plots.png)


## Generalised linear models

The current implementation supports only simple one-parameter exponential family observation models. This includes the most commonly used cases of **logistic regression** (`LogisticGlm`) and **Poisson regression** (`PoissonGlm`).

### Logistic regression

Again, we start by creating an appropriate response variable.
```scala
val ylb = (0 until 100) map (i => Bernoulli(sigmoid(1.0 + X(i,0))).sample())
val yl = DenseVector(ylb.toArray map {b => if (b) 1.0 else 0.0})
```

Then we can do logistic regression in a typical way.
```scala
import scalaglm.{Glm, LogisticGlm}
val glm = Glm(yl, X, List("V1","V2","V3"), LogisticGlm)
```
```scala
glm.coefficients
// res20: DenseVector[Double] = DenseVector(0.8031150386510574, 1.044598442928214, -0.05470970651521105, 0.1776284576718573)
glm.fitted
// res21: DenseVector[Double] = DenseVector(0.7712982669636602, 0.9454182666734534, 0.7185941993755776, 0.911849563601957, 0.7198746059005009, 0.9518016719261239, 0.37725962112957717, 0.943896954966451, 0.8344518040776876, 0.6921448812677355, 0.851303520958289, 0.9474365110301071, 0.5164520033658403, 0.9506453117636657, 0.9476015915518942, 0.6195008061000299, 0.9836012887027851, 0.9344626959067481, 0.3449317431138706, 0.7970855150785926, 0.6057820857094038, 0.6380155444787271, 0.9075486978610505, 0.4192909704824067, 0.9469803909710509, 0.5974390943476209, 0.6819374789503798, 0.6935770554774993, 0.5397350968642308, 0.9113618031144762, 0.7572506983868152, 0.9173433482611522, 0.7688003751499057, 0.6527103108280408, 0.8020237922260377, 0.746625300245709, 0.736738641687465, 0.3870065985396714, 0.5441335156985286, 0.8137654109163408, 0.932937592884775, 0.6453471095425626, 0.6994352131730078, 0.726965994639045, 0.5100593426965727, 0.6266177470922308, 0.5233456011291878, 0.8604532635200324, 0.6591523466773562, 0.5245037097037932, 0.7263448320151853, 0.33654797687046933, 0.5346080409817893, 0.46027054747198093, 0.6817691687067905, 0.7165968749344308, 0.7834472819010546, 0.4751555091093908, 0.8371144012140295, 0.8783593486664857, 0.8595593405332351, 0.4197699559653008, 0.50107515087534, 0.7480659024175338, 0.9593082841456403, 0.690921102696305, 0.16182535417530705, 0.7596888269031241, 0.7537121984595918, 0.9387917520150146, 0.7186425490830493, 0.7581950426398127, 0.5824460131459336, 0.49682479903423293, 0.9342230604421647, 0.870942623201989, 0.9678160474741976, 0.5845695232911947, 0.8692775162836633, 0.4334454712119615, 0.8222794201068232, 0.7125031690348309, 0.8597693645335862, 0.8934521007631928, 0.21957861463996994, 0.2240086210748432, 0.9578057363803161, 0.713209052624106, 0.8403283241284227, 0.8547976984309449, 0.9424663863704275, 0.8764287043573141, 0.8544620419803491, 0.8432772877030088, 0.501137029132448, 0.3805563214275334, 0.2663303488067586, 0.5935178539974928, 0.8919711289358393, 0.7763113449959702)
glm.predict(response=true).fitted
// res22: DenseVector[Double] = DenseVector(0.7712982669636602, 0.9454182666734534, 0.7185941993755776, 0.911849563601957, 0.7198746059005009, 0.9518016719261239, 0.37725962112957717, 0.943896954966451, 0.8344518040776876, 0.6921448812677355, 0.851303520958289, 0.9474365110301071, 0.5164520033658403, 0.9506453117636657, 0.9476015915518942, 0.6195008061000299, 0.9836012887027851, 0.9344626959067481, 0.3449317431138706, 0.7970855150785926, 0.6057820857094038, 0.6380155444787271, 0.9075486978610505, 0.4192909704824067, 0.9469803909710509, 0.5974390943476209, 0.6819374789503798, 0.6935770554774993, 0.5397350968642308, 0.9113618031144762, 0.7572506983868152, 0.9173433482611522, 0.7688003751499057, 0.6527103108280408, 0.8020237922260377, 0.746625300245709, 0.736738641687465, 0.3870065985396714, 0.5441335156985286, 0.8137654109163408, 0.932937592884775, 0.6453471095425626, 0.6994352131730078, 0.726965994639045, 0.5100593426965727, 0.6266177470922308, 0.5233456011291878, 0.8604532635200324, 0.6591523466773562, 0.5245037097037932, 0.7263448320151853, 0.33654797687046933, 0.5346080409817893, 0.46027054747198093, 0.6817691687067905, 0.7165968749344308, 0.7834472819010546, 0.4751555091093908, 0.8371144012140295, 0.8783593486664857, 0.8595593405332351, 0.4197699559653008, 0.50107515087534, 0.7480659024175338, 0.9593082841456403, 0.690921102696305, 0.16182535417530705, 0.7596888269031241, 0.7537121984595918, 0.9387917520150146, 0.7186425490830493, 0.7581950426398127, 0.5824460131459336, 0.49682479903423293, 0.9342230604421647, 0.870942623201989, 0.9678160474741976, 0.5845695232911947, 0.8692775162836633, 0.4334454712119615, 0.8222794201068232, 0.7125031690348309, 0.8597693645335862, 0.8934521007631928, 0.21957861463996994, 0.2240086210748432, 0.9578057363803161, 0.713209052624106, 0.8403283241284227, 0.8547976984309449, 0.9424663863704275, 0.8764287043573141, 0.8544620419803491, 0.8432772877030088, 0.501137029132448, 0.3805563214275334, 0.2663303488067586, 0.5935178539974928, 0.8919711289358393, 0.7763113449959702)
glm.summary
// Estimate	 S.E.	 z-stat	p-value		Variable
// ---------------------------------------------------------
//   0.8031	 0.313	 2.568	0.0102 *	(Intercept)
//   1.0446	 0.288	 3.626	0.0003 *	V1
//  -0.0547	 0.117	-0.468	0.6400  	V2
//   0.1776	 0.084	 2.114	0.0345 *	V3
glm.plots
// res24: Figure = breeze.plot.Figure@61d711c7
```

![Logistic regression plots](glm-plots.png)


### Poisson regression

We first create an appropriate response, and then do Poisson regression.
```scala
val yp = DenseVector.tabulate(100)(i => Poisson(math.exp(-0.5 + X(i,0))).sample().toDouble)

import scalaglm.PoissonGlm
val pglm = Glm(yp, X, List("V1","V2","V3"), PoissonGlm)
```
```scala
pglm.coefficients
// res26: DenseVector[Double] = DenseVector(-0.5323394119453752, 0.9980539321192005, -0.04166409900210126, 0.0022739902053085966)
pglm.summary
// Estimate	 S.E.	 z-stat	p-value		Variable
// ---------------------------------------------------------
//  -0.5323	 0.173	-3.077	0.0021 *	(Intercept)
//   0.9981	 0.110	 9.034	0.0000 *	V1
//  -0.0417	 0.043	-0.976	0.3290  	V2
//   0.0023	 0.037	 0.061	0.9512  	V3
pglm.plots
// res28: Figure = breeze.plot.Figure@29226703
```
![Poisson regression plots](pglm-plots.png)


## Non-linear response

The above covers the main functionality of the library based on a linear reponse to variation in covariate values. For flexible modelling of a nonlinear response, see the documentation on [flexible regression modelling](FlexibleRegression.md).


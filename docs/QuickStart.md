# scala-glm - Quickstart Guide

## PCA

This library contains code for principal components analysis based on a thin SVD of the centred data matrix. This is more numerically stable than a construction from the spectral decomposition of the covariance matrix. It is analogous to the R function `prcomp` rather than the R function `princomp`. First create some synthetic data.

```scala
import breeze.linalg._
import breeze.numerics._
import breeze.stats.distributions._
val X = DenseMatrix.tabulate(100, 3)((i, j) => 
	Gaussian(j, j+1).sample())
```
Now we can do PCA.
```scala
import scalaglm.Pca
val pca = Pca(X, List("V1", "V2", "V3"))
```
```scala
pca.sdev
// res0: DenseVector[Double] = DenseVector(2.9983028236193734, 2.1535551099890538, 1.0658940390476228)
pca.loadings
// res1: DenseMatrix[Double] = 0.08303427727502519  7.432896946195911E-4  -0.9965464145326319   
// 0.10550402559003713  0.9943731856937553    0.009532479087250426  
// 0.9909461183039725   -0.10593118093216003  0.08248863876078341   
pca.scores
// res2: DenseMatrix[Double] = -0.6637562921957815   -0.25356196886142207  -1.6426684131523501    
// -0.20994253201955781  2.584927829430451     -3.0563892025954638    
// 2.5368459273230934    1.7760061827958251    0.45472882471072484    
// -1.9374091574221937   0.8703038537541002    -0.33488872673896125   
// 3.388370317358524     0.10731539323914069   0.7348329242245999     
// 1.4924706758783457    -1.7587536874728698   -0.20880551419066373   
// 2.01595765312172      2.077921465587442     -0.609597987979771     
// -1.491895534003724    3.027437776487606     -0.4753968746000812    
// -0.9889975226556924   -1.7110902786525342   -1.4317069358535373    
// 2.094355839113753     -3.2494734296263275   1.125121394687449      
// 5.665577250999137     3.749547641093608     -0.32198766992687267   
// 3.263688863921908     -4.64301430818116     0.13903689837174824    
// -2.7500398609206993   1.3363202742320157    -1.5525529925933943    
// 0.16624099453989305   2.4795053812040497    -0.2833087139899843    
// -1.3482961361367396   -0.1958595973859704   0.9851058599224987     
// -1.8259124058869523   -0.7519743597000184   1.7015632738421467     
// 2.387534624764846     -3.184343792936917    -0.1876379096023561    
// -1.67618767074824     2.296849974933064     0.6060608085512774     
// 3.887974352153094     2.113925284040997     0.44732886769937263    
// 1.990241028681226     0.799170690806846     -1.0179559680156687    
// -0.10608865455209718  -2.928922380316005    -0.21732320466794045   
// -2.2178169140383215   -0.2988842370263579   -1.3173227770387854    
// 0.4301641618879607    -1.722170424090857    1.263201198471082      
// -1.1429126347225917   0.2927383553594916    0.997880923186764      
// -1.3069370686913862   0.45223085932883134   0.89636645903661       
// 1.452370284259015     0.12372530761585107   0.32641991191648223    
// -2.2353907841242044   0.5625981661434878    -0.6026432629629827    
// 1.1890525307768276    -0.8112552683876385   -0.04336663893378048   
// 2.860068142017032     -3.9531109217181597   -0.2587556745647814    
// -1.2530933927934569   -0.39553460989205846  -1.480167237660967     
// -3.7808985532386017   0.4795388055610891    -0.6466296491315981    
// 4.312516039961826     -1.7205607549295665   0.0752797284749428     
// 0.3913943666923193    -0.30691767213127397  -0.6997627924392783    
// -0.405029543113302    1.3975372150689604    0.5883857789125642     
// 0.7983883596431198    -0.9662999199416871   -1.4816971533475667    
// 0.06182278683986489   -1.954401283593544    -0.05502735757132457   
// 2.1072749802900144    -0.21031407573460226  2.2415716966355803     
// 2.5444213263075524    -1.7951511077919347   -1.0930083016052474    
// 1.5473679807506948    -2.1818223246409807   -1.0967894422562752    
// -1.8174134310789225   -1.1104399399885514   -1.7987187161533849    
// 0.036736542069339295  -1.5523228371612867   1.043918420497331      
// 0.029791473789268774  -2.7744863118454073   -0.16128353225731604   
// 3.0310195059976697    -1.7602101607024272   1.0776794363245723     
// -5.829781264195285    -2.0332514692173462   -2.022172768560553     
// -2.3508600340075847   -0.186614992256189    0.8381334521495928     
// 0.5116491016227498    -2.282570402459187    0.8597758773257203     
// 5.5350173493785135    1.0347112403378336    0.2164457089445279     
// 0.01820851694014003   3.448182227161894     0.7353793979429826     
// 3.4719853771188025    0.43843087932969627   -1.0774975379542626    
// ...
pca.plots
// res3: breeze.plot.Figure = breeze.plot.Figure@35589496
pca.summary
// Standard deviations:
// V1	V2	V3
//  2.998	 2.154	 1.066
// Cumulative proportion of variance explained:
// V1	V2	V3
//  0.609	 0.923	 1.000
// Loadings:
// PC01	PC02	PC03	
//  0.083	 0.001	-0.997	V1
//  0.106	 0.994	 0.010	V2
//  0.991	-0.106	 0.082	V3
```
The final line prints a readable summary of the PCA to the console. `plots` produces some diagnostic plots, including a "scree plot".

![PCA Plots](pca-plots.png)

Note that there is also a utility function `pairs` for producing a "scatterplot matrix":
```scala
import scalaglm.Utils.pairs
pairs(X, List("V1", "V2", "V3"))
// res6: breeze.plot.Figure = breeze.plot.Figure@2737f854
```

![Pairs plots](pairs-plots.png)


## Linear regression

This code computes regression coefficients and associated diagnostics via the QR decomposition of the covariate matrix. The diagnostics are analogous to those produced by the R function `lm`. We start by creating a synthetic response variable.

```scala
val y = DenseVector.tabulate(100)(i => 
	Gaussian(2.0 + 1.5*X(i,0) + 0.5*X(i,1), 3.0).sample())
```
So we can now do linear regression and generate all of the usual diagnostics.
```scala
import scalaglm.Lm
val lm = Lm(y,X,List("V1", "V2", "V3"))
```
```scala
lm.coefficients
// res8: DenseVector[Double] = DenseVector(2.7861724457475625, 1.063480801305788, 0.35113918774313874, -0.0675287570017702)
lm.se
// res9: DenseVector[Double] = DenseVector(0.40341075636166435, 0.29116418999621335, 0.14417695512940956, 0.1067682953310651)
lm.fitted
// res10: DenseVector[Double] = DenseVector(4.708470384528568, 7.250049602415589, 3.3927687144664334, 3.6464829359170414, 2.5491463237058394, 2.774146735073331, 4.600495143281847, 4.592068571236993, 3.944923439768719, 0.8602989253928002, 5.105257949208222, 1.4782372644917536, 5.058612367372325, 4.289286869895563, 1.8982974880643297, 0.9108954889239266, 2.2948801946241217, 3.1718596192320097, 3.6002537123636458, 4.576030084886994, 2.2719058705021844, 4.25594737920383, 1.1618185106087957, 2.0712133558784043, 2.22639610520219, 2.8756243636976846, 3.8035502086104622, 2.919073957704765, 2.123489450315643, 4.450751942603246, 3.730292892569197, 2.6508665609804, 3.7496788787718853, 2.943759541883155, 4.368429831513504, 2.457363036290234, 0.760654793283095, 3.761670130856161, 3.5693403065847864, 4.500789818290017, 1.4323676651708457, 2.2754803383017412, 1.4972440631306467, 4.174101167801549, 1.9991036544830434, 1.3949073857281868, 3.5563079258049783, 3.544679729688646, 4.597027411093652, 1.877566552403476, 2.660334832564235, 4.5785163843567735, 1.0662687175078163, 2.6192047799302434, 3.0657382830490345, 4.276649047258987, 1.0836997853774355, 1.8112256698431985, 3.6668336499402634, 2.87892036244476, 5.135028016740762, 1.8953529734593983, 3.6144011277557295, 2.3293457579745454, 2.6351320513609187, 5.127279427404629, 3.836758887967624, 3.507372801174888, 3.3739262182986, 3.892636138384182, 3.919925661977932, 3.735127554470357, 2.1903330441676148, 2.860842905052068, 0.8627142915503275, 2.3365704920271755, 1.4911310992532583, 3.7581488742941267, 3.1792385803541636, 2.5214585686994253, 0.5042983081137615, 5.199684990719421, 1.932428099594706, 2.8286016513752683, 1.757181170924251, 1.9059332553125403, 3.20132956745828, 2.3532025804927956, 3.933559501833772, 3.6639682179548125, 5.129511262063525, 2.7410824062642414, 4.2690411263141685, 2.608537220859526, 0.6079271566244028, 7.4722271598486225, 2.1280321143625116, 0.4862381386933504, 3.6870901272818566, 5.3002037260171395)
lm.residuals
// res11: DenseVector[Double] = DenseVector(-1.5985186927373154, 0.045326360653850095, 2.4442892385184023, -2.431576605335845, -6.456991365437929, 0.6961106898810048, 1.2223421108604828, -2.548428531583458, 1.2117057635139994, 0.18174793823773072, -1.794905966556176, -0.6613395937788872, 1.2832488458642732, -0.3801166984617934, 1.6512567612340296, -3.3202596270532942, 3.416733384440707, 0.5742974011816817, 2.4269355774547527, 0.30991931147972807, 3.6440761693807877, -4.45958062136622, 3.7868640760241767, 0.49250132213958686, 3.0482522658021813, -0.009720458739853388, 1.409124715659225, -2.5547659873123885, -5.908093841337383, 0.3633803675603611, -5.266789817218614, 1.5852780773252175, -3.6659506766447074, 0.2976036663074737, 1.9369744221019758, 5.347440162063369, -3.5254706717412594, -1.8840262962742587, -5.002860868003713, 5.197025900205843, -3.051706830464865, 4.919439887799329, -1.4254017092186633, 2.2408437669817687, -0.0034350913591587595, 0.9378118065164445, 5.116942634740594, -0.03750682581177589, -2.5938040053341656, 0.24977343914886307, 4.295219616172049, -0.09881885411477409, -4.189675346388846, -2.777840102666698, -5.701471005269806, -0.7442561983461142, 0.6309311815510001, 0.22041526243222975, -0.9251294988144902, -2.415783972846243, -5.311867798943463, -4.495351909149154, 0.7962016402855063, -1.158392424908551, -2.9131323833409373, 0.27459223637320207, 0.47365756264038295, -0.616580134042942, -0.07559071212454027, -1.7285909039263379, -3.253306559020663, -2.3103220693836892, 3.931539253304368, -0.6228351202840221, 2.093272822781781, -2.6767660298840577, 3.668224004518967, 5.064238515058669, 4.790572219212273, -5.780810580758455, 0.5215324807415402, -0.25904699154991473, -1.5362735786885162, 0.5980325984213124, 0.7572801489190331, 3.9226761153282457, -4.534305476114781, 0.7002520665656493, -3.6939930801950944, 4.737461032909298, 1.1498958041676772, 3.7827800978522417, -0.1085453095456197, -0.36161101091149517, -3.2553771519529344, 2.7397454121382916, 2.31595809711438, 7.009471600969277, 3.7000996414712253, 5.9156295109372845)
lm.studentised
// res12: DenseVector[Double] = DenseVector(-0.525276773042013, 0.01549183661895675, 0.7996095640532918, -0.7917710663239744, -2.114240040130322, 0.22698707307719396, 0.4001436991631782, -0.8373527812355511, 0.3983909441520731, 0.06017815884476682, -0.6033960474890897, -0.221304148137364, 0.4237003564911088, -0.12423398819353151, 0.5387497937884842, -1.094504493192587, 1.1251831764922138, 0.18806266154905474, 0.7991001875143566, 0.10133906434903919, 1.1940493999208235, -1.4627970726887722, 1.2419484580347422, 0.16066646470766002, 0.9939105655936287, -0.003159539417180756, 0.4594638342299732, -0.830270256388835, -1.9610077737470133, 0.11921991957887869, -1.7267971654990408, 0.5216746007293379, -1.1924153861804858, 0.09693798005422376, 0.6357186023413111, 1.7425533970420144, -1.173858665250306, -0.6191878973594245, -1.6432090553082652, 1.7171506461346435, -0.9978039902373422, 1.610190139065238, -0.4690638227965727, 0.7599015721094081, -0.001121773543542989, 0.3071487456701736, 1.692472431596995, -0.012363814626192899, -0.85217970781923, 0.08206957014224624, 1.4163535360553938, -0.03238008440760127, -1.3775967846078745, -0.9092464341200526, -1.8816585047360515, -0.24298523832422092, 0.20701938386676788, 0.07368662213423423, -0.316036954511939, -0.7854973089677907, -1.7926202781036062, -1.469652142598016, 0.261319551766075, -0.3776628199079468, -0.9608655641492415, 0.0908864346269715, 0.156324578811767, -0.20210704565872512, -0.024838694228303412, -0.5640387249756971, -1.0600911634151244, -0.7527848909354742, 1.3410305089574135, -0.2041489753279038, 0.6902398801872757, -0.8759733885271539, 1.2004502638121983, 1.6779174758728788, 1.5870859941758315, -1.8958692738209693, 0.18007139201815234, -0.08658891638883083, -0.500930837602091, 0.19660916060287836, 0.2573214978844542, 1.2843181278600977, -1.475100268832685, 0.23624976751175225, -1.2037031501419178, 1.5476134178848961, 0.3826077793228998, 1.2413935159672782, -0.03552438546344316, -0.11784755287562892, -1.0835515758864513, 0.9501386747997072, 0.7547502322993296, 2.340559478287834, 1.2119320062995889, 2.0022209480497057)
val pred = lm.predict()
// pred: scalaglm.PredictLm = PredictLm(
//   mod = Lm(
//     y = DenseVector(3.109951691791253, 7.295375963069439, 5.837057952984836, 1.2149063305811965, -3.9078450417320894, 3.470257424954336, 5.82283725414233, 2.043640039653535, 5.156629203282718, 1.042046863630531, 3.310351982652046, 0.8168976707128665, 6.341861213236598, 3.90917017143377, 3.5495542492983594, -2.4093641381293676, 5.711613579064829, 3.7461570204136914, 6.0271892898183985, 4.885949396366722, 5.915982039882972, -0.20363324216238965, 4.948682586632972, 2.563714678017991, 5.274648371004371, 2.865903904957831, 5.212674924269687, 0.3643079703923764, -3.78460439102174, 4.814132310163607, -1.5364969246494167, 4.236144638305618, 0.08372820212717791, 3.2413632081906285, 6.30540425361548, 7.804803198353603, -2.7648158784581645, 1.8776438345819024, -1.4335205614189266, 9.69781571849586, -1.6193391652940197, 7.19492022610107, 0.07184235391198335, 6.414944934783318, 1.9956685631238846, 2.3327191922446313, 8.673250560545572, 3.50717290387687, 2.0032234057594867, 2.127339991552339, 6.955554448736284, 4.4796975302419995, -3.123406628881029, -0.15863532273645475, -2.635732722220771, 3.5323928489128726, 1.7146309669284356, 2.0316409322754283, 2.741704151125773, 0.4631363895985168, -0.17683978220270102, -2.599998935689755, 4.410602768041236, 1.1709533330659943, -0.2780003319800186, 5.401871663777831, 4.310416450608007, 2.890792667131946, 3.29833550617406, 2.164045234457844, 0.6666191029572692, 1.4248054850866678, 6.121872297471983, 2.2380077847680457, 2.9559871143321086, -0.34019553785688195, 5.159355103772225, 8.822387389352796, 7.969810799566437, -3.25935201205903, 1.0258307888553018, 4.940637999169506, 0.39615452090618974, 3.4266342497965807, 2.514461319843284, 5.828609370640786, -1.332975908656501, 3.053454647058445, 0.2395664216386777, 8.40142925086411, 6.279407066231202, 6.523862504116483, 4.160495816768549, 2.2469262099480307, -2.6474499953285315, 10.211972571986914, 4.443990211476891, 7.495709739662627, 7.387189768753082, 11.215833236954424),
//     Xmat = 1.6021749913166432     0.8469773240873952    1.1697436461232629     
// 3.050805292995467      3.7038983820802764    1.2021481502968934     
// -0.22071045669220324   3.2227952864126364    4.299384883795171      
// 0.19399034654351627    1.84261024043972      -0.10355318440729455   
// -0.4303818011173824    1.656003247571036     5.343071464570511      
// 0.35118601486709283    -0.4085860669121706   3.5841725253054215     
// 0.7969134415144554     3.457910265076903     3.6634355579822397     
// 0.3726095146585487     4.0332704609010825    0.09782874165493105    
// 1.363852551226442      -0.6346530177892393   1.0192467314781766     
// -0.9292650005140829    -1.8147008678668248   4.448555809123237      
// 0.814582438424279      5.507921709294518     7.126659180566233      
// 0.14947288675024797    -3.086431039136624    5.673580494199879      
// 1.340319486831632      2.2086613033692393    -1.058635563166749     
// 0.31845964269656424    3.6651923345713278    1.814840914827417      
// -1.073321420346713     0.8571825091250783    0.7020505873491338     
// -1.827376363499016     0.2606360774806825    0.3467680891113747     
// 0.4033528760869479     -1.7315200120598462   4.623893201373649      
// -0.7209588647206658    3.2976589516775454    0.0818051648678575     
// -0.1008949120177716    3.701291927597803     5.601873769875431      
// 1.2007752787677664     2.1797489121421005    3.7397264546072093     
// 0.22606929575842497    -1.7409060770249694   2.123341100766635      
// 1.148878976012697      0.6410517747663971    -0.3386083346616551    
// ...
pred.fitted
// res13: DenseVector[Double] = DenseVector(4.708470384528562, 7.250049602415588, 3.392768714466433, 3.6464829359170414, 2.5491463237058394, 2.7741467350733306, 4.600495143281847, 4.592068571236993, 3.944923439768719, 0.8602989253928002, 5.105257949208223, 1.478237264491753, 5.058612367372326, 4.289286869895563, 1.8982974880643295, 0.9108954889239265, 2.2948801946241217, 3.17185961923201, 3.6002537123636458, 4.576030084886993, 2.2719058705021844, 4.25594737920383, 1.1618185106087955, 2.0712133558784043, 2.22639610520219, 2.8756243636976846, 3.8035502086104622, 2.9190739577047653, 2.123489450315643, 4.450751942603245, 3.7302928925691976, 2.650866560980399, 3.7496788787718844, 2.943759541883155, 4.368429831513503, 2.4573630362902334, 0.7606547932830954, 3.761670130856161, 3.569340306584785, 4.500789818290016, 1.432367665170846, 2.275480338301741, 1.4972440631306467, 4.174101167801549, 1.9991036544830434, 1.3949073857281866, 3.556307925804978, 3.5446797296886468, 4.597027411093652, 1.8775665524034755, 2.660334832564236, 4.578516384356773, 1.0662687175078165, 2.619204779930243, 3.0657382830490354, 4.276649047258987, 1.0836997853774353, 1.811225669843199, 3.666833649940264, 2.87892036244476, 5.135028016740762, 1.8953529734593983, 3.61440112775573, 2.3293457579745454, 2.6351320513609187, 5.127279427404628, 3.836758887967624, 3.5073728011748875, 3.3739262182985996, 3.8926361383841814, 3.9199256619779326, 3.735127554470357, 2.1903330441676157, 2.860842905052068, 0.8627142915503277, 2.3365704920271755, 1.4911310992532578, 3.758148874294126, 3.1792385803541636, 2.5214585686994253, 0.5042983081137615, 5.199684990719421, 1.9324280995947063, 2.828601651375269, 1.7571811709242513, 1.9059332553125399, 3.2013295674582793, 2.353202580492797, 3.9335595018337712, 3.6639682179548116, 5.1295112620635255, 2.7410824062642414, 4.2690411263141685, 2.608537220859526, 0.6079271566244032, 7.4722271598486225, 2.128032114362512, 0.48623813869335075, 3.687090127281856, 5.3002037260171395)
pred.se
// res14: DenseVector[Double] = DenseVector(0.576340365359871, 1.016246504652783, 0.49883869965124283, 0.4022216047781468, 0.5157338896744109, 0.43392299307370713, 0.511514756895881, 0.5750634874488847, 0.5852137783104102, 0.6868765623609189, 0.8628517432802683, 0.8141332378201236, 0.6483416277400412, 0.48117470735735873, 0.4462030471015787, 0.625000691633578, 0.6101161956160858, 0.5174648083799692, 0.6077044685045409, 0.4902582143154334, 0.5285074566481216, 0.5466486277876024, 0.5440500639657678, 0.44354448488502846, 0.43260238821452224, 0.3578776008128031, 0.4328775568581521, 0.35367078419285797, 0.7185558067207345, 0.5504439220269298, 0.5389679191540317, 0.5989428564855347, 0.3759192272606732, 0.40992109361310947, 0.5563817198759223, 0.41956983471716597, 0.7571491852313966, 0.5787407389792023, 0.5690358015080362, 0.6582141039161207, 0.48912240781292915, 0.508915836380074, 0.5989579427543104, 0.9473195892763214, 0.4649125487342696, 0.5202504941138374, 0.6727004486776615, 0.6248877562146951, 0.5735044195839715, 0.5750596503370827, 0.6297544238889105, 0.5286419306980241, 0.5862851873649326, 0.5094585833303096, 0.6419857043754852, 0.4597990969501339, 0.5520602248245778, 0.8034947898306731, 1.0120321797863827, 0.366871226021355, 0.9015098769281192, 0.4868459939501857, 0.5566814116906974, 0.43019836701354947, 0.6336456929148829, 0.6820082737314512, 0.6422788243644288, 0.5348411464385526, 0.5759645512677681, 0.4483399604677758, 0.41843457005471774, 0.4174040570425381, 0.9990759108125538, 0.5341268153495798, 0.6293479573861286, 0.5054826235498877, 0.505815227262295, 0.6955924170986963, 0.6942830222905912, 0.5438845117426216, 1.0976820975223278, 0.8018715370143771, 0.4332429482739839, 0.5839969836992666, 0.9655740462724663, 0.5143190480949426, 0.3799389036335197, 0.8987226122818239, 0.4186984838997348, 0.47182205125275756, 0.7487746551438526, 0.5547402494701639, 0.5069695442976573, 0.4215681112769402, 0.7530101252041264, 1.1307059738926337, 0.42124066366443935, 0.7902264442080672, 0.5215602386537744, 0.9294744928745139)
val predNew = lm.predict(DenseMatrix((1.1, 1.6, 1.0), (1.4, 2.2, 3.0)))
// predNew: scalaglm.PredictLm = PredictLm(
//   mod = Lm(
//     y = DenseVector(3.109951691791253, 7.295375963069439, 5.837057952984836, 1.2149063305811965, -3.9078450417320894, 3.470257424954336, 5.82283725414233, 2.043640039653535, 5.156629203282718, 1.042046863630531, 3.310351982652046, 0.8168976707128665, 6.341861213236598, 3.90917017143377, 3.5495542492983594, -2.4093641381293676, 5.711613579064829, 3.7461570204136914, 6.0271892898183985, 4.885949396366722, 5.915982039882972, -0.20363324216238965, 4.948682586632972, 2.563714678017991, 5.274648371004371, 2.865903904957831, 5.212674924269687, 0.3643079703923764, -3.78460439102174, 4.814132310163607, -1.5364969246494167, 4.236144638305618, 0.08372820212717791, 3.2413632081906285, 6.30540425361548, 7.804803198353603, -2.7648158784581645, 1.8776438345819024, -1.4335205614189266, 9.69781571849586, -1.6193391652940197, 7.19492022610107, 0.07184235391198335, 6.414944934783318, 1.9956685631238846, 2.3327191922446313, 8.673250560545572, 3.50717290387687, 2.0032234057594867, 2.127339991552339, 6.955554448736284, 4.4796975302419995, -3.123406628881029, -0.15863532273645475, -2.635732722220771, 3.5323928489128726, 1.7146309669284356, 2.0316409322754283, 2.741704151125773, 0.4631363895985168, -0.17683978220270102, -2.599998935689755, 4.410602768041236, 1.1709533330659943, -0.2780003319800186, 5.401871663777831, 4.310416450608007, 2.890792667131946, 3.29833550617406, 2.164045234457844, 0.6666191029572692, 1.4248054850866678, 6.121872297471983, 2.2380077847680457, 2.9559871143321086, -0.34019553785688195, 5.159355103772225, 8.822387389352796, 7.969810799566437, -3.25935201205903, 1.0258307888553018, 4.940637999169506, 0.39615452090618974, 3.4266342497965807, 2.514461319843284, 5.828609370640786, -1.332975908656501, 3.053454647058445, 0.2395664216386777, 8.40142925086411, 6.279407066231202, 6.523862504116483, 4.160495816768549, 2.2469262099480307, -2.6474499953285315, 10.211972571986914, 4.443990211476891, 7.495709739662627, 7.387189768753082, 11.215833236954424),
//     Xmat = 1.6021749913166432     0.8469773240873952    1.1697436461232629     
// 3.050805292995467      3.7038983820802764    1.2021481502968934     
// -0.22071045669220324   3.2227952864126364    4.299384883795171      
// 0.19399034654351627    1.84261024043972      -0.10355318440729455   
// -0.4303818011173824    1.656003247571036     5.343071464570511      
// 0.35118601486709283    -0.4085860669121706   3.5841725253054215     
// 0.7969134415144554     3.457910265076903     3.6634355579822397     
// 0.3726095146585487     4.0332704609010825    0.09782874165493105    
// 1.363852551226442      -0.6346530177892393   1.0192467314781766     
// -0.9292650005140829    -1.8147008678668248   4.448555809123237      
// 0.814582438424279      5.507921709294518     7.126659180566233      
// 0.14947288675024797    -3.086431039136624    5.673580494199879      
// 1.340319486831632      2.2086613033692393    -1.058635563166749     
// 0.31845964269656424    3.6651923345713278    1.814840914827417      
// -1.073321420346713     0.8571825091250783    0.7020505873491338     
// -1.827376363499016     0.2606360774806825    0.3467680891113747     
// 0.4033528760869479     -1.7315200120598462   4.623893201373649      
// -0.7209588647206658    3.2976589516775454    0.0818051648678575     
// -0.1008949120177716    3.701291927597803     5.601873769875431      
// 1.2007752787677664     2.1797489121421005    3.7397264546072093     
// 0.22606929575842497    -1.7409060770249694   2.123341100766635      
// 1.148878976012697      0.6410517747663971    -0.3386083346616551    
// ...
predNew.fitted
// res15: DenseVector[Double] = DenseVector(4.450295270571181, 4.8449655096052595)
predNew.se
// res16: DenseVector[Double] = DenseVector(0.46993245083869795, 0.5191105252799298)
lm.plots
// res17: breeze.plot.Figure = breeze.plot.Figure@a9b7237
lm.summary
// Estimate	 S.E.	 t-stat	p-value		Variable
// ---------------------------------------------------------
//   2.7862	 0.403	 6.907	0.0000 *	(Intercept)
//   1.0635	 0.291	 3.653	0.0004 *	V1
//   0.3511	 0.144	 2.435	0.0167 *	V2
//  -0.0675	 0.107	-0.632	0.5286  	V3
// 
// Residual standard error:   3.0973 on 96 degrees of freedom
// Multiple R-squared: 0.1699, Adjusted R-squared: 0.1439
// F-statistic: 6.5482 on 3 and 96 DF, p-value: 0.00045
//
```
The plots include a plot of studentised residuals against fitted values and a normal Q-Q plot for the studentised residuals.

![Linear model plots](lm-plots.png)


## Generalised linear models

The current implementation supports only simple one-parameter exponential family observation models. This includes the most commonly used cases of **logistic regression** (`LogisticGlm`) and **Poisson regression** (`PoissonGlm`).

### Logistic regression

Again, we start by creating an appropriate response variable.
```scala
val ylb = (0 until 100) map (i => Bernoulli(sigmoid(1.0 + X(i,0))).sample())
val yl = DenseVector(ylb.toArray map {b => if (b) 1.0 else 0.0})
```

Then we can do logistic regression in a typical way.
```scala
import scalaglm.{Glm, LogisticGlm}
val glm = Glm(yl, X, List("V1","V2","V3"), LogisticGlm)
```
```scala
glm.coefficients
// res20: DenseVector[Double] = DenseVector(1.5321451642821702, 1.3131445516990106, 0.034358850855064474, 0.1752250266052594)
glm.fitted
// res21: DenseVector[Double] = DenseVector(0.9795698551688526, 0.997202427326163, 0.8915248119948078, 0.8620054488514778, 0.8765470050506601, 0.9313300060946033, 0.9657541240420192, 0.8981792642859149, 0.9701096174650626, 0.7367284118331064, 0.9827038617365472, 0.931917985628956, 0.9601729087278252, 0.916389015075459, 0.5683660140542062, 0.31050776043502215, 0.9433494220420563, 0.6710769646145124, 0.9247297232511914, 0.9789406013282552, 0.8948486443517805, 0.9527312059113077, 0.5985066451504854, 0.5806788959794403, 0.6017081300104123, 0.8737513106860975, 0.8897374402062097, 0.9106902966969855, 0.9537830169940821, 0.9703666240186839, 0.8456806284226583, 0.954685501261804, 0.9503272076567226, 0.74742960190378, 0.983186675243589, 0.8803239245040585, 0.41062698464839453, 0.9829075316675171, 0.9773548129441894, 0.9765121954759259, 0.6394870975314125, 0.8918916837990897, 0.7995161347643687, 0.9454517807919142, 0.5444980326958472, 0.718138651121184, 0.9630590423117158, 0.7407629481736918, 0.9870599335770259, 0.8815523881027422, 0.4505346120558873, 0.9473131524900171, 0.46881341825971734, 0.9421155437164558, 0.7136900370637229, 0.9546643217631697, 0.4793065933089005, 0.1992767042505337, 0.5772582916143408, 0.7588120593088149, 0.9961328900078941, 0.8045906283427742, 0.7448117630828806, 0.628863674458354, 0.4940101730331665, 0.9823933380323613, 0.9877039028215863, 0.9619765211550728, 0.9360765879865098, 0.9205871394988361, 0.8995468803722176, 0.8797935334967943, 0.24933238440665442, 0.9567197500995297, 0.31886415596279954, 0.5148265255180031, 0.4782359337799137, 0.9881017179357263, 0.9826307126864279, 0.8745877296989394, 0.25634177110888756, 0.8816933308927933, 0.7823459457947677, 0.7383287741746302, 0.8881281684160222, 0.6359925243147836, 0.9281092258770053, 0.21149022141959622, 0.9306050746945621, 0.9325413291135354, 0.9415139781718918, 0.5715592813265219, 0.8920328947504621, 0.6729170197592355, 0.20026787400223775, 0.9943140955982557, 0.7181374137059906, 0.46621488211474205, 0.935268337126652, 0.9862669858196121)
glm.predict(response=true).fitted
// res22: DenseVector[Double] = DenseVector(0.9795698551688526, 0.997202427326163, 0.8915248119948078, 0.8620054488514778, 0.8765470050506601, 0.9313300060946033, 0.9657541240420192, 0.8981792642859149, 0.9701096174650626, 0.7367284118331064, 0.9827038617365472, 0.931917985628956, 0.9601729087278252, 0.916389015075459, 0.5683660140542062, 0.31050776043502215, 0.9433494220420563, 0.6710769646145124, 0.9247297232511914, 0.9789406013282552, 0.8948486443517805, 0.9527312059113077, 0.5985066451504854, 0.5806788959794403, 0.6017081300104123, 0.8737513106860975, 0.8897374402062097, 0.9106902966969855, 0.9537830169940821, 0.9703666240186839, 0.8456806284226583, 0.954685501261804, 0.9503272076567226, 0.74742960190378, 0.983186675243589, 0.8803239245040585, 0.41062698464839453, 0.9829075316675171, 0.9773548129441894, 0.9765121954759259, 0.6394870975314125, 0.8918916837990897, 0.7995161347643687, 0.9454517807919142, 0.5444980326958472, 0.718138651121184, 0.9630590423117158, 0.7407629481736918, 0.9870599335770259, 0.8815523881027422, 0.4505346120558873, 0.9473131524900171, 0.46881341825971734, 0.9421155437164558, 0.7136900370637229, 0.9546643217631697, 0.4793065933089005, 0.1992767042505337, 0.5772582916143408, 0.7588120593088149, 0.9961328900078941, 0.8045906283427742, 0.7448117630828806, 0.628863674458354, 0.4940101730331665, 0.9823933380323613, 0.9877039028215863, 0.9619765211550728, 0.9360765879865098, 0.9205871394988361, 0.8995468803722176, 0.8797935334967943, 0.24933238440665442, 0.9567197500995297, 0.31886415596279954, 0.5148265255180031, 0.4782359337799137, 0.9881017179357263, 0.9826307126864279, 0.8745877296989394, 0.25634177110888756, 0.8816933308927933, 0.7823459457947677, 0.7383287741746302, 0.8881281684160222, 0.6359925243147836, 0.9281092258770053, 0.21149022141959622, 0.9306050746945621, 0.9325413291135354, 0.9415139781718918, 0.5715592813265219, 0.8920328947504621, 0.6729170197592355, 0.20026787400223775, 0.9943140955982557, 0.7181374137059906, 0.46621488211474205, 0.935268337126652, 0.9862669858196121)
glm.summary
// Estimate	 S.E.	 z-stat	p-value		Variable
// ---------------------------------------------------------
//   1.5321	 0.414	 3.703	0.0002 *	(Intercept)
//   1.3131	 0.338	 3.883	0.0001 *	V1
//   0.0344	 0.152	 0.227	0.8207  	V2
//   0.1752	 0.105	 1.676	0.0938  	V3
glm.plots
// res24: breeze.plot.Figure = breeze.plot.Figure@16f65b78
```

![Logistic regression plots](glm-plots.png)


### Poisson regression

We first create an appropriate response, and then do Poisson regression.
```scala
val yp = DenseVector.tabulate(100)(i => Poisson(math.exp(-0.5 + X(i,0))).sample().toDouble)

import scalaglm.PoissonGlm
val pglm = Glm(yp, X, List("V1","V2","V3"), PoissonGlm)
```
```scala
pglm.coefficients
// res26: DenseVector[Double] = DenseVector(-0.344906380273206, 0.9578032322248217, -0.04075824441728403, -0.01599006364500985)
pglm.summary
// Estimate	 S.E.	 z-stat	p-value		Variable
// ---------------------------------------------------------
//  -0.3449	 0.153	-2.252	0.0243 *	(Intercept)
//   0.9578	 0.098	 9.787	0.0000 *	V1
//  -0.0408	 0.042	-0.966	0.3341  	V2
//  -0.0160	 0.032	-0.493	0.6221  	V3
pglm.plots
// res28: breeze.plot.Figure = breeze.plot.Figure@1a2c1f4c
```
![Poisson regression plots](pglm-plots.png)


## Non-linear response

The above covers the main functionality of the library based on a linear reponse to variation in covariate values. For flexible modelling of a nonlinear response, see the documentation on [flexible regression modelling](FlexibleRegression.md).


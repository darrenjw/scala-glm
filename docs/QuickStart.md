# scala-glm - Quickstart Guide

## PCA

This library contains code for principal components analysis based on a thin SVD of the centred data matrix. This is more numerically stable than a construction from the spectral decomposition of the covariance matrix. It is analogous to the R function `prcomp` rather than the R function `princomp`. First create some synthetic data.

```scala
import breeze.linalg.*
import breeze.numerics.*
import breeze.stats.distributions.*
import breeze.stats.distributions.Rand.VariableSeed.randBasis

val X = DenseMatrix.tabulate(100, 3)((i, j) => 
	Gaussian(j, j+1).sample())
```
Now we can do PCA.
```scala
import scalaglm.Pca
val pca = Pca(X, List("V1", "V2", "V3"))
```
```scala
pca.sdev
// res0: DenseVector[Double] = DenseVector(2.875574480466734, 1.9551473043513803, 1.0221526611139453)
pca.loadings
// res1: DenseMatrix[Double] = 0.049396731885590316  -0.03449684962556765  0.9981833149501819    
// 0.08968759432555884   -0.9952126259003737   -0.03883252081151976  
// -0.9947442376325271   -0.09144285983276179  0.04606631179602734   
pca.scores
// res2: DenseMatrix[Double] = -0.8964811362975824    1.7706050120290862    -0.18396391574572915   
// 2.029768294824517      -1.0372907118684866   -1.117048514144831     
// -1.4059352176046787    0.6209258070452183    -0.2847472175431159    
// 3.9037847968881794     -3.1402950635831437   1.4155230495509912     
// -5.724630085843227     -1.3459050608367864   0.6220734757740877     
// 0.6390734599868694     -3.5144985062989123   -1.6331875331237933    
// 2.1681261007473753     -1.014017830118773    -1.08432619535666      
// -3.2689013670579725    -1.9554062251912463   -0.6127146181764538    
// -0.25928491418990257   1.1180781657165022    0.8379308868748564     
// -0.8499681173562125    -2.7993785194596974   0.08541881568840204    
// 2.923680957630307      1.6906505936144811    0.5739605820920588     
// 0.8789010312164702     2.3882468970917197    -0.8870776704471078    
// 2.8076743492284204     -2.4856534848814142   -0.62112222608719      
// -2.139246687686651     1.620375179861462     -1.651048068760916     
// 0.7895735441511752     0.5329890342030102    0.887910462761183      
// 4.575171562962809      1.9415986438076587    -0.6240558801629404    
// -1.922793855546959     0.12062370573253017   -0.8085662211232387    
// 2.6349406722189763     -1.5579159095347859   -0.8860099962143364    
// 1.269391703448982      -1.2064493933023681   -0.38975857926754826   
// -1.1169777768392462    2.3416474384444377    0.38969876727058345    
// -7.824857666648102     -1.3848841605639595   -0.6743995315691859    
// 0.330296619736987      0.6809059575621175    -0.18346098918813417   
// -2.433166732696354     4.668400516832769     0.8618226129113692     
// -1.3196007401945242    -0.6042325280657114   -0.8019675992365801    
// 3.214413631414683      -1.6494401079341445   0.5640491778969453     
// -1.5757814786768003    -1.5916469739789494   -0.2619130061232735    
// -1.3149139695017134    -0.22426967329161793  1.7969972557655751     
// -2.1034263407618825    0.34904350248325716   -0.4211923399225267    
// -3.6633451894611477    5.538039523218641     -0.06263939188049146   
// 3.059267224752753      -3.2248772082055224   -0.04258795498523118   
// 4.293472030229174      -0.446960789497307    -1.1645289725216186    
// -0.07525884156609634   0.606015873841809     -2.897381116480912     
// 0.11060632416056226    -0.39550575716663544  -0.2600349821909119    
// 1.338439751347535      -2.076131660029437    -1.5978610325121243    
// 2.7220279070917504     0.750095443102144     -1.7319607880244705    
// 1.2047104786664184     -1.4111433075022222   0.7644101099520689     
// -1.2981348176929421    0.6057960525457299    -1.1392657386245986    
// -4.162837355290959     1.9438072811644471    -1.124512546750982     
// 1.8162602761175775     0.3614920408607598    1.0869923140134148     
// -0.018072492423136237  -1.6857472459580176   0.5971416257808709     
// 2.7002949286819877     -0.15874328826144554  0.15825879754902128    
// 3.0720851064156087     0.7709156257904592    0.9402171361370143     
// -2.3519555987350294    -1.1137950913812753   2.3593133185443715     
// 2.292645904199757      0.6207556706327243    0.2566076584926047     
// -0.36834316221668895   -2.7012368469143055   0.14053942149389817    
// -2.4130761147797344    0.20880423706613302   0.5503753443134634     
// -0.8355973581930394    0.1093093570493468    1.4304687921328803     
// 2.7110017333504626     0.48595249957196696   0.2901602155077424     
// 2.726851633492841      2.2743796566254906    -0.17933395395384252   
// ...
pca.plots
// res3: Figure = breeze.plot.Figure@6a191c86
pca.summary
// Standard deviations:
// V1	V2	V3
//  2.876	 1.955	 1.022
// Cumulative proportion of variance explained:
// V1	V2	V3
//  0.629	 0.920	 1.000
// Loadings:
// PC01	PC02	PC03	
//  0.049	-0.034	 0.998	V1
//  0.090	-0.995	-0.039	V2
// -0.995	-0.091	 0.046	V3
```
The final line prints a readable summary of the PCA to the console. `plots` produces some diagnostic plots, including a "scree plot".

![PCA Plots](pca-plots.png)

Note that there is also a utility function `pairs` for producing a "scatterplot matrix":
```scala
import scalaglm.Utils.pairs
pairs(X, List("V1", "V2", "V3"))
// res6: Figure = breeze.plot.Figure@4926c97e
```

![Pairs plots](pairs-plots.png)


## Linear regression

This code computes regression coefficients and associated diagnostics via the QR decomposition of the covariate matrix. The diagnostics are analogous to those produced by the R function `lm`. We start by creating a synthetic response variable.

```scala
val y = DenseVector.tabulate(100)(i => 
	Gaussian(2.0 + 1.5*X(i,0) + 0.5*X(i,1), 3.0).sample())
```
So we can now do linear regression and generate all of the usual diagnostics.
```scala
import scalaglm.Lm
val lm = Lm(y,X,List("V1", "V2", "V3"))
```
```scala
lm.coefficients
// res8: DenseVector[Double] = DenseVector(1.4982000376133757, 1.7695394876229316, 0.5656355223104971, 0.16042527675692209)
lm.se
// res9: DenseVector[Double] = DenseVector(0.41118179759698825, 0.2898060749325082, 0.15171439147285998, 0.10442029431943667)
lm.fitted
// res10: DenseVector[Double] = DenseVector(0.9416066151765546, 1.037567654319846, 1.5102154286114213, 6.776881356469737, 4.447439311300737, 1.7452868724108672, 1.077059269601142, 2.6209955782661347, 3.134778239125027, 4.331078841492648, 2.2384504324982943, -0.7225922629082688, 2.814610211904095, -1.5057674648540065, 3.5735020122772663, -0.05585205078726374, 0.9232114707382921, 1.76180570281349, 2.4359335242925377, 1.5865570626606862, 2.2462698681430675, 1.612109230250199, 0.955862244919454, 1.384759676760347, 4.34797271575858, 2.9668965941733436, 5.694735890836272, 1.4597885708398213, -1.192573364467413, 4.294761392692782, 0.5288462291186784, -3.0854763315941303, 2.1701219209395712, 0.8735742487260998, -1.1959463249905768, 4.589861265952621, 0.02066366743088377, -0.7465757030750859, 4.009754242835434, 4.498441126029757, 2.6961333041743534, 3.46423858792111, 7.270096746123558, 2.379336877634965, 4.354631992899534, 3.257934293872193, 4.829354880915923, 2.5152329316888835, 0.5502939685854756, 1.5896104877204327, -0.30627553008832975, 2.7786202822121138, -1.477224473315539, 2.3644032699025526, 1.3734505356506994, 5.714737238678425, 2.7757471971515857, 5.392413416834906, 1.1412135989507233, 4.9382977726471875, -0.19625229421763102, -1.513044138467467, 2.336875591284919, 3.60043115709035, 2.365584648922674, 3.4113403006870233, 4.2184384294960395, 3.6925120141807737, 5.865504857452153, 1.526367142183049, -0.5747727804775231, -0.13550961112595594, 1.9429278053517378, 1.7177046219434606, -0.21741756283807323, -1.2918024188841195, 2.1021466727985407, 5.697331059241263, 3.9310139617229156, 3.7957947806429626, -0.019601029340724274, 5.618568804008557, -0.9797193788495822, 4.5123718949756935, 3.550149693537002, 2.650854489154898, 1.2995157616184225, 1.8595655515853473, 0.3524811848276741, 6.957988488826011, 3.3586362394268354, 3.601224405900723, 5.4991214150594185, 2.7229240511039543, 1.4706396116346436, 5.149828040410051, 5.3150078969941195, 4.724449462983678, -0.22004914672672116, 4.134373221311276)
lm.residuals
// res11: DenseVector[Double] = DenseVector(-0.9620444113446659, 1.2171535770090642, -1.589723041444476, -1.6189379268253266, -0.4813942715191475, 1.1515358739840993, -4.837446920991754, 2.464114567559633, 1.0496736741535093, 4.086104149061676, -2.4886826462312803, -0.5110788411297738, -0.158229405170923, 3.976153994625083, -0.40242404107004015, -2.0831467793413037, 1.1035524033890005, -1.8536657024041214, -8.211729830757626, -0.9348714301373046, 3.1596448839552203, 0.7990861502103168, 2.354375584415301, 1.1779035877336972, 0.8377743279858034, 5.409691197038983, 0.8852587384013733, -2.0367861372514993, 0.6235472910366453, 0.7357920834611544, -3.713536862189902, -2.199639203353581, -1.2583188482857097, 3.6138015654528095, -0.4208638295900906, 1.048978051326019, 1.4900966713730668, 1.540247852123094, 0.2868967780423315, 7.995362203972931, -2.5034611003561045, -0.10929107662086945, -5.8321344257025585, 4.0178608839749375, 1.1136219203379882, -1.0287257699656358, -4.317998380152597, -3.7962561185847257, 5.8102620819351385, 4.1886182443250535, 5.9971697947830735, -0.3912245650186308, -0.51744558599142, 3.1767862226432624, 4.243995782030813, -0.5091137171441336, 4.566008512687781, 5.185743972685952, 2.0660322766319448, -3.4965150300026973, -1.8718759601378165, 1.850921551355122, -2.6675487874708086, 0.1596790564504329, 1.478657844681889, -0.18999410012056295, 4.199109287050408, -2.837753540743459, -1.2879307978126153, -2.6855855089796172, -0.5802635104710336, -3.1214843459639843, -0.5934927590969774, 2.7400846194924213, -4.32565733124549, -0.16868172653958213, 2.105457798776489, 0.5642649833233513, 0.3454913236780319, -2.500467144856379, -2.226820575385091, -0.6382129418794991, -1.0720751545219525, -5.298044476350489, 0.4420312190851008, -5.0181036205695495, -0.6223065168602553, -4.4298687638692735, -2.6972458076869965, 4.2620905109668055, -1.9848280360483095, 0.9650881840901917, -0.8106802508309947, 2.0293910251694016, -0.09622417099542746, 3.6601577020601814, -2.314395049737068, 1.1479743862024208, -0.874446506955679, -4.144571107022262)
lm.studentised
// res12: DenseVector[Double] = DenseVector(-0.32915422743657746, 0.41865230316406027, -0.5424233332712666, -0.5699581899842985, -0.16807849088923596, 0.4042896279195036, -1.6637919090007667, 0.8505642107718525, 0.3592420971818725, 1.4067053191161485, -0.8565552457125806, -0.1761254579739894, -0.054700083959782694, 1.381190747417145, -0.13765330064253573, -0.7237771108112456, 0.3778169854141501, -0.6384249646607878, -2.806260288459621, -0.32115188636089603, 1.1247185084687155, 0.27230344733228146, 0.8324581175486137, 0.4029501611275473, 0.28859970382694483, 1.8516270241541057, 0.30663886770473386, -0.6961034207953912, 0.22359735662117308, 0.2555975288176304, -1.2881213629373776, -0.7820760514777156, -0.4286650330863324, 1.254911396569512, -0.14624527891175357, 0.3594648259171474, 0.5113850994621403, 0.5363025576739556, 0.09847107783002691, 2.7374408006025592, -0.8563703560899361, -0.03762487423375754, -2.0530261173624638, 1.3736097802054468, 0.38298196397523165, -0.3520698442719334, -1.4857767570553586, -1.299397820127274, 2.00172364527371, 1.4844458852437996, 2.065221771313491, -0.13475161446143305, -0.17927336761086404, 1.0834150535462979, 1.4492731902712435, -0.17842150387163472, 1.5673968267065839, 1.7894417263371964, 0.7200719613144909, -1.2079142322749956, -0.644749350567108, 0.6427339633384287, -0.9391089551808378, 0.05453610696821583, 0.5035232359675849, -0.06500401795857996, 1.4437279486228844, -0.9717719985134817, -0.4479135523745468, -0.9199016236561907, -0.20122880508453864, -1.0898116736408727, -0.20322225149513565, 0.9487631236900584, -1.4887793329655743, -0.05910469420966593, 0.7190978787636682, 0.19629878925944233, 0.11826734141040471, -0.8632227293501958, -0.7646679563811244, -0.2214294490292418, -0.3713716178425002, -1.8444297928721844, 0.1537136863571465, -1.7428617892069125, -0.21880986032304758, -1.5387809824393748, -0.9249302745937421, 1.5059918066774938, -0.6783122520112316, 0.34443352848316144, -0.28156957074367, 0.6973440333180985, -0.033868651521087506, 1.265886554848343, -0.8141549914169844, 0.3981789742615861, -0.302836199643333, -1.4203396652155649)
val pred = lm.predict()
// pred: PredictLm = PredictLm(
//   mod = Lm(
//     y = DenseVector(-0.020437796168111255, 2.2547212313289102, -0.07950761283305474, 5.15794342964441, 3.96604503978159, 2.8968227463949665, -3.7603876513906114, 5.085110145825768, 4.1844519132785365, 8.417182990554323, -0.250232213732986, -1.2336711040380426, 2.6563808067331722, 2.4703865297710763, 3.171077971207226, -2.1389988301285676, 2.0267638741272926, -0.09185999959063151, -5.775796306465088, 0.6516856325233816, 5.405914752098288, 2.4111953804605157, 3.3102378293347554, 2.562663264494044, 5.185747043744383, 8.376587791212327, 6.579994629237645, -0.5769975664116778, -0.5690260734307677, 5.030553476153936, -3.1846906330712237, -5.285115534947711, 0.9118030726538615, 4.487375814178909, -1.6168101545806675, 5.63883931727864, 1.5107603388039506, 0.7936721490480081, 4.296651020877765, 12.493803330002688, 0.1926722038182489, 3.3549475113002405, 1.4379623204209997, 6.3971977616099025, 5.468253913237522, 2.229208523906557, 0.5113565007633261, -1.2810231868958422, 6.360556050520614, 5.778228732045486, 5.690894264694744, 2.387395717193483, -1.994670059306959, 5.541189492545815, 5.617446317681513, 5.205623521534291, 7.341755709839367, 10.578157389520857, 3.207245875582668, 1.4417827426444902, -2.0681282543554476, 0.33787741288765494, -0.33067319618588953, 3.760110213540783, 3.844242493604563, 3.2213462005664604, 8.417547716546448, 0.8547584734373146, 4.577574059639538, -1.1592183667965685, -1.1550362909485568, -3.25699395708994, 1.3494350462547604, 4.457789241435882, -4.5430748940835635, -1.4604841454237016, 4.20760447157503, 6.261596042564614, 4.2765052854009475, 1.2953276357865837, -2.2464216047258154, 4.980355862129058, -2.0517945333715346, -0.7856725813747953, 3.9921809126221026, -2.367249131414651, 0.6772092447581672, -2.5703032122839264, -2.3447646228593224, 11.220078999792817, 1.373808203378526, 4.566312589990915, 4.688441164228424, 4.752315076273356, 1.3744154406392162, 8.809985742470232, 3.0006128472570515, 5.872423849186099, -1.0944956536824002, -0.010197885710985677),
//     Xmat = -0.32687240269383727  -0.7874516946337851   2.9124515885394113     
// -1.0168511651217436   2.305683880960866     0.2153600781186964     
// -0.4129776689839531   0.3149455245939933    3.519715339647567      
// 1.6762368292613437    4.46835025795333      -1.3398360750769003    
// 0.3467156729230313    1.8498129505167444    8.03733869808895       
// -1.5152924371766991   4.666347259975411     1.8014920955231102     
// -0.978156710139534    2.2936607038465056    0.0771087056216948     
// -0.7434983568386133   2.7245945402434693    5.593369102090633      
// 0.7471514703521959    -0.12058289336032435  2.3853481639013165     
// 0.10196857096234377   3.7543644463096197    3.296484863379259      
// 0.6211368833020375    -0.39469101862881306  -0.8454065943062243    
// -0.9623174434570365   -1.2156032618078858   1.057531610034488      
// -0.43343584935196444  3.797623254276204     -0.4031695578659207    
// -1.8474974266704691   -0.6924311455842207   4.094839748973692      
// 0.8690341609301964    0.5538339565948558    1.3978068545432671     
// -0.5017818388647097   -0.4497974679795502   -2.5663529647311165    
// -0.9441173396163084   0.7868378970994347    4.055476136792013      
// -0.7383789045868103   2.8691212976652345    -0.32838110768933726   
// -0.3226071640160079   2.3775938877104528    1.0207122293221946     
// 0.21515713775422146   -1.3978129086512001   3.105998122599878      
// -1.049801773856221    1.7505863984921106    10.070368612372851     
// ...
pred.fitted
// res13: DenseVector[Double] = DenseVector(0.9416066151765519, 1.0375676543198422, 1.5102154286114204, 6.776881356469737, 4.447439311300736, 1.7452868724108672, 1.0770592696011414, 2.6209955782661343, 3.134778239125027, 4.331078841492648, 2.238450432498294, -0.7225922629082694, 2.8146102119040943, -1.5057674648540074, 3.5735020122772667, -0.055852050787264185, 0.9232114707382919, 1.7618057028134895, 2.4359335242925373, 1.5865570626606864, 2.246269868143067, 1.6121092302501987, 0.9558622449194538, 1.3847596767603463, 4.34797271575858, 2.9668965941733436, 5.694735890836272, 1.4597885708398208, -1.1925733644674132, 4.294761392692781, 0.5288462291186775, -3.0854763315941316, 2.1701219209395712, 0.8735742487260993, -1.1959463249905782, 4.589861265952621, 0.020663667430883104, -0.7465757030750868, 4.009754242835434, 4.498441126029757, 2.6961333041743534, 3.46423858792111, 7.270096746123558, 2.379336877634965, 4.354631992899534, 3.2579342938721925, 4.829354880915923, 2.5152329316888835, 0.5502939685854755, 1.5896104877204327, -0.3062755300883301, 2.7786202822121133, -1.4772244733155402, 2.3644032699025526, 1.3734505356506992, 5.714737238678426, 2.7757471971515852, 5.3924134168349065, 1.1412135989507228, 4.9382977726471875, -0.19625229421763157, -1.5130441384674675, 2.3368755912849184, 3.60043115709035, 2.365584648922674, 3.4113403006870233, 4.2184384294960395, 3.692512014180774, 5.865504857452155, 1.526367142183049, -0.5747727804775233, -0.13550961112595727, 1.9429278053517378, 1.7177046219434602, -0.21741756283807356, -1.29180241888412, 2.1021466727985407, 5.697331059241263, 3.9310139617229156, 3.795794780642963, -0.019601029340724607, 5.618568804008557, -0.9797193788495826, 4.5123718949756935, 3.550149693537001, 2.6508544891548977, 1.2995157616184208, 1.8595655515853473, 0.3524811848276732, 6.957988488826011, 3.3586362394268354, 3.601224405900723, 5.499121415059419, 2.722924051103954, 1.4706396116346436, 5.149828040410051, 5.3150078969941195, 4.724449462983679, -0.2200491467267216, 4.134373221311275)
pred.se
// res14: DenseVector[Double] = DenseVector(0.41318462356030156, 0.510758331743952, 0.3519660625101323, 0.8032365611236932, 0.7143217277987964, 0.7749620448060711, 0.5097929296385111, 0.5661566366159678, 0.41926036651590814, 0.5252332600428028, 0.5212281491917327, 0.541267138918366, 0.5880436361417046, 0.6526349123236886, 0.4083178221374901, 0.6553918409158495, 0.4264912314156057, 0.5320202402844577, 0.38806479276890454, 0.4893434880222084, 0.9062640510201218, 0.3190688814382219, 0.8452884913168056, 0.41018712894792, 0.5353072675180551, 0.4215102553646242, 0.6154043432789483, 0.38984083878434533, 0.967711656392119, 0.6529586618995074, 0.6341781052532178, 0.8960072193346946, 0.31074338119516337, 0.6484770557301163, 0.6569984897409225, 0.4445828745150518, 0.47207745584093175, 0.6819847991046347, 0.4741184240403684, 0.42732295658193487, 0.40918758927135546, 0.5251095180455831, 0.8021752500334529, 0.39686192747837884, 0.5081772514359157, 0.4190864260774113, 0.5169291082578322, 0.42177097085088144, 0.5367393026289, 0.8669016725618051, 0.5298959684763438, 0.5330923030041846, 0.6183315318151669, 0.33995379083722194, 0.37154553199406526, 0.7558240673399285, 0.476553431523441, 0.5613656365353614, 0.6935589406329696, 0.5781205124273163, 0.5333101833358662, 0.6483143625787957, 0.8030239690863977, 0.3747654797975731, 0.2993212580398237, 0.4129832171401146, 0.5038529668032069, 0.4311257789747137, 0.6673977049129153, 0.4362268188103609, 0.6310264639434763, 0.7137681067620301, 0.4295801877239312, 0.6102931509644036, 0.5209431181011956, 0.7538750440378468, 0.3750440918163085, 0.6711753161947789, 0.4236797699243816, 0.5680478745067398, 0.48247730885817364, 0.6372097881695252, 0.6162300742851291, 0.6799560898408676, 0.6661961788327309, 0.6506685082466861, 0.7903910143124016, 0.6525029033307568, 0.4575485855001073, 0.8390140298488868, 0.388748930428212, 0.9286441551222707, 0.6510439573365864, 0.49421292932032085, 0.8009413344037488, 0.5943693809620441, 0.7952528495310299, 0.6334861030127574, 0.6128275972651623, 0.4455793990771661)
val predNew = lm.predict(DenseMatrix((1.1, 1.6, 1.0), (1.4, 2.2, 3.0)))
// predNew: PredictLm = PredictLm(
//   mod = Lm(
//     y = DenseVector(-0.020437796168111255, 2.2547212313289102, -0.07950761283305474, 5.15794342964441, 3.96604503978159, 2.8968227463949665, -3.7603876513906114, 5.085110145825768, 4.1844519132785365, 8.417182990554323, -0.250232213732986, -1.2336711040380426, 2.6563808067331722, 2.4703865297710763, 3.171077971207226, -2.1389988301285676, 2.0267638741272926, -0.09185999959063151, -5.775796306465088, 0.6516856325233816, 5.405914752098288, 2.4111953804605157, 3.3102378293347554, 2.562663264494044, 5.185747043744383, 8.376587791212327, 6.579994629237645, -0.5769975664116778, -0.5690260734307677, 5.030553476153936, -3.1846906330712237, -5.285115534947711, 0.9118030726538615, 4.487375814178909, -1.6168101545806675, 5.63883931727864, 1.5107603388039506, 0.7936721490480081, 4.296651020877765, 12.493803330002688, 0.1926722038182489, 3.3549475113002405, 1.4379623204209997, 6.3971977616099025, 5.468253913237522, 2.229208523906557, 0.5113565007633261, -1.2810231868958422, 6.360556050520614, 5.778228732045486, 5.690894264694744, 2.387395717193483, -1.994670059306959, 5.541189492545815, 5.617446317681513, 5.205623521534291, 7.341755709839367, 10.578157389520857, 3.207245875582668, 1.4417827426444902, -2.0681282543554476, 0.33787741288765494, -0.33067319618588953, 3.760110213540783, 3.844242493604563, 3.2213462005664604, 8.417547716546448, 0.8547584734373146, 4.577574059639538, -1.1592183667965685, -1.1550362909485568, -3.25699395708994, 1.3494350462547604, 4.457789241435882, -4.5430748940835635, -1.4604841454237016, 4.20760447157503, 6.261596042564614, 4.2765052854009475, 1.2953276357865837, -2.2464216047258154, 4.980355862129058, -2.0517945333715346, -0.7856725813747953, 3.9921809126221026, -2.367249131414651, 0.6772092447581672, -2.5703032122839264, -2.3447646228593224, 11.220078999792817, 1.373808203378526, 4.566312589990915, 4.688441164228424, 4.752315076273356, 1.3744154406392162, 8.809985742470232, 3.0006128472570515, 5.872423849186099, -1.0944956536824002, -0.010197885710985677),
//     Xmat = -0.32687240269383727  -0.7874516946337851   2.9124515885394113     
// -1.0168511651217436   2.305683880960866     0.2153600781186964     
// -0.4129776689839531   0.3149455245939933    3.519715339647567      
// 1.6762368292613437    4.46835025795333      -1.3398360750769003    
// 0.3467156729230313    1.8498129505167444    8.03733869808895       
// -1.5152924371766991   4.666347259975411     1.8014920955231102     
// -0.978156710139534    2.2936607038465056    0.0771087056216948     
// -0.7434983568386133   2.7245945402434693    5.593369102090633      
// 0.7471514703521959    -0.12058289336032435  2.3853481639013165     
// 0.10196857096234377   3.7543644463096197    3.296484863379259      
// 0.6211368833020375    -0.39469101862881306  -0.8454065943062243    
// -0.9623174434570365   -1.2156032618078858   1.057531610034488      
// -0.43343584935196444  3.797623254276204     -0.4031695578659207    
// -1.8474974266704691   -0.6924311455842207   4.094839748973692      
// 0.8690341609301964    0.5538339565948558    1.3978068545432671     
// -0.5017818388647097   -0.4497974679795502   -2.5663529647311165    
// -0.9441173396163084   0.7868378970994347    4.055476136792013      
// -0.7383789045868103   2.8691212976652345    -0.32838110768933726   
// -0.3226071640160079   2.3775938877104528    1.0207122293221946     
// 0.21515713775422146   -1.3978129086512001   3.105998122599878      
// -1.049801773856221    1.7505863984921106    10.070368612372851     
// ...
predNew.fitted
// res15: DenseVector[Double] = DenseVector(4.510135586452318, 5.70122929963934)
predNew.se
// res16: DenseVector[Double] = DenseVector(0.4524641652724013, 0.5479390063167322)
lm.plots
// res17: Figure = breeze.plot.Figure@77d7ac1e
lm.summary
// Estimate	 S.E.	 t-stat	p-value		Variable
// ---------------------------------------------------------
//   1.4982	 0.411	 3.644	0.0004 *	(Intercept)
//   1.7695	 0.290	 6.106	0.0000 *	V1
//   0.5656	 0.152	 3.728	0.0003 *	V2
//   0.1604	 0.104	 1.536	0.1277  	V3
// 
// Residual standard error:   2.9518 on 96 degrees of freedom
// Multiple R-squared: 0.3608, Adjusted R-squared: 0.3408
// F-statistic: 18.0616 on 3 and 96 DF, p-value: 0.00000
//
```
The plots include a plot of studentised residuals against fitted values and a normal Q-Q plot for the studentised residuals.

![Linear model plots](lm-plots.png)


## Generalised linear models

The current implementation supports only simple one-parameter exponential family observation models. This includes the most commonly used cases of **logistic regression** (`LogisticGlm`) and **Poisson regression** (`PoissonGlm`).

### Logistic regression

Again, we start by creating an appropriate response variable.
```scala
val ylb = (0 until 100) map (i => Bernoulli(sigmoid(1.0 + X(i,0))).sample())
val yl = DenseVector(ylb.toArray map {b => if (b) 1.0 else 0.0})
```

Then we can do logistic regression in a typical way.
```scala
import scalaglm.{Glm, LogisticGlm}
val glm = Glm(yl, X, List("V1","V2","V3"), LogisticGlm)
```
```scala
glm.coefficients
// res20: DenseVector[Double] = DenseVector(1.3367574640814852, 1.265516714458115, -0.18159029408692734, -0.041497466560768706)
glm.fitted
// res21: DenseVector[Double] = DenseVector(0.7201547197144333, 0.40667899958141857, 0.6481408319545376, 0.9371595136863423, 0.7514003208657044, 0.18197982487005923, 0.42047530172780667, 0.4179918041588756, 0.9007155835412947, 0.656390146487663, 0.9028737332160012, 0.5734119317950509, 0.528807098253365, 0.2600962973168766, 0.9070350376097551, 0.708873696285979, 0.45779742086154834, 0.4737613813433917, 0.6116819555514414, 0.8499208775734866, 0.32572852750356407, 0.7108924756000841, 0.9272620962831992, 0.44765164069905483, 0.8547009509451723, 0.577694238293768, 0.9585202268672708, 0.5838223273983995, 0.8002207615035665, 0.6828788800559952, 0.46090646811698655, 0.06987987418286654, 0.6528867678656866, 0.23247667975702588, 0.3004210302731477, 0.8680462428441196, 0.3856448887786035, 0.37539295257681576, 0.9306133271301603, 0.8214139491561444, 0.8056925620791939, 0.9294025629070445, 0.9743532743495124, 0.8349509528866774, 0.6841975972107436, 0.8211164230838278, 0.9407117729871108, 0.8430775276205993, 0.7923458472063956, 0.9661026767040837, 0.6750246027045066, 0.757226902379646, 0.2943715954649994, 0.8247382365614062, 0.7679492758271462, 0.9836876974548662, 0.8696335857888172, 0.9361584672943768, 0.6408295823185698, 0.8935733306456786, 0.5483746633800108, 0.5084554611153776, 0.6288043427580576, 0.7248669621322816, 0.7351170122838798, 0.8691811774513961, 0.6684092383363629, 0.9177721867816073, 0.9426957069148649, 0.8419602183427842, 0.3593010938948176, 0.15917505144155275, 0.7583539531568774, 0.43181961284870257, 0.6567586755172153, 0.7452956199719217, 0.6617687680566047, 0.8525189737985588, 0.8444019499598671, 0.9230586515058454, 0.6664931679582008, 0.8201788259188053, 0.20620702921795497, 0.7641677030276968, 0.4622950707446569, 0.608867842863535, 0.14637446181777167, 0.5338032889355819, 0.3769708555827748, 0.8779957688235418, 0.8558326811843596, 0.9807183812921337, 0.8325914060690861, 0.8909214714918811, 0.9544520126893006, 0.8439826784974409, 0.9854364793507835, 0.7418434195990891, 0.40734402132790987, 0.7478888582570413)
glm.predict(response=true).fitted
// res22: DenseVector[Double] = DenseVector(0.7201547197144333, 0.40667899958141857, 0.6481408319545376, 0.9371595136863423, 0.7514003208657044, 0.18197982487005923, 0.42047530172780667, 0.4179918041588756, 0.9007155835412947, 0.656390146487663, 0.9028737332160012, 0.5734119317950509, 0.528807098253365, 0.2600962973168766, 0.9070350376097551, 0.708873696285979, 0.45779742086154834, 0.4737613813433917, 0.6116819555514414, 0.8499208775734866, 0.32572852750356407, 0.7108924756000841, 0.9272620962831992, 0.44765164069905483, 0.8547009509451723, 0.577694238293768, 0.9585202268672708, 0.5838223273983995, 0.8002207615035665, 0.6828788800559952, 0.46090646811698655, 0.06987987418286654, 0.6528867678656866, 0.23247667975702588, 0.3004210302731477, 0.8680462428441196, 0.3856448887786035, 0.37539295257681576, 0.9306133271301603, 0.8214139491561444, 0.8056925620791939, 0.9294025629070445, 0.9743532743495124, 0.8349509528866774, 0.6841975972107436, 0.8211164230838278, 0.9407117729871108, 0.8430775276205993, 0.7923458472063956, 0.9661026767040837, 0.6750246027045066, 0.757226902379646, 0.2943715954649994, 0.8247382365614062, 0.7679492758271462, 0.9836876974548662, 0.8696335857888172, 0.9361584672943768, 0.6408295823185698, 0.8935733306456786, 0.5483746633800108, 0.5084554611153776, 0.6288043427580576, 0.7248669621322816, 0.7351170122838798, 0.8691811774513961, 0.6684092383363629, 0.9177721867816073, 0.9426957069148649, 0.8419602183427842, 0.3593010938948176, 0.15917505144155275, 0.7583539531568774, 0.43181961284870257, 0.6567586755172153, 0.7452956199719217, 0.6617687680566047, 0.8525189737985588, 0.8444019499598671, 0.9230586515058454, 0.6664931679582008, 0.8201788259188053, 0.20620702921795497, 0.7641677030276968, 0.4622950707446569, 0.608867842863535, 0.14637446181777167, 0.5338032889355819, 0.3769708555827748, 0.8779957688235418, 0.8558326811843596, 0.9807183812921337, 0.8325914060690861, 0.8909214714918811, 0.9544520126893006, 0.8439826784974409, 0.9854364793507835, 0.7418434195990891, 0.40734402132790987, 0.7478888582570413)
glm.summary
// Estimate	 S.E.	 z-stat	p-value		Variable
// ---------------------------------------------------------
//   1.3368	 0.390	 3.428	0.0006 *	(Intercept)
//   1.2655	 0.305	 4.143	0.0000 *	V1
//  -0.1816	 0.134	-1.357	0.1747  	V2
//  -0.0415	 0.085	-0.486	0.6269  	V3
glm.plots
// res24: Figure = breeze.plot.Figure@16d76c51
```

![Logistic regression plots](glm-plots.png)


### Poisson regression

We first create an appropriate response, and then do Poisson regression.
```scala
val yp = DenseVector.tabulate(100)(i => Poisson(math.exp(-0.5 + X(i,0))).sample().toDouble)

import scalaglm.PoissonGlm
val pglm = Glm(yp, X, List("V1","V2","V3"), PoissonGlm)
```
```scala
pglm.coefficients
// res26: DenseVector[Double] = DenseVector(-0.6406556399264011, 1.163134726392117, 0.08190267063563693, -0.01942557501671975)
pglm.summary
// Estimate	 S.E.	 z-stat	p-value		Variable
// ---------------------------------------------------------
//  -0.6407	 0.185	-3.458	0.0005 *	(Intercept)
//   1.1631	 0.111	10.454	0.0000 *	V1
//   0.0819	 0.054	 1.513	0.1304  	V2
//  -0.0194	 0.034	-0.575	0.5653  	V3
pglm.plots
// res28: Figure = breeze.plot.Figure@32dfd06a
```
![Poisson regression plots](pglm-plots.png)


## Non-linear response

The above covers the main functionality of the library based on a linear reponse to variation in covariate values. For flexible modelling of a nonlinear response, see the documentation on [flexible regression modelling](FlexibleRegression.md).


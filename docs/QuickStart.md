# scala-glm - Quickstart Guide

## PCA

This library contains code for principal components analysis based on a thin SVD of the centred data matrix. This is more numerically stable than a construction from the spectral decomposition of the covariance matrix. It is analogous to the R function `prcomp` rather than the R function `princomp`. First create some synthetic data.

```scala
import breeze.linalg.*
import breeze.numerics.*
import breeze.stats.distributions.*
import breeze.stats.distributions.Rand.VariableSeed.randBasis

val X = DenseMatrix.tabulate(100, 3)((i, j) => 
	Gaussian(j, j+1).sample())
```
Now we can do PCA.
```scala
import scalaglm.Pca
val pca = Pca(X, List("V1", "V2", "V3"))
```
```scala
pca.sdev
// res0: DenseVector[Double] = DenseVector(2.9101473818099675, 1.9177707449071648, 0.8429459799308858)
pca.loadings
// res1: DenseMatrix[Double] = 0.002850250200939321  -0.02272892603678084  -0.9997376015710356    
// 0.29247097770060776   -0.9560080473968622   0.022568573621072768   
// 0.9562701518277366    0.29245855985704      -0.003922689090869581  
pca.scores
// res2: DenseMatrix[Double] = 3.3559267454810975     -3.656994283856937    -0.03189615005780339   
// 0.3954764247902342     -3.0550042091071505   0.8986245095470339     
// -2.9688884555802177    2.542997742318442     0.9126647519443516     
// 4.561063247182242      0.35927587273340345   0.13396452644218543    
// 2.610665756156317      -1.8065929623969972   1.4350554644627889     
// 1.9044519781440663     0.46757870083878283   0.5256772698327706     
// -3.8137282834677113    -0.2699605991210089   -0.24460453662025702   
// -3.5001018729192372    2.8955528039843585    0.15844141247752597    
// 1.8823687497345896     -0.5399896922345815   0.35818067377401575    
// 1.9915959649404535     4.043626039157802     0.02174827547147431    
// 0.5072432706557446     4.062291686146735     -0.025441066984733827  
// -1.9004910947186948    -1.8583553097655308   0.049214044961382375   
// -0.001598346275389878  -0.6690664596221493   0.17569209575817574    
// 1.0108332392447332     0.7430897790090337    0.39651896242833906    
// 3.6622447053336598     2.7054595169869025    0.5152164379415526     
// -3.3903990091050114    0.36413643753640446   -0.1254547302224777    
// -2.3476062739471435    0.1096015508265622    -0.27391311666784224   
// -3.241656461718457     -3.7354348817722256   -0.6607863844347149    
// 3.5526530311518068     1.603666860208402     -0.5849128238780338    
// -5.160180170301033     -0.45060101690690524  1.3586481577546976     
// -1.0328617876028394    0.25064066048589956   -0.279733416736379     
// -2.8104457118170774    1.3764613888872708    -0.2451950278112546    
// -2.531266534332719     -2.2214086851836257   -0.8187376321816944    
// -4.545145080085915     -1.3750132907197241   -0.7053094699415969    
// 3.5031822878931895     -0.5200047195609645   -0.49151468059543685   
// 1.8144832328296303     -1.341905128897712    0.46863545430836046    
// -5.221836805054076     2.8210687762704314    0.8729016107672376     
// 2.941109949313408      2.041291958652413     1.6914499347786038     
// 1.5162338825446868     -0.9865681258214707   0.16780757849318292    
// -4.108801000243165     -2.5067187856122324   -0.5396969976488851    
// 3.7889459439817084     -2.2174492972855875   -0.16549202667870083   
// 8.407486784759334      -0.19433179011647495  0.3164799073147545     
// -4.323075616101262     -0.6574925466294921   -1.0444915598103668    
// 6.161048030154031      -0.46956167237216584  0.32492294296272745    
// 4.367851890120217      0.6851170842678609    0.015041642445578991   
// 2.5226218531609668     1.06958441011375      0.7085117605240551     
// -3.10507165541258      3.5564176189551286    -0.8128191867272402    
// -2.7450486420594977    -0.7503008137712784   -0.04889701473378674   
// 1.354161972523603      -1.1490287292761403   0.5535220278354528     
// -1.9654989029699546    0.022730368823409952  -1.4409685332833122    
// 5.354191470482134      1.3468935302589664    -0.6308224450961645    
// -1.1278559234811847    -1.5540031104006142   0.2181920726519296     
// -0.8088698832693954    -1.0002248352485201   -1.1275790688848055    
// -0.7001128734041128    -1.588876262957946    -0.7863404727753551    
// 0.36593236717407646    -1.3011850915873795   1.3396492002648863     
// 0.46724269322143347    -0.09592514425056473  -0.706328500465847     
// 0.5202672768983316     -0.18733675561694918  1.1695480974992978     
// -1.5847529494182317    -0.42080146985272504  0.5984037448014548     
// -1.2811964883849298    1.1353407141931418    0.25651259175190066    
// ...
pca.plots
// res3: Figure = breeze.plot.Figure@395cc7d6
pca.summary
// Standard deviations:
// V1	V2	V3
//  2.910	 1.918	 0.843
// Cumulative proportion of variance explained:
// V1	V2	V3
//  0.659	 0.945	 1.000
// Loadings:
// PC01	PC02	PC03	
//  0.003	-0.023	-1.000	V1
//  0.292	-0.956	 0.023	V2
//  0.956	 0.292	-0.004	V3
```
The final line prints a readable summary of the PCA to the console. `plots` produces some diagnostic plots, including a "scree plot".

![PCA Plots](pca-plots.png)

Note that there is also a utility function `pairs` for producing a "scatterplot matrix":
```scala
import scalaglm.Utils.pairs
pairs(X, List("V1", "V2", "V3"))
// res6: Figure = breeze.plot.Figure@1319035c
```

![Pairs plots](pairs-plots.png)


## Linear regression

This code computes regression coefficients and associated diagnostics via the QR decomposition of the covariate matrix. The diagnostics are analogous to those produced by the R function `lm`. We start by creating a synthetic response variable.

```scala
val y = DenseVector.tabulate(100)(i => 
	Gaussian(2.0 + 1.5*X(i,0) + 0.5*X(i,1), 3.0).sample())
```
So we can now do linear regression and generate all of the usual diagnostics.
```scala
import scalaglm.Lm
val lm = Lm(y,X,List("V1", "V2", "V3"))
```
```scala
lm.coefficients
// res8: DenseVector[Double] = DenseVector(2.0039715075384885, 1.4758601381231446, 0.6072168752005557, -0.03661349631099061)
lm.se
// res9: DenseVector[Double] = DenseVector(0.3384518082468553, 0.3275456985220257, 0.14063097814057443, 0.10005093666475376)
lm.fitted
// res10: DenseVector[Double] = DenseVector(5.187885604913924, 3.0171586249004703, -0.9945997767819241, 2.6131660632574305, 1.7783061903947706, 1.583008597687525, 2.330297334680598, -0.19044459229654415, 2.4540695782566053, 0.09819545232856919, -0.06237731161656333, 3.174044467660843, 2.524898283617058, 1.4684901493472216, 0.45818899202861074, 1.8221279358121099, 2.3512098057599458, 5.187651062106795, 2.7384315201737532, -0.09784320956084117, 2.464589794466482, 1.4498163015373147, 4.5768946848940235, 3.5867017100412237, 3.921435150623388, 2.7836635139489205, -1.440912387521349, -0.9519338853708986, 2.9575826221036987, 4.115728971711708, 4.547348896891687, 3.2568740225230606, 3.666779819274667, 3.0867361205646717, 2.555054207094402, 1.0304054971783103, 0.8742800707771318, 2.501210931700624, 2.4715208988475066, 4.167369399884037, 3.23039838764668, 2.85032897012045, 4.5181884087836055, 4.403153655742762, 1.2724985761023724, 3.524827870522712, 0.8478926789864462, 1.5195597237138179, 1.0916242376328953, 6.677028887371653, 3.8080842679119336, 3.5906271672013523, 0.698388147823191, 2.8351674538703615, 4.6578784409548755, 1.0656476531899584, 3.3071075158715435, 5.452119006389225, 1.5002321741642564, 1.6249306606647764, 2.2414505155073363, 2.0638963773013583, -2.047776457274976, 5.1120181591613205, 2.9698202681089234, 3.873391708603902, 1.6370259972640029, -1.7036310155803556, 4.2901958660832955, 3.5615913544865, 4.97525877643778, 1.0330388306308298, 2.605405091012378, 1.2779804128769474, 3.8020602275284734, 2.3597810009926334, 0.40776248217684663, 2.21557944890007, 0.42855667580956414, 2.728308818152488, 0.6019764452079963, 2.111274516427469, 2.2293925597932716, 2.6148640153329303, 4.708660430745667, -2.2458939727490597, 3.9402702237748293, 1.5734959775509305, 0.9023676293991848, 4.243142461797263, 3.751362057703116, 1.3454039589887767, 1.5783602200629463, 6.27816488495797, -0.2651160444252765, 2.584856534666733, 2.3653898978399877, 2.622634762762612, 1.1844402122198223, 2.897047395668304)
lm.residuals
// res11: DenseVector[Double] = DenseVector(-2.0366730207185357, -7.13421737285594, -0.4281808765281925, -0.6644911790379275, 1.0408870043485348, 0.9539874405984798, 0.8216881249014807, -1.6525344767825738, -1.6967152033548043, 2.4399586984486383, -1.0282818870312065, 0.31199733606476165, -2.4793903892831213, 0.2959616090775399, -2.9424790321329484, 3.4199496012656416, 1.1408429303093417, 1.3745873677203875, 7.469338215683175, -1.6830887668896635, 4.09129895965986, 0.46428067307014564, 0.5083574224347842, 1.9755480846626128, 0.6286808826019659, -1.14776014156037, -0.508358800491588, 2.327443617289762, 2.465327135051125, 5.446574781290368, 1.2733359651705447, -3.657601087230887, -4.740863959923958, 6.350790132776639, 3.5803087018584985, 1.7116182264624917, 1.9034968301736632, 0.44048529632507094, -1.822115191382349, 0.11861357789687776, -1.3683330773387272, -1.1075575559594961, -1.9681107229842674, 2.0765549057224186, 0.9938315704168617, 5.018182353096163, -4.539015098217268, -0.523008964568957, -1.2786610504146578, -3.975572197853024, 2.57726201937196, -4.52091346640978, -2.5683371442465988, -2.4419073830537283, -0.6919114998768867, 3.5812096749824542, -1.2532308781546715, 0.7638467225374672, 2.4285354983323972, 2.4108290879147427, 0.9316337821966711, 0.6950184824068848, -2.400357356592223, -3.0770256230853033, -0.8742911827763447, 3.9569600302542747, -2.5949243726207176, 1.1680719140984286, 0.5520560918775219, -2.6424897081233376, 0.04342972724514382, -2.9392305766972244, 4.582122285462431, 1.1827876681460225, 3.2621489063164404, 2.5672731254201553, 2.982235880654059, 2.684925452570819, -2.81264739090523, -3.680198253864173, 3.39820558510739, -0.48998656405015795, -2.8550782667626358, -2.69673388792443, 4.637524945364676, -0.38151746880680015, 0.019995477398967676, -0.05461453014690676, -1.0135793481721005, -3.0946014678899627, -2.2493107038155045, -0.260665313538478, -3.8576481273097265, -0.026935421583313968, 0.9370084038903311, -5.480751732916145, 0.7480506774207174, -3.4494127650990234, 0.6358365749383055, -0.5995849713241626)
lm.studentised
// res12: DenseVector[Double] = DenseVector(-0.7645693541365625, -2.660030323693099, -0.15988595130048422, -0.2462289679391263, 0.3899607682386058, 0.35050530433927213, 0.3033761588154139, -0.6163814908501986, -0.62275588576719, 0.9157038792762946, -0.3850895015687943, 0.11492278487701972, -0.9076369280211185, 0.10852488559288655, -1.098603871068267, 1.2600265514574565, 0.4189058335046891, 0.5179225261052985, 2.770021542083304, -0.6346694486377272, 1.4983866017620486, 0.17116052428088532, 0.18889305799794967, 0.7364407925881209, 0.232165517242202, -0.4223758541479658, -0.19238346003346599, 0.8794778885046091, 0.9043882354826714, 2.035312913920056, 0.4732123376138095, -1.3998811552518062, -1.7692237910511524, 2.380553915881641, 1.325748366251778, 0.6317756724379157, 0.7166564915048225, 0.16198051751655837, -0.6699135790931473, 0.044152240720787335, -0.5122190711350648, -0.406922779599654, -0.7278489468963635, 0.7658632786655929, 0.369205874059843, 1.8423484561140955, -1.6771191569790909, -0.19213149627063275, -0.4692152843577507, -1.5042847983545833, 0.9481745114845798, -1.7090691164466485, -0.943821621036751, -0.9034599899016854, -0.2626159909449973, 1.314419548495313, -0.4624544402906581, 0.2848147488910436, 0.8900264774468565, 0.8947740318321745, 0.3413861770726109, 0.2543158671771161, -0.9072329949023481, -1.1614172300346024, -0.3300209599549123, 1.4785453209280126, -0.9650590863674258, 0.43997828725171223, 0.21093211460011788, -0.976684806434376, 0.016458650804037748, -1.0786929309215785, 1.713058339910338, 0.43906157367597703, 1.2118851358724418, 0.9563581066112421, 1.105653370641825, 0.9827645320241487, -1.0517644344761765, -1.3476468131140114, 1.2600448140035372, -0.180735152047513, -1.0527502654890994, -0.9962303688062872, 1.7143262135491941, -0.1451726239320035, 0.007365131604294216, -0.020003885083740305, -0.38056104604721835, -1.167899542299235, -0.8322803520316129, -0.09550337666246836, -1.4390068653639905, -0.010135307730273949, 0.35270866154186703, -2.024712430957598, 0.2740752302575226, -1.276057994732172, 0.23378547746270853, -0.2220031456924903)
val pred = lm.predict()
// pred: PredictLm = PredictLm(
//   mod = Lm(
//     y = DenseVector(3.151212584195388, -4.11705874795547, -1.4227806533101166, 1.948674884219503, 2.8191931947433053, 2.536996038286005, 3.151985459582079, -1.842979069079118, 0.757354374901801, 2.5381541507772076, -1.0906591986477698, 3.4860418037256045, 0.04550789433393687, 1.7644517584247614, -2.4842900401043377, 5.242077537077751, 3.4920527360692875, 6.5622384298271825, 10.207769735856928, -1.7809319764505047, 6.555888754126342, 1.9140969746074603, 5.085252107328808, 5.5622497947038365, 4.550116033225354, 1.6359033723885505, -1.949271188012937, 1.3755097319188634, 5.422909757154824, 9.562303753002077, 5.820684862062231, -0.4007270647078265, -1.074084140649291, 9.43752625334131, 6.1353629089529, 2.742023723640802, 2.777776900950795, 2.941696228025695, 0.6494057074651576, 4.285982977780915, 1.862065310307953, 1.7427714141609538, 2.550077685799338, 6.479708561465181, 2.266330146519234, 8.543010223618875, -3.6911224192308216, 0.9965507591448609, -0.18703681278176254, 2.7014566895186287, 6.385346287283894, -0.930286299208428, -1.8699489964234077, 0.39326007081663317, 3.9659669410779887, 4.646857328172413, 2.053876637716872, 6.215965728926692, 3.9287676724966536, 4.035759748579519, 3.1730842977040075, 2.758914859708243, -4.448133813867199, 2.0349925360760173, 2.0955290853325788, 7.830351738858177, -0.9578983753567147, -0.535559101481927, 4.842251957960817, 0.9191016463631625, 5.018688503682924, -1.9061917460663944, 7.187527376474808, 2.46076808102297, 7.064209133844914, 4.927054126412789, 3.3899983628309056, 4.900504901470889, -2.384090715095666, -0.9518894357116849, 4.000182030315386, 1.6212879523773112, -0.6256857069693644, -0.08186987259149969, 9.346185376110343, -2.62741144155586, 3.960265701173797, 1.5188814474040238, -0.11121171877291558, 1.1485409939073006, 1.5020513538876115, 1.0847386454502987, -2.27928790724678, 6.251229463374656, 0.6718923594650547, -2.895895198249412, 3.113440575260705, -0.8267780023364115, 1.8202767871581278, 2.2974624243441415),
//     Xmat = 0.0337381325054693     5.398242555330048      3.927039426254548     
// -0.9186589719454528    3.9778899237018996     1.2684561556783172    
// -1.0695213841892393    -2.3575072088636366    -0.3116570459922987   
// -0.219929589190318     1.914866654913483      6.253417457836356     
// -1.4770103712745053    3.444383796421477      3.7497798973782746    
// -0.6215731615454072    1.0431869823503763     3.7431169180768347    
// 0.14897175593008619    0.05849455494356237    -1.9376862943381692   
// -0.32502324081178763   -2.866938937467063     -0.7135742519730841   
// -0.4312825115733639    1.9961916117681004     3.4279844217672673    
// -0.19880773065134386   -2.3614289225447025    4.874272522875625     
// -0.15628579727945002   -2.814468511175324     3.4604743839021173    
// -0.10321401754021586   2.143210098218587      -0.573806865874976    
// -0.2512778195686459    1.564465834688819      1.5893691612803647    
// -0.5012578529860826    0.5155237094457283     2.969658211983241     
// -0.6569695530355226    -0.5823778155407993    6.078570071401636     
// 0.016647463957304605   -0.42120674699165517   -1.3478894263655166   
// 0.17382441997202944    0.12376676981275758    -0.42455640949881923  
// 0.6454414547591522     3.5294376315548095     -2.402506152429183    
// 0.467601236706533      0.4140640985683308     5.6558575958840835    
// -1.4535922095225242    -0.12642672527077514   -3.2843769428807814   
// 0.18018487604761838    0.3733254954577512     0.8739654261944017    
// 0.11500029493779922    -1.2220804069067683    -0.49676459737647605  
// ...
pred.fitted
// res13: DenseVector[Double] = DenseVector(5.187885604913917, 3.0171586249004694, -0.9945997767819268, 2.613166063257429, 1.7783061903947701, 1.5830085976875243, 2.3302973346805977, -0.19044459229654534, 2.4540695782566044, 0.09819545232856833, -0.062377311616564485, 3.1740444676608415, 2.5248982836170564, 1.4684901493472207, 0.4581889920286101, 1.8221279358121094, 2.351209805759945, 5.187651062106793, 2.7384315201737524, -0.09784320956084237, 2.464589794466481, 1.4498163015373142, 4.576894684894022, 3.5867017100412233, 3.9214351506233873, 2.7836635139489196, -1.4409123875213508, -0.9519338853708996, 2.957582622103698, 4.1157289717117065, 4.547348896891686, 3.2568740225230592, 3.666779819274666, 3.0867361205646713, 2.5550542070944013, 1.0304054971783094, 0.8742800707771309, 2.5012109317006237, 2.4715208988475053, 4.167369399884036, 3.2303983876466793, 2.850328970120449, 4.518188408783605, 4.403153655742761, 1.2724985761023708, 3.5248278705227114, 0.847892678986445, 1.5195597237138172, 1.0916242376328942, 6.6770288873716535, 3.8080842679119327, 3.590627167201351, 0.6983881478231899, 2.8351674538703606, 4.657878440954873, 1.0656476531899575, 3.3071075158715426, 5.452119006389225, 1.5002321741642552, 1.6249306606647758, 2.2414505155073354, 2.0638963773013574, -2.0477764572749773, 5.11201815916132, 2.9698202681089225, 3.8733917086039007, 1.6370259972640016, -1.703631015580357, 4.290195866083295, 3.561591354486499, 4.975258776437779, 1.0330388306308287, 2.605405091012377, 1.2779804128769467, 3.8020602275284725, 2.359781000992633, 0.40776248217684563, 2.2155794489000695, 0.42855667580956336, 2.728308818152487, 0.6019764452079956, 2.111274516427468, 2.229392559793271, 2.614864015332929, 4.708660430745665, -2.2458939727490606, 3.9402702237748284, 1.5734959775509296, 0.9023676293991847, 4.243142461797262, 3.7513620577031146, 1.345403958988776, 1.5783602200629454, 6.278164884957969, -0.2651160444252775, 2.5848565346667316, 2.3653898978399868, 2.6226347627626114, 1.1844402122198212, 2.8970473956683036)
pred.se
// res14: DenseVector[Double] = DenseVector(0.6740568947421409, 0.5975940002445776, 0.6151259500781083, 0.5171511460609476, 0.6523766964766479, 0.3773031280971813, 0.46304796834821843, 0.601977879838057, 0.3566900066903632, 0.6710680087798598, 0.6481407273050095, 0.42414806199455857, 0.2968139532086908, 0.3361993152967793, 0.6136396243902842, 0.42831719528431733, 0.36528784918658724, 0.7115784498902783, 0.5284043132866768, 0.7194632202464818, 0.3079140977447916, 0.4386034905294056, 0.554506486131282, 0.5950933250238796, 0.4664283104396633, 0.40750915363937307, 0.7535693849970024, 0.7395147770205384, 0.34555912712689113, 0.6237750806226829, 0.5564943730463292, 0.8506364922623245, 0.6081624809293614, 0.6582049563932613, 0.5070152573439679, 0.4587058244276001, 0.7039282939301411, 0.39406909467015494, 0.390229265649038, 0.5772045621574273, 0.6434208036954379, 0.3770209441433276, 0.4884727887279903, 0.4456826755329438, 0.5517617806774723, 0.3622255427930812, 0.4748483373701283, 0.3744662688338222, 0.3522444300157829, 0.7521391333651286, 0.40254410407832947, 0.7435942286807988, 0.38116831840667564, 0.4949074331502627, 0.7801846372972594, 0.35646811207385926, 0.45433139901178443, 0.5980374353566, 0.3239757012863015, 0.5392449248240403, 0.32090396091486517, 0.28558986246840484, 0.741630340207661, 0.7287701900801559, 0.729396895966577, 0.6228560058539032, 0.565879781410041, 0.7085901673225076, 0.8369145152279909, 0.4797526598091598, 0.7664500969081741, 0.35454067544506346, 0.6289787223067467, 0.5414623519055973, 0.5518181426491032, 0.586624971817445, 0.5244589963768778, 0.29390483095282577, 0.6315322549383351, 0.3046746130197005, 0.5263506733027887, 0.4476013143407926, 0.44184865520253863, 0.4719760148746, 0.4820683095387007, 0.8023421268353034, 0.4238870329323173, 0.3103286921078087, 0.6757755176309491, 0.7275183486683887, 0.4962804330822268, 0.31739910545176736, 0.6031093129784307, 0.6982317025821714, 0.7019349074550376, 0.4720309049198991, 0.31757653169515276, 0.4930516916080971, 0.3914961757377179, 0.5059463069579481)
val predNew = lm.predict(DenseMatrix((1.1, 1.6, 1.0), (1.4, 2.2, 3.0)))
// predNew: PredictLm = PredictLm(
//   mod = Lm(
//     y = DenseVector(3.151212584195388, -4.11705874795547, -1.4227806533101166, 1.948674884219503, 2.8191931947433053, 2.536996038286005, 3.151985459582079, -1.842979069079118, 0.757354374901801, 2.5381541507772076, -1.0906591986477698, 3.4860418037256045, 0.04550789433393687, 1.7644517584247614, -2.4842900401043377, 5.242077537077751, 3.4920527360692875, 6.5622384298271825, 10.207769735856928, -1.7809319764505047, 6.555888754126342, 1.9140969746074603, 5.085252107328808, 5.5622497947038365, 4.550116033225354, 1.6359033723885505, -1.949271188012937, 1.3755097319188634, 5.422909757154824, 9.562303753002077, 5.820684862062231, -0.4007270647078265, -1.074084140649291, 9.43752625334131, 6.1353629089529, 2.742023723640802, 2.777776900950795, 2.941696228025695, 0.6494057074651576, 4.285982977780915, 1.862065310307953, 1.7427714141609538, 2.550077685799338, 6.479708561465181, 2.266330146519234, 8.543010223618875, -3.6911224192308216, 0.9965507591448609, -0.18703681278176254, 2.7014566895186287, 6.385346287283894, -0.930286299208428, -1.8699489964234077, 0.39326007081663317, 3.9659669410779887, 4.646857328172413, 2.053876637716872, 6.215965728926692, 3.9287676724966536, 4.035759748579519, 3.1730842977040075, 2.758914859708243, -4.448133813867199, 2.0349925360760173, 2.0955290853325788, 7.830351738858177, -0.9578983753567147, -0.535559101481927, 4.842251957960817, 0.9191016463631625, 5.018688503682924, -1.9061917460663944, 7.187527376474808, 2.46076808102297, 7.064209133844914, 4.927054126412789, 3.3899983628309056, 4.900504901470889, -2.384090715095666, -0.9518894357116849, 4.000182030315386, 1.6212879523773112, -0.6256857069693644, -0.08186987259149969, 9.346185376110343, -2.62741144155586, 3.960265701173797, 1.5188814474040238, -0.11121171877291558, 1.1485409939073006, 1.5020513538876115, 1.0847386454502987, -2.27928790724678, 6.251229463374656, 0.6718923594650547, -2.895895198249412, 3.113440575260705, -0.8267780023364115, 1.8202767871581278, 2.2974624243441415),
//     Xmat = 0.0337381325054693     5.398242555330048      3.927039426254548     
// -0.9186589719454528    3.9778899237018996     1.2684561556783172    
// -1.0695213841892393    -2.3575072088636366    -0.3116570459922987   
// -0.219929589190318     1.914866654913483      6.253417457836356     
// -1.4770103712745053    3.444383796421477      3.7497798973782746    
// -0.6215731615454072    1.0431869823503763     3.7431169180768347    
// 0.14897175593008619    0.05849455494356237    -1.9376862943381692   
// -0.32502324081178763   -2.866938937467063     -0.7135742519730841   
// -0.4312825115733639    1.9961916117681004     3.4279844217672673    
// -0.19880773065134386   -2.3614289225447025    4.874272522875625     
// -0.15628579727945002   -2.814468511175324     3.4604743839021173    
// -0.10321401754021586   2.143210098218587      -0.573806865874976    
// -0.2512778195686459    1.564465834688819      1.5893691612803647    
// -0.5012578529860826    0.5155237094457283     2.969658211983241     
// -0.6569695530355226    -0.5823778155407993    6.078570071401636     
// 0.016647463957304605   -0.42120674699165517   -1.3478894263655166   
// 0.17382441997202944    0.12376676981275758    -0.42455640949881923  
// 0.6454414547591522     3.5294376315548095     -2.402506152429183    
// 0.467601236706533      0.4140640985683308     5.6558575958840835    
// -1.4535922095225242    -0.12642672527077514   -3.2843769428807814   
// 0.18018487604761838    0.3733254954577512     0.8739654261944017    
// 0.11500029493779922    -1.2220804069067683    -0.49676459737647605  
// ...
predNew.fitted
// res15: DenseVector[Double] = DenseVector(4.5623511634838465, 5.296212337419142)
predNew.se
// res16: DenseVector[Double] = DenseVector(0.4926667298325718, 0.586890020392635)
lm.plots
// res17: Figure = breeze.plot.Figure@47cbe861
lm.summary
// Estimate	 S.E.	 t-stat	p-value		Variable
// ---------------------------------------------------------
//   2.0040	 0.338	 5.921	0.0000 *	(Intercept)
//   1.4759	 0.328	 4.506	0.0000 *	V1
//   0.6072	 0.141	 4.318	0.0000 *	V2
//  -0.0366	 0.100	-0.366	0.7152  	V3
// 
// Residual standard error:   2.7478 on 96 degrees of freedom
// Multiple R-squared: 0.2999, Adjusted R-squared: 0.2780
// F-statistic: 13.7066 on 3 and 96 DF, p-value: 0.00000
//
```
The plots include a plot of studentised residuals against fitted values and a normal Q-Q plot for the studentised residuals.

![Linear model plots](lm-plots.png)


## Generalised linear models

The current implementation supports only simple one-parameter exponential family observation models. This includes the most commonly used cases of **logistic regression** (`LogisticGlm`) and **Poisson regression** (`PoissonGlm`).

### Logistic regression

Again, we start by creating an appropriate response variable.
```scala
val ylb = (0 until 100) map (i => Bernoulli(sigmoid(1.0 + X(i,0))).sample())
val yl = DenseVector(ylb.toArray map {b => if (b) 1.0 else 0.0})
```

Then we can do logistic regression in a typical way.
```scala
import scalaglm.{Glm, LogisticGlm}
val glm = Glm(yl, X, List("V1","V2","V3"), LogisticGlm)
```
```scala
glm.coefficients
// res20: DenseVector[Double] = DenseVector(1.0040821809088498, 0.9352131504930441, -0.022877298098259655, 0.037703751249029256)
glm.fitted
// res21: DenseVector[Double] = DenseVector(0.74272903879546, 0.5254186711698221, 0.5115065863173898, 0.729161285999641, 0.4219789712963084, 0.6318224289138767, 0.7444078931062478, 0.6767332978527804, 0.6647025292336194, 0.7419169828523466, 0.7413087517313265, 0.6978097144737448, 0.6885219413251586, 0.6537293447437783, 0.6529844536369437, 0.7268038687538309, 0.7591099906975997, 0.807893451725107, 0.8382362964077055, 0.383131547880713, 0.7679914797656123, 0.7541481986939134, 0.8354207090553187, 0.8121078957696355, 0.8222213383578457, 0.638640136968463, 0.5035784804197605, 0.37773636695944307, 0.6996254145592187, 0.7874486306162772, 0.7713280966995366, 0.7183636081190483, 0.8577321818270819, 0.7012595282276741, 0.7501184703438486, 0.5976745656496496, 0.8412940331268818, 0.7139270017949007, 0.6171681460597955, 0.9047340047847504, 0.8510463379962253, 0.669755307387259, 0.8789887665070242, 0.8402709951123435, 0.4276601847710432, 0.8375558696748425, 0.47144559184408386, 0.5865928545305013, 0.6676600198867123, 0.9328767966904457, 0.7970649522649246, 0.9377914888398388, 0.6303821080182915, 0.8247075910124441, 0.5933704554994306, 0.5858182449190508, 0.8096390515066503, 0.840684347948749, 0.6740763424987826, 0.7659078394764237, 0.6435361519968915, 0.7189761920216297, 0.4024825826924961, 0.9478255005696556, 0.4469015353214639, 0.6179433479960497, 0.819797067714261, 0.40058860551039627, 0.516999598605234, 0.8496268692760037, 0.9449060786005616, 0.670414082583932, 0.7892540323379147, 0.6587826091062676, 0.8292719301863458, 0.8830688281147611, 0.5044371499004272, 0.7553051225049395, 0.40801537965486273, 0.7061464990966558, 0.4924128560338087, 0.7492450111614922, 0.5947303435446508, 0.6188652767291369, 0.8490651325246266, 0.41299446575026094, 0.8643893584479544, 0.6906552211120417, 0.8436039055984087, 0.9300687304410855, 0.8085402362731758, 0.6568557980601067, 0.5191385154579183, 0.924333311279755, 0.4634672862607052, 0.693139415839026, 0.6574063109585846, 0.8668223001549774, 0.541566217829573, 0.8727006616548216)
glm.predict(response=true).fitted
// res22: DenseVector[Double] = DenseVector(0.74272903879546, 0.5254186711698221, 0.5115065863173898, 0.729161285999641, 0.4219789712963084, 0.6318224289138767, 0.7444078931062478, 0.6767332978527804, 0.6647025292336194, 0.7419169828523466, 0.7413087517313265, 0.6978097144737448, 0.6885219413251586, 0.6537293447437783, 0.6529844536369437, 0.7268038687538309, 0.7591099906975997, 0.807893451725107, 0.8382362964077055, 0.383131547880713, 0.7679914797656123, 0.7541481986939134, 0.8354207090553187, 0.8121078957696355, 0.8222213383578457, 0.638640136968463, 0.5035784804197605, 0.37773636695944307, 0.6996254145592187, 0.7874486306162772, 0.7713280966995366, 0.7183636081190483, 0.8577321818270819, 0.7012595282276741, 0.7501184703438486, 0.5976745656496496, 0.8412940331268818, 0.7139270017949007, 0.6171681460597955, 0.9047340047847504, 0.8510463379962253, 0.669755307387259, 0.8789887665070242, 0.8402709951123435, 0.4276601847710432, 0.8375558696748425, 0.47144559184408386, 0.5865928545305013, 0.6676600198867123, 0.9328767966904457, 0.7970649522649246, 0.9377914888398388, 0.6303821080182915, 0.8247075910124441, 0.5933704554994306, 0.5858182449190508, 0.8096390515066503, 0.840684347948749, 0.6740763424987826, 0.7659078394764237, 0.6435361519968915, 0.7189761920216297, 0.4024825826924961, 0.9478255005696556, 0.4469015353214639, 0.6179433479960497, 0.819797067714261, 0.40058860551039627, 0.516999598605234, 0.8496268692760037, 0.9449060786005616, 0.670414082583932, 0.7892540323379147, 0.6587826091062676, 0.8292719301863458, 0.8830688281147611, 0.5044371499004272, 0.7553051225049395, 0.40801537965486273, 0.7061464990966558, 0.4924128560338087, 0.7492450111614922, 0.5947303435446508, 0.6188652767291369, 0.8490651325246266, 0.41299446575026094, 0.8643893584479544, 0.6906552211120417, 0.8436039055984087, 0.9300687304410855, 0.8085402362731758, 0.6568557980601067, 0.5191385154579183, 0.924333311279755, 0.4634672862607052, 0.693139415839026, 0.6574063109585846, 0.8668223001549774, 0.541566217829573, 0.8727006616548216)
glm.summary
// Estimate	 S.E.	 z-stat	p-value		Variable
// ---------------------------------------------------------
//   1.0041	 0.296	 3.387	0.0007 *	(Intercept)
//   0.9352	 0.311	 3.003	0.0027 *	V1
//  -0.0229	 0.116	-0.198	0.8432  	V2
//   0.0377	 0.085	 0.442	0.6585  	V3
glm.plots
// res24: Figure = breeze.plot.Figure@68472161
```

![Logistic regression plots](glm-plots.png)


### Poisson regression

We first create an appropriate response, and then do Poisson regression.
```scala
val yp = DenseVector.tabulate(100)(i => Poisson(math.exp(-0.5 + X(i,0))).sample().toDouble)

import scalaglm.PoissonGlm
val pglm = Glm(yp, X, List("V1","V2","V3"), PoissonGlm)
```
```scala
pglm.coefficients
// res26: DenseVector[Double] = DenseVector(-0.5781555925309022, 0.9845136227833745, -0.004495566602914347, -0.013260630484528085)
pglm.summary
// Estimate	 S.E.	 z-stat	p-value		Variable
// ---------------------------------------------------------
//  -0.5782	 0.171	-3.377	0.0007 *	(Intercept)
//   0.9845	 0.142	 6.947	0.0000 *	V1
//  -0.0045	 0.066	-0.068	0.9455  	V2
//  -0.0133	 0.044	-0.301	0.7633  	V3
pglm.plots
// res28: Figure = breeze.plot.Figure@49a514ba
```
![Poisson regression plots](pglm-plots.png)


## Non-linear response

The above covers the main functionality of the library based on a linear reponse to variation in covariate values. For flexible modelling of a nonlinear response, see the documentation on [flexible regression modelling](FlexibleRegression.md).


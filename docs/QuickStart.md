# scala-glm - Quickstart Guide

## PCA

This library contains code for principal components analysis based on a thin SVD of the centred data matrix. This is more numerically stable than a construction from the spectral decomposition of the covariance matrix. It is analogous to the R function `prcomp` rather than the R function `princomp`. First create some synthetic data.

```scala
import breeze.linalg._
import breeze.numerics._
import breeze.stats.distributions._
val X = DenseMatrix.tabulate(100, 3)((i, j) => 
	Gaussian(j, j+1).sample())
// X: DenseMatrix[Double] = 2.2666512668956074     0.9012275365045993    4.204892784830352      
// 0.7743143320028836     1.436631117806304     0.5680528698293128     
// -1.3684299805494715    0.11493766687987306   1.3496321381825458     
// 0.8946363540210884     0.9090046951036983    -2.1415792524670048    
// 0.782469851327486      1.9444803172621064    2.588351092053796      
// -1.653391053822999     0.6717458863399826    2.833046654813368      
// -1.4105151405581036    -2.062389901169743    3.0545200772952246     
// -0.5713795350138204    -0.4028269945421026   -0.8389378870373729    
// -0.20905788285091823   0.3223408612816919    6.1143775131108296     
// 0.8787913387612921     0.3465839114146322    1.5716251962342844     
// 0.4389770971802636     1.3578938167360268    0.866900473410408      
// 0.8043883590728809     0.49411568501034786   4.093120754911311      
// -0.06573765951106819   -0.22425376830849997  2.984345038670531      
// 0.447575965631879      0.7825370234553404    -4.932643487568863     
// -0.11830066533467896   0.3777668853061865    4.844758348782789      
// 2.3396423510925596E-5  0.7637363146388284    1.3422092213267767     
// 0.1858679348422991     2.7783411257057375    4.356302936582773      
// -0.3666146735390753    -1.7664905632682926   -0.4257723305792611    
// -1.3562056670924034    0.6951527390416818    4.805930717377921      
// -0.749246864229255     -2.812860926424742    5.526715937833739      
// -0.8169363629473156    5.394721552354266     4.509022062616143      
// 2.2968313647666094     0.9926921718839201    5.622904523070551      
// -0.7892325074514942    -1.240431545770531    1.8610428422100236     
// -0.636483228727806     1.0000226723122312    0.3632051040818849     
// 0.38727452399362156    -0.2847349763038458   6.2971453563601525     
// -0.08224414569538584   2.1478270048098054    9.942420225602795      
// 0.6751304901264232     -0.21666338181389344  -0.4994828754101577    
// 0.5115609761522696     1.3617113299282118    0.07748379759163937    
// -0.2907902113974128    -4.624479191074093    4.665685314652599      
// -1.1793786467161078    1.9939918466644313    6.702079414098843      
// -0.4092710969067736    -0.3099183696517718   3.420610314511869      
// -0.8796044371662024    2.4126706655632013    -1.56701856216195      
// -0.3348090739910293    0.90494233068439      3.3005044738205034     
// 0.24062584479220092    -2.338087239889516    3.813701641072014      
// 0.5058242344875782     1.6684489523084958    -3.079873661749497     
// -1.1531380310652346    2.9741913609996935    -1.0648242423139669    
// -0.6236646231046656    -1.0687778460023072   -3.3806472384475548    
// 0.013374089593112056   -0.6035960379392991   3.0949808687770206     
// 0.5135942599709565     -0.04094168481097005  0.5061460268591591     
// -0.26987026244226525   3.4406417043376583    2.479207389489825      
// 0.3422050302468517     -0.9187849865920568   6.067648231035356      
// -0.6216580748517825    0.14036242993747639   4.507835421889028      
// 1.1220589959245828     -0.22871558512563128  4.063779082104267      
// -1.734511376024465     1.2070943604751447    1.1477762204251438     
// -0.10790251947824166   4.520072296224922     3.830581277549376      
// -1.2471172245853102    2.004161716029909     6.212430389976967      
// 0.25977421077666074    -2.73901368003514     0.5476373244608435     
// 0.8347660427856425     0.03969466488838702   0.2988203669620877     
// -0.9405036048502448    -0.48581270919125075  5.6173771396521985     
// ...
```
Now we can do PCA.
```scala
import scalaglm.Pca
val pca = Pca(X, List("V1", "V2", "V3"))
// pca: Pca = Pca(
//   mat = 2.2666512668956074     0.9012275365045993    4.204892784830352      
// 0.7743143320028836     1.436631117806304     0.5680528698293128     
// -1.3684299805494715    0.11493766687987306   1.3496321381825458     
// 0.8946363540210884     0.9090046951036983    -2.1415792524670048    
// 0.782469851327486      1.9444803172621064    2.588351092053796      
// -1.653391053822999     0.6717458863399826    2.833046654813368      
// -1.4105151405581036    -2.062389901169743    3.0545200772952246     
// -0.5713795350138204    -0.4028269945421026   -0.8389378870373729    
// -0.20905788285091823   0.3223408612816919    6.1143775131108296     
// 0.8787913387612921     0.3465839114146322    1.5716251962342844     
// 0.4389770971802636     1.3578938167360268    0.866900473410408      
// 0.8043883590728809     0.49411568501034786   4.093120754911311      
// -0.06573765951106819   -0.22425376830849997  2.984345038670531      
// 0.447575965631879      0.7825370234553404    -4.932643487568863     
// -0.11830066533467896   0.3777668853061865    4.844758348782789      
// 2.3396423510925596E-5  0.7637363146388284    1.3422092213267767     
// 0.1858679348422991     2.7783411257057375    4.356302936582773      
// -0.3666146735390753    -1.7664905632682926   -0.4257723305792611    
// -1.3562056670924034    0.6951527390416818    4.805930717377921      
// -0.749246864229255     -2.812860926424742    5.526715937833739      
// -0.8169363629473156    5.394721552354266     4.509022062616143      
// 2.2968313647666094     0.9926921718839201    5.622904523070551      
// -0.7892325074514942    -1.240431545770531    1.8610428422100236     
// -0.636483228727806     1.0000226723122312    0.3632051040818849     
// 0.38727452399362156    -0.2847349763038458   6.2971453563601525     
// -0.08224414569538584   2.1478270048098054    9.942420225602795      
// 0.6751304901264232     -0.21666338181389344  -0.4994828754101577    
// 0.5115609761522696     1.3617113299282118    0.07748379759163937    
// -0.2907902113974128    -4.624479191074093    4.665685314652599      
// -1.1793786467161078    1.9939918466644313    6.702079414098843      
// -0.4092710969067736    -0.3099183696517718   3.420610314511869      
// -0.8796044371662024    2.4126706655632013    -1.56701856216195      
// -0.3348090739910293    0.90494233068439      3.3005044738205034     
// 0.24062584479220092    -2.338087239889516    3.813701641072014      
// 0.5058242344875782     1.6684489523084958    -3.079873661749497     
// -1.1531380310652346    2.9741913609996935    -1.0648242423139669    
// -0.6236646231046656    -1.0687778460023072   -3.3806472384475548    
// 0.013374089593112056   -0.6035960379392991   3.0949808687770206     
// 0.5135942599709565     -0.04094168481097005  0.5061460268591591     
// -0.26987026244226525   3.4406417043376583    2.479207389489825      
// 0.3422050302468517     -0.9187849865920568   6.067648231035356      
// -0.6216580748517825    0.14036242993747639   4.507835421889028      
// 1.1220589959245828     -0.22871558512563128  4.063779082104267      
// -1.734511376024465     1.2070943604751447    1.1477762204251438     
// -0.10790251947824166   4.520072296224922     3.830581277549376      
// -1.2471172245853102    2.004161716029909     6.212430389976967      
// 0.25977421077666074    -2.73901368003514     0.5476373244608435     
// 0.8347660427856425     0.03969466488838702   0.2988203669620877     
// ...
pca.sdev
// res0: DenseVector[Double] = DenseVector(3.1149982695599405, 2.0303990120660576, 0.9111342660333693)
pca.loadings
// res1: DenseMatrix[Double] = 0.025020053361977063  0.0014960295012884889  -0.9996858300613725    
// 0.024943245188679852  0.9996866203030101     0.0021203081387361523  
// -0.9993757208623901   0.024988458993644436   -0.02497489675457568   
pca.scores
// res2: DenseMatrix[Double] = -1.980435506675107    0.27350999848108704   -2.450141001822515      
// 1.6301503580984107    0.7156341900078014    -0.8663079923720247     
// 0.7624801125249359    -0.5893202162332338   1.2534408754176087      
// 4.3279406617722005    0.12064358883239669   -0.9200381609289929     
// -0.37601517546459035  1.273820580013859     -0.9238408922002739     
// -0.7132494766890501   0.003955443482849947  1.5024449030905778      
// -0.9967060889504891   -2.72342589231499     1.2483168079134133      
// 2.956711372916519     -1.160419202071892    0.5102023289659785      
// -3.965109870788072    -0.2611839185039512   -0.024126247539749734   
// 0.6026292465078283    -0.34883739111078294  -0.9981275267966644     
// 1.3211351995259455    0.6438876303003354    -0.5387067458129602     
// -1.9154738404165157   -0.13845487165951323  -0.9864092007126182     
// -0.8470793745504781   -0.885607533288825    -0.09038815512792306    
// 7.102922504784465     -0.07619766013269917  -0.4036798348009918     
// -2.6926300478847134   -0.2373653148205679   -0.08302882406997153    
// 0.820320315672949     0.06113687057170521   -0.11302153500658028    
// -2.136991141728805    2.1507059315121713    -0.3698127830280309     
// 2.5149127801068314    -2.513024721483385    0.2922916443768396      
// -2.6768824717919877   0.07709889155465187   1.1561299370436804      
// -3.469532824418789    -3.410896093452517    0.5239222160015827      
// -2.2494441269514382   4.768582428460305     0.634409852104412       
// -3.394525477284675    0.4004250491909758    -2.5155323815625446     
// 0.2320729166224395    -1.9306188217771407   0.658779138849362       
// 1.7886815798994606    0.27193314397056245   0.5482366455351197      
// -4.147985788710121    -0.8626102932178502   -0.6261231005231005     
// -7.742056381139527    1.6595767601686222    -0.24263452202058278    
// 2.6532995479539583    -0.9639666558307346   -0.7439992098411773     
// 2.1119703326757815    0.6280862285530565    -0.5915441268329588     
// -2.642756753337977    -5.242776597460966    0.08327255843388191     
// -4.535025958632006    1.423177341764387     0.934756291600397       
// -1.2938042771722043   -0.9608576282865958   0.2419600388156656      
// 3.746853367429937     1.6355414105887454    0.8424838584133196      
// -1.1416078039461186   0.2507324968794039    0.1730969196303327      
// -1.7209788622712967   -2.9775959000862566   -0.4218504830592763     
// 5.274864217766123     0.8558216458543886    -0.5063041326385203     
// 3.2521348802880046    2.2090259846821443    1.104579861891609       
// 5.478914837139096     -1.889752977991793    0.6245378982751665      
// -0.9651287840740455   -1.2619479523397092   -0.17304249063467372    
// 1.648639863103438     -0.7634125728186316   -0.6072566233765102     
// -0.2559500945189389   2.765211435695758     0.13406678380934534     
// -3.9355748396598518   -1.5022638099035517   -0.5766804806431363     
// -2.3744331217306054   -0.4838675947300237   0.428081690395207       
// -1.8962321063191512   -0.8613175796944028   -1.3047798547758764     
// 0.9822925719872722    0.4969024807373248    1.6267642985545496      
// -1.575503404563579    3.8783148154598033    -0.059311771620749035   
// -4.047123765468473    1.4210071106278692    1.0147240851249555      
// 1.5335252051644706    -3.459981965751382    -0.3602733016956775     
// 1.8658831613024005    -0.6875017592027057   -0.9229785928128511     
// -3.506878547948202    -1.082597767886557    0.7177886746232793      
// ...
pca.plots
// res3: breeze.plot.Figure = breeze.plot.Figure@296d071
pca.summary
// Standard deviations:
// V1	V2	V3
//  3.115	 2.030	 0.911
// Cumulative proportion of variance explained:
// V1	V2	V3
//  0.662	 0.943	 1.000
// Loadings:
// PC01	PC02	PC03	
//  0.025	 0.001	-1.000	V1
//  0.025	 1.000	 0.002	V2
// -0.999	 0.025	-0.025	V3
```
The final line prints a readable summary of the PCA to the console. `plots` produces some diagnostic plots, including a "scree plot".

![PCA Plots](pca-plots.png)

Note that there is also a utility function `pairs` for producing a "scatterplot matrix":
```scala
import scalaglm.Utils.pairs
pairs(X, List("V1", "V2", "V3"))
// res6: breeze.plot.Figure = breeze.plot.Figure@7e681ce
```

![Pairs plots](paris-plots.png)


## Linear regression

This code computes regression coefficients and associated diagnostics via the QR decomposition of the covariate matrix. The diagnostics are analogous to those produced by the R function `lm`. We start by creating a synthetic response variable.

```scala
val y = DenseVector.tabulate(100)(i => 
	Gaussian(2.0 + 1.5*X(i,0) + 0.5*X(i,1), 3.0).sample())
// y: DenseVector[Double] = DenseVector(9.325289845244544, 2.3834935533689725, 2.156617374606469, 8.458489854793164, 6.400928384672971, 2.257607026372144, -5.193183344305888, 0.5509772665172964, 2.722984589369715, 5.321681691787552, 2.295770444655877, 3.387376773755081, 0.5834517936774251, 1.7479474373863715, 1.1173689406323748, 0.1604752263314544, 7.672349133389341, 0.30876722321631633, -3.5602841375463337, -3.372538982477533, 2.053917563889331, 9.527057457320318, -1.2731534199922463, 6.811108209512193, 6.631566372933353, 4.473119241758082, 7.283137013479194, 5.686585809793369, 2.3468079165147153, 3.017825590529064, -0.36689728021363077, 2.2000104298966763, 0.015319953359049121, 0.8685791287515101, 4.567197780061521, 2.712946880672897, 1.6084395899194766, 6.618033321532057, 2.5957010917720207, 9.995502129659886, 0.9430295028043221, 3.0741051736484923, -0.6896621446858102, -3.2308771626346116, 5.692935024815941, 0.7887090848625413, 1.100379570388549, 1.8144116119306997, -0.966858665944188, -1.0409755167050436, 7.785621836812957, 9.139323656571403, 4.761224451701772, 6.858644798686429, 1.6244140815189776, 2.570028433027952, 1.9763471642190198, 5.392412206774599, 6.965447121819569, -3.3016780214670494, 5.51370735540475, 12.950968559872521, 6.604627985705131, -2.852831299808404, 4.729546309730988, -2.8037108911937496, -2.76947152476677, 2.433822049363319, 1.7867816919589523, -0.43369921804896316, 2.3394225479249924, 2.6199693964331665, 1.3695138598259404, 1.8151287110123586, 3.872275484572922, 0.06978959250789019, 5.766973468959354, 5.069946068195506, 9.361875071001062, 4.86396023659834, -3.478627205384351, -1.3019517677255286, 3.8715007988533627, -1.6726466601381502, 1.0189983069569224, 3.3835578539806264, 3.1480148596667776, 3.147439151658187, -0.8602152558976552, -2.0144677146733274, 6.6178892001271725, 2.187212544636896, 1.074290569008141, 1.16500985256554, 7.101615792631483, 6.005863944230222, 4.7539306590024015, 2.417640109604535, 1.0706642865015659, 7.1353461349084775)
```
So we can now do linear regression and generate all of the usual diagnostics.
```scala
import scalaglm.Lm
val lm = Lm(y,X,List("V1", "V2", "V3"))
// lm: Lm = Lm(
//   y = DenseVector(9.325289845244544, 2.3834935533689725, 2.156617374606469, 8.458489854793164, 6.400928384672971, 2.257607026372144, -5.193183344305888, 0.5509772665172964, 2.722984589369715, 5.321681691787552, 2.295770444655877, 3.387376773755081, 0.5834517936774251, 1.7479474373863715, 1.1173689406323748, 0.1604752263314544, 7.672349133389341, 0.30876722321631633, -3.5602841375463337, -3.372538982477533, 2.053917563889331, 9.527057457320318, -1.2731534199922463, 6.811108209512193, 6.631566372933353, 4.473119241758082, 7.283137013479194, 5.686585809793369, 2.3468079165147153, 3.017825590529064, -0.36689728021363077, 2.2000104298966763, 0.015319953359049121, 0.8685791287515101, 4.567197780061521, 2.712946880672897, 1.6084395899194766, 6.618033321532057, 2.5957010917720207, 9.995502129659886, 0.9430295028043221, 3.0741051736484923, -0.6896621446858102, -3.2308771626346116, 5.692935024815941, 0.7887090848625413, 1.100379570388549, 1.8144116119306997, -0.966858665944188, -1.0409755167050436, 7.785621836812957, 9.139323656571403, 4.761224451701772, 6.858644798686429, 1.6244140815189776, 2.570028433027952, 1.9763471642190198, 5.392412206774599, 6.965447121819569, -3.3016780214670494, 5.51370735540475, 12.950968559872521, 6.604627985705131, -2.852831299808404, 4.729546309730988, -2.8037108911937496, -2.76947152476677, 2.433822049363319, 1.7867816919589523, -0.43369921804896316, 2.3394225479249924, 2.6199693964331665, 1.3695138598259404, 1.8151287110123586, 3.872275484572922, 0.06978959250789019, 5.766973468959354, 5.069946068195506, 9.361875071001062, 4.86396023659834, -3.478627205384351, -1.3019517677255286, 3.8715007988533627, -1.6726466601381502, 1.0189983069569224, 3.3835578539806264, 3.1480148596667776, 3.147439151658187, -0.8602152558976552, -2.0144677146733274, 6.6178892001271725, 2.187212544636896, 1.074290569008141, 1.16500985256554, 7.101615792631483, 6.005863944230222, 4.7539306590024015, 2.417640109604535, 1.0706642865015659, 7.1353461349084775),
//   Xmat = 2.2666512668956074     0.9012275365045993    4.204892784830352      
// 0.7743143320028836     1.436631117806304     0.5680528698293128     
// -1.3684299805494715    0.11493766687987306   1.3496321381825458     
// 0.8946363540210884     0.9090046951036983    -2.1415792524670048    
// 0.782469851327486      1.9444803172621064    2.588351092053796      
// -1.653391053822999     0.6717458863399826    2.833046654813368      
// -1.4105151405581036    -2.062389901169743    3.0545200772952246     
// -0.5713795350138204    -0.4028269945421026   -0.8389378870373729    
// -0.20905788285091823   0.3223408612816919    6.1143775131108296     
// 0.8787913387612921     0.3465839114146322    1.5716251962342844     
// 0.4389770971802636     1.3578938167360268    0.866900473410408      
// 0.8043883590728809     0.49411568501034786   4.093120754911311      
// -0.06573765951106819   -0.22425376830849997  2.984345038670531      
// 0.447575965631879      0.7825370234553404    -4.932643487568863     
// -0.11830066533467896   0.3777668853061865    4.844758348782789      
// 2.3396423510925596E-5  0.7637363146388284    1.3422092213267767     
// 0.1858679348422991     2.7783411257057375    4.356302936582773      
// -0.3666146735390753    -1.7664905632682926   -0.4257723305792611    
// -1.3562056670924034    0.6951527390416818    4.805930717377921      
// -0.749246864229255     -2.812860926424742    5.526715937833739      
// -0.8169363629473156    5.394721552354266     4.509022062616143      
// 2.2968313647666094     0.9926921718839201    5.622904523070551      
// -0.7892325074514942    -1.240431545770531    1.8610428422100236     
// ...
lm.coefficients
// res8: DenseVector[Double] = DenseVector(3.1157436716415123, 1.9878057896358168, 0.4883279820674142, -0.17569843771639604)
lm.se
// res9: DenseVector[Double] = DenseVector(0.362448315102406, 0.31416008984166044, 0.14099473146005778, 0.09226254659438712)
lm.fitted
// res10: DenseVector[Double] = DenseVector(7.3227077142871995, 5.256671356759114, 0.21456965435451886, 5.714271553137404, 5.165916678688796, -0.3406061957697885, -1.2318835953574332, 1.9306405065881544, 1.7832986874071766, 4.755724713137069, 4.499129375488676, 4.236847102268727, 2.35121582041811, 5.254230247561194, 2.2138425919703284, 3.252919929271152, 4.076559123862537, 1.599165662218804, -0.08506178987334995, -0.7182476389568465, 3.33399819705714, 7.178222181319953, 0.6141829704221704, 2.2750631088043685, 2.6401275550264818, 2.2542346089949348, 4.439727537521061, 4.783975505505737, -0.5403070062944406, 0.567545101758512, 1.5498545153256287, 2.8207581896053533, 2.312223438443791, 1.7822462750498325, 5.477103314290587, 2.462998038657219, 1.948079832491839, 2.3037926257687675, 4.0277472786338055, 3.8238627568961316, 2.2812360787468027, 1.1565314123381971, 4.520491183951292, 0.055667380629950775, 4.435505055909609, 0.5238907648411196, 2.1983683062518744, 4.741978188452902, 0.022004833304084204, -1.7958578720492313, 3.263664990941484, 9.779038526721953, 3.438137283282718, 2.781485999603648, 4.6928784076891255, 3.915071149628265, 2.8889887349135703, 5.9658724113085695, 2.9981561346574495, 0.9470896305092809, 4.259337875620861, 7.481456661989834, 2.6030043321718757, -0.5170562393030127, 1.140602727113255, 1.965813117235565, 2.2167165768408053, 5.202625105754303, 3.4610815184472123, 0.20590582837231922, 2.7948551362865275, 7.244357133480694, 1.6389724065636428, -0.8322592964372599, 0.97844585600696, 2.0837305587274817, 5.504341792192555, 2.8086772685609382, 4.231735813288972, 4.290611446807778, -0.24423757965328896, 1.0416315576326158, 3.4022306816681347, 2.299866352908699, 4.384378301761448, 1.8752456655015435, 0.8167454490111015, 3.0083091370393866, 4.33305540108611, 4.585340722420459, 4.744857166607894, 1.8477657746679883, -0.19292720202151947, 3.6908455078944677, 3.984595819291016, 4.084557694045144, 0.9988224692143997, -1.4354104209049332, 0.9671601436366808, 5.361683614603627)
lm.residuals
// res11: DenseVector[Double] = DenseVector(2.002582130957345, -2.873177803390141, 1.9420477202519504, 2.74421830165576, 1.2350117059841752, 2.5982132221419327, -3.9612997489484547, -1.3796632400708582, 0.9396859019625385, 0.5659569786504823, -2.2033589308327985, -0.8494703285136458, -1.7677640267406851, -3.506282810174823, -1.0964736513379536, -3.0924447029396975, 3.5957900095268043, -1.2903984390024876, -3.4752223476729838, -2.6542913435206867, -1.2800806331678092, 2.348835276000365, -1.8873363904144167, 4.536045100707825, 3.991438817906871, 2.218884632763147, 2.8434094759581328, 0.9026103042876326, 2.8871149228091557, 2.4502804887705523, -1.9167517955392595, -0.620747759708677, -2.2969034850847416, -0.9136671462983224, -0.9099055342290656, 0.2499488420156779, -0.33964024257236236, 4.314240695763289, -1.4320461868617849, 6.171639372763755, -1.3382065759424806, 1.9175737613102952, -5.2101533286371025, -3.2865445432645624, 1.2574299689063313, 0.2648183200214217, -1.0979887358633253, -2.927566576522202, -0.9888634992482722, 0.7548823553441877, 4.521956845871473, -0.6397148701505504, 1.3230871684190544, 4.077158799082781, -3.068464326170148, -1.3450427166003132, -0.9126415706945505, -0.5734602045339701, 3.9672909871621194, -4.24876765197633, 1.2543694797838896, 5.469511897882687, 4.0016236535332546, -2.3357750605053913, 3.588943582617733, -4.769524008429315, -4.986188101607575, -2.7688030563909845, -1.67429982648826, -0.6396050464212824, -0.4554325883615351, -4.6243877370475275, -0.2694585467377024, 2.6473880074496186, 2.893829628565962, -2.0139409662195913, 0.2626316767667989, 2.2612687996345677, 5.130139257712091, 0.573348789790562, -3.2343896257310623, -2.3435833253581446, 0.46927011718522804, -3.972513013046849, -3.3653799948045253, 1.5083121884790829, 2.3312694106556764, 0.1391300146188006, -5.193270656983765, -6.599808437093786, 1.8730320335192783, 0.3394467699689079, 1.2672177710296606, -2.525835655328928, 3.117019973340467, 1.9213062501850775, 3.755108189788002, 3.853050530509468, 0.10350414286488507, 1.7736625203048506)
lm.studentised
// res12: DenseVector[Double] = DenseVector(0.7357883860953593, -1.0204070425726537, 0.6923513463615856, 0.9830368174159628, 0.43891802803769064, 0.9298450211181103, -1.4252197057990224, -0.4905930863073424, 0.3343090487796162, 0.20096274789057872, -0.7798162659295256, -0.3020837396882571, -0.6245093940635159, -1.272486655251921, -0.3883432456195627, -1.0914364678117403, 1.280058919701278, -0.4606347892772127, -1.240964382206088, -0.9581067797416906, -0.4674095414065189, 0.8687737164731307, -0.6707383072973951, 1.606061545750325, 1.4258656264886553, 0.8119557758778312, 1.0114866205700526, 0.32002373280097574, 1.0592715334923557, 0.8810377540124334, -0.6778126562416045, -0.2223615588974363, -0.8110752535310557, -0.3268081450378994, -0.3266360048469337, 0.08991125214447239, -0.12262215982480619, 1.5260282241084615, -0.5074464400168299, 2.198468016986443, -0.47834507059636133, 0.6794685617322866, -1.8629375609578498, -1.1797540258868542, 0.45271793921998493, 0.09509617122595135, -0.39404687432649027, -1.040786498830857, -0.3527850399157779, 0.27586622669458993, 1.641376555239123, -0.24828901619764324, 0.47225529386939913, 1.4473840729555116, -1.1101735157246664, -0.5027448275516517, -0.34357971683458016, -0.20474325610457025, 1.4213888895731512, -1.5138629755449908, 0.44412396353348327, 1.9929640698469189, 1.4119395196691251, -0.8388820637976911, 1.2815006242234213, -1.7162911384112514, -1.7670606973653558, -0.9909363945291929, -0.5912437447041351, -0.22764550187351598, -0.1606866115716942, -1.6809089645919062, -0.09681545131777976, 0.9514889333053024, 1.0250514024046327, -0.7118660128388545, 0.09412079106437882, 0.8038828621136899, 1.8158619846845605, 0.2039777327448247, -1.1634670047580056, -0.830489822527163, 0.1690352951647015, -1.4115284319399712, -1.214369259599523, 0.5351181701998995, 0.8353406209538754, 0.0496819587987126, -1.8379281238033316, -2.4095797623684536, 0.6646881363252128, 0.11995650553555648, 0.45434643831315175, -0.8931897613918987, 1.1154376412306646, 0.6875994549913417, 1.332252240654204, 1.4049035789291364, 0.03738647099009707, 0.643368992974201)
val pred = lm.predict()
// pred: scalaglm.PredictLm = PredictLm(
//   mod = Lm(
//     y = DenseVector(9.325289845244544, 2.3834935533689725, 2.156617374606469, 8.458489854793164, 6.400928384672971, 2.257607026372144, -5.193183344305888, 0.5509772665172964, 2.722984589369715, 5.321681691787552, 2.295770444655877, 3.387376773755081, 0.5834517936774251, 1.7479474373863715, 1.1173689406323748, 0.1604752263314544, 7.672349133389341, 0.30876722321631633, -3.5602841375463337, -3.372538982477533, 2.053917563889331, 9.527057457320318, -1.2731534199922463, 6.811108209512193, 6.631566372933353, 4.473119241758082, 7.283137013479194, 5.686585809793369, 2.3468079165147153, 3.017825590529064, -0.36689728021363077, 2.2000104298966763, 0.015319953359049121, 0.8685791287515101, 4.567197780061521, 2.712946880672897, 1.6084395899194766, 6.618033321532057, 2.5957010917720207, 9.995502129659886, 0.9430295028043221, 3.0741051736484923, -0.6896621446858102, -3.2308771626346116, 5.692935024815941, 0.7887090848625413, 1.100379570388549, 1.8144116119306997, -0.966858665944188, -1.0409755167050436, 7.785621836812957, 9.139323656571403, 4.761224451701772, 6.858644798686429, 1.6244140815189776, 2.570028433027952, 1.9763471642190198, 5.392412206774599, 6.965447121819569, -3.3016780214670494, 5.51370735540475, 12.950968559872521, 6.604627985705131, -2.852831299808404, 4.729546309730988, -2.8037108911937496, -2.76947152476677, 2.433822049363319, 1.7867816919589523, -0.43369921804896316, 2.3394225479249924, 2.6199693964331665, 1.3695138598259404, 1.8151287110123586, 3.872275484572922, 0.06978959250789019, 5.766973468959354, 5.069946068195506, 9.361875071001062, 4.86396023659834, -3.478627205384351, -1.3019517677255286, 3.8715007988533627, -1.6726466601381502, 1.0189983069569224, 3.3835578539806264, 3.1480148596667776, 3.147439151658187, -0.8602152558976552, -2.0144677146733274, 6.6178892001271725, 2.187212544636896, 1.074290569008141, 1.16500985256554, 7.101615792631483, 6.005863944230222, 4.7539306590024015, 2.417640109604535, 1.0706642865015659, 7.1353461349084775),
//     Xmat = 2.2666512668956074     0.9012275365045993    4.204892784830352      
// 0.7743143320028836     1.436631117806304     0.5680528698293128     
// -1.3684299805494715    0.11493766687987306   1.3496321381825458     
// 0.8946363540210884     0.9090046951036983    -2.1415792524670048    
// 0.782469851327486      1.9444803172621064    2.588351092053796      
// -1.653391053822999     0.6717458863399826    2.833046654813368      
// -1.4105151405581036    -2.062389901169743    3.0545200772952246     
// -0.5713795350138204    -0.4028269945421026   -0.8389378870373729    
// -0.20905788285091823   0.3223408612816919    6.1143775131108296     
// 0.8787913387612921     0.3465839114146322    1.5716251962342844     
// 0.4389770971802636     1.3578938167360268    0.866900473410408      
// 0.8043883590728809     0.49411568501034786   4.093120754911311      
// -0.06573765951106819   -0.22425376830849997  2.984345038670531      
// 0.447575965631879      0.7825370234553404    -4.932643487568863     
// -0.11830066533467896   0.3777668853061865    4.844758348782789      
// 2.3396423510925596E-5  0.7637363146388284    1.3422092213267767     
// 0.1858679348422991     2.7783411257057375    4.356302936582773      
// -0.3666146735390753    -1.7664905632682926   -0.4257723305792611    
// -1.3562056670924034    0.6951527390416818    4.805930717377921      
// -0.749246864229255     -2.812860926424742    5.526715937833739      
// -0.8169363629473156    5.394721552354266     4.509022062616143      
// 2.2968313647666094     0.9926921718839201    5.622904523070551      
// ...
pred.fitted
// res13: DenseVector[Double] = DenseVector(7.322707714287199, 5.256671356759115, 0.21456965435451716, 5.7142715531374035, 5.165916678688796, -0.34060619576979, -1.2318835953574347, 1.9306405065881538, 1.7832986874071757, 4.755724713137069, 4.499129375488676, 4.236847102268727, 2.3512158204181097, 5.254230247561194, 2.2138425919703284, 3.252919929271152, 4.076559123862537, 1.5991656622188035, -0.08506178987335122, -0.7182476389568473, 3.3339981970571397, 7.178222181319954, 0.61418297042217, 2.2750631088043685, 2.6401275550264813, 2.254234608994934, 4.439727537521061, 4.783975505505738, -0.5403070062944412, 0.5675451017585118, 1.5498545153256282, 2.8207581896053524, 2.3122234384437905, 1.782246275049833, 5.477103314290588, 2.462998038657218, 1.948079832491838, 2.303792625768767, 4.027747278633806, 3.8238627568961303, 2.2812360787468027, 1.1565314123381967, 4.520491183951293, 0.05566738062994944, 4.435505055909609, 0.5238907648411189, 2.198368306251874, 4.741978188452902, 0.02200483330408376, -1.7958578720492326, 3.2636649909414848, 9.779038526721953, 3.4381372832827175, 2.7814859996036474, 4.692878407689124, 3.915071149628265, 2.8889887349135703, 5.96587241130857, 2.9981561346574503, 0.9470896305092801, 4.259337875620861, 7.481456661989834, 2.6030043321718748, -0.517056239303014, 1.1406027271132542, 1.9658131172355644, 2.216716576840805, 5.202625105754303, 3.461081518447212, 0.2059058283723184, 2.794855136286527, 7.244357133480694, 1.638972406563643, -0.832259296437261, 0.9784458560069595, 2.0837305587274813, 5.504341792192554, 2.808677268560938, 4.231735813288972, 4.290611446807777, -0.24423757965329057, 1.0416315576326152, 3.4022306816681334, 2.2998663529086985, 4.384378301761448, 1.8752456655015433, 0.8167454490111008, 3.008309137039386, 4.33305540108611, 4.585340722420459, 4.744857166607894, 1.8477657746679879, -0.1929272020215197, 3.6908455078944673, 3.9845958192910156, 4.084557694045144, 0.9988224692143988, -1.435410420904935, 0.9671601436366797, 5.361683614603626)
pred.se
// res14: DenseVector[Double] = DenseVector(0.8417967741409356, 0.43348760449242063, 0.49812936619706677, 0.5685947639712904, 0.4459913779263125, 0.5553197367485855, 0.6252513744848642, 0.45553017932375406, 0.46412323688974644, 0.4301555308160739, 0.3644335764620132, 0.45675988701164333, 0.32191280148953316, 0.7236228203706384, 0.3797627355444412, 0.2969562802099896, 0.4745903287936563, 0.5182893867539732, 0.5232776764315002, 0.6643306478920018, 0.7847678507704519, 0.8981127799031167, 0.4456418073307802, 0.37328970629148006, 0.5291913079842172, 0.8050894544462973, 0.462368244283344, 0.40155770924281575, 0.8291340804444166, 0.617650238099811, 0.3456096971162836, 0.5683871322081934, 0.31045456583195974, 0.5477888662134089, 0.5967628809427492, 0.622936703976489, 0.6665741246600075, 0.3516502176059739, 0.390041044005658, 0.485333426106782, 0.5382801221535711, 0.3892929376185226, 0.5426020701643598, 0.5962894991055591, 0.6337168806804874, 0.6011543742924865, 0.593225902223318, 0.45177770344653156, 0.5091707877883042, 0.7926227054158781, 0.7254447089612459, 1.2156727909089262, 0.5167344554478183, 0.4256313507169162, 0.6904743704136067, 0.9789887345396512, 1.0297517595709123, 0.5208421989715942, 0.5707279683526698, 0.48920450139393207, 0.3729898573620683, 0.7644511795019308, 0.28960097085851333, 0.6027822458331619, 0.5224304536144633, 0.627290627711359, 0.3923669571868008, 0.555899949491587, 0.3113408795716079, 0.4711912967933768, 0.2880471805830435, 0.739930059396813, 0.6081701309076125, 0.6120697763911722, 0.3824178260090703, 0.33520477190794035, 0.5744737539759334, 0.4512010614624752, 0.36677849509909716, 0.464062062842964, 0.6229029752752518, 0.3910144308746736, 0.6395900411517716, 0.4423771735974551, 0.6603627439745792, 0.4139728392311978, 0.5723684278245957, 0.5233176783517036, 0.36344994578240336, 0.7836606745547758, 0.41899050725116976, 0.32969338669134135, 0.5805991373278379, 0.34533528744095104, 0.5543452974541696, 0.5554216020368525, 0.41421792381906203, 0.7710183799128, 0.6720328324533978, 0.7183545895647443)
val predNew = lm.predict(DenseMatrix((1.1, 1.6, 1.0), (1.4, 2.2, 3.0)))
// predNew: scalaglm.PredictLm = PredictLm(
//   mod = Lm(
//     y = DenseVector(9.325289845244544, 2.3834935533689725, 2.156617374606469, 8.458489854793164, 6.400928384672971, 2.257607026372144, -5.193183344305888, 0.5509772665172964, 2.722984589369715, 5.321681691787552, 2.295770444655877, 3.387376773755081, 0.5834517936774251, 1.7479474373863715, 1.1173689406323748, 0.1604752263314544, 7.672349133389341, 0.30876722321631633, -3.5602841375463337, -3.372538982477533, 2.053917563889331, 9.527057457320318, -1.2731534199922463, 6.811108209512193, 6.631566372933353, 4.473119241758082, 7.283137013479194, 5.686585809793369, 2.3468079165147153, 3.017825590529064, -0.36689728021363077, 2.2000104298966763, 0.015319953359049121, 0.8685791287515101, 4.567197780061521, 2.712946880672897, 1.6084395899194766, 6.618033321532057, 2.5957010917720207, 9.995502129659886, 0.9430295028043221, 3.0741051736484923, -0.6896621446858102, -3.2308771626346116, 5.692935024815941, 0.7887090848625413, 1.100379570388549, 1.8144116119306997, -0.966858665944188, -1.0409755167050436, 7.785621836812957, 9.139323656571403, 4.761224451701772, 6.858644798686429, 1.6244140815189776, 2.570028433027952, 1.9763471642190198, 5.392412206774599, 6.965447121819569, -3.3016780214670494, 5.51370735540475, 12.950968559872521, 6.604627985705131, -2.852831299808404, 4.729546309730988, -2.8037108911937496, -2.76947152476677, 2.433822049363319, 1.7867816919589523, -0.43369921804896316, 2.3394225479249924, 2.6199693964331665, 1.3695138598259404, 1.8151287110123586, 3.872275484572922, 0.06978959250789019, 5.766973468959354, 5.069946068195506, 9.361875071001062, 4.86396023659834, -3.478627205384351, -1.3019517677255286, 3.8715007988533627, -1.6726466601381502, 1.0189983069569224, 3.3835578539806264, 3.1480148596667776, 3.147439151658187, -0.8602152558976552, -2.0144677146733274, 6.6178892001271725, 2.187212544636896, 1.074290569008141, 1.16500985256554, 7.101615792631483, 6.005863944230222, 4.7539306590024015, 2.417640109604535, 1.0706642865015659, 7.1353461349084775),
//     Xmat = 2.2666512668956074     0.9012275365045993    4.204892784830352      
// 0.7743143320028836     1.436631117806304     0.5680528698293128     
// -1.3684299805494715    0.11493766687987306   1.3496321381825458     
// 0.8946363540210884     0.9090046951036983    -2.1415792524670048    
// 0.782469851327486      1.9444803172621064    2.588351092053796      
// -1.653391053822999     0.6717458863399826    2.833046654813368      
// -1.4105151405581036    -2.062389901169743    3.0545200772952246     
// -0.5713795350138204    -0.4028269945421026   -0.8389378870373729    
// -0.20905788285091823   0.3223408612816919    6.1143775131108296     
// 0.8787913387612921     0.3465839114146322    1.5716251962342844     
// 0.4389770971802636     1.3578938167360268    0.866900473410408      
// 0.8043883590728809     0.49411568501034786   4.093120754911311      
// -0.06573765951106819   -0.22425376830849997  2.984345038670531      
// 0.447575965631879      0.7825370234553404    -4.932643487568863     
// -0.11830066533467896   0.3777668853061865    4.844758348782789      
// 2.3396423510925596E-5  0.7637363146388284    1.3422092213267767     
// 0.1858679348422991     2.7783411257057375    4.356302936582773      
// -0.3666146735390753    -1.7664905632682926   -0.4257723305792611    
// -1.3562056670924034    0.6951527390416818    4.805930717377921      
// -0.749246864229255     -2.812860926424742    5.526715937833739      
// -0.8169363629473156    5.394721552354266     4.509022062616143      
// 2.2968313647666094     0.9926921718839201    5.622904523070551      
// ...
predNew.fitted
// res15: DenseVector[Double] = DenseVector(5.907956373832377, 6.445898024530778)
predNew.se
// res16: DenseVector[Double] = DenseVector(0.5020600986635809, 0.6089664991452779)
lm.plots
// res17: breeze.plot.Figure = breeze.plot.Figure@6073a259
lm.summary
// Estimate	 S.E.	 t-stat	p-value		Variable
// ---------------------------------------------------------
//   3.1157	 0.362	 8.596	0.0000 *	(Intercept)
//   1.9878	 0.314	 6.327	0.0000 *	V1
//   0.4883	 0.141	 3.463	0.0008 *	V2
//  -0.1757	 0.092	-1.904	0.0599  	V3
// 
// Residual standard error:   2.8489 on 96 degrees of freedom
// Multiple R-squared: 0.3781, Adjusted R-squared: 0.3586
// F-statistic: 19.4534 on 3 and 96 DF, p-value: 0.00000
//
```
The plots include a plot of studentised residuals against fitted values and a normal Q-Q plot for the studentised residuals.

![Linear model plots](lm-plots.png)


## Generalised linear models

The current implementation supports only simple one-parameter exponential family observation models. This includes the most commonly used cases of **logistic regression** (`LogisticGlm`) and **Poisson regression** (`PoissonGlm`).

### Logistic regression

Again, we start by creating an appropriate response variable.
```scala
val ylb = (0 until 100) map (i => Bernoulli(sigmoid(1.0 + X(i,0))).sample())
// ylb: IndexedSeq[Boolean] = Vector(
//   true,
//   true,
//   false,
//   true,
//   false,
//   true,
//   true,
//   false,
//   true,
//   true,
//   true,
//   true,
//   true,
//   true,
//   false,
//   false,
//   true,
//   false,
//   true,
//   true,
//   true,
//   true,
//   false,
//   true,
//   false,
//   true,
//   false,
//   true,
//   false,
//   true,
//   true,
//   true,
//   true,
//   true,
//   false,
//   false,
//   false,
//   true,
//   true,
//   false,
//   true,
//   true,
//   false,
//   false,
//   true,
//   true,
//   false,
//   true,
// ...
val yl = DenseVector(ylb.toArray map {b => if (b) 1.0 else 0.0})
// yl: DenseVector[Double] = DenseVector(1.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 1.0, 0.0, 1.0, 0.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0)
```

Then we can do logistic regression in a typical way.
```scala
import scalaglm.{Glm, LogisticGlm}
val glm = Glm(yl, X, List("V1","V2","V3"), LogisticGlm)
// glm: Glm = Glm(
//   y = DenseVector(1.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 1.0, 0.0, 1.0, 0.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0),
//   Xmat = 2.2666512668956074     0.9012275365045993    4.204892784830352      
// 0.7743143320028836     1.436631117806304     0.5680528698293128     
// -1.3684299805494715    0.11493766687987306   1.3496321381825458     
// 0.8946363540210884     0.9090046951036983    -2.1415792524670048    
// 0.782469851327486      1.9444803172621064    2.588351092053796      
// -1.653391053822999     0.6717458863399826    2.833046654813368      
// -1.4105151405581036    -2.062389901169743    3.0545200772952246     
// -0.5713795350138204    -0.4028269945421026   -0.8389378870373729    
// -0.20905788285091823   0.3223408612816919    6.1143775131108296     
// 0.8787913387612921     0.3465839114146322    1.5716251962342844     
// 0.4389770971802636     1.3578938167360268    0.866900473410408      
// 0.8043883590728809     0.49411568501034786   4.093120754911311      
// -0.06573765951106819   -0.22425376830849997  2.984345038670531      
// 0.447575965631879      0.7825370234553404    -4.932643487568863     
// -0.11830066533467896   0.3777668853061865    4.844758348782789      
// 2.3396423510925596E-5  0.7637363146388284    1.3422092213267767     
// 0.1858679348422991     2.7783411257057375    4.356302936582773      
// -0.3666146735390753    -1.7664905632682926   -0.4257723305792611    
// -1.3562056670924034    0.6951527390416818    4.805930717377921      
// -0.749246864229255     -2.812860926424742    5.526715937833739      
// -0.8169363629473156    5.394721552354266     4.509022062616143      
// 2.2968313647666094     0.9926921718839201    5.622904523070551      
// -0.7892325074514942    -1.240431545770531    1.8610428422100236     
// -0.636483228727806     1.0000226723122312    0.3632051040818849     
// 0.38727452399362156    -0.2847349763038458   6.2971453563601525     
// -0.08224414569538584   2.1478270048098054    9.942420225602795      
// 0.6751304901264232     -0.21666338181389344  -0.4994828754101577    
// 0.5115609761522696     1.3617113299282118    0.07748379759163937    
// -0.2907902113974128    -4.624479191074093    4.665685314652599      
// -1.1793786467161078    1.9939918466644313    6.702079414098843      
// -0.4092710969067736    -0.3099183696517718   3.420610314511869      
// -0.8796044371662024    2.4126706655632013    -1.56701856216195      
// -0.3348090739910293    0.90494233068439      3.3005044738205034     
// 0.24062584479220092    -2.338087239889516    3.813701641072014      
// 0.5058242344875782     1.6684489523084958    -3.079873661749497     
// -1.1531380310652346    2.9741913609996935    -1.0648242423139669    
// -0.6236646231046656    -1.0687778460023072   -3.3806472384475548    
// 0.013374089593112056   -0.6035960379392991   3.0949808687770206     
// 0.5135942599709565     -0.04094168481097005  0.5061460268591591     
// -0.26987026244226525   3.4406417043376583    2.479207389489825      
// 0.3422050302468517     -0.9187849865920568   6.067648231035356      
// ...
glm.coefficients
// res20: DenseVector[Double] = DenseVector(0.5983935574305733, 0.5594883272357527, 0.0015973345273268017, 0.13961422262082757)
glm.fitted
// res21: DenseVector[Double] = DenseVector(0.9209307565350572, 0.7527282666589594, 0.5053458943753698, 0.6902715695955807, 0.8022874761520615, 0.5174796667493431, 0.5578366812568594, 0.5401489412117517, 0.7917649473687096, 0.787520166177718, 0.7245604012515391, 0.8348897979176255, 0.7266938955504791, 0.5402601192985385, 0.7701584840545734, 0.6871906976694603, 0.7883526861522374, 0.5820054402420921, 0.6252046728325867, 0.7203732398906819, 0.6855654408378404, 0.9352370896726304, 0.6022080485349047, 0.5731205905668908, 0.8447213244068754, 0.8747813967455297, 0.7121891799357072, 0.7104558262164982, 0.7464389134423419, 0.7062905431964446, 0.6998286335260464, 0.47286192240380037, 0.7054349394648628, 0.7793243227125422, 0.6116058147840384, 0.4524720441609328, 0.44417542374374713, 0.7382737165899186, 0.7223890833391863, 0.6897675419414446, 0.8369238287458057, 0.7068564668715357, 0.8573153035243521, 0.4477239153175638, 0.7465028874072831, 0.6837784711134388, 0.6933476918722772, 0.7516101703450492, 0.7017578175241334, 0.49024753813947014, 0.7078991440656646, 0.9055247758216217, 0.7937297573939534, 0.643635161619314, 0.483370157498409, 0.625245288476125, 0.9434688257359253, 0.7460009405407354, 0.8626117567614069, 0.5123399419316861, 0.6777935360393974, 0.7213034840190814, 0.6806997829383258, 0.6339569981497631, 0.4970659021296889, 0.7350473755002135, 0.7674773940459682, 0.772185629016072, 0.6756610759459281, 0.5788703279499635, 0.7117699054798854, 0.7693474697398781, 0.6801607507940417, 0.5638528406024998, 0.6027105625581122, 0.7353528455987256, 0.6537801364258787, 0.5815787209027313, 0.7682518803011859, 0.6606161736059452, 0.4253134336025185, 0.5807113150870175, 0.7831035858688931, 0.796756664495127, 0.5083601018132008, 0.7645337977685206, 0.8021001634984939, 0.6214070189277792, 0.7404344938441689, 0.8836944268814474, 0.6846152457585859, 0.6548754111643598, 0.7421158913980291, 0.7303089637949686, 0.6814647010763684, 0.5268225021256252, 0.5826710747485451, 0.34542344444480155, 0.4508270772178673, 0.5139424568712392)
glm.predict(response=true).fitted
// res22: DenseVector[Double] = DenseVector(0.9209307565350572, 0.7527282666589594, 0.5053458943753698, 0.6902715695955807, 0.8022874761520615, 0.5174796667493431, 0.5578366812568594, 0.5401489412117517, 0.7917649473687096, 0.787520166177718, 0.7245604012515391, 0.8348897979176255, 0.7266938955504791, 0.5402601192985385, 0.7701584840545734, 0.6871906976694603, 0.7883526861522374, 0.5820054402420921, 0.6252046728325867, 0.7203732398906819, 0.6855654408378404, 0.9352370896726304, 0.6022080485349047, 0.5731205905668908, 0.8447213244068754, 0.8747813967455297, 0.7121891799357072, 0.7104558262164982, 0.7464389134423419, 0.7062905431964446, 0.6998286335260464, 0.47286192240380037, 0.7054349394648628, 0.7793243227125422, 0.6116058147840384, 0.4524720441609328, 0.44417542374374713, 0.7382737165899186, 0.7223890833391863, 0.6897675419414446, 0.8369238287458057, 0.7068564668715357, 0.8573153035243521, 0.4477239153175638, 0.7465028874072831, 0.6837784711134388, 0.6933476918722772, 0.7516101703450492, 0.7017578175241334, 0.49024753813947014, 0.7078991440656646, 0.9055247758216217, 0.7937297573939534, 0.643635161619314, 0.483370157498409, 0.625245288476125, 0.9434688257359253, 0.7460009405407354, 0.8626117567614069, 0.5123399419316861, 0.6777935360393974, 0.7213034840190814, 0.6806997829383258, 0.6339569981497631, 0.4970659021296889, 0.7350473755002135, 0.7674773940459682, 0.772185629016072, 0.6756610759459281, 0.5788703279499635, 0.7117699054798854, 0.7693474697398781, 0.6801607507940417, 0.5638528406024998, 0.6027105625581122, 0.7353528455987256, 0.6537801364258787, 0.5815787209027313, 0.7682518803011859, 0.6606161736059452, 0.4253134336025185, 0.5807113150870175, 0.7831035858688931, 0.796756664495127, 0.5083601018132008, 0.7645337977685206, 0.8021001634984939, 0.6214070189277792, 0.7404344938441689, 0.8836944268814474, 0.6846152457585859, 0.6548754111643598, 0.7421158913980291, 0.7303089637949686, 0.6814647010763684, 0.5268225021256252, 0.5826710747485451, 0.34542344444480155, 0.4508270772178673, 0.5139424568712392)
glm.summary
// Estimate	 S.E.	 z-stat	p-value		Variable
// ---------------------------------------------------------
//   0.5984	 0.273	 2.194	0.0282 *	(Intercept)
//   0.5595	 0.264	 2.121	0.0339 *	V1
//   0.0016	 0.114	 0.014	0.9888  	V2
//   0.1396	 0.077	 1.808	0.0706  	V3
glm.plots
// res24: breeze.plot.Figure = breeze.plot.Figure@5de23925
```

![Logistic regression plots](glm-plots.png)


### Poisson regression

We first create an appropriate response, and then do Poisson regression.
```scala
val yp = DenseVector.tabulate(100)(i => Poisson(math.exp(-0.5 + X(i,0))).sample().toDouble)
// yp: DenseVector[Double] = DenseVector(7.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 1.0, 1.0, 2.0, 0.0, 2.0, 4.0, 0.0, 0.0, 1.0, 0.0, 2.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 2.0, 5.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 2.0, 1.0, 1.0, 2.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 0.0)

import scalaglm.PoissonGlm
val pglm = Glm(yp, X, List("V1","V2","V3"), PoissonGlm)
// pglm: Glm = Glm(
//   y = DenseVector(7.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 3.0, 1.0, 1.0, 1.0, 2.0, 0.0, 2.0, 4.0, 0.0, 0.0, 1.0, 0.0, 2.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 5.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 2.0, 5.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 2.0, 1.0, 1.0, 2.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 0.0),
//   Xmat = 2.2666512668956074     0.9012275365045993    4.204892784830352      
// 0.7743143320028836     1.436631117806304     0.5680528698293128     
// -1.3684299805494715    0.11493766687987306   1.3496321381825458     
// 0.8946363540210884     0.9090046951036983    -2.1415792524670048    
// 0.782469851327486      1.9444803172621064    2.588351092053796      
// -1.653391053822999     0.6717458863399826    2.833046654813368      
// -1.4105151405581036    -2.062389901169743    3.0545200772952246     
// -0.5713795350138204    -0.4028269945421026   -0.8389378870373729    
// -0.20905788285091823   0.3223408612816919    6.1143775131108296     
// 0.8787913387612921     0.3465839114146322    1.5716251962342844     
// 0.4389770971802636     1.3578938167360268    0.866900473410408      
// 0.8043883590728809     0.49411568501034786   4.093120754911311      
// -0.06573765951106819   -0.22425376830849997  2.984345038670531      
// 0.447575965631879      0.7825370234553404    -4.932643487568863     
// -0.11830066533467896   0.3777668853061865    4.844758348782789      
// 2.3396423510925596E-5  0.7637363146388284    1.3422092213267767     
// 0.1858679348422991     2.7783411257057375    4.356302936582773      
// -0.3666146735390753    -1.7664905632682926   -0.4257723305792611    
// -1.3562056670924034    0.6951527390416818    4.805930717377921      
// -0.749246864229255     -2.812860926424742    5.526715937833739      
// -0.8169363629473156    5.394721552354266     4.509022062616143      
// 2.2968313647666094     0.9926921718839201    5.622904523070551      
// -0.7892325074514942    -1.240431545770531    1.8610428422100236     
// -0.636483228727806     1.0000226723122312    0.3632051040818849     
// 0.38727452399362156    -0.2847349763038458   6.2971453563601525     
// -0.08224414569538584   2.1478270048098054    9.942420225602795      
// 0.6751304901264232     -0.21666338181389344  -0.4994828754101577    
// 0.5115609761522696     1.3617113299282118    0.07748379759163937    
// -0.2907902113974128    -4.624479191074093    4.665685314652599      
// -1.1793786467161078    1.9939918466644313    6.702079414098843      
// -0.4092710969067736    -0.3099183696517718   3.420610314511869      
// -0.8796044371662024    2.4126706655632013    -1.56701856216195      
// -0.3348090739910293    0.90494233068439      3.3005044738205034     
// 0.24062584479220092    -2.338087239889516    3.813701641072014      
// 0.5058242344875782     1.6684489523084958    -3.079873661749497     
// -1.1531380310652346    2.9741913609996935    -1.0648242423139669    
// -0.6236646231046656    -1.0687778460023072   -3.3806472384475548    
// 0.013374089593112056   -0.6035960379392991   3.0949808687770206     
// 0.5135942599709565     -0.04094168481097005  0.5061460268591591     
// -0.26987026244226525   3.4406417043376583    2.479207389489825      
// 0.3422050302468517     -0.9187849865920568   6.067648231035356      
// ...
pglm.coefficients
// res26: DenseVector[Double] = DenseVector(-0.5782329621469999, 0.7939592216857086, 0.04645581217557239, 0.03782139236818776)
pglm.summary
// Estimate	 S.E.	 z-stat	p-value		Variable
// ---------------------------------------------------------
//  -0.5782	 0.162	-3.563	0.0004 *	(Intercept)
//   0.7940	 0.125	 6.358	0.0000 *	V1
//   0.0465	 0.049	 0.951	0.3414  	V2
//   0.0378	 0.036	 1.061	0.2887  	V3
pglm.plots
// res28: breeze.plot.Figure = breeze.plot.Figure@683f4dbc
```
![Poisson regression plots](pglm-plots.png)


## Non-linear response

The above covers the main functionality of the library based on a linear reponse to variation in covariate values. For flexible modelling of a nonlinear response, see the documentation on [flexible regression modelling](FlexibleRegression.md).


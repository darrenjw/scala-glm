# scala-glm - Quickstart Guide

## PCA

This library contains code for principal components analysis based on a thin SVD of the centred data matrix. This is more numerically stable than a construction from the spectral decomposition of the covariance matrix. It is analogous to the R function `prcomp` rather than the R function `princomp`. First create some synthetic data.

```scala
import breeze.linalg.*
import breeze.numerics.*
import breeze.stats.distributions.*
import breeze.stats.distributions.Rand.VariableSeed.randBasis

val X = DenseMatrix.tabulate(100, 3)((i, j) => 
	Gaussian(j, j+1).sample())
```
Now we can do PCA.
```scala
import scalaglm.Pca
val pca = Pca(X, List("V1", "V2", "V3"))
```
```scala
pca.sdev
// res0: DenseVector[Double] = DenseVector(3.4666890108608888, 2.034068758241888, 0.961351795516373)
pca.loadings
// res1: DenseMatrix[Double] = 0.027632226947432892  -0.009072878622531168  -0.9995769819815913    
// -0.09922418679387945  0.9949954412232405     -0.011774238831532047  
// 0.9946813664631597    0.0995075616145299     0.02659369084034148    
pca.scores
// res2: DenseMatrix[Double] = 1.4219888094671482    -4.123823255016634     -1.8588508680381859    
// 0.5354312234195918    -2.369552949700884     -0.25839693646960415   
// -4.728066312374986    0.3330965080785161     0.6862077342724677     
// 1.4660315149169394    2.1977236540264404     0.41757275448793996    
// 1.048061470583703     1.432227808247207      -1.2021030210051715    
// 0.8351267769549353    -0.9298924243508103    1.2616850826492059     
// -0.8819518803762281   1.9071488974904196     -1.0439135063168872    
// -11.041162619653031   -1.3599795440207678    0.012667474761451192   
// -1.9646006741079851   -0.65797194465627      -0.1631315781717991    
// 2.768835755190461     -0.33425362909092293   0.3602352106403498     
// 1.9306711104346488    0.9795524246611313     0.4192877543307554     
// 4.316804385638006     3.345480814261675      -0.943702366899454     
// 2.8148228599588383    0.36447865755499315    1.3115135653585992     
// -2.968049059711032    -1.4130471527464152    1.7072364856189282     
// 0.5477128113333862    -1.892929803690512     -1.28034745408643      
// 1.4317437603570968    1.109159624732859      0.26436041940197963    
// 3.097740983690187     -2.119985660039549     0.1547750621362835     
// 0.9251544919509267    0.9133363220319848     0.4930411516329891     
// -2.96518428304278     -1.3689812150804894    -0.9264082650349823    
// 4.622207647265434     1.2738071298531        2.013168921849025      
// 3.5649962418512278    -4.246272186196981     -1.1416859220927376    
// 0.09640477917903445   -3.8766733924228474    1.1423954682067825     
// -4.06585381019471     4.457189579246496      0.10296899212538829    
// 1.4039069117686838    0.8695809095275738     -0.7669207352148653    
// 1.8218476381992108    1.1395999282610176     1.0125738644548208     
// 1.754178668964943     0.43231230009445143    -0.5404686278918587    
// 1.4758964811820932    1.5703602865564614     -1.0951730976994778    
// -6.4409221780282495   0.5441266675094553     -0.1500771362059127    
// -3.906038610177396    1.0591093867865558     0.42362336189969063    
// -1.1676655519251495   -3.3290306685830733    0.5573706309462814     
// 2.4760557256496893    -2.266876272777311     -0.3588041388597605    
// 1.0048776504486563    -1.435297737600422     -1.0633317287338697    
// 6.026953989336412     -2.1897259355095553    0.6930781107310158     
// -0.14849631773253674  1.2197245749458583     -0.7513746082056013    
// -1.3555361710864033   3.1322751059756846     -0.8676221017139193    
// 3.7360917459470246    -0.2475798966915786    1.1036223377705034     
// 3.822985917150053     1.9059211367962166     0.224979865496959      
// 2.034913313907361     -1.4967308696164348    0.8071416452687618     
// -4.91956985437675     2.3675601330536384     -0.10819957090630623   
// -0.46459396977745593  1.3777268936293925     0.5520454197972073     
// -1.6922630001118555   -1.6256857779825942    1.00549828245777       
// 1.090801718950259     0.5177709716091825     0.11071087263054905    
// -5.360448025884403    -2.0851639938908777    -0.0982994165854548    
// -1.3506206939758993   1.987814809547554      -0.7218535981743475    
// -1.9751835039316232   -0.4836936723872362    1.120955569731824      
// 3.9489295688317716    1.1378697707037322     -0.15763826807681697   
// -6.409601089893614    -0.011435897991166288  1.3636342974262634     
// 3.346535505806571     1.0483858126659733     0.5494015141546442     
// -3.8762549640392265   -0.610381656790606     -0.9939257810405719    
// ...
pca.plots
// res3: Figure = breeze.plot.Figure@323b1180
pca.summary
// Standard deviations:
// V1	V2	V3
//  3.467	 2.034	 0.961
// Cumulative proportion of variance explained:
// V1	V2	V3
//  0.704	 0.946	 1.000
// Loadings:
// PC01	PC02	PC03	
//  0.028	-0.009	-1.000	V1
// -0.099	 0.995	-0.012	V2
//  0.995	 0.100	 0.027	V3
```
The final line prints a readable summary of the PCA to the console. `plots` produces some diagnostic plots, including a "scree plot".

![PCA Plots](pca-plots.png)

Note that there is also a utility function `pairs` for producing a "scatterplot matrix":
```scala
import scalaglm.Utils.pairs
pairs(X, List("V1", "V2", "V3"))
// res6: Figure = breeze.plot.Figure@38f1023d
```

![Pairs plots](pairs-plots.png)


## Linear regression

This code computes regression coefficients and associated diagnostics via the QR decomposition of the covariate matrix. The diagnostics are analogous to those produced by the R function `lm`. We start by creating a synthetic response variable.

```scala
val y = DenseVector.tabulate(100)(i => 
	Gaussian(2.0 + 1.5*X(i,0) + 0.5*X(i,1), 3.0).sample())
```
So we can now do linear regression and generate all of the usual diagnostics.
```scala
import scalaglm.Lm
val lm = Lm(y,X,List("V1", "V2", "V3"))
```
```scala
lm.coefficients
// res8: DenseVector[Double] = DenseVector(2.070832677923739, 1.4686768962634704, 0.38286411892595024, 0.08830414972268963)
lm.se
// res9: DenseVector[Double] = DenseVector(0.36588204956661197, 0.31678182572538455, 0.14932855156263578, 0.08907456386441576)
lm.fitted
// res10: DenseVector[Double] = DenseVector(3.833208355828311, 2.0603516979783176, 1.2129162693344409, 2.8698509536510404, 4.925186584843943, 0.39450723663620646, 4.696851829613131, 0.9949946985365135, 2.338474382172298, 2.118898161705327, 2.450814271720991, 5.561034937922506, 0.98748248442906, -0.7863267175521336, 3.7433551512800842, 2.6822592601777933, 1.7785438791184465, 2.226529729688891, 3.1025437874593664, 0.4616163554674439, 2.926518267475162, -0.6061098547530708, 3.6826345276025085, 4.1057674913566755, 1.628958780003405, 3.6399162902643476, 4.8586592426167705, 2.366978844631831, 1.9465844726652692, 0.34583342714939935, 2.422107054809359, 3.6378930168654624, 1.225754270445898, 4.074328263172142, 4.855989858974064, 1.1460508923255732, 3.256301102043746, 0.9579145452778635, 3.12934087304533, 2.188909875600261, 0.2807068804834933, 2.6547219631195933, 1.3988685684010989, 4.211337147129361, 0.5152329898748111, 3.541118824076447, -0.06478966793519547, 2.4134622864398434, 3.4049671868520868, 3.1248683957322267, 3.656588884115574, 3.5469961632054856, 0.9483102994297373, 5.236046961538066, 3.5899204523187205, -1.3395311333059126, -0.5308330041414211, 2.0694316509741046, 1.2538271173233888, 2.388353296719985, 2.0846801615267063, 3.8993455475740233, 6.463529286712657, 0.7003500150552235, 4.0481254777951765, 0.9709000466536559, 2.8575305514694134, 4.052972866720064, 2.3255969681052457, 2.9778360341097763, 3.1489154036977873, 2.068704145367562, 0.8320490998662325, 0.5841317044902679, 3.9799226845119304, 3.232104444487656, 4.8142561741119545, 3.9125966345252787, 2.876038167283637, 1.4850644594324869, 2.3370344765169326, 1.5040556633340785, 0.9121408283509918, 2.6315146025463187, 2.6235165258956865, 4.017232241255616, 3.8732839035147264, 0.3013358612366869, 2.000217627238837, 1.9254820599424078, 7.521902451065997, 1.553139471860976, 3.372842280277857, 3.2070504741985517, 0.44082636926148133, 3.2192141052103755, 3.4354717520249434, 6.245658163210088, 0.6823479479460324, 1.5338275314648335)
lm.residuals
// res11: DenseVector[Double] = DenseVector(-2.7833090344754017, 2.2791363958139037, -0.7604379052962809, 1.1551655192168973, -2.300356216959047, -2.73283290040962, 2.2866786916274133, -2.640641768123026, -3.810793860543022, -0.9282769678689329, -6.3677663084913005, -1.1630412453237504, -3.086760948343915, 5.132047884284276, -4.79914376397217, -2.4601298755770546, 1.372376678530268, -2.7865326792913754, 3.248399141471934, -0.1884021797483305, -3.151708875617386, 5.08999501546422, -7.572708075048139, -1.5417489929211339, -2.7426488894202565, -3.2601749892717398, -1.9985386855334006, 4.2274209228577195, -6.951208137382769, 1.43359806090904, 2.5087407935295984, 2.821886331154197, -0.1993827213820727, 2.9851915355221914, 5.787045498526171, 4.841616325538706, 0.28356730585580525, -2.220640253397029, 2.3903344724420426, 1.2825075839873352, -3.846940476303472, 0.48571223568394606, 1.7231843156513973, -4.170826954216891, 1.8387220830804694, 5.501379111300439, -0.9614342938155439, -1.2570741036420614, 1.4048794487117737, -0.47639469907030385, -1.3187158781344586, 1.0970115874190656, 2.1339153358202845, -2.4977416122909606, 1.6979414346878468, -0.9540225108050602, -1.634342329248996, -1.945670167846799, -0.38098133417145397, 3.500479884473978, 0.4237836356904685, 0.7386887691373247, -0.14455258300452822, -2.911482109658912, 1.183247200961862, -1.0507060806986952, -2.26979950281336, -1.5289968004483656, -1.0050300256236144, 0.6090398182498196, 0.47724737565730946, 3.9924061825766337, 2.9249498362829134, 0.9472465681742521, 2.2545974444789993, -2.2880553401925408, -0.09217889785870614, 1.8936799431966453, -0.08412057637196169, -0.7893539995399266, 4.33043681133071, 2.469187330258696, -1.7570674940955204, -5.19368907685394, -6.719957787556158, 0.8521379094344583, 6.701029518743439, -0.7250355170168351, 5.166320613774064, 0.8766910265906172, -0.4736576330699158, 5.984906435326468, 1.906018753075665, 2.8864608624760177, -1.5151873500875785, -2.866136556394459, 1.4163526760577065, 3.0399729383633662, 0.34938143274338485, -2.6263797109136364)
lm.studentised
// res12: DenseVector[Double] = DenseVector(-0.963048259184956, 0.7613234673730609, -0.2552668274261666, 0.3860352700127933, -0.7712026335054316, -0.91542203992652, 0.7665060591146765, -0.9270367010255111, -1.2664270555370976, -0.3090469228211273, -2.1191947156256288, -0.396308453529549, -1.037023178611582, 1.7407998332193342, -1.6132609565106582, -0.8179388207769801, 0.45951905041306407, -0.9264241151934841, 1.088824055764841, -0.06466555747192308, -1.0833700218018643, 1.7328004704010256, -2.593999137405739, -0.5137574866096665, -0.9173260592836071, -1.084346477754509, -0.6697528327474382, 1.4277004183047033, -2.325377824847782, 0.4830880406153303, 0.8399290260421252, 0.9443476018903864, -0.06775112773663962, 0.9947004563912454, 1.9522622985482636, 1.6260843605511401, 0.0950660065181481, -0.742313080736688, 0.8065617499167876, 0.42698178775355144, -1.2884930286962344, 0.1611858463418238, 0.5816659691187412, -1.394795989241854, 0.6151241298204925, 1.8394380338706293, -0.32798398977882975, -0.42006783689445126, 0.47162706120401726, -0.1592620079316262, -0.4383019894005067, 0.36563719035315984, 0.7137260291660401, -0.8402134943146992, 0.5750771493952018, -0.330624221608381, -0.554288186818807, -0.6485135373396453, -0.13088467950317859, 1.1779059382765076, 0.14629099403980317, 0.25047431091233324, -0.04976444330402879, -0.992501058672222, 0.39490322815978063, -0.35701234970320755, -0.7702134514242666, -0.5158894406936649, -0.33973971939151343, 0.20438890887948954, 0.15878262145454863, 1.3283142369282503, 0.992390157023912, 0.31947469594365707, 0.7646959339280777, -0.7619756119457234, -0.031020305961553075, 0.634748356982197, -0.02800812266735156, -0.26272251428576854, 1.4395685754626906, 0.8265278541698758, -0.5879244559320594, -1.7462546935957275, -2.2405369990992545, 0.28602049273540076, 2.2662195272275434, -0.25217700356619294, 1.7188201737066031, 0.29435251613024804, -0.1657666188166734, 1.9952637646213944, 0.6347471117125122, 0.9658271839236634, -0.5091172902510951, -0.9530791401984413, 0.47555199695546696, 1.0885764181538211, 0.11746307850869007, -0.8759179972722843)
val pred = lm.predict()
// pred: PredictLm = PredictLm(
//   mod = Lm(
//     y = DenseVector(1.0498993213529095, 4.339488093792221, 0.45247836403816, 4.025016472867938, 2.624830367884896, -2.3383256637734133, 6.983530521240544, -1.6456470695865124, -1.472319478370724, 1.1906211938363942, -3.9169520367703097, 4.397993692598756, -2.099278463914855, 4.345721166732142, -1.0557886126920861, 0.2221293846007386, 3.1509205576487145, -0.5600029496024845, 6.350942928931301, 0.2732141757191134, -0.2251906081422237, 4.483885160711149, -3.8900735474456303, 2.5640184984355416, -1.1136901094168514, 0.37974130099260783, 2.86012055708337, 6.59439976748955, -5.0046236647175, 1.7794314880584392, 4.930847848338957, 6.4597793480196595, 1.0263715490638252, 7.059519798694334, 10.643035357500235, 5.98766721786428, 3.5398684078995513, -1.2627257081191658, 5.519675345487372, 3.471417459587596, -3.5662335958199787, 3.1404341988035394, 3.122052884052496, 0.04051019291246938, 2.3539550729552805, 9.042497935376886, -1.0262239617507394, 1.156388182797782, 4.8098466355638605, 2.648473696661923, 2.3378730059811152, 4.644007750624551, 3.0822256352500217, 2.7383053492471054, 5.287861887006567, -2.2935536441109727, -2.165175333390417, 0.12376148312730573, 0.8728457831519348, 5.888833181193963, 2.508463797217175, 4.638034316711348, 6.318976703708128, -2.2111320946036885, 5.2313726787570385, -0.07980603404503916, 0.5877310486560532, 2.5239760662716986, 1.3205669424816313, 3.586875852359596, 3.626162779355097, 6.061110327944196, 3.756998936149146, 1.53137827266452, 6.23452012899093, 0.9440491042951153, 4.722077276253248, 5.806276577721924, 2.7919175909116754, 0.6957104598925603, 6.6674712878476425, 3.9732429935927747, -0.8449266657445287, -2.5621744743076214, -4.0964412616604715, 4.869370150690075, 10.574313422258166, -0.42369965578014823, 7.166538241012901, 2.802173086533025, 7.048244817996081, 7.538045907187444, 5.278861033353522, 6.0935113366745695, -1.0743609808260972, 0.3530775488159166, 4.85182442808265, 9.285631101573454, 1.0317293806894172, -1.0925521794488031),
//     Xmat = 1.91189651189346       -3.309571459539889    2.508756433472754     
// 0.2717057592046905     -1.4949566743850542   1.8440392598897812    
// -0.8424622956773962    1.7053114770160205    -3.0974090793673286   
// -0.4197017722028229    2.9491656393910173    3.2421451165021415    
// 1.1946846590258369     2.248043949728821     2.7071523197894924    
// -1.2525138474842987    -0.11013587107458367  2.3258225423019363    
// 0.9789225930293046     2.910229712590339     0.8388690851622385    
// -0.32829079221657287   0.655050794652233     -9.563314131906495    
// 0.09187028439027256    0.45500057782859293   -0.4698471743403334   
// -0.30341677816936563   0.30126520005095025   4.2845445160303886    
// -0.3975247001122035    1.6909671407079965    3.5831418237970816    
// 1.0093572468166063     3.824341140019695     6.155764957640878     
// -1.259361512113814     0.9807370282817609    4.425114180775048     
// -1.798583387815549     -0.21875162223664035  -1.4933542884537596   
// 1.2892389970107097     -1.0099047580281106   1.876505697487121     
// -0.2576252864001277    1.8712555259527284    3.095644892255109     
// -0.07275342912291682   -1.5057462469605434   4.428542634385386     
// -0.49843079113780564   1.723985599118731     2.5783455518563136    
// 0.833626638909967      -0.14418130798946027  -1.5561581887575553   
// -1.91902821597871      1.6979169693040035    6.332030815349926     
// 1.2553619716540483     -3.6524898289737076   4.6472534629472       
// -1.1269514425412959    -2.9674658666830385   1.2946301962459104    
// ...
pred.fitted
// res13: DenseVector[Double] = DenseVector(3.8332083558283094, 2.0603516979783163, 1.2129162693344415, 2.8698509536510395, 4.925186584843943, 0.3945072366362058, 4.69685182961313, 0.9949946985365129, 2.338474382172298, 2.1188981617053266, 2.4508142717209904, 5.561034937922505, 0.9874824844290598, -0.7863267175521343, 3.7433551512800833, 2.6822592601777933, 1.7785438791184462, 2.2265297296888904, 3.102543787459366, 0.46161635546744395, 2.9265182674751617, -0.606109854753071, 3.682634527602508, 4.105767491356675, 1.6289587800034049, 3.639916290264347, 4.85865924261677, 2.366978844631831, 1.9465844726652695, 0.345833427149399, 2.4221070548093575, 3.637893016865461, 1.225754270445898, 4.074328263172142, 4.8559898589740635, 1.1460508923255728, 3.2563011020437456, 0.9579145452778635, 3.1293408730453294, 2.1889098756002605, 0.28070688048349296, 2.6547219631195933, 1.3988685684010989, 4.21133714712936, 0.5152329898748107, 3.5411188240764466, -0.06478966793519542, 2.413462286439843, 3.4049671868520863, 3.1248683957322267, 3.6565888841155734, 3.546996163205485, 0.948310299429737, 5.236046961538065, 3.5899204523187205, -1.3395311333059128, -0.5308330041414215, 2.069431650974104, 1.2538271173233886, 2.3883532967199845, 2.0846801615267063, 3.8993455475740233, 6.463529286712657, 0.7003500150552229, 4.0481254777951765, 0.9709000466536554, 2.8575305514694134, 4.052972866720063, 2.3255969681052444, 2.9778360341097754, 3.1489154036977873, 2.068704145367561, 0.8320490998662324, 0.5841317044902681, 3.97992268451193, 3.2321044444876557, 4.8142561741119545, 3.9125966345252783, 2.8760381672836366, 1.4850644594324869, 2.3370344765169326, 1.504055663334078, 0.9121408283509915, 2.6315146025463187, 2.6235165258956865, 4.017232241255616, 3.8732839035147264, 0.30133586123668643, 2.000217627238837, 1.9254820599424076, 7.521902451065999, 1.5531394718609757, 3.3728422802778564, 3.207050474198551, 0.4408263692614809, 3.2192141052103747, 3.435471752024943, 6.245658163210087, 0.6823479479460317, 1.533827531464833)
pred.se
// res14: DenseVector[Double] = DenseVector(0.9143353093330848, 0.47619658520322194, 0.5606350885128507, 0.4840954983303467, 0.539916867125135, 0.5258682107656691, 0.53752212915569, 1.0367696341955763, 0.366169176872191, 0.40820870514415125, 0.3998189134228438, 0.759156877459088, 0.5734122350164514, 0.705284998144097, 0.5824225431267073, 0.3772730331284608, 0.518868938014625, 0.37632905496484664, 0.5366778481965603, 0.8368437513498158, 0.8517215022680831, 0.7484390527114503, 0.8162657198155151, 0.42794918948621363, 0.4996236046097409, 0.3862386015451461, 0.5333706105478778, 0.6489882150713315, 0.5028963552754225, 0.6182467016103637, 0.5171483127856316, 0.5093630957456249, 0.7267917634059455, 0.4267664346729344, 0.6338538674091804, 0.56866771987141, 0.5397530267774754, 0.4894367876367411, 0.6369633983524287, 0.40833899633007964, 0.5242390363704544, 0.3291219693752807, 0.6421150791247054, 0.4969382059376208, 0.5034458246695509, 0.4938233914164803, 0.7719598187682921, 0.4830628678646548, 0.5616922118709406, 0.4909651356636712, 0.3694272483470251, 0.4325104898073041, 0.4996579278233667, 0.5928622762382091, 0.6864268799746815, 0.9287012889983012, 0.7034224890236189, 0.43302188976149847, 0.8460802211757998, 0.5976765641715073, 0.8927172883025221, 0.7008302941425121, 0.8667259592480768, 0.7638069863805327, 0.4592529871148223, 0.7260500988089956, 0.7099627838892831, 0.6360455637070833, 0.6614761042700181, 0.5562801830206939, 0.3932991897166773, 0.39365281621599285, 0.7082824987496326, 0.6304011684136815, 0.704195428251996, 0.41465458115212933, 0.5987486704768706, 0.5369330969662299, 0.4099813877353891, 0.4019828384289147, 0.373826245782831, 0.5138264531572618, 0.5069641170291409, 0.5855891797412435, 0.4394693079210069, 0.559052315529846, 0.6673317027934421, 0.9604553004461438, 0.3927524006670195, 0.5639257416758181, 1.0119814483390575, 0.437455504264586, 0.41460536130857606, 0.5069912919091086, 0.5757567903101836, 0.3810794180347154, 0.5641216961925276, 1.1789901720336777, 0.5845418362263316, 0.4451044152670087)
val predNew = lm.predict(DenseMatrix((1.1, 1.6, 1.0), (1.4, 2.2, 3.0)))
// predNew: PredictLm = PredictLm(
//   mod = Lm(
//     y = DenseVector(1.0498993213529095, 4.339488093792221, 0.45247836403816, 4.025016472867938, 2.624830367884896, -2.3383256637734133, 6.983530521240544, -1.6456470695865124, -1.472319478370724, 1.1906211938363942, -3.9169520367703097, 4.397993692598756, -2.099278463914855, 4.345721166732142, -1.0557886126920861, 0.2221293846007386, 3.1509205576487145, -0.5600029496024845, 6.350942928931301, 0.2732141757191134, -0.2251906081422237, 4.483885160711149, -3.8900735474456303, 2.5640184984355416, -1.1136901094168514, 0.37974130099260783, 2.86012055708337, 6.59439976748955, -5.0046236647175, 1.7794314880584392, 4.930847848338957, 6.4597793480196595, 1.0263715490638252, 7.059519798694334, 10.643035357500235, 5.98766721786428, 3.5398684078995513, -1.2627257081191658, 5.519675345487372, 3.471417459587596, -3.5662335958199787, 3.1404341988035394, 3.122052884052496, 0.04051019291246938, 2.3539550729552805, 9.042497935376886, -1.0262239617507394, 1.156388182797782, 4.8098466355638605, 2.648473696661923, 2.3378730059811152, 4.644007750624551, 3.0822256352500217, 2.7383053492471054, 5.287861887006567, -2.2935536441109727, -2.165175333390417, 0.12376148312730573, 0.8728457831519348, 5.888833181193963, 2.508463797217175, 4.638034316711348, 6.318976703708128, -2.2111320946036885, 5.2313726787570385, -0.07980603404503916, 0.5877310486560532, 2.5239760662716986, 1.3205669424816313, 3.586875852359596, 3.626162779355097, 6.061110327944196, 3.756998936149146, 1.53137827266452, 6.23452012899093, 0.9440491042951153, 4.722077276253248, 5.806276577721924, 2.7919175909116754, 0.6957104598925603, 6.6674712878476425, 3.9732429935927747, -0.8449266657445287, -2.5621744743076214, -4.0964412616604715, 4.869370150690075, 10.574313422258166, -0.42369965578014823, 7.166538241012901, 2.802173086533025, 7.048244817996081, 7.538045907187444, 5.278861033353522, 6.0935113366745695, -1.0743609808260972, 0.3530775488159166, 4.85182442808265, 9.285631101573454, 1.0317293806894172, -1.0925521794488031),
//     Xmat = 1.91189651189346       -3.309571459539889    2.508756433472754     
// 0.2717057592046905     -1.4949566743850542   1.8440392598897812    
// -0.8424622956773962    1.7053114770160205    -3.0974090793673286   
// -0.4197017722028229    2.9491656393910173    3.2421451165021415    
// 1.1946846590258369     2.248043949728821     2.7071523197894924    
// -1.2525138474842987    -0.11013587107458367  2.3258225423019363    
// 0.9789225930293046     2.910229712590339     0.8388690851622385    
// -0.32829079221657287   0.655050794652233     -9.563314131906495    
// 0.09187028439027256    0.45500057782859293   -0.4698471743403334   
// -0.30341677816936563   0.30126520005095025   4.2845445160303886    
// -0.3975247001122035    1.6909671407079965    3.5831418237970816    
// 1.0093572468166063     3.824341140019695     6.155764957640878     
// -1.259361512113814     0.9807370282817609    4.425114180775048     
// -1.798583387815549     -0.21875162223664035  -1.4933542884537596   
// 1.2892389970107097     -1.0099047580281106   1.876505697487121     
// -0.2576252864001277    1.8712555259527284    3.095644892255109     
// -0.07275342912291682   -1.5057462469605434   4.428542634385386     
// -0.49843079113780564   1.723985599118731     2.5783455518563136    
// 0.833626638909967      -0.14418130798946027  -1.5561581887575553   
// -1.91902821597871      1.6979169693040035    6.332030815349926     
// 1.2553619716540483     -3.6524898289737076   4.6472534629472       
// -1.1269514425412959    -2.9674658666830385   1.2946301962459104    
// ...
predNew.fitted
// res15: DenseVector[Double] = DenseVector(4.387264003817767, 5.234193843497757)
predNew.se
// res16: DenseVector[Double] = DenseVector(0.4846186608773111, 0.5892506213111149)
lm.plots
// res17: Figure = breeze.plot.Figure@50c5b440
lm.summary
// Estimate	 S.E.	 t-stat	p-value		Variable
// ---------------------------------------------------------
//   2.0708	 0.366	 5.660	0.0000 *	(Intercept)
//   1.4687	 0.317	 4.636	0.0000 *	V1
//   0.3829	 0.149	 2.564	0.0119 *	V2
//   0.0883	 0.089	 0.991	0.3240  	V3
// 
// Residual standard error:   3.0313 on 96 degrees of freedom
// Multiple R-squared: 0.2314, Adjusted R-squared: 0.2074
// F-statistic: 9.6326 on 3 and 96 DF, p-value: 0.00001
//
```
The plots include a plot of studentised residuals against fitted values and a normal Q-Q plot for the studentised residuals.

![Linear model plots](lm-plots.png)


## Generalised linear models

The current implementation supports only simple one-parameter exponential family observation models. This includes the most commonly used cases of **logistic regression** (`LogisticGlm`) and **Poisson regression** (`PoissonGlm`).

### Logistic regression

Again, we start by creating an appropriate response variable.
```scala
val ylb = (0 until 100) map (i => Bernoulli(sigmoid(1.0 + X(i,0))).sample())
val yl = DenseVector(ylb.toArray map {b => if (b) 1.0 else 0.0})
```

Then we can do logistic regression in a typical way.
```scala
import scalaglm.{Glm, LogisticGlm}
val glm = Glm(yl, X, List("V1","V2","V3"), LogisticGlm)
```
```scala
glm.coefficients
// res20: DenseVector[Double] = DenseVector(0.8591610044468522, 0.6136335387304652, 0.19504713094295445, -0.05201333117074533)
glm.fitted
// res21: DenseVector[Double] = DenseVector(0.7783977668389049, 0.6543887795561887, 0.6976053437788128, 0.7326695895000022, 0.8687471033800698, 0.48703316716860773, 0.8790920732185682, 0.7829423988235665, 0.736667775713641, 0.6245442994505377, 0.6810657024281193, 0.8703753274888907, 0.5118726571812265, 0.44781507534263565, 0.7950597758687727, 0.7119844720165689, 0.5721142088083859, 0.680366643846052, 0.8058898187813132, 0.4215057341488541, 0.6627037465839284, 0.3826045177206248, 0.8716943054816109, 0.8174227519583983, 0.6053521440914585, 0.7790475890269595, 0.861297388349769, 0.815080266405251, 0.7477311202855205, 0.5128249874351956, 0.648878565439376, 0.7826092546891584, 0.44694176477802783, 0.8372107173405583, 0.8933395049125323, 0.5034250049638626, 0.720302510341142, 0.5149286118424191, 0.8467653572703481, 0.7067013659467738, 0.5288333550898512, 0.7129777095157651, 0.7131847962459876, 0.8611998297806096, 0.5668210616831555, 0.7377749139401493, 0.6096349081123241, 0.6489345351754535, 0.8393736881584221, 0.6898954065691204, 0.803091376707906, 0.8310632412099017, 0.5099796633541026, 0.8752015966382486, 0.8085195360412051, 0.24566572888583754, 0.46335229867141103, 0.6528837322622032, 0.6986086972910691, 0.5902792830428457, 0.8338224913658592, 0.8320664475664883, 0.8949458789345569, 0.4444877780759999, 0.8004530311689604, 0.524939829158253, 0.7993832904281246, 0.8866683785700606, 0.6421683637634897, 0.8327348843674132, 0.8040871552428677, 0.6350090256498206, 0.6166500623258786, 0.4741203026418571, 0.7140981471505573, 0.7449477010648409, 0.8687081136045738, 0.7826125042101991, 0.7202902782760795, 0.5844136451905698, 0.7154802759098092, 0.6814301875585868, 0.5081097116057384, 0.7924293872530243, 0.7866227135752394, 0.7809166853633364, 0.8798747320091199, 0.7133655476418453, 0.7219584513481498, 0.6138446228709302, 0.9424985967309943, 0.6958841119715232, 0.7373365762284528, 0.7800002420447827, 0.5164627856869074, 0.7760839974671712, 0.8105860104551229, 0.9224998140426074, 0.5348116836402429, 0.5689220112617634)
glm.predict(response=true).fitted
// res22: DenseVector[Double] = DenseVector(0.7783977668389049, 0.6543887795561887, 0.6976053437788128, 0.7326695895000022, 0.8687471033800698, 0.48703316716860773, 0.8790920732185682, 0.7829423988235665, 0.736667775713641, 0.6245442994505377, 0.6810657024281193, 0.8703753274888907, 0.5118726571812265, 0.44781507534263565, 0.7950597758687727, 0.7119844720165689, 0.5721142088083859, 0.680366643846052, 0.8058898187813132, 0.4215057341488541, 0.6627037465839284, 0.3826045177206248, 0.8716943054816109, 0.8174227519583983, 0.6053521440914585, 0.7790475890269595, 0.861297388349769, 0.815080266405251, 0.7477311202855205, 0.5128249874351956, 0.648878565439376, 0.7826092546891584, 0.44694176477802783, 0.8372107173405583, 0.8933395049125323, 0.5034250049638626, 0.720302510341142, 0.5149286118424191, 0.8467653572703481, 0.7067013659467738, 0.5288333550898512, 0.7129777095157651, 0.7131847962459876, 0.8611998297806096, 0.5668210616831555, 0.7377749139401493, 0.6096349081123241, 0.6489345351754535, 0.8393736881584221, 0.6898954065691204, 0.803091376707906, 0.8310632412099017, 0.5099796633541026, 0.8752015966382486, 0.8085195360412051, 0.24566572888583754, 0.46335229867141103, 0.6528837322622032, 0.6986086972910691, 0.5902792830428457, 0.8338224913658592, 0.8320664475664883, 0.8949458789345569, 0.4444877780759999, 0.8004530311689604, 0.524939829158253, 0.7993832904281246, 0.8866683785700606, 0.6421683637634897, 0.8327348843674132, 0.8040871552428677, 0.6350090256498206, 0.6166500623258786, 0.4741203026418571, 0.7140981471505573, 0.7449477010648409, 0.8687081136045738, 0.7826125042101991, 0.7202902782760795, 0.5844136451905698, 0.7154802759098092, 0.6814301875585868, 0.5081097116057384, 0.7924293872530243, 0.7866227135752394, 0.7809166853633364, 0.8798747320091199, 0.7133655476418453, 0.7219584513481498, 0.6138446228709302, 0.9424985967309943, 0.6958841119715232, 0.7373365762284528, 0.7800002420447827, 0.5164627856869074, 0.7760839974671712, 0.8105860104551229, 0.9224998140426074, 0.5348116836402429, 0.5689220112617634)
glm.summary
// Estimate	 S.E.	 z-stat	p-value		Variable
// ---------------------------------------------------------
//   0.8592	 0.278	 3.091	0.0020 *	(Intercept)
//   0.6136	 0.263	 2.336	0.0195 *	V1
//   0.1950	 0.115	 1.689	0.0912  	V2
//  -0.0520	 0.068	-0.762	0.4460  	V3
glm.plots
// res24: Figure = breeze.plot.Figure@38c90a80
```

![Logistic regression plots](glm-plots.png)


### Poisson regression

We first create an appropriate response, and then do Poisson regression.
```scala
val yp = DenseVector.tabulate(100)(i => Poisson(math.exp(-0.5 + X(i,0))).sample().toDouble)

import scalaglm.PoissonGlm
val pglm = Glm(yp, X, List("V1","V2","V3"), PoissonGlm)
```
```scala
pglm.coefficients
// res26: DenseVector[Double] = DenseVector(-0.40913337143250705, 0.9880452473680974, 0.01218366729844711, -0.05433055169862404)
pglm.summary
// Estimate	 S.E.	 z-stat	p-value		Variable
// ---------------------------------------------------------
//  -0.4091	 0.147	-2.778	0.0055 *	(Intercept)
//   0.9880	 0.082	12.100	0.0000 *	V1
//   0.0122	 0.049	 0.250	0.8027  	V2
//  -0.0543	 0.032	-1.679	0.0931  	V3
pglm.plots
// res28: Figure = breeze.plot.Figure@4e08c94c
```
![Poisson regression plots](pglm-plots.png)


## Non-linear response

The above covers the main functionality of the library based on a linear reponse to variation in covariate values. For flexible modelling of a nonlinear response, see the documentation on [flexible regression modelling](FlexibleRegression.md).


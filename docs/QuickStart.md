# scala-glm - Quickstart Guide

## PCA

This library contains code for principal components analysis based on a thin SVD of the centred data matrix. This is more numerically stable than a construction from the spectral decomposition of the covariance matrix. It is analogous to the R function `prcomp` rather than the R function `princomp`. First create some synthetic data.

```scala
import breeze.linalg.*
import breeze.numerics.*
import breeze.stats.distributions.*
import breeze.stats.distributions.Rand.VariableSeed.randBasis

val X = DenseMatrix.tabulate(100, 3)((i, j) => 
	Gaussian(j, j+1).sample())
```
Now we can do PCA.
```scala
import scalaglm.Pca
val pca = Pca(X, List("V1", "V2", "V3"))
```
```scala
pca.sdev
// res0: DenseVector[Double] = DenseVector(2.990187642696698, 2.0398457338646168, 0.9700899238147428)
pca.loadings
// res1: DenseMatrix[Double] = -0.07142289658766182   0.04889874941536264   -0.9962467978109851   
// 0.0030754407953855756  -0.9987820595265955   -0.04924367199677453  
// -0.9974413824916941    -0.00658102373688263  0.07118552254238458   
pca.scores
// res2: DenseMatrix[Double] = -0.2632719924462454    0.8959043491764275     -0.8967494908123455   
// -5.864418665936479     -0.6564007596810658    0.4704659612432237    
// -4.748642265116574     1.0037249599188443     -1.5838750448848604   
// -1.3471036397642195    -0.9798965527157155    -0.2136256725995346   
// -2.5984994927656295    1.459342259798984      -0.4007115670921814   
// -0.618699274728352     -0.4383224437945166    -1.046831844974079    
// -0.14662887811516548   0.9679095887523212     -0.13019188093441464  
// 6.387669920361351      1.279694792452609      -0.352166928747464    
// -0.584228328817459     -2.6211724563919643    -1.9451134006883413   
// 2.74720970935899       -0.5576775782940335    0.5248631043722217    
// -1.276502002185115     1.3137836664994698     1.0576393154239112    
// 2.8348655579456663     -2.450166704276001     -0.7049850885012138   
// 2.95289436236054       4.175983525472444      0.20367401945551247   
// -3.135675739600696     -1.3471474296363082    0.27688359938738183   
// 4.328929725193747      2.8776521311421672     0.6268557066997518    
// 0.8815733871828698     4.267469326404921      0.565521156785486     
// 5.304759850545925      1.3844961284655808     2.3321559017874374    
// 2.9308226995235933     0.23861263672210342    -0.37276237574618415  
// -4.266272603167294     2.2677331218807533     -0.4671409795669021   
// -6.6820040794650994    2.538788648996607      1.8159260544181177    
// -2.9480141971672746    -0.9462400578821281    2.841069975905319     
// -2.642201112341446     -1.0298993952925608    -0.2609801655242699   
// 3.442608355103731      0.21174045232624836    -0.7222366552427771   
// -0.050712599996061536  -1.6300311055714072    -0.39720867071607363  
// 0.4752877152151422     -0.11548196701970452   0.3438327905088055    
// 3.2745323200274097     0.4131006807444927     -0.22530743289199642  
// 6.9220030011912295     -1.6754393441310367    -1.2706096126717312   
// -0.10786760873155311   -0.3955970822652956    1.5190317059314713    
// 0.48241963834274326    1.5563290454582932     -1.1737382412127915   
// -2.075785727101467     -1.354362254753405     -0.18754240954168314  
// 0.7244496458072283     -0.11232410721123726   0.18838398332228118   
// -0.47694556569975144   1.063031314235507      -1.669460205767856    
// 3.445516581521988      1.8476737412973363     -0.3741923270524641   
// 3.9687953852026774     0.07678626946038457    -1.3839092882712765   
// 0.3682263652688404     -0.28029102943356415   -0.13261656148929624  
// -0.8457113200282301    -1.4858868401374705    -1.0396501847778603   
// 2.6206655550853846     0.5473577528781423     -0.33811792842788696  
// -2.2580363000662618    -2.9406210831514072    0.7681116573126308    
// 0.8506494754305788     1.951342332350386      0.33453299248487833   
// -0.054335412136735685  -0.5280235163191289    -0.21894390088790816  
// -6.339083979053731     -0.16700384112648445   1.628494638552687     
// -1.5406172150698159    -1.4726961345918061    0.706108905318988     
// 0.7344711958145264     -0.3276939201139631    1.6757422102895285    
// -3.3374357431601527    -0.7940884909452405    -1.1095103590383886   
// 1.3437566606697453     1.1483558569169872     0.6851863822794166    
// -0.611124514414924     2.030325467307201      -0.6083688040386169   
// 6.030201831336014      1.6615247010064016     0.19440371917207241   
// 5.930539802815146      -2.988863465923865     0.49249957896522956   
// 5.279809038609197      -0.9377371899060252    1.5071967526925476    
// ...
pca.plots
// res3: Figure = breeze.plot.Figure@f028a9a
pca.summary
// Standard deviations:
// V1	V2	V3
//  2.990	 2.040	 0.970
// Cumulative proportion of variance explained:
// V1	V2	V3
//  0.637	 0.933	 1.000
// Loadings:
// PC01	PC02	PC03	
// -0.071	 0.049	-0.996	V1
//  0.003	-0.999	-0.049	V2
// -0.997	-0.007	 0.071	V3
```
The final line prints a readable summary of the PCA to the console. `plots` produces some diagnostic plots, including a "scree plot".

![PCA Plots](pca-plots.png)

Note that there is also a utility function `pairs` for producing a "scatterplot matrix":
```scala
import scalaglm.Utils.pairs
pairs(X, List("V1", "V2", "V3"))
// res6: Figure = breeze.plot.Figure@3f9767fe
```

![Pairs plots](pairs-plots.png)


## Linear regression

This code computes regression coefficients and associated diagnostics via the QR decomposition of the covariate matrix. The diagnostics are analogous to those produced by the R function `lm`. We start by creating a synthetic response variable.

```scala
val y = DenseVector.tabulate(100)(i => 
	Gaussian(2.0 + 1.5*X(i,0) + 0.5*X(i,1), 3.0).sample())
```
So we can now do linear regression and generate all of the usual diagnostics.
```scala
import scalaglm.Lm
val lm = Lm(y,X,List("V1", "V2", "V3"))
```
```scala
lm.coefficients
// res8: DenseVector[Double] = DenseVector(1.4518828919997078, 1.174275231808507, 0.6165574378726676, 0.08348462367918405)
lm.se
// res9: DenseVector[Double] = DenseVector(0.4666211027853739, 0.34045470013651075, 0.16310397535619675, 0.11317202277240057)
lm.fitted
// res10: DenseVector[Double] = DenseVector(2.9371477794433405, 3.0975001828621185, 4.438692749687079, 3.3488512888028352, 2.415695581655851, 3.9208681890975416, 1.9621373410774596, 0.9732113833930027, 6.208049654892838, 1.5543262486682103, 0.5369110753008821, 4.066411808465115, -0.7418807259571676, 3.2638646759465875, -0.7489805775531424, -0.8828891835380855, -2.112271116480085, 2.1509324683905566, 2.3187842432137318, -0.16016714438713697, -0.05360016181631755, 3.647362824627987, 2.498754723207655, 3.7172630746465165, 1.8987932592623262, 1.8205051877347387, 3.633528193288386, 0.7481986674048773, 2.7755952425195094, 3.6474135591142254, 2.041505890495328, 3.8018811459994266, 1.1682285624072752, 3.2774623796048363, 2.5776192912239106, 4.535324580681272, 1.9882404238255242, 3.4228208124033244, 0.6926521150672088, 2.889011523822071, 1.5193768837415154, 2.557844854180657, 0.3838956849455095, 4.6438320406900395, 0.6412055014915343, 2.0161514270110055, 0.16610096275476294, 2.4258239745106813, 0.17506778285337443, 0.46412641624396034, 1.6365153716456133, 3.9474711333634804, 2.9410882024347487, 1.1985252074892208, 1.2672436879739093, 2.135812085953584, 1.1023203709990748, 0.1085718423295794, 3.5597899131795057, 2.444010645174699, 1.2638599565481161, 3.1188994521686073, 1.5670427910490048, 2.037985994825184, 3.5170377366647823, 1.9282194238005144, 4.5860384950245265, 0.5619758258617349, 4.297062558418242, 4.1946547732299, 0.9545321340551332, 4.919310015862786, 4.917424401496217, 4.159324846778221, 3.8733464343700037, 1.7362197220895013, -0.9765083027862651, 2.3062646094896087, 2.274306601388555, 3.7984181803771397, 1.3296810088300348, 4.93400562429682, 1.4022388929454566, 5.273972128103678, 1.136624887582767, 1.92131896539659, 4.832573765199554, 6.190197734319456, 0.8190451476493265, 4.098449486785795, -1.9786414107839374, 1.8998168495688716, 3.1026294411384367, 2.523326208260338, 2.299395523386579, 1.7158761063423946, 3.442826315932022, 4.708581373989471, 1.8417070891299256, 1.2024385157142738)
lm.residuals
// res11: DenseVector[Double] = DenseVector(0.6126055255103107, 5.889879273149074, 1.209913483973545, -2.7663232870862187, -0.03769047744362641, 0.49672569091510876, -3.7884956697480865, -2.4928032702797314, 4.979610350938074, 2.9497642462945644, 1.1738586898481347, 8.20720082940483, -4.392032300545726, -2.804567440777482, 0.5178077476890344, 1.0231482494237112, -4.62322046366048, -4.175340804914957, 0.9998379815095317, 0.24225054505602606, -1.2312954609608646, 0.1695744526205889, 1.340103660520278, -0.021741019184573496, -1.7861195843557964, -1.8774392032452587, -2.447915357255149, -2.4533665115157435, 2.1791783419606743, 1.339615716043152, 1.4453155343321935, -0.01955185232518719, 0.5894575649376737, 0.4425995356736028, 0.8700168180135939, 3.0863841488938126, 6.409655392775668, 0.5281845036338662, 6.389719964099102, -0.2841861975163176, 1.1940364512932153, -1.5331162504086682, 1.3363505432705538, 2.403607193697705, 7.364983589271091, 1.4169444474446076, -0.4641299240155594, -0.3585668640125861, 0.4974620372583405, 1.5871445626633123, -1.9434765437629078, -4.210011377362932, 0.5735787311816081, -2.060420694534421, 4.027423162613678, -3.5083028079585143, -1.8066929264556757, 4.3314151873258755, 1.8618479391593183, 1.9536040713495035, 4.560065626894734, -2.562815458625796, -2.1086465007974393, 4.321715403444989, -1.9850971997929667, -5.34805523158697, -4.623760164764258, 2.3661881801068696, -0.5314854382019814, -2.5872056486378243, 2.605502730863106, -8.203711844603543, 1.7679765019194678, -4.954367324676523, -4.64133844139131, -2.7253274090930066, -2.674230483219363, 3.760088950695036, 1.3856764979470708, -1.8492549440189245, -0.9745256437224883, -4.006809739317641, 1.8998670633588925, 1.7305386651361019, 0.6918455263191394, 1.43865706666812, 4.663280282715857, -3.154789379030777, -7.409043718281592, -2.0261107994661516, 0.4478036122705966, -3.733828780313974, 2.36170421474239, 2.481591170027846, 2.097070329816275, 2.8413015544543074, -6.018933218685916, 6.493970777917992, -3.981491121389107, -2.368015540099744)
lm.studentised
// res12: DenseVector[Double] = DenseVector(0.18777053191937923, 1.8351800659699882, 0.37951297877696105, -0.845415132941779, -0.011575411701976937, 0.15240798604049624, -1.1563987701132443, -0.7804799460689021, 1.564318368237642, 0.9048662620635116, 0.36116420455507703, 2.539475788044857, -1.3760163927703692, -0.8621345819150338, 0.16161402151201093, 0.3198501985662368, -1.4821896042314537, -1.2802307500719294, 0.3104058639999263, 0.07795524369112156, -0.39559125026985537, 0.05199068069852279, 0.4125380784279236, -0.006655339340332314, -0.5449394859187697, -0.57616702114785, -0.7776380105129688, -0.7576148505237142, 0.6714734773901206, 0.4104062845613529, 0.44083815070876614, -0.006062146598035213, 0.18184371924081427, 0.13762253812467176, 0.2653020392160258, 0.949465028850121, 1.9636847098810104, 0.16378063101968135, 1.9591257480831914, -0.08668845360989527, 0.3784136005271445, -0.4705520932784938, 0.41393031801051045, 0.743083800338594, 2.257015503978211, 0.4351419198828104, -0.14506779230136527, -0.11302740077800105, 0.1563032106344953, 0.48710311402146295, -0.6054329089762015, -1.309082235248513, 0.17544297248067386, -0.6299482040727329, 1.2441615601190723, -1.0746508545057043, -0.5621548303200528, 1.3338412848739551, 0.575059185638091, 0.5960100304700254, 1.4185289699703332, -0.7883392570930075, -0.6473684082648755, 1.3286587640724201, -0.6173513922996555, -1.6479444098501668, -1.4437114085544835, 0.7290719844548907, -0.16477768405592602, -0.7971215718798507, 0.8097003740589039, -2.551607885069164, 0.5571105621784825, -1.5537052911214129, -1.4260071634903813, -0.8364360017301617, -0.8416645878841034, 1.147970062441107, 0.42605077682275694, -0.57072120732348, -0.29820063774276434, -1.3023654223426422, 0.5817683256584687, 0.5480172692328177, 0.21342507262886048, 0.4392683899581289, 1.4385447648813958, -0.9974227503395272, -2.271357439406059, -0.6236465966788722, 0.14294463793775733, -1.1461486594817871, 0.7364249967835669, 0.759563595084054, 0.6452707135142836, 0.8707977382992739, -1.84373910328353, 2.0672867649192876, -1.2311000006287456, -0.7253053637121872)
val pred = lm.predict()
// pred: PredictLm = PredictLm(
//   Lm(
//     DenseVector(3.549753304953651, 8.987379456011192, 5.648606233660624, 0.5825280017166166, 2.3780051042122246, 4.41759388001265, -1.826358328670627, -1.5195918868867286, 11.187660005830912, 4.5040904949627745, 1.7107697651490168, 12.273612637869943, -5.133913026502893, 0.45929723516910537, -0.231172829864108, 0.14025906588562564, -6.735491580140565, -2.0244083365244006, 3.3186222247232635, 0.08208340066888908, -1.2848956227771822, 3.816937277248576, 3.838858383727933, 3.695522055461943, 0.1126736749065298, -0.05693401551052002, 1.1856128360332367, -1.7051678441108664, 4.954773584480184, 4.9870292751573775, 3.4868214248275216, 3.7823292936742394, 1.757686127344949, 3.720061915278439, 3.4476361092375045, 7.621708729575085, 8.397895816601192, 3.9510053160371905, 7.082372079166311, 2.6048253263057535, 2.7134133350347307, 1.024728603771989, 1.7202462282160633, 7.0474392343877446, 8.006189090762625, 3.433095874455613, -0.2980289612607965, 2.0672571104980952, 0.6725298201117149, 2.0512709789072727, -0.30696117211729446, -0.2625402439994513, 3.5146669336163567, -0.8618954870452002, 5.294666850587587, -1.3724907220049305, -0.7043725554566009, 4.439987029655455, 5.421637852338824, 4.3976147165242025, 5.8239255834428505, 0.5560839935428112, -0.5416037097484347, 6.359701398270173, 1.5319405368718155, -3.4198358077864555, -0.03772166973973157, 2.9281640059686045, 3.7655771202162605, 1.6074491245920761, 3.560034864918239, -3.284401828740757, 6.685400903415685, -0.7950424778983032, -0.7679920070213067, -0.9891076870035054, -3.650738786005628, 6.066353560184645, 3.659983099335626, 1.9491632363582152, 0.35515536510754653, 0.927195884979179, 3.302105956304349, 7.00451079323978, 1.8284704139019063, 3.35997603206471, 9.495854047915412, 3.0354083552886792, -6.5899985706322655, 2.0723386873196437, -1.5308377985133408, -1.8340119307451022, 5.464333655880827, 5.004917378288184, 4.396465853202854, 4.557177660796702, -2.576106902753894, 11.202552151907463, -2.1397840322591812, -1.16557702438547),
//     0.9309033765478941     0.2806214054127971    2.624541918820693     
// -0.10703629838135571   1.7464831948006039    8.31889910351642      
// 1.941080439655546      0.19297420844243907   7.048812882962635     
// 0.2360295375550596     2.11716490816573      3.7665736717314293    
// 0.6310673049154943     -0.31373885410878777  4.985397185708676     
// 1.0405660657035747     1.6195207002290024    2.9771566860249554    
// 0.16241278944344656    0.1713144814173343    2.562291185431337     
// -0.0678979207881757    -0.10906427092430993  -3.9731421173312      
// 1.826275538534182      3.8440528270923924    2.89319468389305      
// -0.7714692808256562    1.6716860905181248    -0.26747281918463406  
// -0.923348615113873     -0.2361063700122048   3.771553575233164     
// 0.35496205696652966    3.6227020987864647    -0.4299972603800346   
// -0.23470616905621722   -3.0397605948832886   -0.5266475527627756   
// -0.14285186243541784   2.454313370077002     5.587903545255076     
// -0.8180667827955967    -1.7596175958170037   -1.8604934081633138   
// -0.44278193585344455   -3.155323878327117    1.56452991162626      
// -2.659676716801232     -0.34925430395524315  -2.7026075768962023   
// 0.14861065345315497    0.9211327751828446    -0.5197543575939059   
// 0.8558938829644065     -1.1230030535036302   6.638854250738949     
// -1.232811523117728     -1.5135844944235806   9.209142291141688     
// -2.6912137908604894    1.9282014687364448    5.580616723108448     
// ...
pred.fitted
// res13: DenseVector[Double] = DenseVector(2.9371477794433387, 3.0975001828621176, 4.438692749687079, 3.3488512888028352, 2.415695581655851, 3.9208681890975416, 1.962137341077459, 0.9732113833930024, 6.208049654892838, 1.5543262486682097, 0.5369110753008814, 4.066411808465115, -0.7418807259571683, 3.2638646759465875, -0.7489805775531431, -0.8828891835380859, -2.112271116480085, 2.150932468390556, 2.3187842432137313, -0.16016714438713786, -0.053600161816317105, 3.6473628246279866, 2.4987547232076546, 3.717263074646516, 1.8987932592623262, 1.820505187734738, 3.6335281932883854, 0.7481986674048768, 2.7755952425195085, 3.647413559114225, 2.041505890495328, 3.8018811459994266, 1.168228562407275, 3.277462379604836, 2.57761929122391, 4.535324580681271, 1.9882404238255242, 3.422820812403325, 0.6926521150672084, 2.889011523822071, 1.5193768837415145, 2.5578448541806567, 0.3838956849455091, 4.643832040690039, 0.641205501491534, 2.016151427011005, 0.16610096275476227, 2.4258239745106804, 0.17506778285337443, 0.4641264162439601, 1.6365153716456127, 3.9474711333634804, 2.941088202434748, 1.1985252074892203, 1.267243687973909, 2.135812085953583, 1.1023203709990745, 0.10857184232957884, 3.559789913179505, 2.4440106451746986, 1.2638599565481154, 3.118899452168607, 1.5670427910490041, 2.037985994825184, 3.517037736664782, 1.9282194238005141, 4.5860384950245265, 0.5619758258617343, 4.297062558418241, 4.1946547732298995, 0.9545321340551327, 4.919310015862786, 4.917424401496216, 4.15932484677822, 3.873346434370003, 1.7362197220895008, -0.9765083027862659, 2.306264609489608, 2.274306601388555, 3.7984181803771393, 1.3296810088300344, 4.93400562429682, 1.4022388929454561, 5.273972128103678, 1.1366248875827665, 1.9213189653965896, 4.8325737651995535, 6.190197734319457, 0.8190451476493261, 4.098449486785796, -1.9786414107839376, 1.8998168495688712, 3.1026294411384363, 2.523326208260337, 2.299395523386579, 1.7158761063423942, 3.4428263159320216, 4.70858137398947, 1.8417070891299254, 1.2024385157142734)
pred.se
// res14: DenseVector[Double] = DenseVector(0.47384102165944314, 0.7537537870725617, 0.839519908210425, 0.40202602387984837, 0.5162491627901966, 0.4962812138504535, 0.3683001969370819, 0.8169130267159298, 0.8576249435619808, 0.4916250264511065, 0.5520199329164661, 0.6509470414019177, 0.8250430076690312, 0.5350120850032953, 0.7765965096136056, 0.7975124790076485, 1.067367957497805, 0.48152415950812316, 0.7023573406302404, 1.100750333292332, 1.0865733340367327, 0.4799321946234104, 0.5623504616163336, 0.44410095280434947, 0.3544046812786927, 0.5007651749690872, 0.9794864311143012, 0.6181750331746053, 0.5797971417491253, 0.46269999860920535, 0.3458361979375064, 0.6829569809917215, 0.6007133832763212, 0.7250278910939595, 0.3383416764067578, 0.5493743461547294, 0.46287541640512603, 0.6843008049814822, 0.48071791564473587, 0.3488126958219451, 0.9550868927342013, 0.5032053551547273, 0.6676304743130363, 0.6369399308250623, 0.4694873914167553, 0.5149845940640413, 0.7952450239970758, 0.8969533968831966, 0.8597486246042969, 0.5018334913544216, 0.7510558887331349, 0.7251937739231948, 0.42443045626202036, 0.4130228974528553, 0.6245251350958648, 0.45932292684943316, 0.7345825738282031, 0.5687366134556756, 0.6213803789999828, 0.35295486335896475, 0.731191031212685, 0.5479030173370331, 0.5087640383260505, 0.5371987146741366, 0.7273901904555258, 0.5802396974785152, 0.781890490200974, 0.57917105597791, 0.6818512182273122, 0.5780174811199993, 0.7169037978414139, 0.7291187896474106, 0.893102477673079, 0.8369543117905565, 0.5243936709397952, 0.5023015419565765, 0.8793569359706253, 0.37439612181112814, 0.5391096616298523, 0.6079751992512857, 0.43430597340597016, 1.1846240735015878, 0.45159081779758775, 0.9469758715980957, 0.6003322804101986, 0.3770406615338148, 0.6001533349660034, 0.9297204435913632, 0.4777961681007149, 0.5601734200638724, 1.0269983404717946, 0.5058178107414467, 0.7640817559165609, 0.44096902361243284, 0.5537829397491377, 0.47142617624254096, 0.4598368334063423, 1.0004008746987496, 0.6397052681903364, 0.4575039481146608)
val predNew = lm.predict(DenseMatrix((1.1, 1.6, 1.0), (1.4, 2.2, 3.0)))
// predNew: PredictLm = PredictLm(
//   Lm(
//     DenseVector(3.549753304953651, 8.987379456011192, 5.648606233660624, 0.5825280017166166, 2.3780051042122246, 4.41759388001265, -1.826358328670627, -1.5195918868867286, 11.187660005830912, 4.5040904949627745, 1.7107697651490168, 12.273612637869943, -5.133913026502893, 0.45929723516910537, -0.231172829864108, 0.14025906588562564, -6.735491580140565, -2.0244083365244006, 3.3186222247232635, 0.08208340066888908, -1.2848956227771822, 3.816937277248576, 3.838858383727933, 3.695522055461943, 0.1126736749065298, -0.05693401551052002, 1.1856128360332367, -1.7051678441108664, 4.954773584480184, 4.9870292751573775, 3.4868214248275216, 3.7823292936742394, 1.757686127344949, 3.720061915278439, 3.4476361092375045, 7.621708729575085, 8.397895816601192, 3.9510053160371905, 7.082372079166311, 2.6048253263057535, 2.7134133350347307, 1.024728603771989, 1.7202462282160633, 7.0474392343877446, 8.006189090762625, 3.433095874455613, -0.2980289612607965, 2.0672571104980952, 0.6725298201117149, 2.0512709789072727, -0.30696117211729446, -0.2625402439994513, 3.5146669336163567, -0.8618954870452002, 5.294666850587587, -1.3724907220049305, -0.7043725554566009, 4.439987029655455, 5.421637852338824, 4.3976147165242025, 5.8239255834428505, 0.5560839935428112, -0.5416037097484347, 6.359701398270173, 1.5319405368718155, -3.4198358077864555, -0.03772166973973157, 2.9281640059686045, 3.7655771202162605, 1.6074491245920761, 3.560034864918239, -3.284401828740757, 6.685400903415685, -0.7950424778983032, -0.7679920070213067, -0.9891076870035054, -3.650738786005628, 6.066353560184645, 3.659983099335626, 1.9491632363582152, 0.35515536510754653, 0.927195884979179, 3.302105956304349, 7.00451079323978, 1.8284704139019063, 3.35997603206471, 9.495854047915412, 3.0354083552886792, -6.5899985706322655, 2.0723386873196437, -1.5308377985133408, -1.8340119307451022, 5.464333655880827, 5.004917378288184, 4.396465853202854, 4.557177660796702, -2.576106902753894, 11.202552151907463, -2.1397840322591812, -1.16557702438547),
//     0.9309033765478941     0.2806214054127971    2.624541918820693     
// -0.10703629838135571   1.7464831948006039    8.31889910351642      
// 1.941080439655546      0.19297420844243907   7.048812882962635     
// 0.2360295375550596     2.11716490816573      3.7665736717314293    
// 0.6310673049154943     -0.31373885410878777  4.985397185708676     
// 1.0405660657035747     1.6195207002290024    2.9771566860249554    
// 0.16241278944344656    0.1713144814173343    2.562291185431337     
// -0.0678979207881757    -0.10906427092430993  -3.9731421173312      
// 1.826275538534182      3.8440528270923924    2.89319468389305      
// -0.7714692808256562    1.6716860905181248    -0.26747281918463406  
// -0.923348615113873     -0.2361063700122048   3.771553575233164     
// 0.35496205696652966    3.6227020987864647    -0.4299972603800346   
// -0.23470616905621722   -3.0397605948832886   -0.5266475527627756   
// -0.14285186243541784   2.454313370077002     5.587903545255076     
// -0.8180667827955967    -1.7596175958170037   -1.8604934081633138   
// -0.44278193585344455   -3.155323878327117    1.56452991162626      
// -2.659676716801232     -0.34925430395524315  -2.7026075768962023   
// 0.14861065345315497    0.9211327751828446    -0.5197543575939059   
// 0.8558938829644065     -1.1230030535036302   6.638854250738949     
// -1.232811523117728     -1.5135844944235806   9.209142291141688     
// -2.6912137908604894    1.9282014687364448    5.580616723108448     
// ...
predNew.fitted
// res15: DenseVector[Double] = DenseVector(3.8135621712645174, 4.702748450889039)
predNew.se
// res16: DenseVector[Double] = DenseVector(0.5624754261511903, 0.6162147529540056)
lm.plots
// res17: Figure = breeze.plot.Figure@50dc7396
lm.summary
// Estimate	 S.E.	 t-stat	p-value		Variable
// ---------------------------------------------------------
//   1.4519	 0.467	 3.111	0.0025 *	(Intercept)
//   1.1743	 0.340	 3.449	0.0008 *	V1
//   0.6166	 0.163	 3.780	0.0003 *	V2
//   0.0835	 0.113	 0.738	0.4625  	V3
// 
// Residual standard error:   3.2968 on 96 degrees of freedom
// Multiple R-squared: 0.2150, Adjusted R-squared: 0.1905
// F-statistic: 8.7637 on 3 and 96 DF, p-value: 0.00003
//
```
The plots include a plot of studentised residuals against fitted values and a normal Q-Q plot for the studentised residuals.

![Linear model plots](lm-plots.png)


## Generalised linear models

The current implementation supports only simple one-parameter exponential family observation models. This includes the most commonly used cases of **logistic regression** (`LogisticGlm`) and **Poisson regression** (`PoissonGlm`).

### Logistic regression

Again, we start by creating an appropriate response variable.
```scala
val ylb = (0 until 100) map (i => Bernoulli(sigmoid(1.0 + X(i,0))).sample())
val yl = DenseVector(ylb.toArray map {b => if (b) 1.0 else 0.0})
```

Then we can do logistic regression in a typical way.
```scala
import scalaglm.{Glm, LogisticGlm}
val glm = Glm(yl, X, List("V1","V2","V3"), LogisticGlm)
```
```scala
glm.coefficients
// res20: DenseVector[Double] = DenseVector(0.2847002704986031, 1.520843036027538, 0.175790201322481, 0.17436408090603578)
glm.fitted
// res21: DenseVector[Double] = DenseVector(0.9009133641535819, 0.8675475592332023, 0.9890104675829929, 0.8419216485889267, 0.8868113688299379, 0.9352961785824168, 0.7327444297180109, 0.37039852640898085, 0.985830529216781, 0.3449402971308142, 0.37673030689795467, 0.8000171092029532, 0.33215829805404895, 0.8135461526963236, 0.1689372928986352, 0.3383672604692197, 0.013481233878113084, 0.6415305517401353, 0.9273410823092681, 0.43769003971569237, 0.07612532376297677, 0.8923048012623634, 0.7248460240117989, 0.8390291760207697, 0.5566733371552591, 0.5607895068002857, 0.7329031440604348, 0.20499250266624378, 0.9127883175118588, 0.8672652333147801, 0.5967705287991514, 0.9682753670605773, 0.5681563961710541, 0.8622488651310252, 0.7300404889148269, 0.9443508537859637, 0.6423353926496369, 0.6561974842842837, 0.4810896909227267, 0.7807120878175583, 0.5530468602765619, 0.5956904395010707, 0.13743999466230594, 0.9725851680926542, 0.34017525565409046, 0.8523989086806855, 0.21503139617110098, 0.2242107414838203, 0.05725255255840855, 0.3410892349062978, 0.6785357064720665, 0.6241251775649415, 0.8637886985768342, 0.5294698148176917, 0.31450504963209375, 0.4425333571103693, 0.1979671623559518, 0.3908212879207784, 0.9352103504078083, 0.6981143114843885, 0.8604047520848467, 0.5876325343250104, 0.7309395519490018, 0.6205683093112706, 0.8093408835900301, 0.8509271561818489, 0.9666848490109683, 0.3405162298870246, 0.8892227799283703, 0.904347016420139, 0.12729108187165922, 0.9682220905796303, 0.7343528697669608, 0.5950288042584926, 0.9504230074281113, 0.41006963177170286, 0.39778804618116687, 0.6748341780919443, 0.5985336127645763, 0.9654845231406648, 0.45490497027439164, 0.9975847687939228, 0.6337950249033116, 0.9713725114238293, 0.745079901472837, 0.5116424991700133, 0.9590716439573147, 0.9579556289102348, 0.491979757465951, 0.8987655428750445, 0.23542243599493187, 0.8375714834115217, 0.9599075741990267, 0.8386249869023841, 0.3831978281089674, 0.7672641462200369, 0.9050547813417135, 0.5893800087489534, 0.2600945859535307, 0.35161832358717865)
glm.predict(response=true).fitted
// res22: DenseVector[Double] = DenseVector(0.9009133641535819, 0.8675475592332023, 0.9890104675829929, 0.8419216485889267, 0.8868113688299379, 0.9352961785824168, 0.7327444297180109, 0.37039852640898085, 0.985830529216781, 0.3449402971308142, 0.37673030689795467, 0.8000171092029532, 0.33215829805404895, 0.8135461526963236, 0.1689372928986352, 0.3383672604692197, 0.013481233878113084, 0.6415305517401353, 0.9273410823092681, 0.43769003971569237, 0.07612532376297677, 0.8923048012623634, 0.7248460240117989, 0.8390291760207697, 0.5566733371552591, 0.5607895068002857, 0.7329031440604348, 0.20499250266624378, 0.9127883175118588, 0.8672652333147801, 0.5967705287991514, 0.9682753670605773, 0.5681563961710541, 0.8622488651310252, 0.7300404889148269, 0.9443508537859637, 0.6423353926496369, 0.6561974842842837, 0.4810896909227267, 0.7807120878175583, 0.5530468602765619, 0.5956904395010707, 0.13743999466230594, 0.9725851680926542, 0.34017525565409046, 0.8523989086806855, 0.21503139617110098, 0.2242107414838203, 0.05725255255840855, 0.3410892349062978, 0.6785357064720665, 0.6241251775649415, 0.8637886985768342, 0.5294698148176917, 0.31450504963209375, 0.4425333571103693, 0.1979671623559518, 0.3908212879207784, 0.9352103504078083, 0.6981143114843885, 0.8604047520848467, 0.5876325343250104, 0.7309395519490018, 0.6205683093112706, 0.8093408835900301, 0.8509271561818489, 0.9666848490109683, 0.3405162298870246, 0.8892227799283703, 0.904347016420139, 0.12729108187165922, 0.9682220905796303, 0.7343528697669608, 0.5950288042584926, 0.9504230074281113, 0.41006963177170286, 0.39778804618116687, 0.6748341780919443, 0.5985336127645763, 0.9654845231406648, 0.45490497027439164, 0.9975847687939228, 0.6337950249033116, 0.9713725114238293, 0.745079901472837, 0.5116424991700133, 0.9590716439573147, 0.9579556289102348, 0.491979757465951, 0.8987655428750445, 0.23542243599493187, 0.8375714834115217, 0.9599075741990267, 0.8386249869023841, 0.3831978281089674, 0.7672641462200369, 0.9050547813417135, 0.5893800087489534, 0.2600945859535307, 0.35161832358717865)
glm.summary
// Estimate	 S.E.	 z-stat	p-value		Variable
// ---------------------------------------------------------
//   0.2847	 0.344	 0.827	0.4081  	(Intercept)
//   1.5208	 0.364	 4.173	0.0000 *	V1
//   0.1758	 0.120	 1.463	0.1436  	V2
//   0.1744	 0.089	 1.956	0.0505  	V3
glm.plots
// res24: Figure = breeze.plot.Figure@51a1c650
```

![Logistic regression plots](glm-plots.png)


### Poisson regression

We first create an appropriate response, and then do Poisson regression.
```scala
val yp = DenseVector.tabulate(100)(i => Poisson(math.exp(-0.5 + X(i,0))).sample().toDouble)

import scalaglm.PoissonGlm
val pglm = Glm(yp, X, List("V1","V2","V3"), PoissonGlm)
```
```scala
pglm.coefficients
// res26: DenseVector[Double] = DenseVector(-0.6700393796304622, 1.114859970547971, 0.06934988784051437, 0.014515320016541851)
pglm.summary
// Estimate	 S.E.	 z-stat	p-value		Variable
// ---------------------------------------------------------
//  -0.6700	 0.192	-3.489	0.0005 *	(Intercept)
//   1.1149	 0.103	10.812	0.0000 *	V1
//   0.0693	 0.055	 1.260	0.2077  	V2
//   0.0145	 0.039	 0.372	0.7096  	V3
pglm.plots
// res28: Figure = breeze.plot.Figure@7ff20ff3
```
![Poisson regression plots](pglm-plots.png)


## Non-linear response

The above covers the main functionality of the library based on a linear reponse to variation in covariate values. For flexible modelling of a nonlinear response, see the documentation on [flexible regression modelling](FlexibleRegression.md).


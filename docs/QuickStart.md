# scala-glm - Quickstart Guide

## PCA

This library contains code for principal components analysis based on a thin SVD of the centred data matrix. This is more numerically stable than a construction from the spectral decomposition of the covariance matrix. It is analogous to the R function `prcomp` rather than the R function `princomp`. First create some synthetic data.

```scala
import breeze.linalg._
import breeze.numerics._
import breeze.stats.distributions._
import breeze.stats.distributions.Rand.VariableSeed.randBasis

val X = DenseMatrix.tabulate(100, 3)((i, j) => 
	Gaussian(j, j+1).sample())
```
Now we can do PCA.
```scala
import scalaglm.Pca
val pca = Pca(X, List("V1", "V2", "V3"))
```
```scala
pca.sdev
// res0: DenseVector[Double] = DenseVector(2.709149617926792, 2.178377090212305, 0.8520902396030748)
pca.loadings
// res1: DenseMatrix[Double] = 0.06267286049185106   -0.09558392647389431  -0.9934464381926195  
// -0.11273119018310362  -0.9897109810335503   0.08811272769304396  
// 0.99164700943313      -0.10647012267035638  0.0728033080353451   
pca.scores
// res2: DenseMatrix[Double] = 5.180765098516316     -0.8539731118172154    0.0985020794976107     
// -1.1069216191167863   -0.022993976836602068  0.27744499194454697    
// -3.479134076480143    0.543604692657928      -0.2012654218141894    
// 0.7367652024856767    -0.7670587997881284    0.704597654794326      
// 0.5019647381906809    0.9617443673343498     -0.31427199522637483   
// 1.300610654833696     3.426956961431309      0.4210994097148037     
// 0.1494337091404908    0.4075610727323018     -0.8452483121715824    
// -3.440083649082903    0.725275562920971      -0.6350255484027574    
// -0.8693522077794147   -3.5793014214223877    -0.1816934455512376    
// -0.9539753170948582   3.8811716982780395     1.6679926825780607     
// 3.093507037615482     0.8743399909427112     0.23313378319852812    
// 2.40761016839742      -1.0585230100141503    -0.6133143584216904    
// -1.7458092228146311   -2.3322984801633533    -1.5777768947891375    
// -1.5957235525486224   -0.64762212859987      0.8791964604288555     
// 2.744094425148759     0.6891789015739946     0.705655710582174      
// 4.688928810489797     -0.9059278567189759    -0.23467634413365163   
// 2.893614096545825     -1.1049384970656106    0.20071744487127993    
// 2.3136142097831183    -1.6793442856015155    0.7335296595049337     
// 1.686643612743973     0.16756520198612937    -0.19620771797996128   
// 0.3428361464255238    -0.11218234494284363   -0.5951575203349727    
// 3.950470367408961     0.5955668504088829     -0.043066177539608536  
// 2.7235452925512704    -0.8336717122963571    0.953447976287833      
// -0.43702452832075606  0.9387675491395593     -0.4844207479698115    
// -1.7460538955671732   1.0576537345981754     -0.7711086463974018    
// -1.1017616906123306   -1.0874366975692373    1.4513812235398533     
// -1.2848170075883083   -0.8112907726348592    1.2566193961743866     
// 0.5390762028883729    3.7778603195551055     -0.44091544542015837   
// -1.9162567930575816   1.659812114096123      -0.005610271705151024  
// -4.216703667583221    -1.844079448339437     0.4000361432320055     
// -3.943110401594875    -0.8939736621520513    0.8707364588645187     
// -2.3563948235997105   0.5097053445520061     -0.569859009822836     
// 2.1900228541759867    1.6465280296945304     0.06313184223618108    
// -0.7267287999033821   -2.2264218842238157    0.5496019358227259     
// -0.8077889836656282   -0.43149709329886105   0.4090008519088956     
// 3.7612793183213413    -3.385821341173317     -0.6664761218810702    
// 0.3007291137858955    1.1064855323107223     0.39315157389063954    
// 1.4421769800599542    0.7667042167422947     0.33198201742893085    
// 2.7845987327449646    0.843870249701679      -0.7556347965626742    
// -0.9621948469569637   0.44824635844574195    1.111058708748929      
// -2.221330563504395    -1.5791028260282858    0.1948254898935543     
// 1.9268862861587188    -4.243063865039273     -0.3590180402149276    
// -4.008929136741939    -1.2936812770049348    -0.1549524598852258    
// 0.711196542915885     -0.44092240820490797   0.7202675179313558     
// -2.827190507567737    3.260829101606388      -0.907101939902709     
// 3.8448662702115666    0.5473503718313352     0.693801862877179      
// 0.14035283392945289   2.5834693098244186     -0.7670167078789046    
// 0.06657786630800741   1.4521819388841168     0.48675384576080255    
// -1.1642377915943924   -0.6168953901822053    -0.4923639051479398    
// -1.869995261251525    1.219125577006323      0.688832764499417      
// ...
pca.plots
// res3: Figure = breeze.plot.Figure@5c56226
pca.summary
// Standard deviations:
// V1	V2	V3
//  2.709	 2.178	 0.852
// Cumulative proportion of variance explained:
// V1	V2	V3
//  0.573	 0.943	 1.000
// Loadings:
// PC01	PC02	PC03	
//  0.063	-0.096	-0.993	V1
// -0.113	-0.990	 0.088	V2
//  0.992	-0.106	 0.073	V3
```
The final line prints a readable summary of the PCA to the console. `plots` produces some diagnostic plots, including a "scree plot".

![PCA Plots](pca-plots.png)

Note that there is also a utility function `pairs` for producing a "scatterplot matrix":
```scala
import scalaglm.Utils.pairs
pairs(X, List("V1", "V2", "V3"))
// res6: Figure = breeze.plot.Figure@ca4970a
```

![Pairs plots](pairs-plots.png)


## Linear regression

This code computes regression coefficients and associated diagnostics via the QR decomposition of the covariate matrix. The diagnostics are analogous to those produced by the R function `lm`. We start by creating a synthetic response variable.

```scala
val y = DenseVector.tabulate(100)(i => 
	Gaussian(2.0 + 1.5*X(i,0) + 0.5*X(i,1), 3.0).sample())
```
So we can now do linear regression and generate all of the usual diagnostics.
```scala
import scalaglm.Lm
val lm = Lm(y,X,List("V1", "V2", "V3"))
```
```scala
lm.coefficients
// res8: DenseVector[Double] = DenseVector(1.0658398834679694, 1.3984519346322313, 0.8691220136484206, 0.0783676390326938)
lm.se
// res9: DenseVector[Double] = DenseVector(0.4144500648012373, 0.3645594446902583, 0.14614509117845373, 0.11841375510654585)
lm.fitted
// res10: DenseVector[Double] = DenseVector(2.7862487175869055, 1.2958990058890478, 1.193891076561071, 1.607535779860833, 1.1907840039386945, -2.18715233648403, 2.416415300954797, 1.5813779656753968, 5.476107227614133, -4.423969781202764, 0.7375405215783197, 3.7347343872364247, 5.991995664191372, 1.1024712892517294, 0.2819773240157042, 3.2406415637279893, 2.7500586753876277, 2.5902571353595034, 1.9122193128912595, 2.623461202283904, 1.4356615335072251, 1.4829181105591975, 1.3729258886290097, 1.5402768279752634, 0.8286878856308251, 0.7941558599228955, -1.463483807857705, -0.07517757566835381, 2.7512114706046686, 1.2022513450452017, 1.7852680719670282, 0.12497428050946927, 3.174067230154697, 1.5535101238857187, 6.227830209305983, 0.10756271800737516, 0.6049495600791217, 2.039584055970775, -0.25615684396953275, 2.8883142446989627, 6.561501628889067, 2.938976971926758, 1.2584808264171283, -0.5628345184713388, 0.5137808178466093, 0.1328747690924713, -0.37700735121393547, 2.893381762915801, -0.5380452119070478, 6.039360724240176, 1.2933978855333725, 0.6281625021924313, 2.020748100474182, 6.749932435463065, 1.799012633043823, 3.4071551385274157, -1.9461672278728097, 0.40808800558099967, 0.9460614573833508, 2.934711398586698, -2.4456847160594033, 3.505006431189068, 0.12356504874296137, 0.029473011765644097, 0.24962651905101785, -0.41923606953479997, 1.3071634731562771, 6.551688544905777, -1.2470796156381456, -1.402589609464619, -0.37819310858372046, 0.7152413795205316, 2.373247178368116, -2.592798308640512, 0.727633636723922, 9.55076087722615, 6.83646879248498, 0.5324332995424312, -0.07047527454047833, 3.3107691820379292, 4.473226889723724, 2.8599802453255028, -2.179930381492794, 1.4071828006037288, 1.0239038689936784, -0.4575747963364156, 2.0584648665015606, -0.23329573427271794, 1.017208080323611, -0.09811162876630287, 6.818100108298875, 2.9059185130086256, 1.9629108876544306, 1.7067926469470853, 8.402693779803588, 1.908424886048917, -2.5220901733666543, 4.115609435637339, 3.3769512424155264, 4.079296268969659)
lm.residuals
// res11: DenseVector[Double] = DenseVector(-1.3843020470677048, 2.09888795797672, -0.8127439822243074, -5.381202211065465, 0.27260042491918335, -0.2500309147414095, -0.9500565647709971, -0.8516372217212567, -0.9739477519746407, 0.7158027548039367, 2.6740862793415308, -4.181109143480585, 4.600962016773473, 3.290758466213494, 4.244869517832603, 0.11548935726952969, -4.520694509127168, 2.7752360935319524, -3.4420820918418014, -4.824810524591491, 1.105699809557143, -5.3192304724669786, 5.119010848549599, 3.2858051457544666, -3.319343306988955, 0.13850217332692394, 3.41632676497409, 0.8757057027783628, -2.2011703147997967, -1.8272047300875323, -2.794919383012256, -5.366142585179912, -0.45785724318189613, 3.8709171618091087, 8.315746553484034, -0.35052916157083913, 3.1653559741658954, -2.743544083419697, -0.6918662596749546, -0.058971187024177585, 1.2750792570633518, -1.9582715713683219, -4.380800761714214, 4.730272640311139, 0.5481988456625003, -2.1549615476170216, -3.216787260279516, -3.4881693667556126, 0.535951001001254, 0.6705784492590068, 4.298835928663144, -0.9524884231942735, -1.035433032268152, -0.6866391848986249, -3.921270213208056, -2.446098667587596, -5.561722812805152, 4.10683074157504, 1.1344839631529535, 2.776177264107065, 8.097173443743216, 0.9262003639151222, -2.716694684839925, -3.558116166095539, -0.8647623517680132, -1.4191584587374897, 2.2640840725405367, -1.9179909777403417, -0.036688215546463177, -2.052459252584815, 1.7661860994526164, -2.7230824447058866, 3.895796076936646, 2.0205826108989875, -0.3618421109259611, -0.20660748151998298, 2.607783001050845, -3.4106839935960167, -2.48330723670665, -3.440906245426092, 1.3328387461874778, 1.3732470488324906, 2.0305642746824555, 0.12112507356928881, 6.481653356638863, 2.397618893466247, -1.2640325907698284, 2.2179568116092296, 3.785453042688207, 0.6045873120693495, 1.1017764531919747, 0.48334179510440256, 5.243228157636226, 0.8044182829856088, 0.6111967203852569, 0.28058378364449155, -3.534797411815872, -6.157716991452883, -3.3308693948128982, 1.3801880256679366)
lm.studentised
// res12: DenseVector[Double] = DenseVector(-0.4565842696977747, 0.6795839806006736, -0.26518748608301035, -1.7477917510729142, 0.08830501430210902, -0.08208750201898514, -0.308797513607165, -0.27861902717326154, -0.31958591539902165, 0.24034946347300304, 0.8714894200669526, -1.3626601002728578, 1.5270180480976443, 1.0722423752803651, 1.3853652053335648, 0.03797517540965106, -1.4726441345514285, 0.9069248699006079, -1.1154775574678821, -1.5640600727849783, 0.3615957136770393, -1.7414106462027958, 1.6596729404853714, 1.0704626940917932, -1.0918774213692577, 0.04537356867471819, 1.1237742382366571, 0.2847176264732238, -0.7242286447708037, -0.6010959197285799, -0.9095440969931762, -1.7460361898675179, -0.1492108754261095, 1.2538850458598991, 2.7594016851057175, -0.1136175477176792, 1.026390782353889, -0.89623314363402, -0.2258657406478281, -0.01919001322983846, 0.4220256201984316, -0.6416576917968632, -1.4224459597745802, 1.565505522645293, 0.1797810450588803, -0.7047928024234387, -1.0442056760700529, -1.1312960066687294, 0.17457993064148766, 0.2204935047637928, 1.400718802066652, -0.3108923885831263, -0.3391241125877297, -0.23090870780993167, -1.2686374700869774, -0.7993416693251949, -1.8461083672669052, 1.3409168889217993, 0.3704701920613519, 0.9034391471598597, 2.7026882870387805, 0.3003624092081389, -0.9148840412210746, -1.1742353164589194, -0.28638821833302197, -0.4614045812686416, 0.7347660833210479, -0.6329890188822869, -0.011958421176767431, -0.673506992435256, 0.5886192864985762, -0.892768830443158, 1.2681016303146462, 0.6783504337136598, -0.11829813511540016, -0.07303346885007714, 0.8874902547443315, -1.1220369881150722, -0.81055787282137, -1.1185566547698884, 0.4437491148141763, 0.44818817898563146, 0.6821761991337444, 0.04036167272018724, 2.12374037910803, 0.8146991259705163, -0.4114461525307428, 0.7215461361070704, 1.24473571387102, 0.19676263946016248, 0.3755914072574815, 0.1574483071312644, 1.7260274334912267, 0.26507467109660926, 0.20933764568307972, 0.09207371512444351, -1.1745687499310808, -2.0216750208891443, -1.0812930350280672, 0.4529077595829235)
val pred = lm.predict()
// pred: PredictLm = PredictLm(
//   Lm(
//     DenseVector(1.4019466705192007, 3.394786963865768, 0.38114709433676364, -3.773666431204632, 1.463384428857878, -2.4371832512254397, 1.4663587361837997, 0.7297407439541401, 4.502159475639492, -3.7081670263988276, 3.4116268009198505, -0.4463747562441607, 10.592957680964846, 4.3932297554652235, 4.526846841848307, 3.356130920997519, -1.7706358337395396, 5.365493228891456, -1.529862778950542, -2.2013493223075873, 2.5413613430643682, -3.8363123619077806, 6.491936737178609, 4.82608197372973, -2.49065542135813, 0.9326580332498194, 1.9528429571163852, 0.800528127110009, 0.5500411558048719, -0.6249533850423306, -1.0096513110452277, -5.241168304670443, 2.716209986972801, 5.4244272856948275, 14.543576762790018, -0.24296644356346397, 3.770305534245017, -0.7039600274489217, -0.9480231036444874, 2.829343057674785, 7.836580885952419, 0.9807054005584361, -3.1223199352970856, 4.167438121839799, 1.0619796635091097, -2.0220867785245504, -3.5937946114934514, -0.5947876038398117, -0.002094210905793703, 6.7099391734991825, 5.592233814196517, -0.3243259210018422, 0.9853150682060301, 6.06329325056444, -2.122257580164233, 0.9610564709398197, -7.507890040677961, 4.51491874715604, 2.0805454205363043, 5.710888662693763, 5.651488727683813, 4.43120679510419, -2.593129636096964, -3.5286431543298953, -0.6151358327169953, -1.8383945282722898, 3.5712475456968136, 4.633697567165435, -1.2837678311846088, -3.455048862049434, 1.387992990868896, -2.007841065185355, 6.269043255304762, -0.5722156977415243, 0.3657915257979609, 9.344153395706167, 9.444251793535825, -2.8782506940535857, -2.5537825112471286, -0.13013706338816267, 5.806065635911202, 4.233227294157993, -0.14936610681033857, 1.5283078741730176, 7.505557225632542, 1.9400440971298312, 0.7944322757317321, 1.9846610773365116, 4.802661123011818, 0.5064756833030466, 7.91987656149085, 3.389260308113028, 7.206139045290657, 2.511210929932694, 9.013890500188845, 2.1890086696934086, -6.056887585182526, -2.0421075558155444, 0.04608184760262812, 5.459484294637596),
//     0.15929760716109942   1.087382182031273     7.051009860323207     
// -0.4919681528591347   0.9895385624255074    0.7403973160676534    
// -0.21922606334733916  0.6540114907421797    -1.707177604575283    
// -0.7296516800419752   1.5557442648423097    2.6790026389069244    
// 0.10257933319739819   -0.2185772619358477   2.187920494420529     
// -0.813554045010646    -2.6836619612570214   2.7709613128678616    
// 0.6609527513128415    0.3228595010920039    1.8586812847266316    
// 0.1967739763247967    0.4315878464330761    -1.7193750569817388   
// 0.3189762763841062    4.442017669655787     1.321196005135825     
// -2.236992705838667    -2.7691739466617715   0.5776255325757331    
// -0.2704651651477836   -0.3759864223627156   4.806974571647929     
// 0.7121992424308549    1.5397284303187027    4.27097492853484      
// 1.5317869007687246    3.1836364869603706    0.21765197775540623   
// -1.060706209952505    1.7158650902893249    0.3659920740372189    
// -0.7440906548381527   -0.1117055633694537   4.514595882768717     
// 0.46443377685255255   1.1648903939871924    6.544557012827658     
// -0.06160192223714829  1.6026051089067512    4.817125341181838     
// -0.5723686104212464   2.2834324405103397    4.341917734556995     
// 0.13544677426942725   0.44428328491546276   3.4558555806111144    
// 0.47430114552909014   0.8374889637851844    2.12401281566928      
// 0.08427927665892047   -0.22102481199942003  5.666352434480358     
// ...
pred.fitted
// res13: DenseVector[Double] = DenseVector(2.786248717586901, 1.2958990058890527, 1.1938910765610689, 1.6075357798608332, 1.1907840039386939, -2.18715233648403, 2.4164153009547955, 1.5813779656753963, 5.476107227614131, -4.423969781202764, 0.7375405215783194, 3.7347343872364243, 5.9919956641913705, 1.1024712892517299, 0.2819773240157045, 3.240641563727989, 2.7500586753876273, 2.5902571353595034, 1.9122193128912595, 2.6234612022839032, 1.4356615335072247, 1.4829181105591975, 1.372925888629009, 1.540276827975263, 0.8286878856308246, 0.794155859922896, -1.4634838078577053, -0.07517757566835392, 2.7512114706046686, 1.2022513450452017, 1.7852680719670275, 0.12497428050946874, 3.174067230154697, 1.5535101238857187, 6.227830209305983, 0.10756271800737494, 0.6049495600791217, 2.0395840559707743, -0.2561568439695332, 2.8883142446989623, 6.561501628889066, 2.9389769719267576, 1.2584808264171286, -0.5628345184713393, 0.5137808178466096, 0.13287476909247053, -0.3770073512139356, 2.8933817629158005, -0.5380452119070476, 6.039360724240174, 1.2933978855333716, 0.6281625021924317, 2.020748100474181, 6.749932435463064, 1.7990126330438225, 3.4071551385274153, -1.9461672278728106, 0.40808800558099956, 0.9460614573833515, 2.934711398586697, -2.4456847160594024, 3.5050064311890674, 0.12356504874296026, 0.02947301176564232, 0.24962651905101785, -0.41923606953480025, 1.307163473156277, 6.551688544905775, -1.2470796156381458, -1.4025896094646195, -0.3781931085837206, 0.7152413795205315, 2.3732471783681164, -2.5927983086405115, 0.7276336367239216, 9.55076087722615, 6.836468792484979, 0.5324332995424315, -0.0704752745404788, 3.3107691820379284, 4.4732268897237235, 2.859980245325502, -2.1799303814927953, 1.4071828006037292, 1.0239038689936781, -0.4575747963364152, 2.0584648665015597, -0.23329573427271844, 1.017208080323611, -0.09811162876630307, 6.818100108298875, 2.9059185130086247, 1.96291088765443, 1.7067926469470853, 8.402693779803588, 1.9084248860489166, -2.522090173366654, 4.115609435637338, 3.3769512424155255, 4.079296268969659)
pred.se
// res14: DenseVector[Double] = DenseVector(0.6854419393289446, 0.3511001413580555, 0.5187485531645177, 0.42740292845590083, 0.3636900547412641, 0.6200706858890876, 0.44313533065826133, 0.5648086382578736, 0.6120438379290316, 0.8902316023002772, 0.4968928699949291, 0.49729982991048755, 0.7639672212602973, 0.4929610209519477, 0.5229278218207546, 0.6428534035726791, 0.48834927634676734, 0.5460110494553229, 0.374433903606351, 0.3821717225003641, 0.5582895756663129, 0.57597451610205, 0.38578316548457847, 0.48999389093520007, 0.6482578663296986, 0.586829587952801, 0.6481907410935136, 0.4495713917650855, 0.6515425142189093, 0.6494009622536131, 0.46845510421922637, 0.46550086584143746, 0.49618055942873196, 0.36278440202743106, 0.7617241503031196, 0.3791835205280635, 0.38882120157524674, 0.539560823540873, 0.5282027723516578, 0.4675691508007679, 0.7304758773260163, 0.5898970006536896, 0.4208082201058272, 0.7295197218994107, 0.6033756553970728, 0.5596720549696056, 0.4146073553548415, 0.3937735001775876, 0.48730742890440387, 0.6424684799856357, 0.4930986619847967, 0.525009184588092, 0.5828042609073814, 0.9052669987035765, 0.3289182968712258, 0.5455016233232362, 0.7653975161154525, 0.5309295483018778, 0.5333585128217481, 0.46832689053911614, 0.8283726575250743, 0.39165185351754384, 0.9189424948533078, 0.6929597107531935, 0.737822049104085, 0.44932109641525, 0.4089191935993071, 0.6934050181545967, 0.49952740474822266, 0.6125884228684613, 0.8115985765562018, 0.5988312167986158, 0.4732273992941092, 0.888571240063296, 0.5533591145660542, 1.2880694639622319, 1.0138863166748033, 0.6496997404816334, 0.5251405111309576, 0.44611605109366614, 0.8003174213532391, 0.5234150980534522, 0.8954904122143336, 0.8099894856852863, 0.589356410096055, 1.0005413504204506, 0.4730845104151117, 0.46174675918062075, 0.6429018675052387, 0.46980539620648154, 1.0280774621282391, 0.48794889901540867, 0.6589039904829878, 0.6728460684542069, 1.066568779928527, 0.6127815847167956, 0.7780056189817253, 0.6203562192890931, 0.415770021909101, 0.6127259774325833)
val predNew = lm.predict(DenseMatrix((1.1, 1.6, 1.0), (1.4, 2.2, 3.0)))
// predNew: PredictLm = PredictLm(
//   Lm(
//     DenseVector(1.4019466705192007, 3.394786963865768, 0.38114709433676364, -3.773666431204632, 1.463384428857878, -2.4371832512254397, 1.4663587361837997, 0.7297407439541401, 4.502159475639492, -3.7081670263988276, 3.4116268009198505, -0.4463747562441607, 10.592957680964846, 4.3932297554652235, 4.526846841848307, 3.356130920997519, -1.7706358337395396, 5.365493228891456, -1.529862778950542, -2.2013493223075873, 2.5413613430643682, -3.8363123619077806, 6.491936737178609, 4.82608197372973, -2.49065542135813, 0.9326580332498194, 1.9528429571163852, 0.800528127110009, 0.5500411558048719, -0.6249533850423306, -1.0096513110452277, -5.241168304670443, 2.716209986972801, 5.4244272856948275, 14.543576762790018, -0.24296644356346397, 3.770305534245017, -0.7039600274489217, -0.9480231036444874, 2.829343057674785, 7.836580885952419, 0.9807054005584361, -3.1223199352970856, 4.167438121839799, 1.0619796635091097, -2.0220867785245504, -3.5937946114934514, -0.5947876038398117, -0.002094210905793703, 6.7099391734991825, 5.592233814196517, -0.3243259210018422, 0.9853150682060301, 6.06329325056444, -2.122257580164233, 0.9610564709398197, -7.507890040677961, 4.51491874715604, 2.0805454205363043, 5.710888662693763, 5.651488727683813, 4.43120679510419, -2.593129636096964, -3.5286431543298953, -0.6151358327169953, -1.8383945282722898, 3.5712475456968136, 4.633697567165435, -1.2837678311846088, -3.455048862049434, 1.387992990868896, -2.007841065185355, 6.269043255304762, -0.5722156977415243, 0.3657915257979609, 9.344153395706167, 9.444251793535825, -2.8782506940535857, -2.5537825112471286, -0.13013706338816267, 5.806065635911202, 4.233227294157993, -0.14936610681033857, 1.5283078741730176, 7.505557225632542, 1.9400440971298312, 0.7944322757317321, 1.9846610773365116, 4.802661123011818, 0.5064756833030466, 7.91987656149085, 3.389260308113028, 7.206139045290657, 2.511210929932694, 9.013890500188845, 2.1890086696934086, -6.056887585182526, -2.0421075558155444, 0.04608184760262812, 5.459484294637596),
//     0.15929760716109942   1.087382182031273     7.051009860323207     
// -0.4919681528591347   0.9895385624255074    0.7403973160676534    
// -0.21922606334733916  0.6540114907421797    -1.707177604575283    
// -0.7296516800419752   1.5557442648423097    2.6790026389069244    
// 0.10257933319739819   -0.2185772619358477   2.187920494420529     
// -0.813554045010646    -2.6836619612570214   2.7709613128678616    
// 0.6609527513128415    0.3228595010920039    1.8586812847266316    
// 0.1967739763247967    0.4315878464330761    -1.7193750569817388   
// 0.3189762763841062    4.442017669655787     1.321196005135825     
// -2.236992705838667    -2.7691739466617715   0.5776255325757331    
// -0.2704651651477836   -0.3759864223627156   4.806974571647929     
// 0.7121992424308549    1.5397284303187027    4.27097492853484      
// 1.5317869007687246    3.1836364869603706    0.21765197775540623   
// -1.060706209952505    1.7158650902893249    0.3659920740372189    
// -0.7440906548381527   -0.1117055633694537   4.514595882768717     
// 0.46443377685255255   1.1648903939871924    6.544557012827658     
// -0.06160192223714829  1.6026051089067512    4.817125341181838     
// -0.5723686104212464   2.2834324405103397    4.341917734556995     
// 0.13544677426942725   0.44428328491546276   3.4558555806111144    
// 0.47430114552909014   0.8374889637851844    2.12401281566928      
// 0.08427927665892047   -0.22102481199942003  5.666352434480358     
// ...
predNew.fitted
// res15: DenseVector[Double] = DenseVector(4.07309987243359, 5.1708439390777)
predNew.se
// res16: DenseVector[Double] = DenseVector(0.5681107736020079, 0.6377914073857448)
lm.plots
// res17: Figure = breeze.plot.Figure@3fd2dbe2
lm.summary
// Estimate	 S.E.	 t-stat	p-value		Variable
// ---------------------------------------------------------
//   1.0658	 0.414	 2.572	0.0117 *	(Intercept)
//   1.3985	 0.365	 3.836	0.0002 *	V1
//   0.8691	 0.146	 5.947	0.0000 *	V2
//   0.0784	 0.118	 0.662	0.5097  	V3
// 
// Residual standard error:   3.1084 on 96 degrees of freedom
// Multiple R-squared: 0.3920, Adjusted R-squared: 0.3730
// F-statistic: 20.6284 on 3 and 96 DF, p-value: 0.00000
//
```
The plots include a plot of studentised residuals against fitted values and a normal Q-Q plot for the studentised residuals.

![Linear model plots](lm-plots.png)


## Generalised linear models

The current implementation supports only simple one-parameter exponential family observation models. This includes the most commonly used cases of **logistic regression** (`LogisticGlm`) and **Poisson regression** (`PoissonGlm`).

### Logistic regression

Again, we start by creating an appropriate response variable.
```scala
val ylb = (0 until 100) map (i => Bernoulli(sigmoid(1.0 + X(i,0))).sample())
val yl = DenseVector(ylb.toArray map {b => if (b) 1.0 else 0.0})
```

Then we can do logistic regression in a typical way.
```scala
import scalaglm.{Glm, LogisticGlm}
val glm = Glm(yl, X, List("V1","V2","V3"), LogisticGlm)
```
```scala
glm.coefficients
// res20: DenseVector[Double] = DenseVector(1.3458263123261498, 1.0142330121754326, -0.053095306464959524, 0.0013888259619173552)
glm.fitted
// res21: DenseVector[Double] = DenseVector(0.8114483770686604, 0.6889777234832268, 0.7477002105802132, 0.6287615332935521, 0.8122214567503802, 0.6608380723300651, 0.8809676365926573, 0.8205528777658567, 0.8077299990181225, 0.31536110804595674, 0.7499134568777311, 0.8799906454827913, 0.9388129837884315, 0.5447367864737385, 0.6464214527299057, 0.8537235892150754, 0.7694036488801234, 0.6570334016579672, 0.8122064181959624, 0.8563576214680871, 0.8101384588904698, 0.6032235790885258, 0.8279476693598137, 0.8536080336199666, 0.41457329024061323, 0.45679686983775264, 0.8130401963248193, 0.7210107418412978, 0.6299051107183853, 0.5081164476096467, 0.823552546032017, 0.7634598912362281, 0.6558808247002794, 0.668542679021485, 0.9042900488515973, 0.6743137595092978, 0.7080164303308821, 0.8887853141149373, 0.48522071468994593, 0.7045876584429234, 0.863268344857647, 0.7472066378647713, 0.621214484423892, 0.8489017074947316, 0.6681293881257953, 0.8611502076836653, 0.6458882672226709, 0.8315854848378808, 0.566970576460296, 0.9054075393373188, 0.8742027957912902, 0.5013954306423533, 0.9137230838876913, 0.894670485978856, 0.7964496844794645, 0.8551743420925371, 0.7100609324541266, 0.6365845084562911, 0.5005937372680299, 0.8930826389611733, 0.2702219075214101, 0.7945897102616036, 0.9438586756870492, 0.8931028976311699, 0.5303265040368239, 0.7008832243732968, 0.761165784642501, 0.879936893878364, 0.6546371390565991, 0.7766245811726296, 0.6961050771422476, 0.7112900824577939, 0.6268150064008029, 0.7836966837876008, 0.6261977233346003, 0.9859767722002877, 0.9762652355900162, 0.6112824170826708, 0.7517119640545626, 0.8194448079276505, 0.769551199029199, 0.9027507979237728, 0.8777679798213287, 0.3607177158441067, 0.6556138307997467, 0.46558440289804454, 0.8824359212997824, 0.7205452771196194, 0.42641708155908514, 0.7816323576848037, 0.6268266384667086, 0.8963364332618093, 0.9096133084830643, 0.681532254531792, 0.8723732320591692, 0.8016958002956573, 0.49105471857256777, 0.6519053708157803, 0.8447275219279992, 0.6529555268864101)
glm.predict(response=true).fitted
// res22: DenseVector[Double] = DenseVector(0.8114483770686604, 0.6889777234832268, 0.7477002105802132, 0.6287615332935521, 0.8122214567503802, 0.6608380723300651, 0.8809676365926573, 0.8205528777658567, 0.8077299990181225, 0.31536110804595674, 0.7499134568777311, 0.8799906454827913, 0.9388129837884315, 0.5447367864737385, 0.6464214527299057, 0.8537235892150754, 0.7694036488801234, 0.6570334016579672, 0.8122064181959624, 0.8563576214680871, 0.8101384588904698, 0.6032235790885258, 0.8279476693598137, 0.8536080336199666, 0.41457329024061323, 0.45679686983775264, 0.8130401963248193, 0.7210107418412978, 0.6299051107183853, 0.5081164476096467, 0.823552546032017, 0.7634598912362281, 0.6558808247002794, 0.668542679021485, 0.9042900488515973, 0.6743137595092978, 0.7080164303308821, 0.8887853141149373, 0.48522071468994593, 0.7045876584429234, 0.863268344857647, 0.7472066378647713, 0.621214484423892, 0.8489017074947316, 0.6681293881257953, 0.8611502076836653, 0.6458882672226709, 0.8315854848378808, 0.566970576460296, 0.9054075393373188, 0.8742027957912902, 0.5013954306423533, 0.9137230838876913, 0.894670485978856, 0.7964496844794645, 0.8551743420925371, 0.7100609324541266, 0.6365845084562911, 0.5005937372680299, 0.8930826389611733, 0.2702219075214101, 0.7945897102616036, 0.9438586756870492, 0.8931028976311699, 0.5303265040368239, 0.7008832243732968, 0.761165784642501, 0.879936893878364, 0.6546371390565991, 0.7766245811726296, 0.6961050771422476, 0.7112900824577939, 0.6268150064008029, 0.7836966837876008, 0.6261977233346003, 0.9859767722002877, 0.9762652355900162, 0.6112824170826708, 0.7517119640545626, 0.8194448079276505, 0.769551199029199, 0.9027507979237728, 0.8777679798213287, 0.3607177158441067, 0.6556138307997467, 0.46558440289804454, 0.8824359212997824, 0.7205452771196194, 0.42641708155908514, 0.7816323576848037, 0.6268266384667086, 0.8963364332618093, 0.9096133084830643, 0.681532254531792, 0.8723732320591692, 0.8016958002956573, 0.49105471857256777, 0.6519053708157803, 0.8447275219279992, 0.6529555268864101)
glm.summary
// Estimate	 S.E.	 z-stat	p-value		Variable
// ---------------------------------------------------------
//   1.3458	 0.349	 3.856	0.0001 *	(Intercept)
//   1.0142	 0.331	 3.060	0.0022 *	V1
//  -0.0531	 0.118	-0.450	0.6530  	V2
//   0.0014	 0.089	 0.016	0.9876  	V3
glm.plots
// res24: Figure = breeze.plot.Figure@55f2a26d
```

![Logistic regression plots](glm-plots.png)


### Poisson regression

We first create an appropriate response, and then do Poisson regression.
```scala
val yp = DenseVector.tabulate(100)(i => Poisson(math.exp(-0.5 + X(i,0))).sample().toDouble)

import scalaglm.PoissonGlm
val pglm = Glm(yp, X, List("V1","V2","V3"), PoissonGlm)
```
```scala
pglm.coefficients
// res26: DenseVector[Double] = DenseVector(-0.5167424305584137, 1.108719747831016, -0.0750624296614125, 0.04027802824015344)
pglm.summary
// Estimate	 S.E.	 z-stat	p-value		Variable
// ---------------------------------------------------------
//  -0.5167	 0.171	-3.017	0.0026 *	(Intercept)
//   1.1087	 0.102	10.847	0.0000 *	V1
//  -0.0751	 0.049	-1.533	0.1252  	V2
//   0.0403	 0.042	 0.949	0.3424  	V3
pglm.plots
// res28: Figure = breeze.plot.Figure@761e1290
```
![Poisson regression plots](pglm-plots.png)


## Non-linear response

The above covers the main functionality of the library based on a linear reponse to variation in covariate values. For flexible modelling of a nonlinear response, see the documentation on [flexible regression modelling](FlexibleRegression.md).


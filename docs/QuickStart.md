# scala-glm - Quickstart Guide

## PCA

This library contains code for principal components analysis based on a thin SVD of the centred data matrix. This is more numerically stable than a construction from the spectral decomposition of the covariance matrix. It is analogous to the R function `prcomp` rather than the R function `princomp`. First create some synthetic data.

```scala
import breeze.linalg._
import breeze.numerics._
import breeze.stats.distributions._
import breeze.stats.distributions.Rand.VariableSeed.randBasis

val X = DenseMatrix.tabulate(100, 3)((i, j) => 
	Gaussian(j, j+1).sample())
```
Now we can do PCA.
```scala
import scalaglm.Pca
val pca = Pca(X, List("V1", "V2", "V3"))
```
```scala
pca.sdev
// res0: DenseVector[Double] = DenseVector(2.787633671003388, 1.913106429394592, 0.8923351694311289)
pca.loadings
// res1: DenseMatrix[Double] = -0.0029222020827334456  2.1592971198744005E-4  0.9999957070454588     
// 0.08755139675724544     -0.9961598923547725    4.7094541434710563E-4  
// 0.9961557175767466      0.0875523971007498     0.0028920755642887516  
pca.scores
// res2: DenseMatrix[Double] = -0.17265266849961527   -1.309697249055991    -0.5136846185785052    
// 1.43947234138877       -2.043943178942564    -0.3853914615738368    
// -4.515525063075086     -0.7068608504155559   -0.488886071560174     
// -0.5887344371712395    1.0136795434745616    -0.8047139825954747    
// 5.388729127213616      -1.9453307580152994   1.9166865333041345     
// 1.3046731266335367     0.9316759245430213    -0.33612041094382594   
// 0.5959885273415158     3.329764751959885     0.8984770645626204     
// -0.6681097656588565    0.19680122719515705   -0.4106744411422474    
// -3.5770293838136418    -1.4139300238337023   -0.2007493655787923    
// 3.306741672203188      4.619711170410029     0.4035993852102069     
// 3.702628746078658      -0.2071794450580896   -0.4624257495589327    
// 0.652980059578584      1.8496199319158806    -1.5278481346942758    
// 0.25075404610999846    -0.15102658232828747  -1.2834892819784391    
// 6.22762630407949       -1.1273905478744795   -0.6643595065050959    
// 2.298656038491506      2.0149464578082057    1.0725098749626087     
// 2.108437705426687      1.838611776895972     0.06033315814939669    
// 0.5345513049504095     0.31431129887416936   0.8030412795860034     
// 0.8201733877878478     0.36138830421839424   0.012638918440841173   
// 0.027080321854452243   0.0832281934781934    0.3394758863982079     
// -4.597303542701211     1.2717316164720192    -0.592286060152378     
// -2.6962843790767588    2.2052224821446873    1.2077017956606129     
// 0.32229437237214326    -2.8985283405708175   0.7977332996121821     
// -0.028178467746904187  -1.562058419141354    0.296765128810759      
// 0.17567230466245834    -1.1869271958960843   0.8234564076977287     
// 1.9303784011258576     -2.2775910563343285   -0.34621348136853186   
// -1.4689450713313064    0.020818579029144683  0.4871367150032559     
// -1.3105021638997727    -1.5827926602136586   0.46784294831321754    
// -2.93799115344349      0.21477679642114322   -0.7210078056199782    
// 1.3769164291661684     -1.4277842487823338   0.34881478989044007    
// 1.6596632787077317     -1.0560157919041766   1.2641194550943664     
// 1.4255300741484216     -1.8043810321124603   0.396962833760683      
// 4.317197744557112      2.823628233800419     0.3123629479061263     
// 2.08917619555318       -1.4174576146771225   -1.6046339294655336    
// 1.31136247002259       -0.28788968562675066  -1.3093052889545929    
// 2.636373573212234      -2.5383574169194234   0.5135057285262232     
// -1.0704772972350387    -3.37908189566586     0.3516047059293279     
// 2.968843372340907      -0.20247140221166174  1.1119350503898566     
// -3.4367266652653705    1.1770389666197525    -0.6157589019023697    
// -4.131898846414057     -1.0009752151153255   -0.2101017294717366    
// -1.026083804231122     1.2790654002949602    0.6061892889573236     
// 1.5067239345406571     0.9982696771791848    -0.3981109769564802    
// -2.913647153231161     -2.5751091833735558   -0.3993961946484877    
// -1.1533133057994354    1.1443523990513338    1.6098927800940739     
// -2.5376081880696852    -0.38554779675331463  -1.3579252253451588    
// -1.1885715887719017    -2.9998074229782508   0.8739614150240779     
// 3.122756006202848      1.4411107688246478    1.535873392994994      
// 4.68628335030098       0.5578733848365911    0.6151666617363103     
// -0.6972429735727833    0.9042469477125099    1.1164026204787352     
// 1.2608173819264485     0.3187985152683789    0.11378925497625603    
// ...
pca.plots
// res3: Figure = breeze.plot.Figure@4660debd
pca.summary
// Standard deviations:
// V1	V2	V3
//  2.788	 1.913	 0.892
// Cumulative proportion of variance explained:
// V1	V2	V3
//  0.636	 0.935	 1.000
// Loadings:
// PC01	PC02	PC03	
// -0.003	 0.000	 1.000	V1
//  0.088	-0.996	 0.000	V2
//  0.996	 0.088	 0.003	V3
```
The final line prints a readable summary of the PCA to the console. `plots` produces some diagnostic plots, including a "scree plot".

![PCA Plots](pca-plots.png)

Note that there is also a utility function `pairs` for producing a "scatterplot matrix":
```scala
import scalaglm.Utils.pairs
pairs(X, List("V1", "V2", "V3"))
// res6: Figure = breeze.plot.Figure@44ef2b3f
```

![Pairs plots](pairs-plots.png)


## Linear regression

This code computes regression coefficients and associated diagnostics via the QR decomposition of the covariate matrix. The diagnostics are analogous to those produced by the R function `lm`. We start by creating a synthetic response variable.

```scala
val y = DenseVector.tabulate(100)(i => 
	Gaussian(2.0 + 1.5*X(i,0) + 0.5*X(i,1), 3.0).sample())
```
So we can now do linear regression and generate all of the usual diagnostics.
```scala
import scalaglm.Lm
val lm = Lm(y,X,List("V1", "V2", "V3"))
```
```scala
lm.coefficients
// res8: DenseVector[Double] = DenseVector(2.0945818085351737, 1.620775176967597, 0.6486698379827802, -0.00859333546131069)
lm.se
// res9: DenseVector[Double] = DenseVector(0.3940416690004815, 0.33110319110375774, 0.15412452889027278, 0.10644731954446567)
lm.fitted
// res10: DenseVector[Double] = DenseVector(2.715709080290729, 3.468548271397492, 2.177230964600242, 0.7235866966367588, 7.308342796501362, 1.6185763257410333, 2.0385352981389637, 1.8870697997431107, 3.1423125870094153, 0.520164549716306, 2.254491832810772, -0.9351435995198352, 0.7370596135541971, 2.631964433525754, 3.244846102253891, 1.7097992708905632, 3.830892712636773, 2.5315960123145356, 3.2067719083814517, 0.7267367131950317, 3.1237128782163497, 5.8904179469108, 4.198943686403563, 4.819049732620225, 3.7044821965532106, 3.421419964134226, 4.433900357132448, 1.273652149716998, 4.257614755501676, 5.51328800603636, 4.581279983937108, 1.5775296216860977, 1.115281974257575, 0.8298353303066266, 5.297443236252559, 5.417359443637386, 4.77164717073121, 0.8003923595480962, 2.8360088247995945, 2.8201136113425935, 1.4838166008328122, 3.599947154549398, 4.528735009055431, 0.6467513578733737, 6.013756858004621, 4.402856982876873, 3.5494374144635525, 3.90384800814154, 2.7422694037979625, 3.6302845978545077, 3.8449319728392415, 1.5450124226407367, 1.5476308952880389, 3.1951426130821043, 4.701576781447509, 0.8145549469307793, 1.0697871480664867, 3.6566302598715086, -0.24934090575246493, 3.7991283606868222, 1.8492495345012956, 2.484187114484948, -1.4795937229968676, 0.6921167434065182, 1.550794183531885, 2.199782398485804, 2.7435290816782953, 4.130899292147579, 3.5792167994033544, 1.782782144321657, 1.78317436344968, 0.6536074273475788, 5.363692293758562, 2.791065700770269, 2.899285893786899, 2.1139819313757178, 3.4459832851215406, 3.053081904607562, 4.319902806743659, 1.748336661605923, -2.671352117571953, 3.155732490240646, 2.214313554995374, 3.8274999708654818, 2.7747102018595933, 0.44668856756408415, 0.31241709403442464, -1.637647308661889, 4.05511313782051, -0.32105572759596596, -1.2639022718703112, 4.356676366758368, 0.4543061472524714, 5.5928675058788855, 5.5091003597199135, 6.357770206410057, 3.0481821386668715, 2.5173227764336774, 6.573150766537063, 3.2538910892989836)
lm.residuals
// res11: DenseVector[Double] = DenseVector(-0.7111500702792868, 0.775547621372831, -4.5455534024031135, 2.461217486251245, 1.8143505992093854, 0.2857652320125026, -1.521645492237095, 7.145264205524381, -2.64450693220042, -0.6064022918574693, -1.6496175121775094, -7.0321715242293, -2.8531224646860474, -5.184125096753494, 3.716818082578881, -1.2554207637648143, 2.7111206499007086, 2.695476738334456, -3.2168065831217336, 3.3454638889131108, -2.2496351562580648, 2.4333431170436395, 3.56455693539903, -5.056840119208597, -3.0833805865036115, 3.4246804441209937, -0.3801859536523837, -1.361039520449495, 2.642530863396461, 3.575691991003154, -1.8446996921202725, -1.5162985175388595, 1.385341169494429, 1.5152912995397507, 2.896396069847728, 3.054319514307144, -0.5603486059705549, -1.8378367345760394, 5.800562190580714, 1.765178786357608, -0.9457029370444907, -3.6825348753886527, -2.2779330433268976, 2.656627765745812, -5.586983865290889, -2.8440925306875124, -2.6466783661512467, 0.6444666351090618, -0.650052581174124, 0.22907059508913497, 1.956472534127721, -2.6938478508824835, -1.9582758285600481, -1.187878367375113, 0.9390607514797553, 1.9542899095299777, -5.248816289564876, 2.0047660576864392, 0.35038998818682554, 0.9652671045368679, 3.313868758961059, 2.9284960115496226, 4.139237931063711, 2.9838302831895653, 2.994307814931092, -2.595008113390772, -6.053830257723402, 3.325104625869203, 0.7699846291896386, 0.3195141680572955, 3.7021076256103544, 1.68301236525698, -2.8843965232440976, -1.2806360803043004, -0.11040305888164026, -1.0418264090546776, 1.3701197520108632, -2.056754477654695, 2.0127920559325716, -0.6063825361256341, -2.286280213477389, 1.3654700855238824, -2.1258494926985887, -4.097734748597629, 3.116336773524617, 2.946367921487901, 2.430834696540103, 2.444566258185649, -0.7916215123357562, -2.4664520830112453, 0.07351947005854775, -3.1324744986721234, -1.8508395210208488, 1.7954289395851344, -0.8061788567845589, -2.8016592048199978, -4.634771811439375, 5.99851869359077, 3.6023769675491497, -1.5684410996762854)
lm.studentised
// res12: DenseVector[Double] = DenseVector(-0.24413015532489907, 0.267326671367422, -1.5788742179767266, 0.8463678931047582, 0.6523019739889941, 0.09799644458583663, -0.5314210786233934, 2.446306765146876, -0.9146282319441487, -0.2156663098643199, -0.569944554265936, -2.4537337529053107, -0.9859555139478205, -1.828147209579682, 1.2921969583635449, -0.4325245197351703, 0.931032599317324, 0.9221016679360148, -1.1005810027493346, 1.1653582260016713, -0.7856946710070207, 0.8454205199316155, 1.223507180100854, -1.739870237405357, -1.0653273510180832, 1.1742790906089484, -0.13076722475908392, -0.4695847558836043, 0.9078525220036819, 1.2394255202687376, -0.6350485365271215, -0.531283282949549, 0.4844772634537294, 0.5244985238344163, 1.0056534493689615, 1.0629295179349756, -0.19426380470709345, -0.6360695166964335, 2.0091490634615066, 0.6067165638673581, -0.3245821495809927, -1.2794059030123106, -0.7942591568242785, 0.9233712397404908, -1.946143240440176, -0.9969744021340776, -0.9208912362108745, 0.22244001997175242, -0.22252136838325318, 0.0787458008971886, 0.670495499751059, -0.9380682181784004, -0.6749309243233979, -0.41376141664336874, 0.32533539857912847, 0.6778252378448356, -1.8274717984004036, 0.7055230526202212, 0.12238227292911523, 0.3340094206217662, 1.1427604119356987, 1.0060319994448053, 1.4642827552789388, 1.0366391005433604, 1.0464873137646447, -0.8899366572843749, -2.0810240669170077, 1.1907139814072736, 0.266639000083869, 0.10995425602631566, 1.2931147910643581, 0.5825463330918323, -1.0184509340956367, -0.43854510380117323, -0.03814943082511446, -0.3626419974565581, 0.4737944559565441, -0.7059480750383349, 0.6952328970423854, -0.2094618820004804, -0.8248164575788672, 0.4722840437938996, -0.7570428709600203, -1.413693178657701, 1.0673724123092345, 1.0150895105768183, 0.8430062861870427, 0.8659459973007919, -0.28109797495575545, -0.8603482140767307, 0.025908226060807015, -1.0813786192235146, -0.64106234730494, 0.6294980111426257, -0.28215590036502075, -0.9931983457747681, -1.6349201846240504, 2.0884301853346483, 1.2588495026601576, -0.5386023200389813)
val pred = lm.predict()
// pred: PredictLm = PredictLm(
//   Lm(
//     DenseVector(2.0045590100114423, 4.244095892770323, -2.3683224378028718, 3.184804182888004, 9.122693395710748, 1.9043415577535359, 0.5168898059018687, 9.032334005267492, 0.4978056548089951, -0.08623774214116331, 0.6048743206332627, -7.9673151237491355, -2.11606285113185, -2.55216066322774, 6.961664184832772, 0.4543785071257489, 6.542013362537482, 5.227072750648992, -0.010034674740281968, 4.0722006021081425, 0.8740777219582849, 8.32376106395444, 7.763500621802593, -0.23779038658837237, 0.6211016100495992, 6.84610040825522, 4.053714403480064, -0.08738737073249703, 6.9001456188981365, 9.088979997039514, 2.7365802918168356, 0.0612311041472382, 2.500623143752004, 2.3451266298463773, 8.193839306100287, 8.47167895794453, 4.211298564760655, -1.0374443750279432, 8.636571015380309, 4.585292397700202, 0.5381136637883215, -0.0825877208392547, 2.2508019657285336, 3.3033791236191856, 0.42677299271373226, 1.5587644521893607, 0.9027590483123058, 4.548314643250602, 2.0922168226238385, 3.8593551929436427, 5.801404506966962, -1.148835428241747, -0.41064493327200924, 2.0072642457069914, 5.640637532927264, 2.768844856460757, -4.179029141498389, 5.661396317557948, 0.10104908243436059, 4.76439546522369, 5.163118293462355, 5.412683126034571, 2.6596442080668434, 3.6759470265960834, 4.545101998462977, -0.39522571490496805, -3.310301176045107, 7.4560039180167825, 4.349201428592993, 2.1022963123789524, 5.485281989060034, 2.3366197926045587, 2.4792957705144643, 1.5104296204659686, 2.788882834905259, 1.0721555223210402, 4.816103037132404, 0.9963274269528668, 6.332694862676231, 1.141954125480289, -4.957632331049342, 4.521202575764528, 0.08846406229678516, -0.2702347777321479, 5.89104697538421, 3.393056489051985, 2.7432517905745275, 0.8069189495237599, 3.263491625484754, -2.7875078106072113, -1.1903828018117635, 1.2242018680862445, -1.3965333737683774, 7.38829644546402, 4.702921502935355, 3.5561110015900597, -1.5865896727725035, 8.515841470024448, 10.175527734086213, 1.6854499896226982),
//     -0.48562556460068      2.1959095337404166     1.885548328467066     
// -0.3622024589263934    3.0685400956551545     3.4275619167972504    
// -0.44800620299497584   1.215175226441657      -2.387777347063091    
// -0.7749361181491704    -0.15511084076324555   1.6736416242675196    
// 1.9283464201822582     3.3171534578665596     7.3769281815276       
// -0.31189518469265454   0.09256903427990282    3.55394598926447      
// 0.9252857289848296     -2.357775772405574     3.0615147482126552    
// -0.3808427058391209    0.6518667250865567     1.5241913743593616    
// -0.16276588524292004   2.001831482351622      -1.5139617981679923   
// 0.42276734339272104    -3.4056714940293125    5.873353669828827     
// -0.4454532047020825    1.436935957593678      5.842608387926932     
// -1.5015152021871776    -0.8794678462766783    2.981679846033171     
// -1.2564140118241092    1.0783956003826116     2.4065454091518585    
// -0.6549633487970925    2.5745853139536905     8.276748446622415     
// 1.094058345387017      -0.8988536432689833    4.643024547210331     
// 0.08240375431463123    -0.7403266672449911    4.435171651584595     
// 0.8293787596932914     0.6406741551425936     2.736027522190643     
// 0.0381553115883977     0.6184123064961664     3.022387394386924     
// 0.36724839162599215    0.8262217691588603     2.2089348549223216    
// -0.5507395375507274    -0.763027748253456     -2.2963099743362516   
// 1.2438869972507318     -1.5256493294519178    -0.3156638014136792   
// 0.8239973126188344     3.8225902538377943     2.243279402194606     
// ...
pred.fitted
// res13: DenseVector[Double] = DenseVector(2.7157090802907247, 3.4685482713974918, 2.1772309646002403, 0.7235866966367581, 7.308342796501362, 1.6185763257410333, 2.0385352981389633, 1.8870697997431103, 3.1423125870094144, 0.5201645497163055, 2.2544918328107713, -0.9351435995198358, 0.7370596135541971, 2.631964433525753, 3.244846102253891, 1.709799270890563, 3.8308927126367722, 2.531596012314535, 3.206771908381451, 0.7267367131950312, 3.123712878216349, 5.890417946910799, 4.198943686403562, 4.819049732620224, 3.7044821965532098, 3.4214199641342256, 4.433900357132448, 1.2736521497169977, 4.257614755501675, 5.513288006036358, 4.581279983937107, 1.5775296216860974, 1.115281974257575, 0.8298353303066262, 5.297443236252558, 5.417359443637385, 4.771647170731209, 0.8003923595480957, 2.836008824799594, 2.8201136113425935, 1.483816600832812, 3.5999471545493966, 4.528735009055431, 0.6467513578733732, 6.01375685800462, 4.402856982876873, 3.5494374144635525, 3.90384800814154, 2.742269403797962, 3.630284597854507, 3.84493197283924, 1.5450124226407365, 1.5476308952880384, 3.195142613082104, 4.701576781447508, 0.8145549469307789, 1.0697871480664864, 3.656630259871509, -0.24934090575246537, 3.7991283606868222, 1.8492495345012951, 2.4841871144849472, -1.4795937229968676, 0.6921167434065181, 1.5507941835318846, 2.1997823984858034, 2.743529081678295, 4.13089929214758, 3.579216799403354, 1.7827821443216567, 1.7831743634496795, 0.6536074273475788, 5.363692293758561, 2.7910657007702686, 2.8992858937868986, 2.1139819313757178, 3.4459832851215397, 3.053081904607561, 4.3199028067436585, 1.7483366616059226, -2.671352117571953, 3.1557324902406454, 2.2143135549953734, 3.8274999708654813, 2.774710201859593, 0.4466885675640835, 0.3124170940344242, -1.637647308661889, 4.05511313782051, -0.32105572759596623, -1.2639022718703121, 4.356676366758367, 0.454306147252471, 5.592867505878885, 5.5091003597199135, 6.357770206410059, 3.048182138666871, 2.517322776433677, 6.573150766537063, 3.2538910892989836)
pred.se
// res14: DenseVector[Double] = DenseVector(0.39572272881873327, 0.47499872161141743, 0.5946358396260268, 0.43106346255893546, 0.9516463704295514, 0.3723326671736853, 0.6658501830281849, 0.33293990347607394, 0.5312782740444046, 0.8579833711586611, 0.5146778502792788, 0.6547669778357547, 0.5179482914918783, 0.7751105227741647, 0.6072213737196619, 0.46624824321175956, 0.4033427640204503, 0.3116255607211416, 0.31500643998263334, 0.6331479932435458, 0.6663156731996726, 0.5981124366006919, 0.3927882837596749, 0.44125666034864786, 0.5149249002803651, 0.3697118254655993, 0.4352722960743723, 0.4914043790266614, 0.41192217177917456, 0.5649341684879358, 0.4518616325304483, 0.7047351904939531, 0.6823886040290106, 0.5437397721353568, 0.5891401808726399, 0.6206314186939861, 0.5674135904429132, 0.5419522038925769, 0.5540244839684947, 0.4213720454040721, 0.39123905855606117, 0.5978587805171175, 0.6455477615473888, 0.6037036446975186, 0.6329766921975624, 0.7100050965842037, 0.6180883718241698, 0.4980188214387905, 0.32881965861635165, 0.4241795855067545, 0.3573598040020221, 0.6288841179251192, 0.4730214569820076, 0.6323957377645371, 0.5573242697373492, 0.5739618476730375, 0.6267045486056898, 0.7535502530175755, 0.6670266054125702, 0.5388766839931535, 0.4825270422662329, 0.4105901576340465, 0.8070491778007269, 0.5976030388682012, 0.674638309463463, 0.37335380945781493, 0.4236649085396948, 0.9186487728961682, 0.5505326996577616, 0.4449558941547079, 0.6676265623295954, 0.5435639168585776, 0.7881103573123523, 0.33855017826083655, 0.5168320570783643, 0.6234651837912932, 0.5287921372958219, 0.39225752528299473, 0.5102370658857373, 0.511253942653045, 0.9792354189301495, 0.5320454448791747, 0.8699043162681355, 0.49014564630694524, 0.3433325844567853, 0.46607917588896636, 0.5721794241299413, 0.820247692046157, 0.8433799800082894, 0.6508139870805558, 0.7678964663982215, 0.5010265811441067, 0.5536582976619694, 0.7122669465587795, 0.6917274921278355, 0.827629066481043, 0.778268473027917, 0.626299293395681, 0.673159210460132, 0.40256567839785035)
val predNew = lm.predict(DenseMatrix((1.1, 1.6, 1.0), (1.4, 2.2, 3.0)))
// predNew: PredictLm = PredictLm(
//   Lm(
//     DenseVector(2.0045590100114423, 4.244095892770323, -2.3683224378028718, 3.184804182888004, 9.122693395710748, 1.9043415577535359, 0.5168898059018687, 9.032334005267492, 0.4978056548089951, -0.08623774214116331, 0.6048743206332627, -7.9673151237491355, -2.11606285113185, -2.55216066322774, 6.961664184832772, 0.4543785071257489, 6.542013362537482, 5.227072750648992, -0.010034674740281968, 4.0722006021081425, 0.8740777219582849, 8.32376106395444, 7.763500621802593, -0.23779038658837237, 0.6211016100495992, 6.84610040825522, 4.053714403480064, -0.08738737073249703, 6.9001456188981365, 9.088979997039514, 2.7365802918168356, 0.0612311041472382, 2.500623143752004, 2.3451266298463773, 8.193839306100287, 8.47167895794453, 4.211298564760655, -1.0374443750279432, 8.636571015380309, 4.585292397700202, 0.5381136637883215, -0.0825877208392547, 2.2508019657285336, 3.3033791236191856, 0.42677299271373226, 1.5587644521893607, 0.9027590483123058, 4.548314643250602, 2.0922168226238385, 3.8593551929436427, 5.801404506966962, -1.148835428241747, -0.41064493327200924, 2.0072642457069914, 5.640637532927264, 2.768844856460757, -4.179029141498389, 5.661396317557948, 0.10104908243436059, 4.76439546522369, 5.163118293462355, 5.412683126034571, 2.6596442080668434, 3.6759470265960834, 4.545101998462977, -0.39522571490496805, -3.310301176045107, 7.4560039180167825, 4.349201428592993, 2.1022963123789524, 5.485281989060034, 2.3366197926045587, 2.4792957705144643, 1.5104296204659686, 2.788882834905259, 1.0721555223210402, 4.816103037132404, 0.9963274269528668, 6.332694862676231, 1.141954125480289, -4.957632331049342, 4.521202575764528, 0.08846406229678516, -0.2702347777321479, 5.89104697538421, 3.393056489051985, 2.7432517905745275, 0.8069189495237599, 3.263491625484754, -2.7875078106072113, -1.1903828018117635, 1.2242018680862445, -1.3965333737683774, 7.38829644546402, 4.702921502935355, 3.5561110015900597, -1.5865896727725035, 8.515841470024448, 10.175527734086213, 1.6854499896226982),
//     -0.48562556460068      2.1959095337404166     1.885548328467066     
// -0.3622024589263934    3.0685400956551545     3.4275619167972504    
// -0.44800620299497584   1.215175226441657      -2.387777347063091    
// -0.7749361181491704    -0.15511084076324555   1.6736416242675196    
// 1.9283464201822582     3.3171534578665596     7.3769281815276       
// -0.31189518469265454   0.09256903427990282    3.55394598926447      
// 0.9252857289848296     -2.357775772405574     3.0615147482126552    
// -0.3808427058391209    0.6518667250865567     1.5241913743593616    
// -0.16276588524292004   2.001831482351622      -1.5139617981679923   
// 0.42276734339272104    -3.4056714940293125    5.873353669828827     
// -0.4454532047020825    1.436935957593678      5.842608387926932     
// -1.5015152021871776    -0.8794678462766783    2.981679846033171     
// -1.2564140118241092    1.0783956003826116     2.4065454091518585    
// -0.6549633487970925    2.5745853139536905     8.276748446622415     
// 1.094058345387017      -0.8988536432689833    4.643024547210331     
// 0.08240375431463123    -0.7403266672449911    4.435171651584595     
// 0.8293787596932914     0.6406741551425936     2.736027522190643     
// 0.0381553115883977     0.6184123064961664     3.022387394386924     
// 0.36724839162599215    0.8262217691588603     2.2089348549223216    
// -0.5507395375507274    -0.763027748253456     -2.2963099743362516   
// 1.2438869972507318     -1.5256493294519178    -0.3156638014136792   
// 0.8239973126188344     3.8225902538377943     2.243279402194606     
// ...
predNew.fitted
// res15: DenseVector[Double] = DenseVector(4.906712908510669, 5.7649606934679944)
predNew.se
// res16: DenseVector[Double] = DenseVector(0.4905239005880657, 0.5820302906654692)
lm.plots
// res17: Figure = breeze.plot.Figure@3fd2dbe2
lm.summary
// Estimate	 S.E.	 t-stat	p-value		Variable
// ---------------------------------------------------------
//   2.0946	 0.394	 5.316	0.0000 *	(Intercept)
//   1.6208	 0.331	 4.895	0.0000 *	V1
//   0.6487	 0.154	 4.209	0.0001 *	V2
//  -0.0086	 0.106	-0.081	0.9358  	V3
// 
// Residual standard error:   2.9398 on 96 degrees of freedom
// Multiple R-squared: 0.3027, Adjusted R-squared: 0.2809
// F-statistic: 13.8888 on 3 and 96 DF, p-value: 0.00000
//
```
The plots include a plot of studentised residuals against fitted values and a normal Q-Q plot for the studentised residuals.

![Linear model plots](lm-plots.png)


## Generalised linear models

The current implementation supports only simple one-parameter exponential family observation models. This includes the most commonly used cases of **logistic regression** (`LogisticGlm`) and **Poisson regression** (`PoissonGlm`).

### Logistic regression

Again, we start by creating an appropriate response variable.
```scala
val ylb = (0 until 100) map (i => Bernoulli(sigmoid(1.0 + X(i,0))).sample())
val yl = DenseVector(ylb.toArray map {b => if (b) 1.0 else 0.0})
```

Then we can do logistic regression in a typical way.
```scala
import scalaglm.{Glm, LogisticGlm}
val glm = Glm(yl, X, List("V1","V2","V3"), LogisticGlm)
```
```scala
glm.coefficients
// res20: DenseVector[Double] = DenseVector(0.9364576374673794, 0.7633224763430169, 0.006565263926292367, 0.06173387464828336)
glm.fitted
// res21: DenseVector[Double] = DenseVector(0.6674307784637497, 0.7092455726817521, 0.6118405811802153, 0.609981277427118, 0.9471295924213091, 0.7147134601325764, 0.8601178074767423, 0.677897385974131, 0.6752208924033426, 0.8319332797313597, 0.7244320867145708, 0.49215415565303733, 0.5332144905793076, 0.7239954936796962, 0.8861805860094942, 0.7804512828259191, 0.8510237147407597, 0.7606463139391113, 0.7955283354533732, 0.5912888995692877, 0.8648815897860977, 0.8492865061829956, 0.7898890921272371, 0.8504609399761487, 0.7213641083163587, 0.7992885111189916, 0.7986953196114682, 0.5917820266897325, 0.8096825292360074, 0.8969091185167691, 0.8157755205465862, 0.8308890515263094, 0.4997752718479794, 0.5441208900889916, 0.8389092645067542, 0.7867622127475034, 0.8932774586654613, 0.603702499906367, 0.6662226053055835, 0.8172805512455642, 0.7074609023411638, 0.6504576705091976, 0.9052420109227286, 0.47741333674619796, 0.8451298250155149, 0.9209960308951296, 0.863823537266668, 0.8707515971427429, 0.7790027527125162, 0.8544902093928322, 0.7784407947893447, 0.5639941232228136, 0.7651077887546704, 0.7460132158199244, 0.7593913665104592, 0.4896926776561742, 0.695321585039431, 0.9182482085463861, 0.6367807961490018, 0.8197380634174015, 0.7032979259589736, 0.7184880807303667, 0.4429254503504227, 0.7614067266738906, 0.4712821400478571, 0.765482360936587, 0.7884388230858275, 0.8479803426494511, 0.7067888040039755, 0.7612562182249746, 0.5141952436963103, 0.7386909015561551, 0.8096291079745112, 0.7396943623237445, 0.6529753202400118, 0.8024992387331188, 0.6846639780910805, 0.7103828842851593, 0.8805063964707712, 0.8070765275406397, 0.35984374898203686, 0.7560869458514552, 0.8074659833350204, 0.7338880731091078, 0.7442467538311026, 0.6142658158812291, 0.48315091440884894, 0.3763151246415189, 0.9160796579439947, 0.6571364517211933, 0.5045671700555071, 0.7433308279945514, 0.6254668537909311, 0.7654672051797485, 0.7644496556812808, 0.8671795016928243, 0.6513621589572213, 0.8681703253402404, 0.9072199719314433, 0.7857684782408478)
glm.predict(response=true).fitted
// res22: DenseVector[Double] = DenseVector(0.6674307784637497, 0.7092455726817521, 0.6118405811802153, 0.609981277427118, 0.9471295924213091, 0.7147134601325764, 0.8601178074767423, 0.677897385974131, 0.6752208924033426, 0.8319332797313597, 0.7244320867145708, 0.49215415565303733, 0.5332144905793076, 0.7239954936796962, 0.8861805860094942, 0.7804512828259191, 0.8510237147407597, 0.7606463139391113, 0.7955283354533732, 0.5912888995692877, 0.8648815897860977, 0.8492865061829956, 0.7898890921272371, 0.8504609399761487, 0.7213641083163587, 0.7992885111189916, 0.7986953196114682, 0.5917820266897325, 0.8096825292360074, 0.8969091185167691, 0.8157755205465862, 0.8308890515263094, 0.4997752718479794, 0.5441208900889916, 0.8389092645067542, 0.7867622127475034, 0.8932774586654613, 0.603702499906367, 0.6662226053055835, 0.8172805512455642, 0.7074609023411638, 0.6504576705091976, 0.9052420109227286, 0.47741333674619796, 0.8451298250155149, 0.9209960308951296, 0.863823537266668, 0.8707515971427429, 0.7790027527125162, 0.8544902093928322, 0.7784407947893447, 0.5639941232228136, 0.7651077887546704, 0.7460132158199244, 0.7593913665104592, 0.4896926776561742, 0.695321585039431, 0.9182482085463861, 0.6367807961490018, 0.8197380634174015, 0.7032979259589736, 0.7184880807303667, 0.4429254503504227, 0.7614067266738906, 0.4712821400478571, 0.765482360936587, 0.7884388230858275, 0.8479803426494511, 0.7067888040039755, 0.7612562182249746, 0.5141952436963103, 0.7386909015561551, 0.8096291079745112, 0.7396943623237445, 0.6529753202400118, 0.8024992387331188, 0.6846639780910805, 0.7103828842851593, 0.8805063964707712, 0.8070765275406397, 0.35984374898203686, 0.7560869458514552, 0.8074659833350204, 0.7338880731091078, 0.7442467538311026, 0.6142658158812291, 0.48315091440884894, 0.3763151246415189, 0.9160796579439947, 0.6571364517211933, 0.5045671700555071, 0.7433308279945514, 0.6254668537909311, 0.7654672051797485, 0.7644496556812808, 0.8671795016928243, 0.6513621589572213, 0.8681703253402404, 0.9072199719314433, 0.7857684782408478)
glm.summary
// Estimate	 S.E.	 z-stat	p-value		Variable
// ---------------------------------------------------------
//   0.9365	 0.315	 2.978	0.0029 *	(Intercept)
//   0.7633	 0.283	 2.697	0.0070 *	V1
//   0.0066	 0.127	 0.052	0.9587  	V2
//   0.0617	 0.086	 0.720	0.4717  	V3
glm.plots
// res24: Figure = breeze.plot.Figure@55f2a26d
```

![Logistic regression plots](glm-plots.png)


### Poisson regression

We first create an appropriate response, and then do Poisson regression.
```scala
val yp = DenseVector.tabulate(100)(i => Poisson(math.exp(-0.5 + X(i,0))).sample().toDouble)

import scalaglm.PoissonGlm
val pglm = Glm(yp, X, List("V1","V2","V3"), PoissonGlm)
```
```scala
pglm.coefficients
// res26: DenseVector[Double] = DenseVector(-0.5620726488732393, 1.0320577920364544, 0.03491437870796975, -0.03449698047607687)
pglm.summary
// Estimate	 S.E.	 z-stat	p-value		Variable
// ---------------------------------------------------------
//  -0.5621	 0.176	-3.198	0.0014 *	(Intercept)
//   1.0321	 0.140	 7.365	0.0000 *	V1
//   0.0349	 0.056	 0.629	0.5294  	V2
//  -0.0345	 0.037	-0.937	0.3490  	V3
pglm.plots
// res28: Figure = breeze.plot.Figure@761e1290
```
![Poisson regression plots](pglm-plots.png)


## Non-linear response

The above covers the main functionality of the library based on a linear reponse to variation in covariate values. For flexible modelling of a nonlinear response, see the documentation on [flexible regression modelling](FlexibleRegression.md).


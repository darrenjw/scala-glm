# scala-glm - Quickstart Guide

## PCA

This library contains code for principal components analysis based on a thin SVD of the centred data matrix. This is more numerically stable than a construction from the spectral decomposition of the covariance matrix. It is analogous to the R function `prcomp` rather than the R function `princomp`. First create some synthetic data.

```scala
import breeze.linalg.*
import breeze.numerics.*
import breeze.stats.distributions.*
import breeze.stats.distributions.Rand.VariableSeed.randBasis

val X = DenseMatrix.tabulate(100, 3)((i, j) => 
	Gaussian(j, j+1).sample())
```
Now we can do PCA.
```scala
import scalaglm.Pca
val pca = Pca(X, List("V1", "V2", "V3"))
```
```scala
pca.sdev
// res0: DenseVector[Double] = DenseVector(3.112371122734644, 2.1625553616006203, 1.0172796652026894)
pca.loadings
// res1: DenseMatrix[Double] = -0.01860769933179505  -0.15295684870532267  0.9880576683370836   
// -0.08388036114398628  0.98498369739552      0.1509012951548287   
// 0.9963020819710917    0.08007070812218015   0.03115835619670416  
pca.scores
// res2: DenseMatrix[Double] = -5.24883811201008      2.528242742602657      -0.5046214795740648   
// -3.3739788999787246    -2.0399707873240547    -0.2886173508097941   
// -0.7322119601387961    -1.428824163503724     1.3963544239751513    
// 3.0205722484362485     2.102165821560422      0.1813818986573866    
// -0.46300364167751623   -3.3861280559894738    -1.4423640050911202   
// -0.7314580377490758    -2.4708544977258624    0.8607191246570884    
// -2.7078512363961114    -2.795226399543563     1.0874382650454815    
// 2.667524123133501      -5.610908773016457     1.265185697069335     
// -4.258175995217611     -0.3667011435761965    -1.2451316880784817   
// 1.8713628182506623     0.004111894717836419   0.07655401458357286   
// 4.8539051820302        1.031690711488464      -0.3102413661636939   
// -0.3182240868850372    -1.0352884265454956    -0.38865993114117803  
// -3.322172773273323     -5.295061530469006     0.22479584090587962   
// -0.11163522960723803   -0.1586493961342198    1.5689496006857155    
// -2.9146264007034195    0.8882602081886389     -0.7604391518477525   
// 1.3786075557085231     -2.7794365221891475    0.8331486752883249    
// 0.4058262653005354     -0.004756904771310683  -2.1126646319011595   
// -0.3843387086353046    1.6964761960050923     0.6847111938792265    
// 0.9282995950458721     2.82530258847337       0.5334519846273645    
// -1.5824200665369468    1.474719932791521      -0.33499516226667486  
// -0.034867656455740643  3.7661005694213165     0.793541848351083     
// -3.1609208364772274    0.19044679611985843    -1.1932620172515642   
// 2.718359272512065      1.3635181717018048     0.7769856397896259    
// 2.472296326017784      -0.5198242767316977    0.6598438159406579    
// 3.8630104670210073     -1.1013341880618004    -0.24704064838955753  
// -3.5435012740221423    -1.2768568492538708    -0.6638017252737225   
// -4.338276832881076     0.7274365717059564     0.07013645646803324   
// 1.1374007944047309     -0.8834102589612262    0.017919695349924575  
// -2.6359117438892894    -2.128348511264376     -0.2934812381501039   
// 1.4409557984929833     -2.212132232432048     0.8824168179526145    
// 3.117532424690442      0.34452053968759355    -0.0894615502539378   
// 0.5394401041412287     0.14331717690974394    -0.6524922604829618   
// -1.669570682124033     1.850665247462722      -0.7574085934334008   
// 5.451886651376936      -0.25775321743947305   -0.41671980981028783  
// -4.264996060996902     0.873595815443201      0.8126338162294334    
// -0.31426165027022307   1.1324665744263704     -0.2976138444150208   
// 0.918042923435355      1.343979153125477      0.1270499156301302    
// 2.2660780922046118     1.0044497431763728     -0.43045016994199636  
// 0.6156418965659509     0.475910347352754      0.10968409224552642   
// -0.14863353292095005   -1.2759207915861246    1.6631830783030443    
// 0.5390406401585632     -3.223302037314197     -1.5393007828372178   
// -1.2912321170560686    0.5866557523330432     2.207377241244755     
// -3.7239643002923315    1.2825687102964818     -0.8963213968937179   
// -1.8054748656133928    3.5295423418884577     1.019673632265325     
// -0.8978792261199859    -0.7655326558170434    -0.8712397373078365   
// 2.1651356217797972     3.581767866659567      -0.9684851573010628   
// 0.6232618944656727     0.3598099260553415     -1.6973536436025822   
// -2.14110679987476      -2.342842102005854     -0.8548926365096816   
// 0.9686197876869398     -1.9802993825816422    -1.4893555065519688   
// ...
pca.plots
// res3: Figure = breeze.plot.Figure@18751aab
pca.summary
// Standard deviations:
// V1	V2	V3
//  3.112	 2.163	 1.017
// Cumulative proportion of variance explained:
// V1	V2	V3
//  0.629	 0.933	 1.000
// Loadings:
// PC01	PC02	PC03	
// -0.019	-0.153	 0.988	V1
// -0.084	 0.985	 0.151	V2
//  0.996	 0.080	 0.031	V3
```
The final line prints a readable summary of the PCA to the console. `plots` produces some diagnostic plots, including a "scree plot".

![PCA Plots](pca-plots.png)

Note that there is also a utility function `pairs` for producing a "scatterplot matrix":
```scala
import scalaglm.Utils.pairs
pairs(X, List("V1", "V2", "V3"))
// res6: Figure = breeze.plot.Figure@5c38117e
```

![Pairs plots](pairs-plots.png)


## Linear regression

This code computes regression coefficients and associated diagnostics via the QR decomposition of the covariate matrix. The diagnostics are analogous to those produced by the R function `lm`. We start by creating a synthetic response variable.

```scala
val y = DenseVector.tabulate(100)(i => 
	Gaussian(2.0 + 1.5*X(i,0) + 0.5*X(i,1), 3.0).sample())
```
So we can now do linear regression and generate all of the usual diagnostics.
```scala
import scalaglm.Lm
val lm = Lm(y,X,List("V1", "V2", "V3"))
```
```scala
lm.coefficients
// res8: DenseVector[Double] = DenseVector(1.7253248393861675, 1.6282663288824406, 0.7692028972424602, -0.017137494478981517)
lm.se
// res9: DenseVector[Double] = DenseVector(0.3310360841121189, 0.2455557370797336, 0.12097353036791678, 0.08161876309024171)
lm.fitted
// res10: DenseVector[Double] = DenseVector(3.2321927986696264, 1.0777624977108071, 3.997654586505899, 3.2737003061151655, -1.920237422755109, 2.545397252476877, 2.992958517298728, 1.2698038112417673, 0.3760477690980566, 2.157341503180432, 1.6778541302107755, 1.0729347433995606, 0.30620989185626035, 4.8700976589360945, 1.6980467380065267, 2.1052326700994146, -1.458175819688614, 4.316832587597048, 4.481701203114572, 2.580067924114774, 5.5151588820648545, 0.6253138598091519, 3.9598906684239985, 2.8301491961875582, 0.8157847070386498, 0.8368486579205323, 3.2079819929925386, 1.6881863395374481, 0.9419630911577441, 2.4709636316494574, 1.9042965708574549, 1.1198445912279622, 2.0521154498182224, 0.7732976913125755, 4.554251387330571, 2.329028538525826, 3.030699880899965, 1.7463143133864114, 2.5942848893257184, 4.470021366205875, -2.116924042047268, 6.481004239560742, 1.7542996906301682, 5.983222577545703, 0.4424796952844573, 2.13712446024721, -0.5814418269885131, -0.19027476510546398, -1.4483846634751507, 3.674832581942518, -2.1848680506121845, 0.010961774269896862, 2.586570522284614, -0.5576807324505255, 3.372743027123566, -0.015850931468902485, 1.9025120606104267, 3.264181830282487, 0.1380945432647258, 3.6943260056103018, 4.899454773594393, -1.3891725257145844, 0.8308401995358096, 4.479576106696667, 5.3848255531736715, 0.7052972294537088, 0.1637896002197466, 2.0310261252308366, 4.192493736820089, 6.299227187661016, 3.673332231143661, 2.381616163641407, -1.4142340707843704, 1.9152749769093536, -0.2818400901621956, 1.7872481281511197, 1.7937301874204752, 4.2885417853137024, 3.43781735110511, 1.611522629349351, 2.408233847158648, 3.1229298224758555, -1.5468680846168121, 4.836115206196475, 3.668931571972198, 2.349813011143747, 1.2017482444960963, 1.5780018442720818, 2.7542797835582244, 0.7100127201875838, 4.376665325555905, 6.728182545337964, 4.571332803122115, -1.469498760584421, 3.350491294503758, 4.867223826579048, 6.366343551738413, 3.272930621169691, 1.361706581644881, 5.498540624838439)
lm.residuals
// res11: DenseVector[Double] = DenseVector(2.1667385415043117, -3.4863699216309487, 0.3178407151494027, -2.19240059231383, -1.2374478002931215, -1.2118711363143304, -3.428000246919991, 1.3215879868639855, -0.9145315520339264, 1.2476258438978176, -1.570937393773101, -0.33642011008196104, 5.5287347882979585, 5.98892413066268, -1.732092259026684, 4.405228339398503, 3.348924188339169, -3.6702974768350187, 8.913362049470503, -0.8581209271232104, -0.5554942067980368, -1.0787887971654946, 2.5762479351615806, -4.72171193995365, -1.0996273629206428, -2.647518485061705, 1.0618210788649667, -2.724919355098632, 1.4553950660330413, 1.7271606039430196, -3.634128054212047, 1.1535759104637138, -2.406102143035789, 0.6743562658062454, -1.3442967139493254, -3.2221373453382545, -1.6925550750693215, 0.4306913089969937, -2.039740569652346, 1.1474645509769283, 2.481913952917015, -2.181654319853009, -1.1776690532760816, -1.0529448174642164, -1.831856402881844, 3.5497825989103005, -0.8092565145670729, 3.630461250033854, -0.5898397639919364, -0.7379785843621689, -2.5438826838962525, -3.6302605128121286, 1.6555788981859578, 0.7719844991061635, -0.3033216682462534, -1.519325158157284, -1.5183991617745258, -1.9566063340809818, 1.6540434120403975, 2.2709419166126388, -5.029832154872992, 3.4645478338547058, 0.7103891330652495, 0.5610107082934306, 1.6229795623666226, 1.184982574925812, 2.5860890937782224, -1.6581276578177961, -1.9526303188503258, 3.185704498862341, 1.7458125588953788, -2.437704874549675, 3.251991997931169, 1.4203790514765924, 1.6164379453705033, -2.0631543521768734, 1.1101740273378211, -5.733259657047844, 3.367404339286578, -0.5333678368676897, 0.435447213150284, 0.2927941132002987, -0.12083736478217877, 2.599937211171195, 0.6980348501474447, -0.02626830278515646, 1.2031756647258407, -0.37322276188337256, 1.0688520468169793, -0.8072045534401248, 2.477759033945799, -1.1506453314679428, 0.8515628012400507, -3.3286774954011555, -3.0617599079707216, -0.471517032102847, 1.993824184189255, -2.1927232305602935, 0.43973012785578236, 1.230030869017578)
lm.studentised
// res12: DenseVector[Double] = DenseVector(0.8884357958507081, -1.4121898858339132, 0.12889970218542518, -0.8870051985184246, -0.5074691841617681, -0.49070440433344786, -1.398982099541317, 0.5555936863186397, -0.3728856884772873, 0.5007405181916025, -0.6383494655531491, -0.13503653666317228, 2.300741637267675, 2.428915500255301, -0.699630212057081, 1.7878675685176952, 1.3722411063138602, -1.4785259165617715, 3.6090425614323043, -0.345233533326229, -0.2267850560613242, -0.43759021304930584, 1.0413558207927458, -1.9023261336095818, -0.44475089543859303, -1.071985977058773, 0.4299116337613561, -1.093287274230568, 0.5883687418207622, 0.6991216556618353, -1.4635988317579498, 0.46317971432564986, -0.9717264090792073, 0.27474279369469273, -0.5460430615882284, -1.2932387598425876, -0.6797385259117765, 0.1733557749386699, -0.817538299385116, 0.466935180798838, 1.018127084207655, -0.8969381429396563, -0.4780607828974785, -0.4307038082976775, -0.7373980083341923, 1.4530209553567688, -0.3290118149636054, 1.4721508319345042, -0.24009229516874891, -0.3066815009848231, -1.0662228889814145, -1.4681773697994573, 0.6634434687813952, 0.3164602012566376, -0.1223327576762288, -0.6157839939739399, -0.6207189445877954, -0.7899484083014914, 0.6728800613253584, 0.9422778721663819, -2.0327853615542066, 1.4154690260570506, 0.28762213579305335, 0.22779029862170466, 0.6787816770758822, 0.477390508454703, 1.0523919819343623, -0.6858002621369375, -0.7911148644747032, 1.3127887867908032, 0.7129731666634923, -0.9779840911253255, 1.3239563414626394, 0.5863259788102639, 0.6600456311163428, -0.8291429766690174, 0.44995249056810893, -2.321331017084347, 1.383776234131282, -0.21458038206015623, 0.17562921791627753, 0.11765449021287508, -0.05053724084579315, 1.068975395171662, 0.2830787087656034, -0.010529117819757577, 0.4955121798045549, -0.15124071046520352, 0.45539037350721884, -0.32528069771131823, 1.0078443106595454, -0.4759405867816102, 0.3447342489067321, -1.3865712114466175, -1.2447655650136922, -0.19083434378930828, 0.8154806225107799, -0.8878054909389079, 0.17822544459842443, 0.5011615779598271)
val pred = lm.predict()
// pred: PredictLm = PredictLm(
//   mod = Lm(
//     y = DenseVector(5.398931340173938, -2.4086074239201416, 4.315495301655302, 1.0812997138013354, -3.1576852230482304, 1.3335261161625467, -0.435041729621263, 2.591391798105753, -0.5384837829358698, 3.4049673470782498, 0.10691673643767441, 0.7365146333175996, 5.834944680154218, 10.859021789598774, -0.03404552102015734, 6.510461009497918, 1.8907483686505548, 0.6465351107620294, 13.395063252585075, 1.7219469969915637, 4.959664675266818, -0.4534749373563427, 6.536138603585579, -1.8915627437660922, -0.28384265588199287, -1.8106698271411725, 4.269803071857505, -1.0367330155611838, 2.3973581571907854, 4.198124235592477, -1.7298314833545922, 2.273420501691676, -0.35398669321756704, 1.447653957118821, 3.2099546733812456, -0.8931088068124287, 1.3381448058306433, 2.177005622383405, 0.5545443196733726, 5.617485917182804, 0.3649899108697472, 4.299349919707733, 0.5766306373540866, 4.930277760081487, -1.3893767075973869, 5.686907059157511, -1.390698341555586, 3.44018648492839, -2.038224427467087, 2.936853997580349, -4.728750734508437, -3.6192987385422315, 4.242149420470572, 0.214303766655638, 3.0694213588773125, -1.5351760896261866, 0.38411289883590083, 1.3075754962015051, 1.7921379553051233, 5.9652679222229406, -0.13037738127859821, 2.0753753081401216, 1.541229332601059, 5.040586814990098, 7.007805115540294, 1.8902798043795208, 2.749878693997969, 0.37289846741304045, 2.2398634179697634, 9.484931686523357, 5.41914479003904, -0.05608871090826817, 1.8377579271467985, 3.335654028385946, 1.3345978552083078, -0.2759062240257537, 2.9039042147582963, -1.4447178717341416, 6.805221690391688, 1.0781547924816612, 2.843681060308932, 3.415723935676154, -1.667705449398991, 7.43605241736767, 4.366966422119643, 2.3235447083585905, 2.404923909221937, 1.2047790823887092, 3.8231318303752038, -0.097191833252541, 6.854424359501704, 5.577537213870021, 5.422895604362166, -4.7981762559855765, 0.28873138653303654, 4.395706794476201, 8.360167735927668, 1.0802073906093974, 1.8014367095006634, 6.728571493856017),
//     Xmat = -0.880977035749215     3.7608819522292314     -2.8272457989926645   
// -0.003699770687524585  -0.8634024659802235    -1.3183694212537032   
// 1.5185132457226138     -0.22876094665652302   1.415064374667133     
// -0.29186945587221397   2.751080801939805      5.398843416622038     
// -0.9919305784603796    -2.6076209501052596    1.438104674197414     
// 1.1486463282161974     -1.336035137736999     1.3156898869200169    
// 1.4590489477481576     -1.4555433857345847    -0.6723032638261794   
// 1.9653281953024213     -4.653010729388296     4.463279034558212     
// -1.1882762745439135    0.7145683738013207     -2.09512035728663     
// -0.05314958997707026   0.7651093263021675     4.082624740555201     
// -0.6479992011608994    1.46871305409448       7.124364962417349     
// -0.31308122399242244   -0.14522109178490816   1.803413926737322     
// 1.0005064999046036     -3.9964845825591206    -1.5113951790602593   
// 1.4832177986535855     0.9963311274741453     2.14042783837452      
// -0.9263273978403878    1.9111281524175174     -0.6409512322491859   
// 1.1293414021934796     -1.821136881677111     3.3923851996829035    
// -2.187597054144131     0.5489475095894099     2.553585036211325     
// 0.3308594799885324     2.713041337845933      1.9897225990341878    
// -0.01568024823301564   3.691987146072576      3.383179814138786     
// -0.6204565277688125    2.441235520945855      0.7465430928991525    
// 0.11532436826399689    4.738696534039493      2.5070086093328303    
// ...
pred.fitted
// res13: DenseVector[Double] = DenseVector(3.2321927986696233, 1.077762497710806, 3.9976545865059006, 3.2737003061151655, -1.9202374227551084, 2.5453972524768775, 2.992958517298728, 1.2698038112417684, 0.37604776909805704, 2.157341503180432, 1.6778541302107752, 1.072934743399561, 0.30620989185626124, 4.8700976589360945, 1.6980467380065265, 2.105232670099415, -1.4581758196886128, 4.316832587597047, 4.4817012031145715, 2.5800679241147746, 5.515158882064854, 0.6253138598091521, 3.959890668423998, 2.8301491961875582, 0.81578470703865, 0.8368486579205326, 3.2079819929925386, 1.6881863395374481, 0.9419630911577445, 2.4709636316494574, 1.904296570857455, 1.1198445912279624, 2.0521154498182224, 0.7732976913125758, 4.554251387330571, 2.329028538525826, 3.030699880899965, 1.7463143133864112, 2.5942848893257184, 4.470021366205876, -2.116924042047267, 6.4810042395607415, 1.7542996906301684, 5.983222577545703, 0.4424796952844574, 2.1371244602472097, -0.5814418269885127, -0.19027476510546337, -1.4483846634751494, 3.6748325819425176, -2.1848680506121845, 0.01096177426989664, 2.586570522284614, -0.5576807324505246, 3.3727430271235654, -0.01585093146890193, 1.9025120606104267, 3.264181830282487, 0.1380945432647258, 3.6943260056103018, 4.8994547735943925, -1.389172525714583, 0.8308401995358097, 4.479576106696668, 5.384825553173671, 0.705297229453709, 0.1637896002197472, 2.031026125230837, 4.192493736820089, 6.299227187661016, 3.673332231143661, 2.381616163641407, -1.41423407078437, 1.9152749769093538, -0.2818400901621949, 1.78724812815112, 1.7937301874204754, 4.2885417853137024, 3.4378173511051098, 1.6115226293493508, 2.4082338471586486, 3.122929822475855, -1.5468680846168117, 4.836115206196475, 3.668931571972198, 2.349813011143747, 1.201748244496096, 1.578001844272082, 2.7542797835582244, 0.7100127201875839, 4.376665325555905, 6.728182545337962, 4.571332803122115, -1.4694987605844194, 3.3504912945037573, 4.867223826579048, 6.366343551738412, 3.2729306211696905, 1.361706581644881, 5.498540624838438)
pred.se
// res14: DenseVector[Double] = DenseVector(0.588475291678962, 0.4464837196478012, 0.46260410260446067, 0.4300248690755554, 0.5899451815938934, 0.44154763167918354, 0.5384560603219405, 0.7974805505497975, 0.5282259650693434, 0.2937456276628155, 0.4878094207811981, 0.2957324031128867, 0.7208652616454339, 0.46324552727659274, 0.40613989153182795, 0.4723164969478528, 0.5815779866922848, 0.36309777015173494, 0.4411321032884192, 0.3403476746879254, 0.5426384338373319, 0.46528283712488844, 0.416899273149121, 0.36534958877837853, 0.42558569896716725, 0.4411208601746734, 0.44041189883836135, 0.2864639962921778, 0.4188281659890352, 0.4369586454604303, 0.35893652734406445, 0.30213717181295685, 0.4037840453109802, 0.5192244376999875, 0.48298496071729596, 0.2940516360531487, 0.30662786577998413, 0.34891830138143887, 0.2631490247976787, 0.5051346875976003, 0.593010949848309, 0.6147443299274986, 0.4750585087107953, 0.5635344347421622, 0.3504758996980548, 0.5707367621974031, 0.4942151528360376, 0.4610311122610764, 0.5086138019554145, 0.7097289009507839, 0.7757123749287246, 0.4245737164440054, 0.25880208078264477, 0.5859319605397949, 0.38254789213694124, 0.45451720127420264, 0.5570448638410269, 0.39904624736928784, 0.5016375357860036, 0.6969924132412737, 0.41440818872721774, 0.5506917111391164, 0.4403526507400572, 0.4781133671078321, 0.7597342294760623, 0.3644293428148944, 0.5055949684865789, 0.6696344939115573, 0.4496116369584141, 0.6367423711830522, 0.5462068698981172, 0.2849632383562277, 0.5107951540725352, 0.6523981375766044, 0.5446715676639549, 0.3202209971705945, 0.45445337274359315, 0.440654473959518, 0.610161146820571, 0.34029379491167855, 0.3833581992355347, 0.317917786377214, 0.7596167784575303, 0.6153709731867366, 0.4622321667478993, 0.26460458849399987, 0.6310904460170892, 0.4521333926019443, 0.8861335213627104, 0.3687961583353692, 0.5000712581327015, 0.6702689108503266, 0.4384904929094741, 0.7287158843126966, 0.4939654575743668, 0.43499595665753815, 0.5624021754400196, 0.44060812204286764, 0.4546965840778755, 0.5198877426866005)
val predNew = lm.predict(DenseMatrix((1.1, 1.6, 1.0), (1.4, 2.2, 3.0)))
// predNew: PredictLm = PredictLm(
//   mod = Lm(
//     y = DenseVector(5.398931340173938, -2.4086074239201416, 4.315495301655302, 1.0812997138013354, -3.1576852230482304, 1.3335261161625467, -0.435041729621263, 2.591391798105753, -0.5384837829358698, 3.4049673470782498, 0.10691673643767441, 0.7365146333175996, 5.834944680154218, 10.859021789598774, -0.03404552102015734, 6.510461009497918, 1.8907483686505548, 0.6465351107620294, 13.395063252585075, 1.7219469969915637, 4.959664675266818, -0.4534749373563427, 6.536138603585579, -1.8915627437660922, -0.28384265588199287, -1.8106698271411725, 4.269803071857505, -1.0367330155611838, 2.3973581571907854, 4.198124235592477, -1.7298314833545922, 2.273420501691676, -0.35398669321756704, 1.447653957118821, 3.2099546733812456, -0.8931088068124287, 1.3381448058306433, 2.177005622383405, 0.5545443196733726, 5.617485917182804, 0.3649899108697472, 4.299349919707733, 0.5766306373540866, 4.930277760081487, -1.3893767075973869, 5.686907059157511, -1.390698341555586, 3.44018648492839, -2.038224427467087, 2.936853997580349, -4.728750734508437, -3.6192987385422315, 4.242149420470572, 0.214303766655638, 3.0694213588773125, -1.5351760896261866, 0.38411289883590083, 1.3075754962015051, 1.7921379553051233, 5.9652679222229406, -0.13037738127859821, 2.0753753081401216, 1.541229332601059, 5.040586814990098, 7.007805115540294, 1.8902798043795208, 2.749878693997969, 0.37289846741304045, 2.2398634179697634, 9.484931686523357, 5.41914479003904, -0.05608871090826817, 1.8377579271467985, 3.335654028385946, 1.3345978552083078, -0.2759062240257537, 2.9039042147582963, -1.4447178717341416, 6.805221690391688, 1.0781547924816612, 2.843681060308932, 3.415723935676154, -1.667705449398991, 7.43605241736767, 4.366966422119643, 2.3235447083585905, 2.404923909221937, 1.2047790823887092, 3.8231318303752038, -0.097191833252541, 6.854424359501704, 5.577537213870021, 5.422895604362166, -4.7981762559855765, 0.28873138653303654, 4.395706794476201, 8.360167735927668, 1.0802073906093974, 1.8014367095006634, 6.728571493856017),
//     Xmat = -0.880977035749215     3.7608819522292314     -2.8272457989926645   
// -0.003699770687524585  -0.8634024659802235    -1.3183694212537032   
// 1.5185132457226138     -0.22876094665652302   1.415064374667133     
// -0.29186945587221397   2.751080801939805      5.398843416622038     
// -0.9919305784603796    -2.6076209501052596    1.438104674197414     
// 1.1486463282161974     -1.336035137736999     1.3156898869200169    
// 1.4590489477481576     -1.4555433857345847    -0.6723032638261794   
// 1.9653281953024213     -4.653010729388296     4.463279034558212     
// -1.1882762745439135    0.7145683738013207     -2.09512035728663     
// -0.05314958997707026   0.7651093263021675     4.082624740555201     
// -0.6479992011608994    1.46871305409448       7.124364962417349     
// -0.31308122399242244   -0.14522109178490816   1.803413926737322     
// 1.0005064999046036     -3.9964845825591206    -1.5113951790602593   
// 1.4832177986535855     0.9963311274741453     2.14042783837452      
// -0.9263273978403878    1.9111281524175174     -0.6409512322491859   
// 1.1293414021934796     -1.821136881677111     3.3923851996829035    
// -2.187597054144131     0.5489475095894099     2.553585036211325     
// 0.3308594799885324     2.713041337845933      1.9897225990341878    
// -0.01568024823301564   3.691987146072576      3.383179814138786     
// -0.6204565277688125    2.441235520945855      0.7465430928991525    
// 0.11532436826399689    4.738696534039493      2.5070086093328303    
// ...
predNew.fitted
// res15: DenseVector[Double] = DenseVector(4.730004942265808, 5.645731590318053)
predNew.se
// res16: DenseVector[Double] = DenseVector(0.41407406075051345, 0.5088384819481724)
lm.plots
// res17: Figure = breeze.plot.Figure@6f1d9289
lm.summary
// Estimate	 S.E.	 t-stat	p-value		Variable
// ---------------------------------------------------------
//   1.7253	 0.331	 5.212	0.0000 *	(Intercept)
//   1.6283	 0.246	 6.631	0.0000 *	V1
//   0.7692	 0.121	 6.358	0.0000 *	V2
//  -0.0171	 0.082	-0.210	0.8341  	V3
// 
// Residual standard error:   2.5088 on 96 degrees of freedom
// Multiple R-squared: 0.4190, Adjusted R-squared: 0.4008
// F-statistic: 23.0771 on 3 and 96 DF, p-value: 0.00000
//
```
The plots include a plot of studentised residuals against fitted values and a normal Q-Q plot for the studentised residuals.

![Linear model plots](lm-plots.png)


## Generalised linear models

The current implementation supports only simple one-parameter exponential family observation models. This includes the most commonly used cases of **logistic regression** (`LogisticGlm`) and **Poisson regression** (`PoissonGlm`).

### Logistic regression

Again, we start by creating an appropriate response variable.
```scala
val ylb = (0 until 100) map (i => Bernoulli(sigmoid(1.0 + X(i,0))).sample())
val yl = DenseVector(ylb.toArray map {b => if (b) 1.0 else 0.0})
```

Then we can do logistic regression in a typical way.
```scala
import scalaglm.{Glm, LogisticGlm}
val glm = Glm(yl, X, List("V1","V2","V3"), LogisticGlm)
```
```scala
glm.coefficients
// res20: DenseVector[Double] = DenseVector(0.7784096182679596, 1.0718906500445584, 0.048186585453936594, 0.00587359351280839)
glm.fitted
// res21: DenseVector[Double] = DenseVector(0.49967913447744333, 0.6737281772962291, 0.9170845359635528, 0.6524516578207284, 0.4008230268657613, 0.8757714057343519, 0.9062143528266748, 0.9362569215439036, 0.3838671952357194, 0.686172752355962, 0.5489534812201878, 0.6097866719612924, 0.8388084433077406, 0.9190001294509437, 0.46849529145958024, 0.8722622992128961, 0.17872575087122242, 0.7816783357760083, 0.7229972098043915, 0.5585717932516058, 0.7586132149933597, 0.37698059495649855, 0.7951494597886499, 0.8106562308483021, 0.6293181638474512, 0.5595863055659396, 0.6908586985509663, 0.6976287377599943, 0.6718968322123029, 0.8706489345447571, 0.6325401999800542, 0.5031827417956029, 0.43605425246505364, 0.5551831673702673, 0.82888658860873, 0.5724725030380483, 0.6677399242361689, 0.5295473151122639, 0.6868979571261582, 0.9346026276899674, 0.3676090196579538, 0.9545519626255804, 0.42502458345083954, 0.809355406958782, 0.4777492605955135, 0.3202332607017738, 0.24447546727948288, 0.5334297058764564, 0.3449702453326832, 0.8236732530883878, 0.6084747430702425, 0.3522058887255161, 0.6977409139572035, 0.21316486393411194, 0.7555777772444392, 0.5026024547246003, 0.2802585808781452, 0.6230357978295772, 0.24445084929695937, 0.3375522719345499, 0.8182502566501908, 0.2200475340994195, 0.6412525580665831, 0.7397458898840348, 0.9649356678110395, 0.6068465820468607, 0.5442052130155056, 0.9253615732614721, 0.8436458768196551, 0.7768182550272218, 0.9145167405390534, 0.7692822165676055, 0.33570955832234045, 0.6469231571035795, 0.5973255885689686, 0.5440008073806849, 0.6013608744961035, 0.8572979651813268, 0.3957410379543613, 0.4679948690725742, 0.6710497073855285, 0.7860450829366715, 0.18586970198563146, 0.9590209734888407, 0.9138533498921732, 0.7373604040286154, 0.7860137813116174, 0.382225711161747, 0.5889420071460212, 0.6126143336008026, 0.8874436729104943, 0.9398468443361319, 0.7129410622615134, 0.6580267818012806, 0.6325989037728104, 0.8727086255652083, 0.9169316700580155, 0.7328398644214218, 0.3895451156527216, 0.8669508603246409)
glm.predict(response=true).fitted
// res22: DenseVector[Double] = DenseVector(0.49967913447744333, 0.6737281772962291, 0.9170845359635528, 0.6524516578207284, 0.4008230268657613, 0.8757714057343519, 0.9062143528266748, 0.9362569215439036, 0.3838671952357194, 0.686172752355962, 0.5489534812201878, 0.6097866719612924, 0.8388084433077406, 0.9190001294509437, 0.46849529145958024, 0.8722622992128961, 0.17872575087122242, 0.7816783357760083, 0.7229972098043915, 0.5585717932516058, 0.7586132149933597, 0.37698059495649855, 0.7951494597886499, 0.8106562308483021, 0.6293181638474512, 0.5595863055659396, 0.6908586985509663, 0.6976287377599943, 0.6718968322123029, 0.8706489345447571, 0.6325401999800542, 0.5031827417956029, 0.43605425246505364, 0.5551831673702673, 0.82888658860873, 0.5724725030380483, 0.6677399242361689, 0.5295473151122639, 0.6868979571261582, 0.9346026276899674, 0.3676090196579538, 0.9545519626255804, 0.42502458345083954, 0.809355406958782, 0.4777492605955135, 0.3202332607017738, 0.24447546727948288, 0.5334297058764564, 0.3449702453326832, 0.8236732530883878, 0.6084747430702425, 0.3522058887255161, 0.6977409139572035, 0.21316486393411194, 0.7555777772444392, 0.5026024547246003, 0.2802585808781452, 0.6230357978295772, 0.24445084929695937, 0.3375522719345499, 0.8182502566501908, 0.2200475340994195, 0.6412525580665831, 0.7397458898840348, 0.9649356678110395, 0.6068465820468607, 0.5442052130155056, 0.9253615732614721, 0.8436458768196551, 0.7768182550272218, 0.9145167405390534, 0.7692822165676055, 0.33570955832234045, 0.6469231571035795, 0.5973255885689686, 0.5440008073806849, 0.6013608744961035, 0.8572979651813268, 0.3957410379543613, 0.4679948690725742, 0.6710497073855285, 0.7860450829366715, 0.18586970198563146, 0.9590209734888407, 0.9138533498921732, 0.7373604040286154, 0.7860137813116174, 0.382225711161747, 0.5889420071460212, 0.6126143336008026, 0.8874436729104943, 0.9398468443361319, 0.7129410622615134, 0.6580267818012806, 0.6325989037728104, 0.8727086255652083, 0.9169316700580155, 0.7328398644214218, 0.3895451156527216, 0.8669508603246409)
glm.summary
// Estimate	 S.E.	 z-stat	p-value		Variable
// ---------------------------------------------------------
//   0.7784	 0.313	 2.490	0.0128 *	(Intercept)
//   1.0719	 0.277	 3.874	0.0001 *	V1
//   0.0482	 0.112	 0.430	0.6669  	V2
//   0.0059	 0.073	 0.080	0.9361  	V3
glm.plots
// res24: Figure = breeze.plot.Figure@4e20bd8b
```

![Logistic regression plots](glm-plots.png)


### Poisson regression

We first create an appropriate response, and then do Poisson regression.
```scala
val yp = DenseVector.tabulate(100)(i => Poisson(math.exp(-0.5 + X(i,0))).sample().toDouble)

import scalaglm.PoissonGlm
val pglm = Glm(yp, X, List("V1","V2","V3"), PoissonGlm)
```
```scala
pglm.coefficients
// res26: DenseVector[Double] = DenseVector(-0.6369371976458453, 1.1589840802210492, 0.015582797564442084, 0.04180967647571827)
pglm.summary
// Estimate	 S.E.	 z-stat	p-value		Variable
// ---------------------------------------------------------
//  -0.6369	 0.176	-3.627	0.0003 *	(Intercept)
//   1.1590	 0.106	10.910	0.0000 *	V1
//   0.0156	 0.045	 0.345	0.7300  	V2
//   0.0418	 0.034	 1.238	0.2156  	V3
pglm.plots
// res28: Figure = breeze.plot.Figure@260b79b
```
![Poisson regression plots](pglm-plots.png)


## Non-linear response

The above covers the main functionality of the library based on a linear reponse to variation in covariate values. For flexible modelling of a nonlinear response, see the documentation on [flexible regression modelling](FlexibleRegression.md).


# scala-glm - Quickstart Guide

## PCA

This library contains code for principal components analysis based on a thin SVD of the centred data matrix. This is more numerically stable than a construction from the spectral decomposition of the covariance matrix. It is analogous to the R function `prcomp` rather than the R function `princomp`. First create some synthetic data.

```scala
import breeze.linalg._
import breeze.numerics._
import breeze.stats.distributions._
import breeze.stats.distributions.Rand.VariableSeed.randBasis

val X = DenseMatrix.tabulate(100, 3)((i, j) => 
	Gaussian(j, j+1).sample())
```
Now we can do PCA.
```scala
import scalaglm.Pca
val pca = Pca(X, List("V1", "V2", "V3"))
```
```scala
pca.sdev
// res0: DenseVector[Double] = DenseVector(2.942568150190125, 1.9452888178608192, 1.0271003369324638)
pca.loadings
// res1: DenseMatrix[Double] = 0.02708158363824444  0.030913884264850082  -0.9991551028680704    
// 0.04366922652063121  -0.99860408779652     -0.029713203986940898  
// 0.998678920615998    0.04282764989745769   0.028393765539748556   
pca.scores
// res2: DenseMatrix[Double] = 3.75269625029684      -1.2219607532878458   -0.37223921145979977   
// -1.9942379384358275   -1.452367045172577    0.5632602364742189     
// -2.7764881209626036   0.8021236879785257    -1.2049400848990512    
// -1.037879752819986    1.219202115231175     -0.31042540745433955   
// -1.7748060840038737   0.8009804976166388    -0.24915782254163735   
// 0.7018817043617538    0.09681284802714687   -0.11017423373247542   
// 0.7508202833660955    0.3591512452695556    0.2856165408340366     
// 0.5093274069640349    1.7832537613825794    0.12322739566539197    
// -1.6073708148258232   -0.3797613698315812   -0.038862389331150306  
// 2.860916031937636     1.1942456757630455    1.445940463457534      
// -3.7904890154494773   0.09335034231458701   -0.8569571920362099    
// -6.730142809551092    -0.4603669245123148   -0.09284679344024942   
// 1.7060465483217595    -2.442989917624301    0.3813370459407757     
// 2.95646072817818      0.7773523101362738    0.1132729581040002     
// -1.7399299172630447   -0.19240719192978656  0.2293497072887467     
// 1.237531833620227     -2.9889945577010506   -1.1877475511874311    
// -4.800708316864478    0.16732791084914256   0.11433728176492954    
// -5.362677799477779    4.098276489308341     0.27724762450263       
// 0.2824910357548324    0.9127647588835126    0.315602392773464      
// 3.2241349450540207    -0.41068055520370766  -0.4648969517945171    
// -3.769171274990123    -0.3953807340978671   -0.2859638976190948    
// 3.7903680741002077    -3.336450946806861    2.303719322718153      
// -0.9787862147494918   -0.8457207556962564   -8.295446599797025E-4  
// -2.595211677212978    -1.1428452705698382   0.25183669964816124    
// -1.3830094065035896   2.3149179019443893    0.9203728671897791     
// -0.3388654708888998   -4.094959444064097    -0.34689815416718295   
// 0.48379905709198784   0.08481018795980703   -1.5088495803041113    
// -0.2377826724597015   1.9873236757422699    1.4722225472734505     
// 0.1399229846355579    -0.10885231206827117  1.7911621168636236     
// -0.3030621504367402   -0.370735094693242    -0.6118651638091513    
// -0.4559222166558639   -0.29557632755237445  0.9679042603567856     
// 3.8855380852505728    -1.22915067694474     -0.04241252067510581   
// 4.271629019682845     5.476946032282765     0.16249748598823383    
// 1.215692760393948     1.516522192867133     0.8262112756270115     
// -1.8780980092538067   0.9693290899143037    -0.2887840720024534    
// 4.749360098059654     1.2902398413274312    -0.4882112267957598    
// 3.1484674004558433    0.5594693342862138    -0.6836195576089414    
// 1.5922788382086008    -1.4774841715201519   1.0887126715782942     
// -4.718945228747934    -2.93478818101223     1.5382679395850187     
// 2.4027399278864916    0.30385655913223764   -0.17281548611524375   
// -0.6709317880145099   0.6343974585789005    0.6947945272499008     
// -0.26303893361495556  -2.114080857318639    -1.340305864062155     
// 3.365133189763614     0.09293521868137097   -0.1418824666600237    
// 5.570281899132796     1.3031428038677746    -2.2988026415645426    
// -0.7685626391648167   -1.7439812215480364   0.6162856241688632     
// -1.0368436673130499   0.4890353645606939    0.23634396961205406    
// 8.440929684155158     -2.5308089469574897   0.2710857108025117     
// -1.9469416315981007   1.6677339322494484    2.037001821882494      
// -0.26223056666278216  0.0761219262727476    1.239870911553615      
// ...
pca.plots
// res3: Figure = breeze.plot.Figure@4bb01d2
pca.summary
// Standard deviations:
// V1	V2	V3
//  2.943	 1.945	 1.027
// Cumulative proportion of variance explained:
// V1	V2	V3
//  0.641	 0.922	 1.000
// Loadings:
// PC01	PC02	PC03	
//  0.027	 0.031	-0.999	V1
//  0.044	-0.999	-0.030	V2
//  0.999	 0.043	 0.028	V3
```
The final line prints a readable summary of the PCA to the console. `plots` produces some diagnostic plots, including a "scree plot".

![PCA Plots](pca-plots.png)

Note that there is also a utility function `pairs` for producing a "scatterplot matrix":
```scala
import scalaglm.Utils.pairs
pairs(X, List("V1", "V2", "V3"))
// res6: Figure = breeze.plot.Figure@1f09787e
```

![Pairs plots](pairs-plots.png)


## Linear regression

This code computes regression coefficients and associated diagnostics via the QR decomposition of the covariate matrix. The diagnostics are analogous to those produced by the R function `lm`. We start by creating a synthetic response variable.

```scala
val y = DenseVector.tabulate(100)(i => 
	Gaussian(2.0 + 1.5*X(i,0) + 0.5*X(i,1), 3.0).sample())
```
So we can now do linear regression and generate all of the usual diagnostics.
```scala
import scalaglm.Lm
val lm = Lm(y,X,List("V1", "V2", "V3"))
```
```scala
lm.coefficients
// res8: DenseVector[Double] = DenseVector(1.404578028943978, 1.2744078607382026, 0.8242095898148907, 0.055613292866263236)
lm.se
// res9: DenseVector[Double] = DenseVector(0.354891942974995, 0.2788822867264401, 0.14743552034441285, 0.09780581476936444)
lm.fitted
// res10: DenseVector[Double] = DenseVector(4.252701838066529, 2.495705493338917, 2.927732513799651, 1.6615134575252313, 1.8159580132483462, 2.4981291316789203, 1.7862971643318222, 0.8537303630157238, 2.4869591527803276, -0.1042384138785919, 2.902603048904875, 1.9742096872083557, 3.971880025688372, 1.960974694873523, 1.97620677159609, 6.373321898257947, 1.4584396816307716, -1.8947382148963632, 1.2558701195964623, 3.6723486635077376, 2.546980590347704, 2.440770184683743, 2.880934509176793, 2.5818124807270744, -0.8334621571056738, 5.948748670121191, 4.293039923994006, -1.1484993589697452, 0.12338702752845299, 3.3870594466315542, 1.2613086625493983, 3.847528092642852, -1.6087616655472543, 0.2399194111552213, 1.7227762956047372, 2.5659214850117937, 3.1883694593131633, 2.2862794677547797, 2.046609329331705, 2.6319535193186727, 0.8616537141569239, 5.698381428890254, 2.877950792369204, 5.006278625132555, 2.8092949316236386, 1.5233636033597038, 5.032304766407627, -1.8463323801453968, 0.6427874673015499, -0.355996516634997, 3.9143468607773064, 2.158512492864768, 2.437158307821485, -0.9326798163672521, 4.814029702603675, 0.726704950527393, -1.7411928759531587, -1.0229429193203858, 4.479047787239865, 1.4349686219617221, 1.4350604943467598, 4.0187899908607445, 2.2964315297782676, 1.6716400379847765, 2.197591389126499, 6.62060724193507, 2.7544165765047692, 6.773935820535083, 3.14217434270682, 2.27393700318241, 2.3898689492521257, 1.6281083176803284, 5.120492386023852, 5.9589307235825295, -1.4670539691934101, 1.6174784606942874, 1.6403235209525124, 4.1781787207972245, 3.105173103542044, 0.7920232102668288, 2.909426733920255, 4.120403955730425, 2.2426891968855722, 3.7300202721000923, -3.7010795728970334, 2.195507686555436, 3.22632575060406, 4.184983437071389, 1.4854515213567954, 4.650999190667354, 3.687850803199897, 1.019671714833391, 0.931724046574594, 7.0491765996862386, 0.42212796816516474, 0.297909371352732, 3.747479039450372, 2.8984317998671982, 3.8634939526482657, 3.891947192720487)
lm.residuals
// res11: DenseVector[Double] = DenseVector(-0.03374468431502109, -3.3782644916168025, -0.31715276188780406, 1.2114427345672616, 2.4968387546874804, 0.7435829463455934, -0.9196461849134459, -5.685764347365429, -0.32449100925675367, -2.1712571846228315, -1.290618071551509, 6.836438900373608, -2.0452721623515524, -8.774013792892111, 0.9940528936429591, -4.289609072471409, -4.882402419881848, 1.7985936040833117, 3.308024702557362, 2.2953163919578485, -1.9398426362006242, 3.108489775152362, 1.3449824207252457, -1.6883902872231273, -2.3143144559623265, -4.813994697267569, 2.242749087076433, 1.2193753375957863, -1.742994614566995, -2.770431565962825, 0.4448579549527558, 2.8014009197960785, 0.059181928366379255, 6.223269330096437, 1.2864598014946163, -0.8027956763355564, -2.6969797763414123, 5.748059439740491, 0.7010755351931088, -0.6258784921815228, 0.7274973689176053, -1.3598246174013333, 0.01918267699763021, 3.629428126772857, 1.8175628384416096, -0.44640898809065743, -0.13749640181786837, 0.014779731430557774, -3.13115242974395, 3.3230506239128763, -0.8046720925037785, -0.24040183606093013, 1.873133372688792, 0.23929087076417688, -2.5858335761767215, -4.105724654149977, -0.7517248997023138, 2.400352946031677, 5.9950851988124265, 6.857207077617492, -0.5348436516345936, -1.2470294269845654, 1.4064502498340055, -2.35303049533551, -0.977759730589556, -1.743191934765533, 1.159567145991562, -0.058158663579059855, -0.17779001468960498, 2.4044694921382286, -3.202164608780083, 2.9042488849148578, 1.313824616400403, 2.1359702970891323, 0.6234368326680471, -0.1734413957753298, -0.006796980525307861, -2.047008732378237, 3.205015305842811, -0.9657775916223261, -1.096670856194368, 0.30969646292387765, -2.1157666740287024, 0.08115661226080473, -2.975071400355142, 6.333183091900436, -2.733819990144501, 4.6678970062223994, -4.732078198069711, 1.8386414263638633, -1.1735267556657405, -2.7492604055966567, 0.1397127177799744, -0.6637211759775044, -0.14825131515506906, -0.412913930783641, -1.9646111502063617, -4.383463401456519, 3.494521859871074, 1.9286910681153508)
lm.studentised
// res12: DenseVector[Double] = DenseVector(-0.012024540390234323, -1.1985983152744915, -0.11318176743340637, 0.4282493245907534, 0.882567165301772, 0.2621366823887816, -0.32437957906016385, -2.0127931703124906, -0.11454969872717205, -0.7783932933168254, -0.4603908723011679, 2.4770349688730477, -0.7284253816582862, -3.11080489289617, 0.35104230377377776, -1.542477402388157, -1.7446111011017125, 0.6607859770471831, 1.1676928378709186, 0.8149300907174396, -0.6898292851381964, 1.1535944270992258, 0.47470391387332744, -0.5986201604541743, -0.8259201603703035, -1.737357754953467, 0.7993229829428353, 0.43668557786495016, -0.6240140461838429, -0.9783196621933704, 0.1575231801016653, 0.9982072447335528, 0.022016389684523952, 2.209232386666712, 0.4550629195445035, -0.287751044933159, -0.9586323982470606, 2.046558821802697, 0.2565155863724631, -0.22137633326347395, 0.25718265760205133, -0.48643841860528686, 0.0068063701912807854, 1.3424452757902976, 0.6445811007912676, -0.15750969269003826, -0.051130411848874895, 0.0053496576279677835, -1.111781955081394, 1.1873112532218855, -0.2862055750308139, -0.08636118150066192, 0.6644644490379187, 0.08587191826414294, -0.9390583132810969, -1.4558490140491025, -0.2749089723565536, 0.8672827735576792, 2.1566710468036865, 2.4820311274970654, -0.19021442325076193, -0.4445437768934884, 0.49769613505884597, -0.8484857099376215, -0.3612078359905217, -0.6286664574538543, 0.41215100390449394, -0.021079786496572276, -0.06293364411662078, 0.851835485696469, -1.1309579218746333, 1.0284500714837301, 0.4944570513023618, 0.771166765366367, 0.22755482865402346, -0.061718747482211, -0.0024092380841297546, -0.7407579664157177, 1.1468340206180252, -0.3429295504782364, -0.3867267685077752, 0.11008072565549357, -0.745762683117659, 0.02889554658446635, -1.098387256654155, 2.3301744059357543, -0.9680596914282389, 1.6680561685229747, -1.6726455817459243, 0.6544971617645996, -0.41850371846822015, -0.9910100158968213, 0.049857026010359615, -0.24397225280784035, -0.052724285644602985, -0.14797391476184327, -0.6940255159250941, -1.5478425257522228, 1.2481579161970524, 0.6995332687482158)
val pred = lm.predict()
// pred: PredictLm = PredictLm(
//   Lm(
//     DenseVector(4.218957153751508, -0.8825589982778856, 2.610579751911847, 2.872956192092493, 4.312796767935827, 3.2417120780245137, 0.8666509794183763, -4.832033984349705, 2.162468143523574, -2.2754955985014234, 1.6119849773533659, 8.810648587581964, 1.9266078633368193, -6.813039098018589, 2.970259665239049, 2.0837128257865385, -3.4239627382510767, -0.09614461081305149, 4.5638948221538245, 5.967665055465586, 0.6071379541470798, 5.549259959836105, 4.225916929902039, 0.893422193503947, -3.1477766130680003, 1.134753972853622, 6.535789011070439, 0.07087597862604123, -1.619607587038542, 0.6166278806687293, 1.7061666175021541, 6.648929012438931, -1.549579737180875, 6.463188741251658, 3.0092360970993535, 1.7631258086762374, 0.491389682971751, 8.03433890749527, 2.747684864524814, 2.00607502713715, 1.5891510830745292, 4.338556811488921, 2.897133469366834, 8.635706751905412, 4.626857770065248, 1.0769546152690463, 4.894808364589759, -1.831552648714839, -2.4883649624424002, 2.9670541072778795, 3.109674768273528, 1.918110656803838, 4.310291680510277, -0.6933889456030752, 2.228196126426954, -3.3790197036225837, -2.4929177756554726, 1.3774100267112908, 10.474132986052291, 8.292175699579214, 0.9002168427121662, 2.771760563876179, 3.702881779612273, -0.6813904573507337, 1.219831658536943, 4.877415307169537, 3.913983722496331, 6.715777156956023, 2.964384328017215, 4.678406495320639, -0.8122956595279573, 4.532357202595186, 6.434317002424255, 8.094901020671662, -0.8436171365253631, 1.4440370649189576, 1.6335265404272046, 2.1311699884189874, 6.310188409384855, -0.17375438135549737, 1.812755877725887, 4.430100418654303, 0.12692252285686978, 3.811176884360897, -6.6761509732521755, 8.528690778455871, 0.49250576045955885, 8.852880443293788, -3.246626676712916, 6.489640617031217, 2.5143240475341564, -1.7295886907632658, 1.0714367643545684, 6.385455423708734, 0.27387665301009567, -0.11500455943090904, 1.7828678892440104, -1.48503160158932, 7.35801581251934, 5.820638260835838),
//     0.4482144705632681     2.406419910385606      5.27789997950044       
// -0.6492534089071372    2.3577437185026766     -0.444747460970083     
// 1.1659634569426065     0.12477869290078258    -1.1796155544435134    
// 0.33218233454879714    -0.24237274390659924   0.5999571029124853     
// 0.23808052768569274    0.1412636139143647     -0.15216752166529313   
// 0.14451843597608224    0.9484736996143949     2.2950367873913002     
// -0.24150270302913326   0.6768784016134324     2.366384042135432      
// -0.04176622914942097   -0.7509568977454026    2.1815903216578283     
// -0.004004132707136727  1.3214204869734283     -0.029550767863192995  
// -1.3178855242241556    -0.09938100255272198   4.542403284024889      
// 0.7689028866167393     0.7779423317689387     -2.2127514252862746    
// -0.09128994888955115   1.1798100823369189     -5.15054014110602      
// -0.3978983617712693    3.513977850710969      3.2030571222570794     
// 0.0033557226029479084  0.36070060095373213    4.582127746339893      
// -0.2697876827433227    1.120569644844605      -0.146295258678669     
// 1.140293275597727      4.085383171750166      2.6672250369557573     
// -0.22664234778159326   0.6310922630846372     -3.1908891538442283    
// -0.2831131821779215    -3.323750417161908     -3.5791373026007562    
// -0.2670319736103602    0.10269513212356884    1.9232348716271512     
// 0.5515594695929902     1.5759434832012602     4.782151267838939      
// 0.1838607650348065     1.2499560715124454     -2.1961804009625068    
// -2.2898300463984667    4.44009225885984       5.3009439293279215     
// ...
pred.fitted
// res13: DenseVector[Double] = DenseVector(4.252701838066528, 2.495705493338918, 2.92773251379965, 1.6615134575252317, 1.8159580132483462, 2.4981291316789203, 1.7862971643318224, 0.8537303630157239, 2.4869591527803276, -0.10423841387859212, 2.9026030489048753, 1.9742096872083557, 3.9718800256883715, 1.960974694873523, 1.9762067715960905, 6.373321898257947, 1.4584396816307719, -1.8947382148963632, 1.2558701195964623, 3.672348663507738, 2.5469805903477045, 2.440770184683743, 2.8809345091767935, 2.5818124807270744, -0.8334621571056744, 5.948748670121192, 4.293039923994005, -1.148499358969745, 0.12338702752845254, 3.3870594466315542, 1.261308662549399, 3.847528092642852, -1.6087616655472545, 0.23991941115522153, 1.7227762956047372, 2.5659214850117937, 3.1883694593131633, 2.28627946775478, 2.0466093293317056, 2.6319535193186727, 0.8616537141569239, 5.698381428890254, 2.8779507923692043, 5.006278625132555, 2.809294931623639, 1.523363603359704, 5.032304766407628, -1.8463323801453968, 0.6427874673015497, -0.355996516634997, 3.914346860777307, 2.158512492864768, 2.437158307821485, -0.9326798163672514, 4.8140297026036745, 0.726704950527393, -1.7411928759531592, -1.0229429193203865, 4.479047787239864, 1.4349686219617226, 1.43506049434676, 4.0187899908607445, 2.2964315297782676, 1.6716400379847767, 2.197591389126499, 6.62060724193507, 2.7544165765047692, 6.773935820535083, 3.1421743427068205, 2.27393700318241, 2.3898689492521257, 1.6281083176803284, 5.120492386023852, 5.95893072358253, -1.4670539691934104, 1.6174784606942874, 1.6403235209525127, 4.178178720797225, 3.105173103542044, 0.792023210266829, 2.909426733920255, 4.120403955730425, 2.2426891968855722, 3.7300202721000923, -3.7010795728970334, 2.1955076865554357, 3.2263257506040603, 4.184983437071389, 1.4854515213567954, 4.650999190667354, 3.687850803199897, 1.0196717148333905, 0.931724046574594, 7.049176599686239, 0.42212796816516507, 0.29790937135273166, 3.747479039450372, 2.8984317998671987, 3.8634939526482657, 3.8919471927204876)
pred.se
// res14: DenseVector[Double] = DenseVector(0.5081027402759433, 0.435402963334784, 0.5305857012948277, 0.36240010450093724, 0.36053795663853455, 0.29522714082633705, 0.309577827880687, 0.3924546023170613, 0.3303018492984082, 0.5939588791017515, 0.5244477678323378, 0.7185993291574915, 0.4998531450983831, 0.42236196553498706, 0.33905901971792546, 0.6322202273689664, 0.5492173024184701, 0.8513797615752293, 0.3285399138115275, 0.4477300197588078, 0.47528641793738846, 0.9341592730037303, 0.3255068135595322, 0.4225368486773249, 0.5308488758541922, 0.6751752161265876, 0.5108960228038604, 0.5800148002790089, 0.5758781637846713, 0.33815343532729014, 0.39769988995958505, 0.507471863816684, 0.9527790196150235, 0.4454805178309337, 0.3764284304450034, 0.5916636506735188, 0.4675302514352062, 0.49507203126694227, 0.8148050734819113, 0.37475923377765863, 0.36323578747812946, 0.5647385648144845, 0.4365079664881691, 0.9078348474985152, 0.42726214524365624, 0.3179290438284982, 0.9498215071084573, 0.7076990666933778, 0.4492618867646751, 0.5479866988478261, 0.4784938723019671, 0.6202568570102709, 0.43215684974675567, 0.6069907212775172, 0.7423115062851202, 0.4246133054077783, 0.8101673858603092, 0.6881781797260499, 0.6374761586089498, 0.7077118022090734, 0.4768724290208014, 0.5142979965581495, 0.38439094789017, 0.6654968662358068, 0.8978797626147381, 0.6670409974035394, 0.46698602642928955, 0.7222399424285724, 0.3908227701389759, 0.4074275427563522, 0.34192352864418696, 0.39891108445524603, 1.0360399837601713, 0.6795957476555978, 0.792158992974693, 0.48623284434658026, 0.4175292314767898, 0.7051406261900844, 0.568721806012548, 0.44976466812419935, 0.3032462402735381, 0.46755464971901134, 0.2910867850735655, 0.49521960732759107, 0.8928468323111737, 0.8640624663853816, 0.3981204359060761, 0.5500160882061833, 0.3602692657493965, 0.49167488831285094, 0.5201980094600872, 0.6613631418441748, 0.5299874627843816, 0.8559135384783174, 0.47670251824345855, 0.5890445254752804, 0.3470684546027567, 0.3368421677040407, 0.5431631564451118, 0.7293329603576938)
val predNew = lm.predict(DenseMatrix((1.1, 1.6, 1.0), (1.4, 2.2, 3.0)))
// predNew: PredictLm = PredictLm(
//   Lm(
//     DenseVector(4.218957153751508, -0.8825589982778856, 2.610579751911847, 2.872956192092493, 4.312796767935827, 3.2417120780245137, 0.8666509794183763, -4.832033984349705, 2.162468143523574, -2.2754955985014234, 1.6119849773533659, 8.810648587581964, 1.9266078633368193, -6.813039098018589, 2.970259665239049, 2.0837128257865385, -3.4239627382510767, -0.09614461081305149, 4.5638948221538245, 5.967665055465586, 0.6071379541470798, 5.549259959836105, 4.225916929902039, 0.893422193503947, -3.1477766130680003, 1.134753972853622, 6.535789011070439, 0.07087597862604123, -1.619607587038542, 0.6166278806687293, 1.7061666175021541, 6.648929012438931, -1.549579737180875, 6.463188741251658, 3.0092360970993535, 1.7631258086762374, 0.491389682971751, 8.03433890749527, 2.747684864524814, 2.00607502713715, 1.5891510830745292, 4.338556811488921, 2.897133469366834, 8.635706751905412, 4.626857770065248, 1.0769546152690463, 4.894808364589759, -1.831552648714839, -2.4883649624424002, 2.9670541072778795, 3.109674768273528, 1.918110656803838, 4.310291680510277, -0.6933889456030752, 2.228196126426954, -3.3790197036225837, -2.4929177756554726, 1.3774100267112908, 10.474132986052291, 8.292175699579214, 0.9002168427121662, 2.771760563876179, 3.702881779612273, -0.6813904573507337, 1.219831658536943, 4.877415307169537, 3.913983722496331, 6.715777156956023, 2.964384328017215, 4.678406495320639, -0.8122956595279573, 4.532357202595186, 6.434317002424255, 8.094901020671662, -0.8436171365253631, 1.4440370649189576, 1.6335265404272046, 2.1311699884189874, 6.310188409384855, -0.17375438135549737, 1.812755877725887, 4.430100418654303, 0.12692252285686978, 3.811176884360897, -6.6761509732521755, 8.528690778455871, 0.49250576045955885, 8.852880443293788, -3.246626676712916, 6.489640617031217, 2.5143240475341564, -1.7295886907632658, 1.0714367643545684, 6.385455423708734, 0.27387665301009567, -0.11500455943090904, 1.7828678892440104, -1.48503160158932, 7.35801581251934, 5.820638260835838),
//     0.4482144705632681     2.406419910385606      5.27789997950044       
// -0.6492534089071372    2.3577437185026766     -0.444747460970083     
// 1.1659634569426065     0.12477869290078258    -1.1796155544435134    
// 0.33218233454879714    -0.24237274390659924   0.5999571029124853     
// 0.23808052768569274    0.1412636139143647     -0.15216752166529313   
// 0.14451843597608224    0.9484736996143949     2.2950367873913002     
// -0.24150270302913326   0.6768784016134324     2.366384042135432      
// -0.04176622914942097   -0.7509568977454026    2.1815903216578283     
// -0.004004132707136727  1.3214204869734283     -0.029550767863192995  
// -1.3178855242241556    -0.09938100255272198   4.542403284024889      
// 0.7689028866167393     0.7779423317689387     -2.2127514252862746    
// -0.09128994888955115   1.1798100823369189     -5.15054014110602      
// -0.3978983617712693    3.513977850710969      3.2030571222570794     
// 0.0033557226029479084  0.36070060095373213    4.582127746339893      
// -0.2697876827433227    1.120569644844605      -0.146295258678669     
// 1.140293275597727      4.085383171750166      2.6672250369557573     
// -0.22664234778159326   0.6310922630846372     -3.1908891538442283    
// -0.2831131821779215    -3.323750417161908     -3.5791373026007562    
// -0.2670319736103602    0.10269513212356884    1.9232348716271512     
// 0.5515594695929902     1.5759434832012602     4.782151267838939      
// 0.1838607650348065     1.2499560715124454     -2.1961804009625068    
// -2.2898300463984667    4.44009225885984       5.3009439293279215     
// ...
predNew.fitted
// res15: DenseVector[Double] = DenseVector(4.180775312326089, 5.1688500101690105)
predNew.se
// res16: DenseVector[Double] = DenseVector(0.4350084960585573, 0.5260542606783094)
lm.plots
// res17: Figure = breeze.plot.Figure@3fd2dbe2
lm.summary
// Estimate	 S.E.	 t-stat	p-value		Variable
// ---------------------------------------------------------
//   1.4046	 0.355	 3.958	0.0001 *	(Intercept)
//   1.2744	 0.279	 4.570	0.0000 *	V1
//   0.8242	 0.147	 5.590	0.0000 *	V2
//   0.0556	 0.098	 0.569	0.5709  	V3
// 
// Residual standard error:   2.8519 on 96 degrees of freedom
// Multiple R-squared: 0.3486, Adjusted R-squared: 0.3282
// F-statistic: 17.1214 on 3 and 96 DF, p-value: 0.00000
//
```
The plots include a plot of studentised residuals against fitted values and a normal Q-Q plot for the studentised residuals.

![Linear model plots](lm-plots.png)


## Generalised linear models

The current implementation supports only simple one-parameter exponential family observation models. This includes the most commonly used cases of **logistic regression** (`LogisticGlm`) and **Poisson regression** (`PoissonGlm`).

### Logistic regression

Again, we start by creating an appropriate response variable.
```scala
val ylb = (0 until 100) map (i => Bernoulli(sigmoid(1.0 + X(i,0))).sample())
val yl = DenseVector(ylb.toArray map {b => if (b) 1.0 else 0.0})
```

Then we can do logistic regression in a typical way.
```scala
import scalaglm.{Glm, LogisticGlm}
val glm = Glm(yl, X, List("V1","V2","V3"), LogisticGlm)
```
```scala
glm.coefficients
// res20: DenseVector[Double] = DenseVector(0.8155366674629574, 1.1135221940194824, 0.12347525601387256, 0.14187230577797336)
glm.fitted
// res21: DenseVector[Double] = DenseVector(0.9137695137349351, 0.5794715050961409, 0.876740066886257, 0.7756717992904053, 0.7458308464221661, 0.8052092611478835, 0.7243055491164825, 0.7282598610442125, 0.7251291197538094, 0.49505316641766217, 0.8105911021568881, 0.5321659230257053, 0.7791607684607296, 0.819636688716036, 0.6531081040723576, 0.9511132915956193, 0.5469589117641007, 0.3970199596897905, 0.6907706688072328, 0.90910496903636, 0.70329356511942, 0.39318559282545856, 0.7460653536156415, 0.6306099803443409, 0.43040499211017796, 0.8635513302807608, 0.9496529319404236, 0.33986845093367357, 0.3147296486405348, 0.8626851731101974, 0.5118487981211923, 0.8826588630899135, 0.7863541364631151, 0.5869122062598131, 0.7480662561639898, 0.9211564014596757, 0.9207280730864124, 0.592404172010482, 0.24527401252743064, 0.8548491402905062, 0.558740205782934, 0.9426439270929529, 0.8728925627990861, 0.9902081924410203, 0.623165237506995, 0.6666638388031252, 0.9298456596472007, 0.17243084390043953, 0.43744630789640493, 0.32027596547462567, 0.7300643350730364, 0.7436751580079544, 0.6342085115860836, 0.4814034327411241, 0.9716294508821457, 0.45641768962842616, 0.6525692352456478, 0.5346730039570556, 0.726583115923056, 0.6232079631605182, 0.553181737844104, 0.9300216999697065, 0.6206685545313426, 0.6801781661872619, 0.24622215728721444, 0.948769456739007, 0.5818205598899605, 0.9322848335593743, 0.7533035463617233, 0.5789519336031372, 0.6867414310803034, 0.8323818562175791, 0.9764016448649087, 0.8762129278121866, 0.4537290181084412, 0.5801584107068887, 0.8438570762886443, 0.9581388374052641, 0.9474136993511729, 0.7773020781181461, 0.8160896228222007, 0.8719158342123376, 0.7539158880003346, 0.8980524077097428, 0.1766339409639639, 0.9669521822147268, 0.861957771166475, 0.8830802075383696, 0.707610985435631, 0.9328075116821574, 0.7316861089110752, 0.9013214006202642, 0.4482215675926718, 0.9894819488356619, 0.5029304882422462, 0.6430174786382383, 0.8558450235353976, 0.837975337076405, 0.6752097964394436, 0.9754400802585232)
glm.predict(response=true).fitted
// res22: DenseVector[Double] = DenseVector(0.9137695137349351, 0.5794715050961409, 0.876740066886257, 0.7756717992904053, 0.7458308464221661, 0.8052092611478835, 0.7243055491164825, 0.7282598610442125, 0.7251291197538094, 0.49505316641766217, 0.8105911021568881, 0.5321659230257053, 0.7791607684607296, 0.819636688716036, 0.6531081040723576, 0.9511132915956193, 0.5469589117641007, 0.3970199596897905, 0.6907706688072328, 0.90910496903636, 0.70329356511942, 0.39318559282545856, 0.7460653536156415, 0.6306099803443409, 0.43040499211017796, 0.8635513302807608, 0.9496529319404236, 0.33986845093367357, 0.3147296486405348, 0.8626851731101974, 0.5118487981211923, 0.8826588630899135, 0.7863541364631151, 0.5869122062598131, 0.7480662561639898, 0.9211564014596757, 0.9207280730864124, 0.592404172010482, 0.24527401252743064, 0.8548491402905062, 0.558740205782934, 0.9426439270929529, 0.8728925627990861, 0.9902081924410203, 0.623165237506995, 0.6666638388031252, 0.9298456596472007, 0.17243084390043953, 0.43744630789640493, 0.32027596547462567, 0.7300643350730364, 0.7436751580079544, 0.6342085115860836, 0.4814034327411241, 0.9716294508821457, 0.45641768962842616, 0.6525692352456478, 0.5346730039570556, 0.726583115923056, 0.6232079631605182, 0.553181737844104, 0.9300216999697065, 0.6206685545313426, 0.6801781661872619, 0.24622215728721444, 0.948769456739007, 0.5818205598899605, 0.9322848335593743, 0.7533035463617233, 0.5789519336031372, 0.6867414310803034, 0.8323818562175791, 0.9764016448649087, 0.8762129278121866, 0.4537290181084412, 0.5801584107068887, 0.8438570762886443, 0.9581388374052641, 0.9474136993511729, 0.7773020781181461, 0.8160896228222007, 0.8719158342123376, 0.7539158880003346, 0.8980524077097428, 0.1766339409639639, 0.9669521822147268, 0.861957771166475, 0.8830802075383696, 0.707610985435631, 0.9328075116821574, 0.7316861089110752, 0.9013214006202642, 0.4482215675926718, 0.9894819488356619, 0.5029304882422462, 0.6430174786382383, 0.8558450235353976, 0.837975337076405, 0.6752097964394436, 0.9754400802585232)
glm.summary
// Estimate	 S.E.	 z-stat	p-value		Variable
// ---------------------------------------------------------
//   0.8155	 0.302	 2.699	0.0070 *	(Intercept)
//   1.1135	 0.315	 3.540	0.0004 *	V1
//   0.1235	 0.130	 0.950	0.3419  	V2
//   0.1419	 0.088	 1.606	0.1082  	V3
glm.plots
// res24: Figure = breeze.plot.Figure@51321ff2
```

![Logistic regression plots](glm-plots.png)


### Poisson regression

We first create an appropriate response, and then do Poisson regression.
```scala
val yp = DenseVector.tabulate(100)(i => Poisson(math.exp(-0.5 + X(i,0))).sample().toDouble)

import scalaglm.PoissonGlm
val pglm = Glm(yp, X, List("V1","V2","V3"), PoissonGlm)
```
```scala
pglm.coefficients
// res26: DenseVector[Double] = DenseVector(-0.5632256704279609, 0.9322660505201241, 0.025907450285202426, 0.035076652436297796)
pglm.summary
// Estimate	 S.E.	 z-stat	p-value		Variable
// ---------------------------------------------------------
//  -0.5632	 0.166	-3.394	0.0007 *	(Intercept)
//   0.9323	 0.082	11.325	0.0000 *	V1
//   0.0259	 0.053	 0.485	0.6280  	V2
//   0.0351	 0.031	 1.127	0.2598  	V3
pglm.plots
// res28: Figure = breeze.plot.Figure@5897dd19
```
![Poisson regression plots](pglm-plots.png)


## Non-linear response

The above covers the main functionality of the library based on a linear reponse to variation in covariate values. For flexible modelling of a nonlinear response, see the documentation on [flexible regression modelling](FlexibleRegression.md).


# scala-glm - Quickstart Guide

## PCA

This library contains code for principal components analysis based on a thin SVD of the centred data matrix. This is more numerically stable than a construction from the spectral decomposition of the covariance matrix. It is analogous to the R function `prcomp` rather than the R function `princomp`. First create some synthetic data.

```scala
import breeze.linalg.*
import breeze.numerics.*
import breeze.stats.distributions.*
import breeze.stats.distributions.Rand.VariableSeed.randBasis

val X = DenseMatrix.tabulate(100, 3)((i, j) => 
	Gaussian(j, j+1).sample())
```
Now we can do PCA.
```scala
import scalaglm.Pca
val pca = Pca(X, List("V1", "V2", "V3"))
```
```scala
pca.sdev
// res0: DenseVector[Double] = DenseVector(3.236788625790188, 2.095945294533315, 0.9742434759088817)
pca.loadings
// res1: DenseMatrix[Double] = 0.04518342147195501    -0.06620590107432041  0.9967824422044286   
// -0.031165817678786567  0.9972223728386406    0.06764784489163754  
// 0.9984924387457822     0.034122100946567424  -0.0429945577310893  
pca.scores
// res2: DenseMatrix[Double] = 0.5027678849206545    3.5395278424168946    -0.7469048804302642   
// -2.025798471254951    -1.178093345214774    0.047943401143226365  
// -0.0828430226874394   -0.238646068669148    -0.05128316843576904  
// -1.5826362789427337   0.8536477806098619    0.5891977648072152    
// -4.326482139011101    -0.4697690295476344   -0.874410345194406    
// -2.437211078057403    1.1935453459756244    -0.8977917346244536   
// -0.5558204719184473   1.6310259863050063    -1.1172950506701373   
// 2.5152716007822082    -0.37563451976581336  -0.37679870669281357  
// -3.5121155808956095   -2.947119701410235    -0.6859934429224971   
// -3.197687779043642    0.1804796865055034    1.295143410974118     
// -3.853524682727107    1.1772187666787504    -2.1641153599610017   
// -5.127215380916023    -5.261343109633127    0.13875794945530473   
// 0.32242438553382263   -2.1790496715684937   0.4841553221225519    
// 0.04114962761836366   2.4372213077840117    -0.23047780412246804  
// 1.3827804474570182    2.33782304587538      0.10104985372138652   
// -3.7221464927984518   6.874383226915889     1.1852394604823213    
// -2.1870057857768788   -1.6107941673145534   2.358463846205194     
// -3.2006193435393215   1.250740895716624     0.19369739675401126   
// -3.7542366553974853   0.3240864275688552    2.2249490582531015    
// 2.3193101513562886    1.8869132190839106    -0.5363085561698949   
// 1.266513846264356     -1.2500604233326205   -0.5687969097335037   
// -2.081606283746039    0.8154669894101341    0.8991198343372773    
// -1.7133519072513042   1.3391086090797337    -1.2518675317913879   
// -1.6859829036591631   -2.5113813674060665   -0.7410082677751159   
// 0.5381636303699269    1.9784623462830857    -0.7992038733532201   
// -3.7923899772370255   1.2466941361381603    0.7953334557884746    
// 3.8659301535839763    2.3316526971542655    -0.12851495664283513  
// 3.302044382867574     -0.05779241780214296  1.460466633382338     
// -0.4084369793250461   -3.2830749263236214   -0.5379482281011814   
// 3.6185487075734475    3.2059573690980505    -1.1624647836169708   
// 2.1115521693486494    3.5093092050485746    0.5265943221710851    
// 8.307013541842892     0.573143078288073     -1.2180154096496176   
// -0.13710972022545384  -0.44906937201319     0.25223144109428786   
// -4.8645793384401355   1.287651796660234     0.3147044843548088    
// 2.490323678690969     -1.9791728227889334   -0.7312459002313161   
// 0.013461839399374027  -0.978445615886821    0.03331321752782446   
// 0.13297569243570478   2.0594918063519105    -2.276013577765098    
// -1.3478236088520719   0.9987472774525801    -0.1441331455767036   
// 2.163375832740641     -1.6987083236511644   0.142855176534114     
// 2.8945886569292893    -1.1563133400816983   -1.5737545380515827   
// -1.999036978536703    -2.4275599147669884   -0.519813773881106    
// -3.6026928250716126   0.2388741058251922    1.4609045112774035    
// 0.08503111328849523   1.2321150927991504    1.4681007032086681    
// 1.5442351017985398    -0.09892790219483968  0.1600555111696072    
// 3.2537213755348726    -0.1963721359943805   -0.27409586675154285  
// -6.491824582152567    -2.858162321718384    -0.8613626323325025   
// -4.937266426897095    -0.7748718677763543   0.36927669547682707   
// -0.11304473702577486  0.886652495386479     0.14892893593842876   
// -2.204689780196673    -0.8359801509117736   -0.27187753916842694  
// ...
pca.plots
// res3: Figure = breeze.plot.Figure@5799992
pca.summary
// Standard deviations:
// V1	V2	V3
//  3.237	 2.096	 0.974
// Cumulative proportion of variance explained:
// V1	V2	V3
//  0.662	 0.940	 1.000
// Loadings:
// PC01	PC02	PC03	
//  0.045	-0.066	 0.997	V1
// -0.031	 0.997	 0.068	V2
//  0.998	 0.034	-0.043	V3
```
The final line prints a readable summary of the PCA to the console. `plots` produces some diagnostic plots, including a "scree plot".

![PCA Plots](pca-plots.png)

Note that there is also a utility function `pairs` for producing a "scatterplot matrix":
```scala
import scalaglm.Utils.pairs
pairs(X, List("V1", "V2", "V3"))
// res6: Figure = breeze.plot.Figure@38f1023d
```

![Pairs plots](pairs-plots.png)


## Linear regression

This code computes regression coefficients and associated diagnostics via the QR decomposition of the covariate matrix. The diagnostics are analogous to those produced by the R function `lm`. We start by creating a synthetic response variable.

```scala
val y = DenseVector.tabulate(100)(i => 
	Gaussian(2.0 + 1.5*X(i,0) + 0.5*X(i,1), 3.0).sample())
```
So we can now do linear regression and generate all of the usual diagnostics.
```scala
import scalaglm.Lm
val lm = Lm(y,X,List("V1", "V2", "V3"))
```
```scala
lm.coefficients
// res8: DenseVector[Double] = DenseVector(2.1236729461722463, 1.4883032522223654, 0.4353190185059077, -0.07067404857606777)
lm.se
// res9: DenseVector[Double] = DenseVector(0.3708353218489819, 0.29793506983379314, 0.13996420129690368, 0.09081614047815931)
lm.fitted
// res10: DenseVector[Double] = DenseVector(2.465105730346892, 2.1410583535342798, 2.2708080803436297, 3.6310194216368497, 1.017610528443495, 1.5044146408886174, 1.2856271960314647, 1.6878096087690972, 0.46413415534904, 4.50423372827099, -0.396854732082649, 0.9707186499036939, 2.429217171807208, 2.888557058351507, 3.3353802057138253, 6.576642938436951, 5.502373098284301, 3.19106173415891, 5.97106406651938, 2.2031009539598427, 1.1265018775784439, 4.0965678746940055, 1.0039071119356378, 0.49506423627358354, 1.8651320091290022, 4.1117884830015194, 2.9433685706062653, 4.565713227382728, 0.5242280422963368, 1.6713635199526493, 4.3584956715935235, 0.6308115866056486, 2.661747709830634, 3.414906905757446, 0.6166474252371381, 2.150955468459214, -0.3398749035320208, 2.5636650350547816, 2.040748118368297, -0.39327713276950205, 0.8636085485138608, 4.781822424485584, 5.06136579110903, 2.6102688855326246, 1.890760122480914, 0.2782327337456655, 2.8117076527562004, 2.9497487972995233, 1.7732101729271863, 2.3335164371291395, 3.1240493596065537, 2.7295135259735033, 2.8223566543097536, 4.191122966914226, 2.13638489305517, -1.1260181263715678, 2.7627243918540914, 4.046987375193757, 3.405617576751857, 0.5155795325450125, 3.432729165710565, 2.4724685498147263, 3.15074536097348, 4.928433373420733, 2.578614623347556, 5.144897375584112, 0.846817987529608, 3.8642977088354513, 1.838084265589601, 2.070398970839125, -0.884240848020055, 5.10470855998704, 3.782943710459345, 1.8285253827807408, 5.190815360171413, 2.908671262523996, 3.226432069571245, 3.600601566176192, 0.6557628268445279, 0.4921454019576048, 0.7930321659177686, 3.546016329047093, -0.9069089951716196, 2.32066431460215, 2.1952157895022038, 0.673379593429398, 3.135148702972762, 4.294111750258124, 2.5104115543146124, 4.032695158329453, 1.750542561614822, 1.6583609692713286, -0.8396986592943181, 3.9164468873042337, 1.6816051497634108, 4.177333603074519, 1.9474855284848007, 0.24445926776121346, 2.9183055765181525, 2.6697009280077197)
lm.residuals
// res11: DenseVector[Double] = DenseVector(-0.7985043946345713, 0.05774380027729853, -2.4838955046929727, -2.589687070180878, 3.823125941442551, -2.6043879624528037, -1.0760127991266006, -3.6316107533327147, -3.816257558964094, 0.4902766352402663, -3.1329594137618346, -0.019216104381618804, -4.069036263689393, 3.5166640316176623, 3.3629181147124836, -0.021332282187119134, 6.482087719333264, 3.4295407892959267, 2.683569852092374, 0.3436313384708023, 1.1965740355514227, 2.928210562593585, 1.0267265536998174, 4.572059982894681, -1.7807607891915695, -1.2986715986586885, 2.7293758590307573, -5.47951269303528, 0.2572431981367701, 0.8357489055790062, -3.167978760910349, 1.9378284702633253, 1.3145563176115158, -3.837324129007653, -2.1158054052607103, -2.0862821342786995, 4.131505680965021, -0.27168531934780216, 6.477775210479791, 1.1057242349700567, -2.4947790390732036, 3.801155527974882, -0.6003133098027371, -0.45864368292279467, -1.711305627476296, 0.731661259829414, -1.036408293018844, 2.3190150683710784, -4.62553502515035, 0.14743035595834586, 4.758752486872707, -3.5397938956776374, -2.418051253623713, 6.0632572780220935, -2.419909706958814, -0.8884591280344931, -3.307676068232493, 0.7890563650762097, 1.6469867594954395, -0.6472599126655338, 3.090034344700084, -2.8057966043531937, -0.7277346711775343, -4.5580080096600355, -1.7397813044794757, 2.3563082355906397, -1.140418177537014, -5.875518175199526, 3.4366926483083082, 1.0717338959682219, 0.027605562668103767, 1.4580499141882832, -6.315256654285639, 0.2154499303655295, 0.9911170080979126, -1.6612994552519855, -2.336326794494183, 3.4800040763502653, -1.2938593297566423, 0.015249346453654944, 5.700307553348556, -2.308038252704017, -1.8547396986646698, 3.139996120544916, -0.4552869579609138, 2.4684316508745745, 0.818359544282103, 0.8029473910563345, -1.9479155856184955, 2.0479888854673804, 1.9244231513706223, 1.8251232765812544, 2.728248053641425, -1.7403549023757812, 0.6486766841642098, -2.672878022173046, 2.8626092709193025, 0.8964248742563112, -0.6834273485613376, -6.4202879310708205)
lm.studentised
// res12: DenseVector[Double] = DenseVector(-0.28217184630199954, 0.02011442384229468, -0.862170081431399, -0.902370522596885, 1.3451688183950528, -0.91205227194253, -0.3772291861215202, -1.2655231529126727, -1.3499039918118236, 0.17260203857421227, -1.12635685172559, -0.006991850496449553, -1.421998612432064, 1.229410690150703, 1.1758388555397261, -0.007976192016738421, 2.3335026636655476, 1.198736342430917, 0.9643583869552442, 0.1202682397571023, 0.41711289726159684, 1.0237343656752038, 0.360681893492829, 1.6056798109382933, -0.6231379324681493, -0.45634187491373873, 0.9605289272865875, -1.9345353371808125, 0.09057383382073443, 0.29778327753834466, -1.119825665419833, 0.702700935632776, 0.45651688505707994, -1.3508590281292514, -0.7421339508356315, -0.7249071024780588, 1.483387481820631, -0.0944990064820807, 2.261290216785867, 0.39125284898190654, -0.874882029180794, 1.3434956834662093, -0.211192429465519, -0.15939272646196084, -0.5973078874821156, 0.2630409994979835, -0.36459317111014306, 0.8057091843697938, -1.6111789121052766, 0.052031133686130125, 1.6573829589152422, -1.2314169733149283, -0.845241518070676, 2.118846039382631, -0.8405520582837847, -0.3293055951425934, -1.1850288720440045, 0.2754970295679772, 0.5819410358551489, -0.23341871876662074, 1.0776008179155627, -0.9914476212466831, -0.25432585802345414, -1.6145313825050025, -0.613324401044969, 0.8457596121441753, -0.4026336046854319, -2.0605716199756055, 1.2031852173661444, 0.3730027391283285, 0.01003600313914035, 0.5185791001030666, -2.2107306149577415, 0.07683296468356299, 0.3495081242318272, -0.5774059360119126, -0.8137826774903978, 1.2132481993076445, -0.4562398102956752, 0.005330969668322201, 1.9928565014628037, -0.8268244917862789, -0.6579695720910228, 1.096097468565082, -0.15925630643589003, 0.8761871346309933, 0.28778575631827585, 0.28438058174654535, -0.6926424167559248, 0.7189012133147875, 0.669027712511825, 0.6414959788651846, 0.9778892842675372, -0.6141274624242168, 0.2255190709452627, -0.9361123284680002, 1.0397893636480955, 0.32149641007224083, -0.23916480653171718, -2.232097289118884)
val pred = lm.predict()
// pred: PredictLm = PredictLm(
//   mod = Lm(
//     y = DenseVector(1.6666013357123208, 2.1988021538115783, -0.21308742434934302, 1.0413323514559716, 4.840736469886046, -1.0999733215641863, 0.20961439690486405, -1.9438011445636174, -3.352123403615054, 4.994510363511257, -3.5298141458444836, 0.9515025455220751, -1.6398190918821842, 6.405221089969169, 6.698298320426309, 6.555310656249832, 11.984460817617565, 6.620602523454837, 8.654633918611754, 2.546732292430645, 2.3230759131298666, 7.0247784372875905, 2.030633665635455, 5.067124219168265, 0.08437121993743268, 2.813116884342831, 5.672744429637023, -0.9137994656525521, 0.7814712404331069, 2.5071124255316555, 1.1905169106831743, 2.568640056868974, 3.9763040274421497, -0.42241722325020703, -1.499157980023572, 0.06467333418051435, 3.7916307774330003, 2.2919797157069794, 8.518523328848088, 0.7124471022005547, -1.631170490559343, 8.582977952460466, 4.461052481306293, 2.15162520260983, 0.17945449500461796, 1.0098939935750795, 1.7752993597373563, 5.268763865670602, -2.852324852223164, 2.4809467930874853, 7.882801846479261, -0.8102803697041341, 0.4043054006860407, 10.25438024493632, -0.2835248139036439, -2.014477254406061, -0.5449516763784015, 4.836043740269966, 5.052604336247296, -0.1316803801205213, 6.522763510410649, -0.33332805453846737, 2.423010689795946, 0.3704253637606971, 0.8388333188680805, 7.501205611174751, -0.293600190007406, -2.0112204663640743, 5.2747769138979095, 3.142132866807347, -0.8566352853519512, 6.5627584741753235, -2.5323129438262937, 2.0439753131462703, 6.181932368269326, 1.2473718072720104, 0.8901052750770622, 7.080605642526457, -0.6380965029121143, 0.5073947484112598, 6.4933397192663245, 1.2379780763430759, -2.7616486938362894, 5.460660435147066, 1.73992883154129, 3.1418112443039723, 3.953508247254865, 5.097059141314459, 0.5624959686961168, 6.0806840437968335, 3.6749657129854443, 3.483484245852583, 1.8885493943471068, 2.1760919849284526, 2.3302818339276206, 1.5044555809014732, 4.810094799404103, 1.1408841420175246, 2.234878227956815, -3.7505870030631008),
//     Xmat = -0.9876963556683657    4.571155518980248      2.5254878563265892    
// 0.0026795378840239327  -7.872645941027212E-4  -0.19441582790332967  
// -0.07063534299415693   0.868784318823456      1.7819326135897413    
// 0.4277027164815229     2.048113621046923      0.29413455406534883   
// -1.067554491372269     0.714877034773171      -2.4278053689062578   
// -1.115618146210034     2.313108965072092      -0.48362144627760273  
// -1.2783713329350455    2.6758904444017593     1.419298054844869     
// -0.26864236428719385   0.6291835792638736     4.385451482964156     
// -0.6789327304373484    -1.76822688286913      -1.7072998293480959   
// 1.102971089348041      1.4749054390927303     -1.3718038874706133   
// -2.440780280736609     2.2553042423150638     -1.843911944404192    
// 0.22340448771358865    -3.9698936811296726    -3.4343907535899785   
// 0.6098578803671363     -1.0426387965219552    2.097357467659801     
// -0.420809208219145     3.5212326701182985     2.0047489482282295    
// -0.023148037487816735  3.402724609573512      3.3267116148740516    
// 0.5265480064632372     8.159126230470845      -1.6623366235123687   
// 2.327129199662464      -0.27096031867828874   -0.46948457831941814  
// -0.0659210245175052    2.4677747771775094     -1.2908552871872834   
// 1.995130637075771      1.6983579431878253     -1.9625901511678454   
// -0.5862872021404986    2.8807636053090633     4.273846395200189     
// -0.45855379508333965   -0.21688320331908595   3.1169939361260166    
// ...
pred.fitted
// res13: DenseVector[Double] = DenseVector(2.46510573034689, 2.1410583535342798, 2.27080808034363, 3.631019421636849, 1.0176105284434946, 1.504414640888617, 1.2856271960314642, 1.6878096087690966, 0.4641341553490395, 4.5042337282709894, -0.39685473208264954, 0.9707186499036937, 2.4292171718072075, 2.888557058351506, 3.3353802057138253, 6.57664293843695, 5.502373098284303, 3.191061734158909, 5.97106406651938, 2.2031009539598423, 1.1265018775784432, 4.096567874694005, 1.0039071119356369, 0.4950642362735833, 1.8651320091290013, 4.1117884830015194, 2.943368570606265, 4.565713227382728, 0.5242280422963366, 1.6713635199526484, 4.358495671593523, 0.6308115866056481, 2.6617477098306335, 3.4149069057574457, 0.6166474252371378, 2.150955468459214, -0.3398749035320211, 2.563665035054781, 2.040748118368297, -0.3932771327695027, 0.8636085485138606, 4.781822424485584, 5.06136579110903, 2.6102688855326237, 1.8907601224809134, 0.27823273374566504, 2.8117076527562004, 2.9497487972995233, 1.7732101729271859, 2.3335164371291395, 3.124049359606553, 2.729513525973503, 2.8223566543097527, 4.191122966914225, 2.13638489305517, -1.1260181263715683, 2.762724391854091, 4.046987375193757, 3.4056175767518564, 0.515579532545012, 3.432729165710565, 2.472468549814727, 3.1507453609734792, 4.9284333734207335, 2.5786146233475553, 5.1448973755841125, 0.8468179875296075, 3.864297708835451, 1.8380842655896004, 2.0703989708391246, -0.884240848020055, 5.104708559987039, 3.782943710459344, 1.8285253827807402, 5.190815360171413, 2.9086712625239954, 3.2264320695712447, 3.6006015661761923, 0.6557628268445269, 0.4921454019576045, 0.7930321659177682, 3.5460163290470925, -0.9069089951716205, 2.320664314602149, 2.1952157895022038, 0.6733795934293971, 3.1351487029727614, 4.294111750258125, 2.5104115543146115, 4.032695158329452, 1.7505425616148218, 1.658360969271328, -0.8396986592943183, 3.9164468873042337, 1.6816051497634108, 4.177333603074519, 1.9474855284848007, 0.24445926776121296, 2.918305576518152, 2.6697009280077193)
pred.se
// res14: DenseVector[Double] = DenseVector(0.6141929216466443, 0.3794674629007175, 0.2919609025393306, 0.38617594043909054, 0.5546783152176742, 0.48090488358558975, 0.49904066324549123, 0.38780230484591754, 0.6269227349520211, 0.5628798456298972, 0.8053324542777365, 0.912043442086898, 0.4440281805742804, 0.4507053041615065, 0.4534308425206751, 1.110121942409724, 0.8178746978264907, 0.4474152233267897, 0.8009902529985333, 0.47080374125490043, 0.3947417164572442, 0.4514935322713473, 0.5310468602483186, 0.5267232842337163, 0.46761477087932923, 0.5352952501333609, 0.5576512538259892, 0.6020028184006342, 0.5646632987516061, 0.7130708745762572, 0.6181355463109258, 0.8834366478617373, 0.305892910496083, 0.5621142495322973, 0.5071813773281127, 0.3200186257380429, 0.7924943143067593, 0.3458696034691054, 0.4232585505111616, 0.6311773397911614, 0.5038795454882181, 0.6167170898334245, 0.5527360746208102, 0.32497158934426906, 0.4205819056031153, 0.8051587660982974, 0.5519706719608705, 0.31795139741569833, 0.37844390700584946, 0.5971218851550939, 0.37582470733126416, 0.34948683688324383, 0.4485770914692282, 0.44342446200784336, 0.3113240072062185, 1.051764528672815, 0.7709629341137457, 0.4267463143386174, 0.6127652397884937, 0.8342692103713779, 0.4033127113416258, 0.6135086248699484, 0.4444457804071601, 0.6444476202293852, 0.5820294106148934, 0.7895259631382887, 0.6023451214816843, 0.504775349495328, 0.47610649884144013, 0.3600946619248228, 0.9050965050242349, 0.6928616594973244, 0.47424923965092036, 0.7225816758462974, 0.5863654723737209, 0.32732347364132974, 0.37809552184693224, 0.39741376714479976, 0.5855365453948846, 0.45023999051444763, 0.4511913475098922, 0.7701333508009076, 0.6627115595111547, 0.4227954601490978, 0.46084042999886504, 0.6696540025739507, 0.5468038341136935, 0.6427776514343966, 0.6901321578509114, 0.5193884152279885, 0.33367822701683075, 0.5391388336016343, 0.7755976176312853, 0.5953954122503538, 0.33433137551546327, 0.4822605268251534, 0.8977286384973979, 0.7814965526409028, 0.46867170038797823, 0.3345380936105039)
val predNew = lm.predict(DenseMatrix((1.1, 1.6, 1.0), (1.4, 2.2, 3.0)))
// predNew: PredictLm = PredictLm(
//   mod = Lm(
//     y = DenseVector(1.6666013357123208, 2.1988021538115783, -0.21308742434934302, 1.0413323514559716, 4.840736469886046, -1.0999733215641863, 0.20961439690486405, -1.9438011445636174, -3.352123403615054, 4.994510363511257, -3.5298141458444836, 0.9515025455220751, -1.6398190918821842, 6.405221089969169, 6.698298320426309, 6.555310656249832, 11.984460817617565, 6.620602523454837, 8.654633918611754, 2.546732292430645, 2.3230759131298666, 7.0247784372875905, 2.030633665635455, 5.067124219168265, 0.08437121993743268, 2.813116884342831, 5.672744429637023, -0.9137994656525521, 0.7814712404331069, 2.5071124255316555, 1.1905169106831743, 2.568640056868974, 3.9763040274421497, -0.42241722325020703, -1.499157980023572, 0.06467333418051435, 3.7916307774330003, 2.2919797157069794, 8.518523328848088, 0.7124471022005547, -1.631170490559343, 8.582977952460466, 4.461052481306293, 2.15162520260983, 0.17945449500461796, 1.0098939935750795, 1.7752993597373563, 5.268763865670602, -2.852324852223164, 2.4809467930874853, 7.882801846479261, -0.8102803697041341, 0.4043054006860407, 10.25438024493632, -0.2835248139036439, -2.014477254406061, -0.5449516763784015, 4.836043740269966, 5.052604336247296, -0.1316803801205213, 6.522763510410649, -0.33332805453846737, 2.423010689795946, 0.3704253637606971, 0.8388333188680805, 7.501205611174751, -0.293600190007406, -2.0112204663640743, 5.2747769138979095, 3.142132866807347, -0.8566352853519512, 6.5627584741753235, -2.5323129438262937, 2.0439753131462703, 6.181932368269326, 1.2473718072720104, 0.8901052750770622, 7.080605642526457, -0.6380965029121143, 0.5073947484112598, 6.4933397192663245, 1.2379780763430759, -2.7616486938362894, 5.460660435147066, 1.73992883154129, 3.1418112443039723, 3.953508247254865, 5.097059141314459, 0.5624959686961168, 6.0806840437968335, 3.6749657129854443, 3.483484245852583, 1.8885493943471068, 2.1760919849284526, 2.3302818339276206, 1.5044555809014732, 4.810094799404103, 1.1408841420175246, 2.234878227956815, -3.7505870030631008),
//     Xmat = -0.9876963556683657    4.571155518980248      2.5254878563265892    
// 0.0026795378840239327  -7.872645941027212E-4  -0.19441582790332967  
// -0.07063534299415693   0.868784318823456      1.7819326135897413    
// 0.4277027164815229     2.048113621046923      0.29413455406534883   
// -1.067554491372269     0.714877034773171      -2.4278053689062578   
// -1.115618146210034     2.313108965072092      -0.48362144627760273  
// -1.2783713329350455    2.6758904444017593     1.419298054844869     
// -0.26864236428719385   0.6291835792638736     4.385451482964156     
// -0.6789327304373484    -1.76822688286913      -1.7072998293480959   
// 1.102971089348041      1.4749054390927303     -1.3718038874706133   
// -2.440780280736609     2.2553042423150638     -1.843911944404192    
// 0.22340448771358865    -3.9698936811296726    -3.4343907535899785   
// 0.6098578803671363     -1.0426387965219552    2.097357467659801     
// -0.420809208219145     3.5212326701182985     2.0047489482282295    
// -0.023148037487816735  3.402724609573512      3.3267116148740516    
// 0.5265480064632372     8.159126230470845      -1.6623366235123687   
// 2.327129199662464      -0.27096031867828874   -0.46948457831941814  
// -0.0659210245175052    2.4677747771775094     -1.2908552871872834   
// 1.995130637075771      1.6983579431878253     -1.9625901511678454   
// -0.5862872021404986    2.8807636053090633     4.273846395200189     
// -0.45855379508333965   -0.21688320331908595   3.1169939361260166    
// ...
predNew.fitted
// res15: DenseVector[Double] = DenseVector(4.386642904650232, 4.952977194268351)
predNew.se
// res16: DenseVector[Double] = DenseVector(0.4696432043715515, 0.5509050042914325)
lm.plots
// res17: Figure = breeze.plot.Figure@50c5b440
lm.summary
// Estimate	 S.E.	 t-stat	p-value		Variable
// ---------------------------------------------------------
//   2.1237	 0.371	 5.727	0.0000 *	(Intercept)
//   1.4883	 0.298	 4.995	0.0000 *	V1
//   0.4353	 0.140	 3.110	0.0025 *	V2
//  -0.0707	 0.091	-0.778	0.4384  	V3
// 
// Residual standard error:   2.8957 on 96 degrees of freedom
// Multiple R-squared: 0.2473, Adjusted R-squared: 0.2238
// F-statistic: 10.5155 on 3 and 96 DF, p-value: 0.00000
//
```
The plots include a plot of studentised residuals against fitted values and a normal Q-Q plot for the studentised residuals.

![Linear model plots](lm-plots.png)


## Generalised linear models

The current implementation supports only simple one-parameter exponential family observation models. This includes the most commonly used cases of **logistic regression** (`LogisticGlm`) and **Poisson regression** (`PoissonGlm`).

### Logistic regression

Again, we start by creating an appropriate response variable.
```scala
val ylb = (0 until 100) map (i => Bernoulli(sigmoid(1.0 + X(i,0))).sample())
val yl = DenseVector(ylb.toArray map {b => if (b) 1.0 else 0.0})
```

Then we can do logistic regression in a typical way.
```scala
import scalaglm.{Glm, LogisticGlm}
val glm = Glm(yl, X, List("V1","V2","V3"), LogisticGlm)
```
```scala
glm.coefficients
// res20: DenseVector[Double] = DenseVector(1.8414379437829806, 1.0680900498587202, -0.10956400050730118, -0.06924553648808815)
glm.fitted
// res21: DenseVector[Double] = DenseVector(0.5276658259275394, 0.865045989565904, 0.8245400163520312, 0.8863003869404318, 0.6880424705138891, 0.6058527637913939, 0.52112764342682, 0.7652883401905424, 0.8066259337382663, 0.9504006142561967, 0.2921525160301614, 0.9400728501879231, 0.9214218367529884, 0.7041951475009044, 0.7709243063494201, 0.8354837448084983, 0.9877417088016505, 0.8306210333655218, 0.980587578986831, 0.6464926712913028, 0.7612574574814777, 0.9166561924974758, 0.5038323880050651, 0.7787778904777902, 0.5840323296108219, 0.9036952864987198, 0.7166494207427505, 0.9551310198438353, 0.830931053943671, 0.41984545543533025, 0.8082027834957359, 0.5039656284669574, 0.8708530380320735, 0.8507711885945315, 0.7500581357247705, 0.854496912368527, 0.2254663760455323, 0.7765106204550029, 0.8787059506520246, 0.5121427525500901, 0.8150641032801562, 0.9579152873186286, 0.9472094809735134, 0.8478174828740549, 0.7764675362265676, 0.7821310973257636, 0.8980610125221377, 0.825638746768833, 0.8114582359567665, 0.9257440257958977, 0.8473440614434186, 0.8945305293016533, 0.8536915281059784, 0.9235540046817629, 0.8014168076536711, 0.8554080241474679, 0.8646817685049866, 0.9141238726423624, 0.9648094501233283, 0.48610676511538925, 0.9039492285813036, 0.9238052349119789, 0.7556414218501674, 0.8891453558659951, 0.8426902712107144, 0.9861031716247445, 0.7328639037104959, 0.9192629072258367, 0.5910974242087854, 0.8740228481993874, 0.46142467612599397, 0.9155492934159994, 0.9502561017935757, 0.48809722944309375, 0.9607661898576464, 0.8265710888324491, 0.8912251570236281, 0.8375776290208741, 0.5141044942172284, 0.6639125831851234, 0.6843491176984653, 0.9732370019755328, 0.5312093505394909, 0.6632655193762196, 0.643493426909367, 0.5862295387288035, 0.9540902824286531, 0.9474609747127428, 0.5131972549533834, 0.9515311895778203, 0.7191657734320038, 0.5053243506027929, 0.7512443731360172, 0.8118874807885299, 0.8055564402300918, 0.8621247876884517, 0.9527181247539432, 0.7029714301799905, 0.9086578249336197, 0.8584804665863204)
glm.predict(response=true).fitted
// res22: DenseVector[Double] = DenseVector(0.5276658259275394, 0.865045989565904, 0.8245400163520312, 0.8863003869404318, 0.6880424705138891, 0.6058527637913939, 0.52112764342682, 0.7652883401905424, 0.8066259337382663, 0.9504006142561967, 0.2921525160301614, 0.9400728501879231, 0.9214218367529884, 0.7041951475009044, 0.7709243063494201, 0.8354837448084983, 0.9877417088016505, 0.8306210333655218, 0.980587578986831, 0.6464926712913028, 0.7612574574814777, 0.9166561924974758, 0.5038323880050651, 0.7787778904777902, 0.5840323296108219, 0.9036952864987198, 0.7166494207427505, 0.9551310198438353, 0.830931053943671, 0.41984545543533025, 0.8082027834957359, 0.5039656284669574, 0.8708530380320735, 0.8507711885945315, 0.7500581357247705, 0.854496912368527, 0.2254663760455323, 0.7765106204550029, 0.8787059506520246, 0.5121427525500901, 0.8150641032801562, 0.9579152873186286, 0.9472094809735134, 0.8478174828740549, 0.7764675362265676, 0.7821310973257636, 0.8980610125221377, 0.825638746768833, 0.8114582359567665, 0.9257440257958977, 0.8473440614434186, 0.8945305293016533, 0.8536915281059784, 0.9235540046817629, 0.8014168076536711, 0.8554080241474679, 0.8646817685049866, 0.9141238726423624, 0.9648094501233283, 0.48610676511538925, 0.9039492285813036, 0.9238052349119789, 0.7556414218501674, 0.8891453558659951, 0.8426902712107144, 0.9861031716247445, 0.7328639037104959, 0.9192629072258367, 0.5910974242087854, 0.8740228481993874, 0.46142467612599397, 0.9155492934159994, 0.9502561017935757, 0.48809722944309375, 0.9607661898576464, 0.8265710888324491, 0.8912251570236281, 0.8375776290208741, 0.5141044942172284, 0.6639125831851234, 0.6843491176984653, 0.9732370019755328, 0.5312093505394909, 0.6632655193762196, 0.643493426909367, 0.5862295387288035, 0.9540902824286531, 0.9474609747127428, 0.5131972549533834, 0.9515311895778203, 0.7191657734320038, 0.5053243506027929, 0.7512443731360172, 0.8118874807885299, 0.8055564402300918, 0.8621247876884517, 0.9527181247539432, 0.7029714301799905, 0.9086578249336197, 0.8584804665863204)
glm.summary
// Estimate	 S.E.	 z-stat	p-value		Variable
// ---------------------------------------------------------
//   1.8414	 0.398	 4.623	0.0000 *	(Intercept)
//   1.0681	 0.321	 3.332	0.0009 *	V1
//  -0.1096	 0.128	-0.857	0.3915  	V2
//  -0.0692	 0.082	-0.846	0.3977  	V3
glm.plots
// res24: Figure = breeze.plot.Figure@38c90a80
```

![Logistic regression plots](glm-plots.png)


### Poisson regression

We first create an appropriate response, and then do Poisson regression.
```scala
val yp = DenseVector.tabulate(100)(i => Poisson(math.exp(-0.5 + X(i,0))).sample().toDouble)

import scalaglm.PoissonGlm
val pglm = Glm(yp, X, List("V1","V2","V3"), PoissonGlm)
```
```scala
pglm.coefficients
// res26: DenseVector[Double] = DenseVector(-0.7940539689403293, 1.1273849190713934, -0.003897406638010582, 0.05684720348301403)
pglm.summary
// Estimate	 S.E.	 z-stat	p-value		Variable
// ---------------------------------------------------------
//  -0.7941	 0.206	-3.860	0.0001 *	(Intercept)
//   1.1274	 0.128	 8.791	0.0000 *	V1
//  -0.0039	 0.058	-0.068	0.9462  	V2
//   0.0568	 0.034	 1.670	0.0949  	V3
pglm.plots
// res28: Figure = breeze.plot.Figure@4e08c94c
```
![Poisson regression plots](pglm-plots.png)


## Non-linear response

The above covers the main functionality of the library based on a linear reponse to variation in covariate values. For flexible modelling of a nonlinear response, see the documentation on [flexible regression modelling](FlexibleRegression.md).


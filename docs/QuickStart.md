# scala-glm - Quickstart Guide

## PCA

This library contains code for principal components analysis based on a thin SVD of the centred data matrix. This is more numerically stable than a construction from the spectral decomposition of the covariance matrix. It is analogous to the R function `prcomp` rather than the R function `princomp`. First create some synthetic data.

```scala
import breeze.linalg.*
import breeze.numerics.*
import breeze.stats.distributions.*
import breeze.stats.distributions.Rand.VariableSeed.randBasis

val X = DenseMatrix.tabulate(100, 3)((i, j) => 
	Gaussian(j, j+1).sample())
```
Now we can do PCA.
```scala
import scalaglm.Pca
val pca = Pca(X, List("V1", "V2", "V3"))
```
```scala
pca.sdev
// res0: DenseVector[Double] = DenseVector(2.833379903505347, 1.9947322162903176, 1.033145213167009)
pca.loadings
// res1: DenseMatrix[Double] = 0.030914629676234984  0.031357737078792226  -0.9990300185666489    
// 0.08574752464788638   -0.9959061421875378   -0.028606257530409983  
// -0.9958371592227022   -0.08477999928304669  -0.03347691791108123   
pca.scores
// res2: DenseMatrix[Double] = 1.681815342688872      -3.6446819310584258    -0.40824421799774196   
// -2.9784118031116793    -0.4563770356040815    1.0327553808931251     
// -4.676109167207329     2.373215045156735      0.5988916907494636     
// -0.2226868172782667    1.315673356394298      -0.6524016512021804    
// 3.298105358287612      -0.4041870179252658    -0.8785302573826992    
// -6.282901716403347     -0.5407779727504743    0.8836777356778565     
// -0.013795621626256296  0.5112706503493443     -1.4020197933729621    
// -3.3385174942889053    1.9843453230727686     -0.5203570575276342    
// -0.636084500692461     -2.75076043912163      -0.9745140394407598    
// 1.8796857636819368     0.07594171375941568    -0.8237033663446585    
// 3.4531312671564476     -0.6789809062925771    -0.6156186692600264    
// 2.3331003748104755     0.31772189122539235    -0.51182473193907      
// -0.8593147703298493    -2.029753135472016     -0.6373338482583293    
// 2.714222036058932      1.332714029579837      0.5260399091595428     
// -1.1327940053630723    -2.112385581461922     -0.8023760597717745    
// 0.3422564153911232     0.4939759609583652     -1.5150716218998188    
// -5.862245758192257     4.189749645766246      0.32672848837139296    
// -2.5138541084260435    2.070193548278739      -1.2302332507455889    
// 2.367862561215289      0.6880081687609879     0.20183197664862781    
// -3.723125479926526     0.08276720389500607    -0.9503079697026984    
// -1.3916709754321928    -2.7271452529758995    1.9216478810684412     
// -6.640144309337616     -3.461226206310479     -1.2573794691472335    
// 2.5224568056412973     0.8847488056568287     0.38821793136886823    
// -0.82377624205746      -0.894652247137427     1.9808919887791379     
// 2.2376188683458813     0.7478225349661184     1.9282873076258353     
// -0.189596175486772     1.4659416825228808     0.5583804074674861     
// 2.241790200106539      1.1583529274139317     0.49514576291227824    
// -3.548238818078883     -1.704591274575588     0.6012099154066891     
// 3.816568684932867      -1.0279316195913135    -1.5761172444097256    
// -2.204855205297755     -1.848861694462531     1.5627273781060593     
// 1.1533243764476542     3.6885398433684764     0.45234025365828384    
// -1.2492285555091192    0.3966168848741267     -0.1353735227145213    
// -1.4306436095105932    -4.055055763806239     1.251547744564191      
// -1.718180984311038     0.5616127393055664     0.6248089239311189     
// 2.128414386626243      2.373446641837099      1.191379676503348      
// 2.278763035714018      0.2470640945376174     0.7888585211277663     
// -0.231273462412166     2.3926403626651864     -1.5728939150432997    
// 4.2007175535865935     2.3372394104013092     2.4696495575800412     
// 2.63549891744681       0.8307554536859068     0.7252570428441077     
// 2.00381415203537       4.665130296584947      0.3293951967876565     
// 4.571353207228462      -1.2737853903721217    1.3320774326032676     
// -3.2591703764870568    -3.6280150634248596    -0.062247884491549735  
// 2.277657208988113      -0.2059618988775991    -0.11153477723055719   
// -1.5873431931538595    -0.3160223841908761    0.6415258432008736     
// -2.4352584367724113    -2.2974907997626044    -1.0179127962288086    
// -2.1125513328032155    -3.037808543004084     -0.9994815737244469    
// -0.40744384757168045   0.29961942152247123    -1.0363448931161867    
// -0.8733009558341783    -0.8844806913546015    1.305662609198998      
// -0.7783164662231549    -3.914753761694927     0.012825089509327115   
// ...
pca.plots
// res3: Figure = breeze.plot.Figure@d73b857
pca.summary
// Standard deviations:
// V1	V2	V3
//  2.833	 1.995	 1.033
// Cumulative proportion of variance explained:
// V1	V2	V3
//  0.614	 0.918	 1.000
// Loadings:
// PC01	PC02	PC03	
//  0.031	 0.031	-0.999	V1
//  0.086	-0.996	-0.029	V2
// -0.996	-0.085	-0.033	V3
```
The final line prints a readable summary of the PCA to the console. `plots` produces some diagnostic plots, including a "scree plot".

![PCA Plots](pca-plots.png)

Note that there is also a utility function `pairs` for producing a "scatterplot matrix":
```scala
import scalaglm.Utils.pairs
pairs(X, List("V1", "V2", "V3"))
// res6: Figure = breeze.plot.Figure@284fa221
```

![Pairs plots](pairs-plots.png)


## Linear regression

This code computes regression coefficients and associated diagnostics via the QR decomposition of the covariate matrix. The diagnostics are analogous to those produced by the R function `lm`. We start by creating a synthetic response variable.

```scala
val y = DenseVector.tabulate(100)(i => 
	Gaussian(2.0 + 1.5*X(i,0) + 0.5*X(i,1), 3.0).sample())
```
So we can now do linear regression and generate all of the usual diagnostics.
```scala
import scalaglm.Lm
val lm = Lm(y,X,List("V1", "V2", "V3"))
```
```scala
lm.coefficients
// res8: DenseVector[Double] = DenseVector(2.0555428988949536, 1.944583111431598, 0.6560004209437523, -0.12800690716989213)
lm.se
// res9: DenseVector[Double] = DenseVector(0.41471544212331246, 0.2903699170616278, 0.1503986796955344, 0.10673255343831868)
lm.fitted
// res10: DenseVector[Double] = DenseVector(5.8328620091473224, 0.022267556065863836, -1.187916151461365, 2.961955928430189, 5.263113974775951, -0.4426517195135311, 4.947775571892192, 1.5549329722808523, 5.856152916492314, 4.530752353031573, 4.946139409713106, 3.8903199347684425, 4.722544188888028, 1.361765280582722, 5.026925251397568, 5.26591455805272, -2.0007597261425527, 3.095453487911921, 2.2867278201045425, 3.408378723567023, -0.010124037203573799, 5.358862669026377, 1.8452321229764979, -1.053166159254432, -1.1587912635676823, 0.5129308238890543, 1.4084208946698376, 1.4537491297294645, 7.117535724694338, -0.016648670564338275, -0.24447817055254759, 2.2341449990970923, 2.0640373009475073, 0.5360409729730864, -0.6884363629120177, 1.3724889253349521, 4.135188925520509, -2.6638717913049383, 1.2445473651106957, -0.3643414308717421, 1.7526902473752524, 3.941181799688228, 3.397876325113949, 1.0455579454875459, 5.238811123991707, 5.711910457622381, 4.259169507503172, 0.2503867475440513, 4.565917533267793, 4.844280840790156, 0.5612563223177189, 3.240658170105121, 1.174864324499696, -1.6275570720056867, 3.3502357274942876, 1.7485494291257115, 3.25269123602246, 0.46089663971711975, 3.6158946689093683, 0.6237542788702353, 6.940681853803866, 3.8542936332292577, 4.399876018095804, 1.4362747626597923, 2.326866058367446, 6.198510260429956, 2.5914891882913724, -0.15122622256283158, 0.8588776543290354, 0.33913409152731555, 0.0039516064143667595, 3.0202222205280465, 2.875106683911472, 3.169763106253103, 4.841231814215519, 0.6963530382458317, 2.4130615555953585, 4.937551971483177, 4.000384717401809, 6.5464762736845135, 2.8423042678617696, -2.00256775184233, -1.1325042723308925, 2.453806064222123, 5.561588807337548, 0.4421307231721423, 1.8098186869727748, 0.7150493688086432, 8.417401393461706, 4.558200538456422, 0.14636808438224677, 2.776672796439997, 3.023474021362667, 9.531790940221278, 2.0279875499232505, 1.685744925429848, 3.610657688805844, 0.3052277381376576, 1.6273830657458201, 4.909001488445308)
lm.residuals
// res11: DenseVector[Double] = DenseVector(-4.196826458797942, -2.749279474180417, 1.5849139561235357, 0.7738470579971652, -2.182659033352703, 0.472901051878321, -5.633724106456023, 1.722882793811725, -2.0230518876850487, -6.401435373272921, -0.29817380530138315, 1.82090441051214, 3.0385011311910777, 2.6156939671820685, 0.03707973828582567, 3.6539515721912297, -5.096275993696086, 2.174487256770631, -2.221509370736437, -11.387280814947491, -3.35646184096664, 2.717408447523126, -0.2591599442748709, 0.4184963364582438, -1.594917547314151, -0.30794286020245754, -1.8876641215811973, -4.05579816280175, 2.8253006014584523, -0.6412078975477118, 0.006443781500826445, 2.800289727110757, 1.9631404267465649, -1.3349571863924483, 6.013739907864202, -0.5331355979611107, -1.8732173474811114, -0.1618761711179948, 1.5482123092974072, -0.846085206825828, 2.0599335074196903, 0.29854565248190834, -4.779636577877012, 2.686764082113565, -0.802768229005391, -3.77049880976788, 0.03978681336903289, 0.8541945468597874, 6.626409493300105, -0.2521962344949884, 0.7796125897486328, -4.508270552927929, 1.7774570754007901, 2.9436502129755135, 1.7359834976506487, -0.33191008365149344, 1.3347838632426177, -2.350681412389827, 5.953900795745886, -3.13566767961034, -1.750853347137995, -0.20555357289984633, 0.2895673739138065, -0.8922470395978854, 1.3466131406090418, 2.41343145270665, -2.2616702372497675, 0.17800954010747527, -1.6472312671315783, -1.255583709833239, 6.746564524036953, -1.0518557330367693, 4.866467597939749, -1.6457092249535294, 2.0663313289672978, -0.2859513379651487, 1.3720683731561247, 2.5878934890202965, -1.7134776321879226, 1.1960025981579907, 2.7684042122502275, -3.605938547474277, 3.5508789849136115, -0.9331462715287877, -4.551592271802212, 3.5631456154124006, 0.8222199650930386, 2.1164663757664797, 2.15367756176105, -4.03295655426149, 2.5675380517211224, 1.5555998152523065, -0.9875996494682364, 3.50924345305161, 3.501016179056778, -0.8769848925743544, -0.7133075803491056, -2.8986928631608873, -2.6558553723506835, 0.49012065047673925)
lm.studentised
// res12: DenseVector[Double] = DenseVector(-1.4405599718418851, -0.9353317221669891, 0.5458454309483206, 0.26148064004671834, -0.74241669821877, 0.16396407817146683, -1.9141602756183538, 0.5875994321258718, -0.6907352993877991, -2.1656714909513557, -0.1013357886382141, 0.6156231977013686, 1.0302478244340518, 0.8874193896253296, 0.012597019538842619, 1.243563206665345, -1.797125394748416, 0.7441640418989974, -0.7507015636684532, -3.8825361020051146, -1.1627927735205863, 0.964718466923755, -0.08770058695111636, 0.1437365396979342, -0.5486240497079835, -0.10405121712305153, -0.6389977049637409, -1.3832939923843952, 0.9726822800022241, -0.21998428309519022, 0.0022110022343897104, 0.9433554638030628, 0.6811497110129857, -0.45101490193926863, 2.0583528186840785, -0.18052173576436042, -0.642695808663979, -0.057241446326994364, 0.5250077064627972, -0.29391099121338465, 0.7101945783074216, 0.10290714542728496, -1.6136021523469148, 0.9073108625579671, -0.27437117711726505, -1.2939765561304395, 0.013458361151361372, 0.2902001464999338, 2.275483653770696, -0.08565829340463575, 0.2637988978424727, -1.5253610335799277, 0.6035554807122733, 1.0123703588973998, 0.5886884319346376, -0.11248091092744247, 0.4605479828251203, -0.8143264446374132, 2.0068606843724783, -1.0716665444307742, -0.5999006584785521, -0.0695855435304447, 0.0999146499432462, -0.30174729958935215, 0.4552889404921959, 0.8249098459827414, -0.7958322108015436, 0.06085198795486847, -0.5603210476036805, -0.4314406215552283, 2.282505610135762, -0.35595054247035157, 1.6572200686611338, -0.5565860642073817, 0.6999748902224031, -0.0972082700310129, 0.4633112811654858, 0.8753388971407241, -0.5844454472047532, 0.4104391415194566, 0.9396009233344143, -1.242882991282333, 1.2135414433112377, -0.32403147517310904, -1.5581165418827934, 1.2183405707967563, 0.2772132212958472, 0.732241561283957, 0.7589382766760971, -1.3803069924252052, 0.8805273535523725, 0.5254627262985476, -0.3331436558717318, 1.24442144112195, 1.192743446338826, -0.2964802720978201, -0.2460015454263026, -0.9816839414912641, -0.896255985049392, 0.16962657147716254)
val pred = lm.predict()
// pred: PredictLm = PredictLm(
//   Lm(
//     DenseVector(1.6360355503493809, -2.7270119181145533, 0.3969978046621706, 3.735802986427354, 3.0804549414232483, 0.030249332364789883, -0.6859485345638303, 3.2778157660925773, 3.833101028807265, -1.8706830202413478, 4.647965604411723, 5.711224345280582, 7.761045320079106, 3.9774592477647905, 5.064004989683394, 8.91986613024395, -7.0970357198386385, 5.269940744682552, 0.06521844936810561, -7.978902091380467, -3.3665858781702136, 8.076271116549503, 1.586072178701627, -0.6346698227961881, -2.7537088108818333, 0.20498796368659677, -0.4792432269113598, -2.6020490330722854, 9.94283632615279, -0.6578565681120501, -0.23803438905172114, 5.0344347262078495, 4.027177727694072, -0.7989162134193619, 5.325303544952184, 0.8393533273738415, 2.261971578039398, -2.825747962422933, 2.792759674408103, -1.21042663769757, 3.8126237547949424, 4.239727452170136, -1.3817602527630632, 3.732322027601111, 4.436042894986316, 1.9414116478545012, 4.298956320872205, 1.1045812944038387, 11.192327026567899, 4.592084606295168, 1.3408689120663517, -1.2676123828228079, 2.952321399900486, 1.3160931409698269, 5.086219225144936, 1.416639345474218, 4.5874750992650775, -1.8897847726727073, 9.569795464655254, -2.511913400740105, 5.189828506665871, 3.6487400603294113, 4.68944339200961, 0.5440277230619068, 3.6734791989764877, 8.611941713136606, 0.32981895104160497, 0.026783317544643692, -0.7883536128025428, -0.9164496183059234, 6.750516130451319, 1.9683664874912772, 7.741574281851221, 1.5240538812995734, 6.907563143182816, 0.410401700280683, 3.7851299287514832, 7.525445460503473, 2.286907085213886, 7.742478871842504, 5.610708480111997, -5.608506299316607, 2.418374712582719, 1.5206597926933352, 1.0099965355353362, 4.005276338584543, 2.6320386520658134, 2.831515744575123, 10.571078955222756, 0.5252439841949323, 2.713906136103369, 4.332272611692304, 2.0358743718944305, 13.041034393272888, 5.529003728980029, 0.8087600328554936, 2.8973501084567386, -2.5934651250232297, -1.0284723066048636, 5.399122138922047),
//     0.3139181465099106    4.95997706457627      0.6786185212709943    
// -1.1697748793054439   1.3439000883503212    5.000901171444813     
// -0.700086109690434    -1.6072701748836904   6.466162896287016     
// 0.6545072894656916    -0.1363931491218513   2.1628272626210374    
// 0.9353296119411244    1.8847942683657735    -1.189928565619799    
// -1.1256455409726676   1.1488682232831833    8.303781190859269     
// 1.3846318613510453    0.7040721191928964    2.048097813608186     
// 0.44723406480481004   -1.073279737273324    5.204576777755621     
// 0.8360130365683602    3.887159846515192     2.930039621549076     
// 0.8517617360088315    1.2834367541261658    0.1800456251995357    
// 0.6688486972381643    2.1642353609706007    -1.329813570308346    
// 0.56178444211675      1.0726038903380242    -0.3024203518112105   
// 0.5148679802524382    3.1403173378174634    3.079925866849348     
// -0.4314633979190181   0.06475780131554187   -0.8027510064219703   
// 0.668704428094275     3.203882570882036     3.36479733464971      
// 1.5080389262503042    0.755060577125799     1.6987788350668014    
// -0.40789345962080054  -3.5102908470406      7.502467172550671     
// 1.1846078605515553    -1.067756766848463    4.399832588838949     
// -0.1384940328595442   0.6863992360139621    -0.3923217261630225   
// 0.8052487324353418    0.7998336952561136    5.763192924560582     
// -2.0799578179066938   3.716003313969549     3.5835240397663966    
// 0.9107122077906602    4.0879755227719965    8.978808235196533     
// ...
pred.fitted
// res13: DenseVector[Double] = DenseVector(5.832862009147321, 0.022267556065866945, -1.1879161514613656, 2.9619559284301884, 5.263113974775949, -0.4426517195135302, 4.947775571892191, 1.5549329722808514, 5.856152916492313, 4.530752353031572, 4.946139409713105, 3.8903199347684416, 4.722544188888028, 1.3617652805827216, 5.026925251397567, 5.265914558052719, -2.0007597261425527, 3.09545348791192, 2.2867278201045425, 3.4083787235670227, -0.010124037203572911, 5.358862669026376, 1.8452321229764979, -1.0531661592544315, -1.1587912635676818, 0.5129308238890542, 1.4084208946698373, 1.4537491297294642, 7.117535724694337, -0.01664867056433783, -0.24447817055254778, 2.2341449990970914, 2.064037300947509, 0.5360409729730864, -0.6884363629120174, 1.3724889253349526, 4.1351889255205085, -2.6638717913049375, 1.2445473651106957, -0.3643414308717431, 1.7526902473752526, 3.941181799688229, 3.397876325113949, 1.0455579454875454, 5.238811123991706, 5.711910457622381, 4.259169507503172, 0.25038674754405266, 4.565917533267794, 4.844280840790155, 0.5612563223177189, 3.2406581701051205, 1.1748643244996955, -1.6275570720056862, 3.350235727494286, 1.7485494291257107, 3.2526912360224607, 0.46089663971711886, 3.615894668909368, 0.6237542788702357, 6.9406818538038655, 3.8542936332292563, 4.399876018095802, 1.4362747626597914, 2.326866058367446, 6.198510260429954, 2.591489188291374, -0.15122622256283158, 0.8588776543290346, 0.33913409152731644, 0.0039516064143667595, 3.0202222205280456, 2.875106683911471, 3.169763106253102, 4.841231814215519, 0.6963530382458315, 2.413061555595358, 4.937551971483175, 4.000384717401808, 6.546476273684512, 2.8423042678617687, -2.0025677518423297, -1.132504272330892, 2.453806064222123, 5.5615888073375475, 0.44213072317214275, 1.8098186869727744, 0.7150493688086432, 8.417401393461702, 4.558200538456422, 0.14636808438224616, 2.776672796439996, 3.023474021362667, 9.531790940221278, 2.0279875499232505, 1.685744925429848, 3.6106576888058437, 0.30522773813765847, 1.6273830657458195, 4.909001488445306)
pred.se
// res14: DenseVector[Double] = DenseVector(0.6602913809582461, 0.532560738925734, 0.7018640322054189, 0.40613603396856934, 0.5293776399134101, 0.7778251649999338, 0.5110277316355127, 0.5713494065161461, 0.5876929982995862, 0.4316599609394954, 0.5153268891387206, 0.4180423530575458, 0.47450570021628613, 0.4853364525111948, 0.5090102579741845, 0.5384395943637842, 0.9390169113740723, 0.6205468125214576, 0.4078586692468778, 0.566820428574811, 0.7689559629134315, 0.9945728465411967, 0.43718817949253413, 0.6680896728214418, 0.6871042461244067, 0.4057694938272703, 0.44357617918951975, 0.5717831121109074, 0.6974884547921464, 0.653817682535153, 0.6554785097039163, 0.33446574949360386, 0.7854840943431407, 0.40310271401049663, 0.6225507811877222, 0.4488544063550406, 0.6545504670465963, 0.9623682563438449, 0.4767313396943079, 0.7978038427752131, 0.7144649771626332, 0.712037204129727, 0.38664220904431634, 0.3931170008331632, 0.6024053172483989, 0.6578376745032378, 0.4287511867101461, 0.5093899022733019, 0.6657455951421273, 0.505061905021679, 0.4353218632816558, 0.43386612352199255, 0.5005853733057416, 0.6847380554338379, 0.4769306812465873, 0.46495288720350597, 0.7236120332375817, 0.7685605178415278, 0.3489008231985856, 0.6017941755680963, 0.6367201686168373, 0.4444548529822876, 0.7240290516425075, 0.4242799670834935, 0.4188330278200774, 0.6031642157224503, 0.9203902972025415, 0.6051205026292803, 0.5301486697165663, 0.6739002364946904, 0.4323101295562229, 0.4371356858080964, 0.5479952728375286, 0.42527277385285495, 0.457302854923649, 0.5198596566618728, 0.391601093653687, 0.4276612085967558, 0.5727302498747158, 0.657512082766418, 0.49237017259916865, 0.7114148090246429, 0.6014369180968027, 0.7938641093233375, 0.6244862700703613, 0.6084851632428728, 0.3552479648148419, 0.7543873745863986, 0.933084851181041, 0.6218231438221994, 0.6488049312266575, 0.3991025247660249, 0.36783096439271523, 0.9854893454371892, 0.5547113577094076, 0.41687740250456273, 0.7181645999275119, 0.45231548830212687, 0.3774402982771433, 0.7581476369638883)
val predNew = lm.predict(DenseMatrix((1.1, 1.6, 1.0), (1.4, 2.2, 3.0)))
// predNew: PredictLm = PredictLm(
//   Lm(
//     DenseVector(1.6360355503493809, -2.7270119181145533, 0.3969978046621706, 3.735802986427354, 3.0804549414232483, 0.030249332364789883, -0.6859485345638303, 3.2778157660925773, 3.833101028807265, -1.8706830202413478, 4.647965604411723, 5.711224345280582, 7.761045320079106, 3.9774592477647905, 5.064004989683394, 8.91986613024395, -7.0970357198386385, 5.269940744682552, 0.06521844936810561, -7.978902091380467, -3.3665858781702136, 8.076271116549503, 1.586072178701627, -0.6346698227961881, -2.7537088108818333, 0.20498796368659677, -0.4792432269113598, -2.6020490330722854, 9.94283632615279, -0.6578565681120501, -0.23803438905172114, 5.0344347262078495, 4.027177727694072, -0.7989162134193619, 5.325303544952184, 0.8393533273738415, 2.261971578039398, -2.825747962422933, 2.792759674408103, -1.21042663769757, 3.8126237547949424, 4.239727452170136, -1.3817602527630632, 3.732322027601111, 4.436042894986316, 1.9414116478545012, 4.298956320872205, 1.1045812944038387, 11.192327026567899, 4.592084606295168, 1.3408689120663517, -1.2676123828228079, 2.952321399900486, 1.3160931409698269, 5.086219225144936, 1.416639345474218, 4.5874750992650775, -1.8897847726727073, 9.569795464655254, -2.511913400740105, 5.189828506665871, 3.6487400603294113, 4.68944339200961, 0.5440277230619068, 3.6734791989764877, 8.611941713136606, 0.32981895104160497, 0.026783317544643692, -0.7883536128025428, -0.9164496183059234, 6.750516130451319, 1.9683664874912772, 7.741574281851221, 1.5240538812995734, 6.907563143182816, 0.410401700280683, 3.7851299287514832, 7.525445460503473, 2.286907085213886, 7.742478871842504, 5.610708480111997, -5.608506299316607, 2.418374712582719, 1.5206597926933352, 1.0099965355353362, 4.005276338584543, 2.6320386520658134, 2.831515744575123, 10.571078955222756, 0.5252439841949323, 2.713906136103369, 4.332272611692304, 2.0358743718944305, 13.041034393272888, 5.529003728980029, 0.8087600328554936, 2.8973501084567386, -2.5934651250232297, -1.0284723066048636, 5.399122138922047),
//     0.3139181465099106    4.95997706457627      0.6786185212709943    
// -1.1697748793054439   1.3439000883503212    5.000901171444813     
// -0.700086109690434    -1.6072701748836904   6.466162896287016     
// 0.6545072894656916    -0.1363931491218513   2.1628272626210374    
// 0.9353296119411244    1.8847942683657735    -1.189928565619799    
// -1.1256455409726676   1.1488682232831833    8.303781190859269     
// 1.3846318613510453    0.7040721191928964    2.048097813608186     
// 0.44723406480481004   -1.073279737273324    5.204576777755621     
// 0.8360130365683602    3.887159846515192     2.930039621549076     
// 0.8517617360088315    1.2834367541261658    0.1800456251995357    
// 0.6688486972381643    2.1642353609706007    -1.329813570308346    
// 0.56178444211675      1.0726038903380242    -0.3024203518112105   
// 0.5148679802524382    3.1403173378174634    3.079925866849348     
// -0.4314633979190181   0.06475780131554187   -0.8027510064219703   
// 0.668704428094275     3.203882570882036     3.36479733464971      
// 1.5080389262503042    0.755060577125799     1.6987788350668014    
// -0.40789345962080054  -3.5102908470406      7.502467172550671     
// 1.1846078605515553    -1.067756766848463    4.399832588838949     
// -0.1384940328595442   0.6863992360139621    -0.3923217261630225   
// 0.8052487324353418    0.7998336952561136    5.763192924560582     
// -2.0799578179066938   3.716003313969549     3.5835240397663966    
// 0.9107122077906602    4.0879755227719965    8.978808235196533     
// ...
predNew.fitted
// res15: DenseVector[Double] = DenseVector(5.116178087809824, 5.837139459465769)
predNew.se
// res16: DenseVector[Double] = DenseVector(0.4566533982551131, 0.5571424857664351)
lm.plots
// res17: Figure = breeze.plot.Figure@4a0abf27
lm.summary
// Estimate	 S.E.	 t-stat	p-value		Variable
// ---------------------------------------------------------
//   2.0555	 0.415	 4.957	0.0000 *	(Intercept)
//   1.9446	 0.290	 6.697	0.0000 *	V1
//   0.6560	 0.150	 4.362	0.0000 *	V2
//  -0.1280	 0.107	-1.199	0.2334  	V3
// 
// Residual standard error:   2.9872 on 96 degrees of freedom
// Multiple R-squared: 0.4059, Adjusted R-squared: 0.3873
// F-statistic: 21.8610 on 3 and 96 DF, p-value: 0.00000
//
```
The plots include a plot of studentised residuals against fitted values and a normal Q-Q plot for the studentised residuals.

![Linear model plots](lm-plots.png)


## Generalised linear models

The current implementation supports only simple one-parameter exponential family observation models. This includes the most commonly used cases of **logistic regression** (`LogisticGlm`) and **Poisson regression** (`PoissonGlm`).

### Logistic regression

Again, we start by creating an appropriate response variable.
```scala
val ylb = (0 until 100) map (i => Bernoulli(sigmoid(1.0 + X(i,0))).sample())
val yl = DenseVector(ylb.toArray map {b => if (b) 1.0 else 0.0})
```

Then we can do logistic regression in a typical way.
```scala
import scalaglm.{Glm, LogisticGlm}
val glm = Glm(yl, X, List("V1","V2","V3"), LogisticGlm)
```
```scala
glm.coefficients
// res20: DenseVector[Double] = DenseVector(1.0742981188155936, 1.5760589769042237, -0.055712482317519504, -0.0218600549768532)
glm.fitted
// res21: DenseVector[Double] = DenseVector(0.7820894323161913, 0.2781758533893875, 0.4797898811600048, 0.8875702894044373, 0.9219713503031626, 0.2798283806585909, 0.9597885977979889, 0.8487958933468713, 0.8919956564245582, 0.9122390630680542, 0.8846211064399432, 0.8706318539967787, 0.8380076609497894, 0.6006626035896027, 0.8671699895138468, 0.9668132517457231, 0.6137248217272447, 0.9480741889975313, 0.6955844088442694, 0.897786926796468, 0.07661864433692728, 0.8894962430599058, 0.6374895844456657, 0.08711421378844868, 0.13122669562622932, 0.5450721535600842, 0.6004014382501387, 0.39037051531630296, 0.9716306924041371, 0.13186381599679411, 0.6621811804567656, 0.7479499244160102, 0.1707961568099399, 0.4698723952609389, 0.3623423444052793, 0.4626950900724394, 0.9741126812793542, 0.07998154673583086, 0.5090626425031999, 0.7362318302923947, 0.26595254074769636, 0.6013250316828035, 0.7716528464946627, 0.44224969720132745, 0.8918404089929032, 0.8831777176956808, 0.9275185597839987, 0.21585949186973977, 0.6047691165945764, 0.9206385007466311, 0.30976949065708415, 0.6729887639964475, 0.8017608492071664, 0.36303398011904625, 0.9089659594201339, 0.8284828761789204, 0.30605802663253656, 0.866053932174268, 0.7637164375251775, 0.1676477691737488, 0.9732078671622871, 0.9200960980514129, 0.9102104545644525, 0.7527597702442644, 0.7526211196243928, 0.9638157934541846, 0.12264759856515342, 0.37764771732600505, 0.7915248993881203, 0.12629554562362302, 0.4228764875832263, 0.8974056598764574, 0.9337614733897573, 0.9007320060154789, 0.8978353650160595, 0.5949636929213036, 0.7361822695897321, 0.8868739433503993, 0.8976816551840515, 0.9732558957001282, 0.8762570377861393, 0.2361947282871841, 0.24877989036331097, 0.2717179414216722, 0.9211954592335055, 0.16889081624306007, 0.7531342191293476, 0.4730923818896721, 0.9913688903898324, 0.7951661266232277, 0.7796703071233315, 0.5675309663852531, 0.6613925992154198, 0.9766163269160573, 0.4525834429486726, 0.6500333236572986, 0.733096622750991, 0.3256630994406128, 0.7236689855536829, 0.9862585256294567)
glm.predict(response=true).fitted
// res22: DenseVector[Double] = DenseVector(0.7820894323161913, 0.2781758533893875, 0.4797898811600048, 0.8875702894044373, 0.9219713503031626, 0.2798283806585909, 0.9597885977979889, 0.8487958933468713, 0.8919956564245582, 0.9122390630680542, 0.8846211064399432, 0.8706318539967787, 0.8380076609497894, 0.6006626035896027, 0.8671699895138468, 0.9668132517457231, 0.6137248217272447, 0.9480741889975313, 0.6955844088442694, 0.897786926796468, 0.07661864433692728, 0.8894962430599058, 0.6374895844456657, 0.08711421378844868, 0.13122669562622932, 0.5450721535600842, 0.6004014382501387, 0.39037051531630296, 0.9716306924041371, 0.13186381599679411, 0.6621811804567656, 0.7479499244160102, 0.1707961568099399, 0.4698723952609389, 0.3623423444052793, 0.4626950900724394, 0.9741126812793542, 0.07998154673583086, 0.5090626425031999, 0.7362318302923947, 0.26595254074769636, 0.6013250316828035, 0.7716528464946627, 0.44224969720132745, 0.8918404089929032, 0.8831777176956808, 0.9275185597839987, 0.21585949186973977, 0.6047691165945764, 0.9206385007466311, 0.30976949065708415, 0.6729887639964475, 0.8017608492071664, 0.36303398011904625, 0.9089659594201339, 0.8284828761789204, 0.30605802663253656, 0.866053932174268, 0.7637164375251775, 0.1676477691737488, 0.9732078671622871, 0.9200960980514129, 0.9102104545644525, 0.7527597702442644, 0.7526211196243928, 0.9638157934541846, 0.12264759856515342, 0.37764771732600505, 0.7915248993881203, 0.12629554562362302, 0.4228764875832263, 0.8974056598764574, 0.9337614733897573, 0.9007320060154789, 0.8978353650160595, 0.5949636929213036, 0.7361822695897321, 0.8868739433503993, 0.8976816551840515, 0.9732558957001282, 0.8762570377861393, 0.2361947282871841, 0.24877989036331097, 0.2717179414216722, 0.9211954592335055, 0.16889081624306007, 0.7531342191293476, 0.4730923818896721, 0.9913688903898324, 0.7951661266232277, 0.7796703071233315, 0.5675309663852531, 0.6613925992154198, 0.9766163269160573, 0.4525834429486726, 0.6500333236572986, 0.733096622750991, 0.3256630994406128, 0.7236689855536829, 0.9862585256294567)
glm.summary
// Estimate	 S.E.	 z-stat	p-value		Variable
// ---------------------------------------------------------
//   1.0743	 0.373	 2.877	0.0040 *	(Intercept)
//   1.5761	 0.330	 4.782	0.0000 *	V1
//  -0.0557	 0.129	-0.432	0.6655  	V2
//  -0.0219	 0.091	-0.241	0.8095  	V3
glm.plots
// res24: Figure = breeze.plot.Figure@10af5cee
```

![Logistic regression plots](glm-plots.png)


### Poisson regression

We first create an appropriate response, and then do Poisson regression.
```scala
val yp = DenseVector.tabulate(100)(i => Poisson(math.exp(-0.5 + X(i,0))).sample().toDouble)

import scalaglm.PoissonGlm
val pglm = Glm(yp, X, List("V1","V2","V3"), PoissonGlm)
```
```scala
pglm.coefficients
// res26: DenseVector[Double] = DenseVector(-0.5729563624470397, 0.9996536869809475, 0.03059148545013453, 0.01784833647604794)
pglm.summary
// Estimate	 S.E.	 z-stat	p-value		Variable
// ---------------------------------------------------------
//  -0.5730	 0.191	-3.000	0.0027 *	(Intercept)
//   0.9997	 0.125	 7.971	0.0000 *	V1
//   0.0306	 0.054	 0.569	0.5691  	V2
//   0.0178	 0.038	 0.473	0.6360  	V3
pglm.plots
// res28: Figure = breeze.plot.Figure@41937f18
```
![Poisson regression plots](pglm-plots.png)


## Non-linear response

The above covers the main functionality of the library based on a linear reponse to variation in covariate values. For flexible modelling of a nonlinear response, see the documentation on [flexible regression modelling](FlexibleRegression.md).


# scala-glm - Quickstart Guide

## PCA

This library contains code for principal components analysis based on a thin SVD of the centred data matrix. This is more numerically stable than a construction from the spectral decomposition of the covariance matrix. It is analogous to the R function `prcomp` rather than the R function `princomp`. First create some synthetic data.

```scala
import breeze.linalg.*
import breeze.numerics.*
import breeze.stats.distributions.*
import breeze.stats.distributions.Rand.VariableSeed.randBasis

val X = DenseMatrix.tabulate(100, 3)((i, j) => 
	Gaussian(j, j+1).sample())
```
Now we can do PCA.
```scala
import scalaglm.Pca
val pca = Pca(X, List("V1", "V2", "V3"))
```
```scala
pca.sdev
// res0: DenseVector[Double] = DenseVector(3.0694167003692714, 1.9127247063542974, 0.9672207100182212)
pca.loadings
// res1: DenseMatrix[Double] = -0.056677283195764705  0.0359769952312239    -0.9977441262085582   
// 0.09778548430029865    0.9947457225334391    0.030314131384242965  
// 0.9935923130890769     -0.09584676997978347  -0.05989751292615812  
pca.scores
// res2: DenseMatrix[Double] = -4.173150408905887    1.6902368867863102    -0.734518202090157     
// 1.2037140031590792    0.516749247269921     0.17969238215495686    
// 4.736511070494115     1.2528592112170882    0.3435953860897644     
// -0.6261921698756876   -3.1713024085172394   1.3334905319538757     
// 1.2622313779574996    -1.7976475600772757   -1.8537285598994107    
// -0.9272143818917808   3.2985393175988555    0.09838849591290219    
// -2.8569497861707296   -1.1914134293828893   -0.5900128025381225    
// 0.22422916959227773   1.0586033232457976    -1.7649094793758737    
// -3.980546438884392    1.6483601761297881    0.9958901324155903     
// -2.063823371382       -2.455193593468265    0.3978387004449925     
// 0.06228187294753734   -2.8702580981193178   0.3813061417999639     
// -2.5309936052488924   -1.234806892823037    -0.44045749428187286   
// 3.3056087485782597    0.344862808859809     -1.9929609507754809    
// -1.4327751964608368   1.2367791991831043    0.547001037825846      
// -2.9600059708937847   -0.940310591728545    -1.0733923889672528    
// 0.475661605348799     3.8286722360429604    -1.872835478223483     
// -3.0433276247472483   -3.1989679799738613   0.18082712339705495    
// -1.5197023069019764   0.29284517780747193   -2.991885364920405     
// -5.280569899715779    -0.6308823718863248   -0.2805880791783331    
// 2.3986479764201394    -1.1588817485720122   0.6465669791824056     
// 2.650699398377486     0.3153627788907727    0.8731249820243746     
// 2.9891807404091946    -0.28527164683829315  -1.3589033844158653    
// 1.5394016147207115    -0.7321223377319663   -0.1738429923740536    
// -1.326395373036875    -2.266156928527978    -1.010892957161494     
// 3.8774579724318343    2.0281882496625157    0.670911949894015      
// -2.940694201746539    -0.14122074271439133  -1.0609435774821216    
// -1.623797219461707    3.8116417931860926    -0.15444948586913454   
// 2.688701149746691     -2.256912683187151    -0.17987182691032305   
// 1.4894748514931013    -1.1640838936637814   -1.7771604291197776    
// -0.36063244437705566  -0.6760776684342841   -1.123931691668751     
// 1.916462285326915     2.836214484532338     0.11975868663861121    
// 4.565650304264974     -2.6490555792573702   0.026360258204307763   
// -0.4676661279005495   0.9361232731764328    -0.5542539995249416    
// -1.0435582214339836   -5.095185796876254    -0.7771141281831837    
// 1.64429327087321      -0.621075428727776    -0.4038762125958829    
// -1.8424795262559026   -0.9141495229633115   -1.332362022241708     
// 2.0138029005289537    -0.9325103112799249   -0.20930642088044144   
// -0.7382793321551667   2.2073237269131005    -0.6480914980636838    
// 3.9426386286603443    -0.1288598380495176   0.2634998214557449     
// -1.073829327916552    1.7358073928056506    -0.34092950049816684   
// -4.021592435688612    -0.7520843629184759   0.2994106018163142     
// -2.322404876933096    -0.2621178314256416   1.7677477193919504     
// -2.8051304065144755   2.7573657337052024    -1.4118487558285493    
// 1.2664537919597147    -3.243793740569084    0.2527046491771142     
// -6.404981477670386    1.1217006603625228    -0.6007849413554274    
// -3.270478499437333    3.2300385629627906    1.5773322987674934     
// -3.2978202744853604   -0.6044811018547758   0.9761088972371669     
// -2.0645505275224716   -0.36623100071896386  2.2638690408985678     
// -4.579619964182151    0.7485514550323618    -0.3371504287667747    
// ...
pca.plots
// res3: Figure = breeze.plot.Figure@4db40f4f
pca.summary
// Standard deviations:
// V1	V2	V3
//  3.069	 1.913	 0.967
// Cumulative proportion of variance explained:
// V1	V2	V3
//  0.672	 0.933	 1.000
// Loadings:
// PC01	PC02	PC03	
// -0.057	 0.036	-0.998	V1
//  0.098	 0.995	 0.030	V2
//  0.994	-0.096	-0.060	V3
```
The final line prints a readable summary of the PCA to the console. `plots` produces some diagnostic plots, including a "scree plot".

![PCA Plots](pca-plots.png)

Note that there is also a utility function `pairs` for producing a "scatterplot matrix":
```scala
import scalaglm.Utils.pairs
pairs(X, List("V1", "V2", "V3"))
// res6: Figure = breeze.plot.Figure@5db18b93
```

![Pairs plots](pairs-plots.png)


## Linear regression

This code computes regression coefficients and associated diagnostics via the QR decomposition of the covariate matrix. The diagnostics are analogous to those produced by the R function `lm`. We start by creating a synthetic response variable.

```scala
val y = DenseVector.tabulate(100)(i => 
	Gaussian(2.0 + 1.5*X(i,0) + 0.5*X(i,1), 3.0).sample())
```
So we can now do linear regression and generate all of the usual diagnostics.
```scala
import scalaglm.Lm
val lm = Lm(y,X,List("V1", "V2", "V3"))
```
```scala
lm.coefficients
// res8: DenseVector[Double] = DenseVector(2.2663523848196685, 2.4620737507049166, 0.4999052696154669, -0.036420008625967275)
lm.se
// res9: DenseVector[Double] = DenseVector(0.39588194698860457, 0.3115023499237861, 0.157573506488148, 0.10063436834617098)
lm.fitted
// res10: DenseVector[Double] = DenseVector(6.264471140146877, 2.6609133607496545, 2.2468242155128597, -2.094838411428398, 6.249394661402184, 4.768970672184134, 4.046746956499451, 7.847739843977631, 1.9945757548214127, 0.7917843223447171, 0.31780341984189053, 3.615033720418117, 7.592495050982495, 2.5237580002295523, 5.386857840011953, 9.71163067457044, 1.0070209839802244, 10.61047433432951, 3.9297791338973536, 0.3830180210395812, 0.6672716109027634, 5.714681795780133, 2.744651070240828, 4.245807859746562, 2.0143451913697135, 5.824984774750768, 5.776443936912009, 1.7149403217659571, 6.407194884145732, 5.33613523130985, 4.083663592348779, 0.7427089190847194, 4.910309831333817, 1.972420534445933, 3.3578844446061975, 5.892195705480772, 2.6528784770254163, 5.92270183767453, 1.728579713588564, 4.938153749089601, 2.283928298486718, -1.224392080820818, 8.371985580597983, 0.2585984940077435, 5.8863064356055625, 1.4184195135030713, 0.6285180736892185, -2.5285900774277534, 4.791797562310969, 2.3419256561808726, 1.2862434742262518, 2.196430353609416, 5.035977678715152, 4.619734616600215, 3.8538139931719506, 1.8160791419318663, -0.1092934801466414, -0.4408411651235352, 3.130262701879471, 2.0421833073527424, 3.63096352677099, 3.740766497557222, 0.4045607786587348, 1.4180474858564491, 6.92294463898706, 4.533205645683778, 2.9727271024915156, 3.557804267081404, 3.332057346622039, 7.012730699864, 2.175277922347419, 0.12853457248208405, 0.5322545240054392, -0.45442911378134127, 4.527589168549637, 1.656900545055628, 1.5258181420784944, 5.908073307631688, -0.9182969987983546, 4.117880004075983, 3.1703162023598397, 2.7908646696340553, -0.7635255952167322, 1.0766240426041158, 3.0055226993205038, 6.131656162340004, 3.1873347955663482, 0.8036198495204828, -1.0749369578180266, -0.9408128629216226, 2.8231885339612264, 6.656643115886803, -0.40610558889386605, -1.576653178548083, 2.1956869682931615, 1.2064017097626247, 3.8729071651541833, 2.8891824840664757, -1.3559856593298063, 2.157026620912685)
lm.residuals
// res11: DenseVector[Double] = DenseVector(1.1825269030540673, -2.8770034624484264, 1.07592462494245, -1.8215824066544286, 3.2449899738050645, 3.2254043506501624, -2.926295186421796, -5.533556007005668, 3.7041309196503294, 0.9934650669027308, -0.14715764172869183, -1.0409414983498575, 0.5715542246237719, -3.1232238578547253, -6.168173499787926, 4.730759182342881, 2.749561139923383, 0.8007298358851536, 4.329045736562984, 1.8543293242239762, 1.1052788506664628, -3.8788545735593583, 0.5116320829086001, -4.359947122408029, 1.871685828330088, 0.6644650501846341, -0.06517090423116034, 3.2664512126376737, 4.84513382326418, -4.613672996390328, 1.7425991217629253, -0.6805281697909991, -2.708469157681298, 0.99396721762289, 2.702946027942927, 1.1300658727142245, 3.912002325787904, -6.41931492940629, -1.1904805743138818, -3.6145480750274612, -3.2978636404642074, 2.015969945401808, -1.567928328853558, 0.5633903730684984, -4.535098293745049, -1.6617531055297348, -1.9692072786902544, 1.1000595078918276, 3.0500146592279185, 1.4080985440138498, -5.443929704103393, -1.196955969857035, -1.17264604848866, 0.059172367413452776, -6.133134495014403E-4, 0.6966976540499996, -0.507177810245545, 2.0388133613854236, -1.0473097721570142, -2.4133263106315805, -5.054964322951257, 4.119736884116484, 4.454478135878849, 1.1448704197754431, -3.870768516528397, -2.4091738169648282, 1.9447694935694306, -3.28450473864617, 1.706979041291063, -0.08304815681900735, 2.71516197013397, 4.777046595678383, 1.9688360482320029, -2.3247161985172715, -0.579924697589361, 2.756160195070595, 1.6439836879002088, 0.5300912102359971, 0.26215728323349763, -2.446201050221503, 5.773547295543124, 5.352475203282779, -5.334564634917515, 2.154479467296886, 2.6489445167734704, 2.6066008320445597, -0.19695491957842393, -0.9903337571477183, -6.355250022494109, -3.3711942661852436, 0.9554023651796886, 1.623973067123833, 0.6496651306800003, -2.3322442902685054, -2.0455746452043355, 1.1315862055006414, 4.375181893403825, 3.0892575083905687, -4.761863612084608, 0.8977617262165802)
lm.studentised
// res12: DenseVector[Double] = DenseVector(0.4023202403802911, -0.9639596910083116, 0.3655325663464132, -0.6246526877131556, 1.112968247480423, 1.096595141588076, -0.9873944172510417, -1.8869666468898234, 1.2620778285684024, 0.3363391936624275, -0.04985658907138923, -0.3506499564098751, 0.19678482804728523, -1.0501951312967255, -2.089711296158, 1.6497929772542541, 0.9384774455186287, 0.28248286114104404, 1.472416587279953, 0.6250362724812567, 0.37287001705779266, -1.3178504731366627, 0.17157425523328207, -1.479267655435513, 0.636770509048331, 0.22478858303327845, -0.022298745066140057, 1.105430748684775, 1.6552015096868515, -1.5556431347998112, 0.5909944931862541, -0.23266810254572654, -0.9090260228978718, 0.3467818180776805, 0.9070589934166448, 0.3830206311201203, 1.3137954558934872, -2.16840144079552, -0.40190672729446536, -1.2161214470563222, -1.1147411667031952, 0.6885144724050807, -0.5386893285170989, 0.19158469214486235, -1.558447914224393, -0.5759093956843562, -0.6666913831498748, 0.37983576026052357, 1.0338398341810695, 0.4756648949671866, -1.826781266915071, -0.4008389407754153, -0.3969739917258216, 0.019871595292149005, -2.0563445324307494E-4, 0.23383237608781435, -0.17201347111393858, 0.7007770940956696, -0.36455736528496696, -0.8103259857308982, -1.7627415627737442, 1.3881183042186112, 1.5122263506936848, 0.38410395814056353, -1.3188216737794944, -0.8090467961325736, 0.6567578078125046, -1.1491608601527108, 0.5735024137930264, -0.028929549723595117, 0.9329597996293367, 1.6175032652386767, 0.6624914457571697, -0.7971939424126537, -0.19542669124284973, 0.9288687204401714, 0.5513528144117728, 0.17917916372516568, 0.08945173806507489, -0.8313940582091244, 1.9698469223402688, 1.8189043267714455, -1.8115094867119494, 0.7347958007556196, 0.8975164875183215, 0.9050605699059717, -0.06596616969445714, -0.33409739721219306, -2.1526471736308355, -1.1437714273109452, 0.3201638948073027, 0.5491190118041853, 0.2215241757193423, -0.7981232035580389, -0.7013209328661313, 0.386762453822664, 1.5010436403416727, 1.03770995260386, -1.650182501444807, 0.30083886894784745)
val pred = lm.predict()
// pred: PredictLm = PredictLm(
//   mod = Lm(
//     y = DenseVector(7.446998043200944, -0.21609010169877196, 3.3227488404553096, -3.916420818082827, 9.494384635207249, 7.994375022834296, 1.1204517700776548, 2.314183836971963, 5.698706674471742, 1.785249389247448, 0.1706457781131987, 2.5740922220682596, 8.164049275606267, -0.599465857625173, -0.7813156597759727, 14.442389856913321, 3.7565821239036072, 11.411204170214663, 8.258824870460337, 2.2373473452635575, 1.7725504615692262, 1.8358272222207748, 3.256283153149428, -0.11413926266146657, 3.8860310196998014, 6.489449824935402, 5.7112730326808485, 4.981391534403631, 11.252328707409912, 0.7224622349195222, 5.826262714111705, 0.062180749293720305, 2.201840673652519, 2.966387752068823, 6.060830472549124, 7.022261578194996, 6.56488080281332, -0.49661309173175994, 0.5380991392746823, 1.3236056740621396, -1.0139353419774892, 0.7915778645809902, 6.804057251744425, 0.8219888670762419, 1.3512081418605133, -0.2433335920266635, -1.340689205001036, -1.4285305695359258, 7.841812221538888, 3.7500242001947224, -4.157686229877141, 0.999474383752381, 3.8633316302264915, 4.6789069840136674, 3.853200679722449, 2.512776795981866, -0.6164712903921864, 1.5979721962618882, 2.082952929722457, -0.3711430032788381, -1.4240007961802674, 7.8605033816737055, 4.859038914537584, 2.5629179056318923, 3.052176122458663, 2.12403182871895, 4.917496596060946, 0.273299528435234, 5.039036387913102, 6.929682543044993, 4.890439892481389, 4.9055811681604675, 2.501090572237442, -2.779145312298613, 3.947664470960276, 4.413060740126223, 3.169801829978703, 6.438164517867685, -0.656139715564857, 1.6716789538544798, 8.943863497902964, 8.143339872916835, -6.098090230134248, 3.2311035099010015, 5.654467216093974, 8.738256994384564, 2.9903798759879243, -0.1867139076272355, -7.430186980312135, -4.312007129106866, 3.778590899140915, 8.280616183010636, 0.2435595417861343, -3.9088974688165887, 0.15011232308882616, 2.337987915263266, 8.248089058558008, 5.978439992457044, -6.117849271414414, 3.054788347129265),
//     Xmat = 1.068194138281017      2.553803803697165     -2.511971611977817    
// -0.19091872846585656   1.939974784156857     2.888155595943952     
// -0.5281983031056803    3.022641871467129     6.317944461060589     
// -1.3710849617000231    -1.8726606975702023   1.354353087876391     
// 1.7513334238539493     -0.4181807799590791   3.2899223253225904    
// 0.11105742611399387    4.49631003677152      0.509125840388361     
// 0.7457429295524769     -0.1796196511510173   -0.9366634297666336   
// 1.8243051774961836     2.3242534933355543    1.9794888466792493    
// -0.6707334813875526    2.5834368229851274    -2.420235196023804    
// -0.3302993684728597    -1.329257452766527    -0.0866597222016039   
// -0.44923874793493096   -1.5347400325083385   2.0665949566318056    
// 0.5764895219937242     -0.1863776910182069   -0.6175947416993042   
// 1.8515197314441298     1.9086641818290908    5.123193348932974     
// -0.38206522301129586   2.409545768527692     0.17754677352871373   
// 1.242906942800725      0.04543319129689194   -1.034173423619297    
// 2.0173959576114697     5.101082455053802     1.9702725231062157    
// -0.0850204697510041    -2.1714836575209584   -0.9756007927017594   
// 3.119804781318352      1.3547929614504197    0.3936201858709336    
// 0.5945466560333902     0.150351295795351     -3.4170126071345877   
// -0.7847498948754349    0.4041481136551134    4.208071997844242     
// -0.9720435129445364    1.9021614307460326    4.303636516182801     
// 1.2141564544531196     1.270119465749274     4.831210793324781     
// ...
pred.fitted
// res13: DenseVector[Double] = DenseVector(6.264471140146871, 2.66091336074965, 2.2468242155128593, -2.0948384114283987, 6.249394661402184, 4.768970672184134, 4.046746956499451, 7.847739843977633, 1.9945757548214125, 0.7917843223447163, 0.3178034198418902, 3.615033720418117, 7.592495050982497, 2.523758000229552, 5.386857840011955, 9.711630674570442, 1.0070209839802235, 10.61047433432951, 3.929779133897354, 0.3830180210395807, 0.6672716109027629, 5.714681795780133, 2.7446510702408276, 4.245807859746561, 2.0143451913697135, 5.824984774750768, 5.776443936912009, 1.7149403217659573, 6.407194884145732, 5.336135231309851, 4.083663592348779, 0.742708919084719, 4.910309831333817, 1.9724205344459331, 3.3578844446061975, 5.892195705480771, 2.652878477025416, 5.92270183767453, 1.7285797135885637, 4.9381537490896, 2.283928298486718, -1.224392080820818, 8.371985580597983, 0.25859849400774304, 5.886306435605563, 1.4184195135030704, 0.6285180736892185, -2.5285900774277548, 4.79179756231097, 2.3419256561808717, 1.2862434742262512, 2.196430353609416, 5.035977678715152, 4.619734616600214, 3.8538139931719506, 1.816079141931866, -0.10929348014664203, -0.44084116512353494, 3.1302627018794706, 2.042183307352742, 3.630963526770989, 3.740766497557222, 0.4045607786587342, 1.4180474858564487, 6.922944638987061, 4.533205645683778, 2.972727102491515, 3.5578042670814036, 3.3320573466220385, 7.012730699864001, 2.1752779223474183, 0.12853457248208355, 0.5322545240054386, -0.45442911378134276, 4.5275891685496354, 1.6569005450556276, 1.525818142078494, 5.908073307631688, -0.9182969987983542, 4.117880004075983, 3.1703162023598392, 2.7908646696340553, -0.7635255952167334, 1.0766240426041152, 3.0055226993205033, 6.131656162340005, 3.1873347955663482, 0.8036198495204823, -1.0749369578180274, -0.9408128629216231, 2.8231885339612264, 6.656643115886804, -0.4061055888938666, -1.5766531785480835, 2.1956869682931615, 1.2064017097626243, 3.8729071651541833, 2.8891824840664744, -1.3559856593298074, 2.1570266209126845)
pred.se
// res14: DenseVector[Double] = DenseVector(0.618369460427354, 0.33768054027363176, 0.5981749546137437, 0.7195353132323972, 0.7216985402701643, 0.6086777641076874, 0.48829495552082525, 0.6496441995922887, 0.6385644875465252, 0.5449594692440453, 0.556437369581218, 0.45722550711881565, 0.765356856673224, 0.4210931162602593, 0.5560754920937521, 0.893977896336647, 0.6617292870874875, 0.9932974591988447, 0.6144205921259469, 0.4690862806168188, 0.48468032071235395, 0.5987886388244206, 0.3597682341090817, 0.578527120751202, 0.6180199057602465, 0.5329190008419312, 0.6927695945268008, 0.5386718309595593, 0.6731098565918062, 0.4752995340693732, 0.5722813291842299, 0.6831581765208294, 0.37958415987852734, 0.8978993413126712, 0.3766503475380021, 0.562838960880485, 0.39417000999944574, 0.5077046163983187, 0.4977423519957302, 0.4332924312910811, 0.5191089356619409, 0.6696979043858923, 0.7415363233015556, 0.6115905323395368, 0.7439893282298976, 0.8342065829388727, 0.5452738816049085, 0.7962529115839527, 0.5640102493352851, 0.5083816921301993, 0.37533868357097605, 0.3236068196260207, 0.5438609165209941, 0.3933994437291022, 0.35512986314644873, 0.3800078954526184, 0.5728502401309423, 0.7465224327333759, 0.8766687295020626, 0.389745363610254, 0.893383402353004, 0.46205990023983773, 0.5872530728770887, 0.37086595004918516, 0.638224787243786, 0.392969447096091, 0.503156150598178, 0.9233102727014387, 0.40330093826244057, 0.8835935737100072, 0.7429821893701364, 0.5471962829440132, 0.4355294535142811, 0.7196511872812609, 0.4644794057300555, 0.46611809949899674, 0.36190949844467785, 0.5189364282213487, 0.6577254220586244, 0.6038335065972682, 0.6566086664964453, 0.6018633118766478, 0.5913765121831146, 0.6516036548026912, 0.5575116624514779, 0.8527060868421407, 0.3275604910524275, 0.4849268202266481, 0.5528366784313259, 0.5781786430183495, 0.3417584415310883, 0.5247564127717874, 0.6487796849638006, 0.6947317780359913, 0.7171272994255355, 0.6792798793829627, 0.7251551785427107, 0.39896796037427973, 0.833456102198967, 0.34096664930909565)
val predNew = lm.predict(DenseMatrix((1.1, 1.6, 1.0), (1.4, 2.2, 3.0)))
// predNew: PredictLm = PredictLm(
//   mod = Lm(
//     y = DenseVector(7.446998043200944, -0.21609010169877196, 3.3227488404553096, -3.916420818082827, 9.494384635207249, 7.994375022834296, 1.1204517700776548, 2.314183836971963, 5.698706674471742, 1.785249389247448, 0.1706457781131987, 2.5740922220682596, 8.164049275606267, -0.599465857625173, -0.7813156597759727, 14.442389856913321, 3.7565821239036072, 11.411204170214663, 8.258824870460337, 2.2373473452635575, 1.7725504615692262, 1.8358272222207748, 3.256283153149428, -0.11413926266146657, 3.8860310196998014, 6.489449824935402, 5.7112730326808485, 4.981391534403631, 11.252328707409912, 0.7224622349195222, 5.826262714111705, 0.062180749293720305, 2.201840673652519, 2.966387752068823, 6.060830472549124, 7.022261578194996, 6.56488080281332, -0.49661309173175994, 0.5380991392746823, 1.3236056740621396, -1.0139353419774892, 0.7915778645809902, 6.804057251744425, 0.8219888670762419, 1.3512081418605133, -0.2433335920266635, -1.340689205001036, -1.4285305695359258, 7.841812221538888, 3.7500242001947224, -4.157686229877141, 0.999474383752381, 3.8633316302264915, 4.6789069840136674, 3.853200679722449, 2.512776795981866, -0.6164712903921864, 1.5979721962618882, 2.082952929722457, -0.3711430032788381, -1.4240007961802674, 7.8605033816737055, 4.859038914537584, 2.5629179056318923, 3.052176122458663, 2.12403182871895, 4.917496596060946, 0.273299528435234, 5.039036387913102, 6.929682543044993, 4.890439892481389, 4.9055811681604675, 2.501090572237442, -2.779145312298613, 3.947664470960276, 4.413060740126223, 3.169801829978703, 6.438164517867685, -0.656139715564857, 1.6716789538544798, 8.943863497902964, 8.143339872916835, -6.098090230134248, 3.2311035099010015, 5.654467216093974, 8.738256994384564, 2.9903798759879243, -0.1867139076272355, -7.430186980312135, -4.312007129106866, 3.778590899140915, 8.280616183010636, 0.2435595417861343, -3.9088974688165887, 0.15011232308882616, 2.337987915263266, 8.248089058558008, 5.978439992457044, -6.117849271414414, 3.054788347129265),
//     Xmat = 1.068194138281017      2.553803803697165     -2.511971611977817    
// -0.19091872846585656   1.939974784156857     2.888155595943952     
// -0.5281983031056803    3.022641871467129     6.317944461060589     
// -1.3710849617000231    -1.8726606975702023   1.354353087876391     
// 1.7513334238539493     -0.4181807799590791   3.2899223253225904    
// 0.11105742611399387    4.49631003677152      0.509125840388361     
// 0.7457429295524769     -0.1796196511510173   -0.9366634297666336   
// 1.8243051774961836     2.3242534933355543    1.9794888466792493    
// -0.6707334813875526    2.5834368229851274    -2.420235196023804    
// -0.3302993684728597    -1.329257452766527    -0.0866597222016039   
// -0.44923874793493096   -1.5347400325083385   2.0665949566318056    
// 0.5764895219937242     -0.1863776910182069   -0.6175947416993042   
// 1.8515197314441298     1.9086641818290908    5.123193348932974     
// -0.38206522301129586   2.409545768527692     0.17754677352871373   
// 1.242906942800725      0.04543319129689194   -1.034173423619297    
// 2.0173959576114697     5.101082455053802     1.9702725231062157    
// -0.0850204697510041    -2.1714836575209584   -0.9756007927017594   
// 3.119804781318352      1.3547929614504197    0.3936201858709336    
// 0.5945466560333902     0.150351295795351     -3.4170126071345877   
// -0.7847498948754349    0.4041481136551134    4.208071997844242     
// -0.9720435129445364    1.9021614307460326    4.303636516182801     
// 1.2141564544531196     1.270119465749274     4.831210793324781     
// ...
predNew.fitted
// res15: DenseVector[Double] = DenseVector(5.738061933353857, 6.703787203082677)
predNew.se
// res16: DenseVector[Double] = DenseVector(0.4457316662239433, 0.5611118432883447)
lm.plots
// res17: Figure = breeze.plot.Figure@5747c447
lm.summary
// Estimate	 S.E.	 t-stat	p-value		Variable
// ---------------------------------------------------------
//   2.2664	 0.396	 5.725	0.0000 *	(Intercept)
//   2.4621	 0.312	 7.904	0.0000 *	V1
//   0.4999	 0.158	 3.173	0.0020 *	V2
//  -0.0364	 0.101	-0.362	0.7182  	V3
// 
// Residual standard error:   3.0036 on 96 degrees of freedom
// Multiple R-squared: 0.4441, Adjusted R-squared: 0.4267
// F-statistic: 25.5621 on 3 and 96 DF, p-value: 0.00000
//
```
The plots include a plot of studentised residuals against fitted values and a normal Q-Q plot for the studentised residuals.

![Linear model plots](lm-plots.png)


## Generalised linear models

The current implementation supports only simple one-parameter exponential family observation models. This includes the most commonly used cases of **logistic regression** (`LogisticGlm`) and **Poisson regression** (`PoissonGlm`).

### Logistic regression

Again, we start by creating an appropriate response variable.
```scala
val ylb = (0 until 100) map (i => Bernoulli(sigmoid(1.0 + X(i,0))).sample())
val yl = DenseVector(ylb.toArray map {b => if (b) 1.0 else 0.0})
```

Then we can do logistic regression in a typical way.
```scala
import scalaglm.{Glm, LogisticGlm}
val glm = Glm(yl, X, List("V1","V2","V3"), LogisticGlm)
```
```scala
glm.coefficients
// res20: DenseVector[Double] = DenseVector(0.7945633761246808, 1.0259956423155674, 0.12536021414207668, -0.11083807934377674)
glm.fitted
// res21: DenseVector[Double] = DenseVector(0.9233736815740268, 0.6275591340379363, 0.4828278618816623, 0.2695248023597498, 0.8979225458658715, 0.8046690334533175, 0.8376700356122403, 0.9392468108727559, 0.667856929330233, 0.5741116976214812, 0.47806249883056434, 0.8070769763310754, 0.9141693909549771, 0.6648422220200069, 0.8993571205646099, 0.9639278171826413, 0.6325678487426859, 0.9840415321722091, 0.8584103106546614, 0.3950013317836345, 0.3914311360787788, 0.8407772947177594, 0.6485109435992088, 0.8380158507799903, 0.46684960715230484, 0.909874878334265, 0.866339981446571, 0.544052839723622, 0.8975632999592313, 0.8677565399233496, 0.704908435587869, 0.40307304017057843, 0.8317982346277384, 0.7058414163113207, 0.7002189785421363, 0.9074298921853695, 0.6317898361410152, 0.875955500842717, 0.47460117594293255, 0.8340470294338234, 0.7305015118565739, 0.33819926034821185, 0.9587410873075389, 0.4477628792469069, 0.9311106572707036, 0.5673397597922317, 0.555769273599515, 0.2257996028821422, 0.879498302809426, 0.7333126044012195, 0.5166138597664365, 0.639295589663866, 0.8880464239353258, 0.8323831629195069, 0.788811243132783, 0.6258885066366247, 0.36704487103954786, 0.3084032392189088, 0.7726795580461402, 0.6329051262082332, 0.53100714979499, 0.6806700002667869, 0.33459801260928784, 0.5800551448113616, 0.9075449947759756, 0.7862509916668595, 0.6282005010620281, 0.5167921035392924, 0.7021166228504521, 0.8655911591137291, 0.45124884126949644, 0.48603576894093115, 0.41908525564111265, 0.47657794362331135, 0.7888697468901474, 0.5857678693199749, 0.5208457532396713, 0.8786419828104004, 0.2713920746928376, 0.6868362606435714, 0.795999275949278, 0.6095590452445109, 0.40158223790339087, 0.4984095314981179, 0.5845298294378994, 0.9201013315379466, 0.7400341417473423, 0.420590192291239, 0.3073892338208054, 0.32542408284545804, 0.6471905920559721, 0.910274070831586, 0.32109185066205387, 0.246438243125689, 0.7743213098497732, 0.4002609460186868, 0.8720233957128842, 0.6675910513481087, 0.17145855358100054, 0.5844408935472742)
glm.predict(response=true).fitted
// res22: DenseVector[Double] = DenseVector(0.9233736815740268, 0.6275591340379363, 0.4828278618816623, 0.2695248023597498, 0.8979225458658715, 0.8046690334533175, 0.8376700356122403, 0.9392468108727559, 0.667856929330233, 0.5741116976214812, 0.47806249883056434, 0.8070769763310754, 0.9141693909549771, 0.6648422220200069, 0.8993571205646099, 0.9639278171826413, 0.6325678487426859, 0.9840415321722091, 0.8584103106546614, 0.3950013317836345, 0.3914311360787788, 0.8407772947177594, 0.6485109435992088, 0.8380158507799903, 0.46684960715230484, 0.909874878334265, 0.866339981446571, 0.544052839723622, 0.8975632999592313, 0.8677565399233496, 0.704908435587869, 0.40307304017057843, 0.8317982346277384, 0.7058414163113207, 0.7002189785421363, 0.9074298921853695, 0.6317898361410152, 0.875955500842717, 0.47460117594293255, 0.8340470294338234, 0.7305015118565739, 0.33819926034821185, 0.9587410873075389, 0.4477628792469069, 0.9311106572707036, 0.5673397597922317, 0.555769273599515, 0.2257996028821422, 0.879498302809426, 0.7333126044012195, 0.5166138597664365, 0.639295589663866, 0.8880464239353258, 0.8323831629195069, 0.788811243132783, 0.6258885066366247, 0.36704487103954786, 0.3084032392189088, 0.7726795580461402, 0.6329051262082332, 0.53100714979499, 0.6806700002667869, 0.33459801260928784, 0.5800551448113616, 0.9075449947759756, 0.7862509916668595, 0.6282005010620281, 0.5167921035392924, 0.7021166228504521, 0.8655911591137291, 0.45124884126949644, 0.48603576894093115, 0.41908525564111265, 0.47657794362331135, 0.7888697468901474, 0.5857678693199749, 0.5208457532396713, 0.8786419828104004, 0.2713920746928376, 0.6868362606435714, 0.795999275949278, 0.6095590452445109, 0.40158223790339087, 0.4984095314981179, 0.5845298294378994, 0.9201013315379466, 0.7400341417473423, 0.420590192291239, 0.3073892338208054, 0.32542408284545804, 0.6471905920559721, 0.910274070831586, 0.32109185066205387, 0.246438243125689, 0.7743213098497732, 0.4002609460186868, 0.8720233957128842, 0.6675910513481087, 0.17145855358100054, 0.5844408935472742)
glm.summary
// Estimate	 S.E.	 z-stat	p-value		Variable
// ---------------------------------------------------------
//   0.7946	 0.316	 2.516	0.0119 *	(Intercept)
//   1.0260	 0.295	 3.477	0.0005 *	V1
//   0.1254	 0.123	 1.022	0.3065  	V2
//  -0.1108	 0.078	-1.418	0.1562  	V3
glm.plots
// res24: Figure = breeze.plot.Figure@47cbe861
```

![Logistic regression plots](glm-plots.png)


### Poisson regression

We first create an appropriate response, and then do Poisson regression.
```scala
val yp = DenseVector.tabulate(100)(i => Poisson(math.exp(-0.5 + X(i,0))).sample().toDouble)

import scalaglm.PoissonGlm
val pglm = Glm(yp, X, List("V1","V2","V3"), PoissonGlm)
```
```scala
pglm.coefficients
// res26: DenseVector[Double] = DenseVector(-0.5522863128989937, 1.0077276199672591, 0.0034497386481973343, 0.017224100978786572)
pglm.summary
// Estimate	 S.E.	 z-stat	p-value		Variable
// ---------------------------------------------------------
//  -0.5523	 0.169	-3.272	0.0011 *	(Intercept)
//   1.0077	 0.088	11.427	0.0000 *	V1
//   0.0034	 0.052	 0.066	0.9475  	V2
//   0.0172	 0.038	 0.452	0.6516  	V3
pglm.plots
// res28: Figure = breeze.plot.Figure@68472161
```
![Poisson regression plots](pglm-plots.png)


## Non-linear response

The above covers the main functionality of the library based on a linear reponse to variation in covariate values. For flexible modelling of a nonlinear response, see the documentation on [flexible regression modelling](FlexibleRegression.md).


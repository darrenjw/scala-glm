# scala-glm - Quickstart Guide

## PCA

This library contains code for principal components analysis based on a thin SVD of the centred data matrix. This is more numerically stable than a construction from the spectral decomposition of the covariance matrix. It is analogous to the R function `prcomp` rather than the R function `princomp`. First create some synthetic data.

```scala
import breeze.linalg.*
import breeze.numerics.*
import breeze.stats.distributions.*
import breeze.stats.distributions.Rand.VariableSeed.randBasis

val X = DenseMatrix.tabulate(100, 3)((i, j) => 
	Gaussian(j, j+1).sample())
```
Now we can do PCA.
```scala
import scalaglm.Pca
val pca = Pca(X, List("V1", "V2", "V3"))
```
```scala
pca.sdev
// res0: DenseVector[Double] = DenseVector(2.9872977787385766, 1.920323933081664, 1.2025398810228858)
pca.loadings
// res1: DenseMatrix[Double] = -0.015526255615702528  -0.1222013649227007   0.9923838782434875     
// 0.2841317123603883     0.9510484405766365    0.12155670984319245    
// 0.958659535715214      -0.28385505119299437  -0.019955061876955504  
pca.scores
// res2: DenseMatrix[Double] = -1.281640793535458    1.7093750183694116    0.037498274263797586   
// 1.391589020049456     -2.680970255367718    0.9349370750637551     
// -2.7182658621737197   2.2976616995329433    -0.1442007502699551    
// -2.807910485038317    -4.449292478653127    -0.812661057553071     
// -1.5338629729482975   0.6354696453381089    3.513542220590396      
// -3.349766451230796    -0.0988493977171598   0.5680617753834973     
// -0.6762656364402407   -3.887021246326328    -0.2520089822484773    
// -2.2670600646268584   1.745450391586242     0.683857547998732      
// 2.3480624561187957    3.175595677477045     0.2305779625377017     
// -3.7120850606863427   1.1009138608383673    -0.10174684073751773   
// -1.805175690697309    3.026099627831899     -0.19832295280959744   
// -5.551319112690306    2.47963798446599      -0.18564181938968488   
// -2.787015232055534    -1.6561284538639374   0.29971640418809725    
// -0.6068015999564365   2.8318031117634006    0.2384543062057552     
// 0.7971323929054968    -1.151106193108957    1.3757174500438758     
// -0.06480445647851481  -1.7764406147687657   0.8816603755304305     
// -3.3112070591818332   -1.3040170707712235   0.1943427368452626     
// 3.0152598807957007    0.5297465025058975    0.9902593826687262     
// 0.27709427995632213   0.5422895962888346    -0.5878069378492283    
// -1.7945492396574987   -0.6446851818355488   1.9171382080444472     
// -2.012013259437604    -0.5945261596137343   0.3068041360038305     
// -0.15824859429427013  1.0979709449618396    0.6700042449360809     
// -4.37127884412498     1.906883681205431     -0.22734643537144042   
// 1.7143713052290723    -0.8282286224023453   -0.874431816823011     
// -1.748809527960088    -2.0113392279723743   -2.491738879578005     
// -1.123078385722947    -0.5441783875596249   -0.19235495738025868   
// -0.6761853887599478   -2.171776241189439    0.2502881283067436     
// -2.6077153359345178   -2.5298640042514897   2.142819646427615      
// 4.063103217674949     -1.5173458979321774   0.40751435450944673    
// -1.8379005667611332   -3.749632197375669    1.2044029854397102     
// 2.684120721843146     2.5081984036494807    0.5289693333834364     
// 2.5692608022245267    -1.0992270557819224   0.493432551810345      
// 1.0198278181287095    2.8604807354033044    -2.3092486675898596    
// 5.1931117720576285    0.1926150355571297    2.1607752736643846     
// -2.307564532714254    -2.5540820232477404   -0.5363183576432559    
// 0.4551728847729329    -2.3934447650623194   -0.054426921700688434  
// 3.088118028324137     0.047471032802709374  1.1640354747205544     
// 4.748938389548479     -1.8053399045756766   1.4595665582408048     
// -0.13302984001206974  2.4276835301679767    -0.6146105013945663    
// 4.375686944967032     0.23085269769151773   2.7315796422961527     
// 3.298782378926173     -2.4733610468289693   -0.5570626656098534    
// -0.8094480624251904   0.5249186178765874    0.3963367573063389     
// 1.175533516035929     3.075814917305706     -0.8458779233207162    
// -5.047071723494288    0.2658765485010764    0.19466085001116357    
// -6.234261219937436    0.9536464447903505    -0.5421600884514715    
// 0.6223386526802328    2.417262351787221     -1.7064894396686174    
// -3.4760601271919827   1.4464378890186687    -0.6510301241264899    
// -1.1448402224842786   -2.2306468108394233   -0.7864561953723584    
// -0.7402190801507098   -0.25622381928738996  -0.8348528363202641    
// ...
pca.plots
// res3: Figure = breeze.plot.Figure@203cba30
pca.summary
// Standard deviations:
// V1	V2	V3
//  2.987	 1.920	 1.203
// Cumulative proportion of variance explained:
// V1	V2	V3
//  0.635	 0.897	 1.000
// Loadings:
// PC01	PC02	PC03	
// -0.016	-0.122	 0.992	V1
//  0.284	 0.951	 0.122	V2
//  0.959	-0.284	-0.020	V3
```
The final line prints a readable summary of the PCA to the console. `plots` produces some diagnostic plots, including a "scree plot".

![PCA Plots](pca-plots.png)

Note that there is also a utility function `pairs` for producing a "scatterplot matrix":
```scala
import scalaglm.Utils.pairs
pairs(X, List("V1", "V2", "V3"))
// res6: Figure = breeze.plot.Figure@6a7ba38b
```

![Pairs plots](pairs-plots.png)


## Linear regression

This code computes regression coefficients and associated diagnostics via the QR decomposition of the covariate matrix. The diagnostics are analogous to those produced by the R function `lm`. We start by creating a synthetic response variable.

```scala
val y = DenseVector.tabulate(100)(i => 
	Gaussian(2.0 + 1.5*X(i,0) + 0.5*X(i,1), 3.0).sample())
```
So we can now do linear regression and generate all of the usual diagnostics.
```scala
import scalaglm.Lm
val lm = Lm(y,X,List("V1", "V2", "V3"))
```
```scala
lm.coefficients
// res8: DenseVector[Double] = DenseVector(2.0512916253124427, 1.0916855593263126, 0.46491882794443623, -0.297043848299348)
lm.se
// res9: DenseVector[Double] = DenseVector(0.35705191443729006, 0.23966313179996454, 0.14892637571877063, 0.10241655795956897)
lm.fitted
// res10: DenseVector[Double] = DenseVector(3.0894076713644543, 1.9385602250102312, 3.356127712794905, -0.04663797525486818, 6.6929612911351954, 3.3373574224717277, 0.455217446672022, 4.011336957924669, 3.2713174724238496, 3.1029307300411184, 3.425568279922526, 3.8607036512098034, 2.3223093560096215, 3.6463977822753337, 3.1457881612396847, 2.4800875578004744, 2.4288871595256194, 2.9885931273799278, 1.6497904619744066, 4.404804419821866, 2.616264613813348, 3.3832702970673347, 3.387630997755206, 0.5388748548278144, -1.1918948110350958, 1.913334952939593, 1.7049574607475309, 4.060307171443334, 1.3384907563527977, 2.3750278885802008, 3.293882036896411, 1.8546666977181898, 0.4625781855074562, 3.8278705614755255, 0.9300872060390512, 1.0767834188844503, 2.9857809966779287, 2.3144147655972698, 2.4297380666824555, 4.635583549814463, -0.012876178069979982, 2.9549011865491996, 2.1975587302357242, 3.3407628815591606, 2.9682131413889206, 1.046430834643136, 2.569337395725701, 0.5733934156054264, 1.22540080647501, 3.289579575130964, 1.2190987317768829, 4.987348566596525, -1.5692410230707607, 3.5930282313149395, 3.585397915621778, 2.9473938526100785, 1.9266550901018504, 0.7773611261400694, 4.733091550189638, 1.580437577873312, -0.5409244015503756, 0.4458724130086753, -0.6627126811696815, 1.0208776603195262, 1.8774050141137575, 1.7788937258250734, 3.087742663555421, 1.0023081241860914, -0.14949718535941736, 3.9376414650678884, 4.51628648521541, -2.4361969676254622, 2.859502281768578, -0.877141161767276, 1.9726051669012783, 3.4437462000803114, 2.744347949163111, -0.7569525295073385, 2.9802853451212883, 1.4704978909562314, 0.6892655588773626, 2.248204127176616, 3.664620516376165, 3.365287967625667, 2.3856669084310616, 0.83459053378687, 1.6502843317171125, -0.1343785562429889, 2.454550525968803, 3.9428510554482767, 0.5769508727138501, 0.24027116815863714, -0.436393452636187, -0.14694952631753133, 2.1581887480003488, 2.243967437439537, 5.74082404753505, 2.1588072543933157, 4.0341370942416805, 2.8969940121590025)
lm.residuals
// res11: DenseVector[Double] = DenseVector(1.3312925075238065, 1.8326791426704365, -6.702425431121838, 2.3929803422918194, 2.0659601847510762, -1.3398373455623052, -0.7905894851653106, -2.4697554576008893, -5.203637282023104, 5.101441287775581, -0.18494575578587247, -3.159860327325993, 2.0438858150038266, -1.560246396200137, -1.731240815015394, -0.07099802755235318, 0.6394102891271385, -3.653326526417742, 6.270510737859766, 1.033561562906046, -8.71388059288062, 2.0946786547487166, 1.0267442593205693, -0.09961608337617966, -2.216157010561391, 2.255551861794041, 3.491270965667775, -2.339316022950411, -0.6041878425759581, 2.638592162855141, 1.0895808732209082, 1.4411081357722586, -0.4479047579894404, -0.5859776198307118, -0.43137051837653984, -5.590845564818258, 1.1671548909044196, -1.5593620612840389, -1.8410737141464073, 3.2603509543855393, 4.318130723597102, 0.014355154406578752, 1.9742597747601343, 1.3442398746590687, -2.3296554395335427, -1.4120789703795007, -0.8639381723724489, 2.4811013217658444, -1.4102839614670257, 5.046052730467619, -4.229488287822152, 0.17546659649675167, -4.430016064501901, -2.228798485444003, 2.5170126856288215, -1.5326327523143495, -0.20650333679454547, 2.7108981665804452, 6.78274239964219, 0.9005194098625118, -1.6157675401843372, 5.709740327967932, 0.3828346936734154, 0.16987134853287422, 1.8058068660053481, -2.187894481524763, -1.2872369259598193, -0.5574622690836096, 0.5821615626641882, -1.238585006047546, -0.2827750380537646, 0.9535259885176857, -3.3911902507928864, 1.4208554623346283, -4.995744003397338, -0.14460723821917876, -0.9583931324619024, 4.627378802405576, 1.9142998073650705, -0.29934302694400294, 2.9268483279134374, -1.9760289830107252, -0.03250830655385961, 3.593333821781094, -2.9548806904628164, -0.3595131071429356, -1.019909799713536, -0.9835340973326732, -3.081953556443965, 1.7040681755361828, 0.6009498465906795, 3.676275875765741, -2.5210554064464046, -6.662910838610749, 2.682149044732527, 3.160290841174866, -1.929071221472272, 3.099715949256268, -1.3868117840852743, 1.3554866044712628)
lm.studentised
// res12: DenseVector[Double] = DenseVector(0.46675566273463387, 0.6485641826470897, -2.3657520852724527, 0.8649180859816955, 0.7558884768321481, -0.4709806228559636, -0.28189259905330727, -0.8692619411487865, -1.8475181620229526, 1.7969591926320354, -0.06548630502966932, -1.1324410399290679, 0.7191879932643894, -0.5506653783803709, -0.609375948967074, -0.02494572635862308, 0.2250373543129752, -1.2861523659419583, 2.1911341928516386, 0.36623624596235804, -3.049420080212019, 0.7331284523578802, 0.36410398295674296, -0.034937748357995894, -0.7967630473301518, 0.7878453874123041, 1.2265579898385868, -0.8407666765901453, -0.21361178413030676, 0.9458808526645652, 0.3854611867635246, 0.5059313136831013, -0.16128625393485962, -0.21127818445747132, -0.15249226637649863, -1.9662713623049708, 0.41139527100768164, -0.5580675971719038, -0.6484472589685344, 1.1823851102211258, 1.5307298112009176, 0.005014379870626755, 0.7003043345121233, 0.47603425121669946, -0.8333881469275211, -0.502019768015078, -0.3048490863941407, 0.8741563821862768, -0.4933932345514199, 1.7727019471805754, -1.4861962211108966, 0.06232934445907323, -1.5973282340071242, -0.7827946902912394, 0.8937070401001317, -0.5469969194274316, -0.07216814849059296, 0.9707290643497133, 2.421740751245414, 0.3154624767032869, -0.5888426867614847, 2.025898195684394, 0.1362986615059813, 0.06026585747147191, 0.6320926892137999, -0.7657735027595202, -0.45408879157046317, -0.19513458350333018, 0.20616634305043677, -0.44125396500271347, -0.10082171563437461, 0.35030450761141685, -1.1865650912254575, 0.5056595282698875, -1.7463637285679998, -0.05094362799918985, -0.3356902842615876, 1.6470328938926495, 0.6936417151262733, -0.10833331107451778, 1.042644523682428, -0.6977863421070488, -0.011545281838995542, 1.2741338364328691, -1.0334789298548097, -0.1266429056006241, -0.3626486286773428, -0.3519820937899213, -1.0882132508573605, 0.5999298552833771, 0.2121067949644124, 1.2969705726754865, -0.891485747677704, -2.3588120024366344, 0.9453794370830678, 1.1028930478591175, -0.6936422062002296, 1.0933432456540364, -0.4885702222010265, 0.48386503311402607)
val pred = lm.predict()
// pred: PredictLm = PredictLm(
//   Lm(
//     DenseVector(4.420700178888261, 3.7712393676806677, -3.3462977183269325, 2.3463423670369514, 8.758921475886272, 1.9975200769094226, -0.33537203849328856, 1.54158150032378, -1.932319809599254, 8.204372017816699, 3.2406225241366537, 0.7008433238838103, 4.366195171013448, 2.086151386075197, 1.4145473462242908, 2.4090895302481212, 3.068297448652758, -0.6647333990378144, 7.920301199834173, 5.438365982727912, -6.097615979067272, 5.477948951816051, 4.4143752570757755, 0.4392587714516347, -3.4080518215964863, 4.168886814733634, 5.196228426415306, 1.720991148492923, 0.7343029137768395, 5.013620051435342, 4.383462910117319, 3.2957748334904484, 0.01467342751801581, 3.2418929416448137, 0.4987166876625113, -4.514062145933807, 4.152935887582348, 0.7550527043132309, 0.5886643525360482, 7.895934504200002, 4.305254545527123, 2.9692563409557784, 4.1718185049958585, 4.685002756218229, 0.6385577018553781, -0.3656481357363648, 1.7053992233532522, 3.0544947373712708, -0.1848831549920158, 8.335632305598583, -3.0103895560452694, 5.162815163093277, -5.999257087572662, 1.3642297458709365, 6.102410601250599, 1.414761100295729, 1.720151753307305, 3.4882592927205147, 11.515833949831828, 2.4809569877358237, -2.156691941734713, 6.155612740976608, -0.27987798749626613, 1.1907490088524004, 3.6832118801191056, -0.40900075569968997, 1.8005057375956015, 0.44484585510248176, 0.4326643773047708, 2.6990564590203423, 4.2335114471616455, -1.4826709791077766, -0.5316879690243086, 0.5437143005673523, -3.02313883649606, 3.2991389618611326, 1.7859548167012087, 3.8704262728982375, 4.894585152486359, 1.1711548640122285, 3.6161138867908003, 0.27217514416589106, 3.6321122098223055, 6.958621789406761, -0.5692137820317549, 0.4750774266439344, 0.6303745320035765, -1.117912653575662, -0.6274030304751621, 5.64691923098446, 1.1779007193045297, 3.9165470439243784, -2.9574488590825916, -6.80986036492828, 4.840337792732876, 5.404258278614403, 3.8117528260627775, 5.258523203649584, 2.6473253101564063, 4.252480616630265),
//     -0.10936824406994151   2.435610223993747      -0.08467008567043788  
// 1.2762364890814737     -0.871181729809368     3.7063604019117724    
// -0.3392674540742309    2.5648218783502386     -1.6252667376883085   
// -0.1767578312932579    -3.9585850872681654    0.21729078021686732   
// 3.4753504967422053     1.7651463392994247     -0.09099649048116198  
// 0.670232160164772      0.1927746819235805     -1.5646122617751939   
// 0.27781747469444157    -2.750018985965504     2.0900210647930084    
// 0.5429596903821884     2.2685000932385626     -1.0524899827931389   
// -0.15328894049473368   4.884841026707763      2.9749324890491993    
// -0.13546236841716378   1.149441719509026      -2.23914524049317     
// -0.4961704358317257    3.5104605912066824     -0.9556149113622308   
// -0.35864394442778785   1.9278924290657216     -4.392028180062066    
// 0.5854947469389007     -1.1609968488544675    -0.5777290645865465   
// -0.057582688594291935  3.7192644815810256     0.23965396836570108   
// 1.5359380360491417     0.46846893364770226    2.693423446363454     
// 1.1354431320779632     -0.4312139383253557    2.054482740282793     
// 0.44603386295735475    -0.9878702648078816    -1.1780964148265447   
// 0.913573956243816      2.6504266155664955     4.350425825685236     
// -0.6114929431810942    1.6925314746194453     1.7533872526171892    
// 2.051589040333827      0.2795342325247866     0.054328888961374666  
// 0.4507663696341628     0.06970255652714963    -0.13624864304620843  
// 0.5755928219655799     2.250212027391071      1.1532089972546145    
// ...
pred.fitted
// res13: DenseVector[Double] = DenseVector(3.089407671364453, 1.938560225010232, 3.3561277127949043, -0.04663797525486896, 6.6929612911351954, 3.3373574224717277, 0.4552174466720224, 4.0113369579246685, 3.271317472423849, 3.1029307300411184, 3.4255682799225258, 3.8607036512098034, 2.322309356009622, 3.646397782275334, 3.1457881612396847, 2.480087557800475, 2.4288871595256203, 2.988593127379928, 1.6497904619744068, 4.404804419821866, 2.6162646138133483, 3.383270297067335, 3.387630997755206, 0.5388748548278146, -1.1918948110350955, 1.913334952939593, 1.704957460747531, 4.060307171443334, 1.3384907563527981, 2.375027888580201, 3.2938820368964103, 1.85466669771819, 0.4625781855074562, 3.8278705614755255, 0.9300872060390515, 1.076783418884451, 2.9857809966779287, 2.314414765597269, 2.4297380666824546, 4.635583549814463, -0.01287617806997976, 2.9549011865491996, 2.1975587302357242, 3.34076288155916, 2.96821314138892, 1.0464308346431355, 2.569337395725701, 0.5733934156054269, 1.2254008064750104, 3.2895795751309636, 1.2190987317768833, 4.987348566596524, -1.569241023070761, 3.5930282313149395, 3.5853979156217775, 2.9473938526100785, 1.9266550901018507, 0.7773611261400698, 4.733091550189638, 1.5804375778733122, -0.540924401550376, 0.44587241300867575, -0.662712681169682, 1.0208776603195266, 1.8774050141137577, 1.7788937258250737, 3.0877426635554204, 1.0023081241860914, -0.14949718535941736, 3.937641465067889, 4.516286485215411, -2.4361969676254622, 2.859502281768578, -0.877141161767276, 1.9726051669012787, 3.4437462000803114, 2.744347949163111, -0.7569525295073387, 2.980285345121289, 1.4704978909562305, 0.6892655588773624, 2.2482041271766167, 3.664620516376165, 3.365287967625667, 2.3856669084310616, 0.8345905337868698, 1.6502843317171116, -0.1343785562429889, 2.454550525968802, 3.942851055448277, 0.5769508727138501, 0.24027116815863758, -0.4363934526361868, -0.1469495263175311, 2.1581887480003483, 2.243967437439537, 5.74082404753505, 2.158807254393316, 4.034137094241681, 2.8969940121590025)
pred.se
// res14: DenseVector[Double] = DenseVector(0.4061364375976053, 0.561502334482024, 0.5231167733571432, 0.8033903689136437, 0.9110452594353454, 0.45535916896699896, 0.659155916034149, 0.4771434059577648, 0.6059323219408626, 0.49052529547949125, 0.5692892587829925, 0.7171572694206213, 0.4728018404572021, 0.5216073936852563, 0.47835391675206385, 0.4470504855812221, 0.4762965406043076, 0.4813010810317175, 0.33232593034241725, 0.5794770052439225, 0.3667794718240503, 0.3696903231515121, 0.5900738612301808, 0.4129646843518883, 0.750780432115938, 0.32206988368752926, 0.44515455389443104, 0.7474009728311799, 0.5477889674068062, 0.7200616888302074, 0.5567213721721179, 0.43197816943689077, 0.7667904119979104, 0.7796792870224075, 0.5459068379313835, 0.4640696738598048, 0.5012023424260605, 0.7017754586004641, 0.4889396486405858, 0.8346775138932556, 0.5850738655983538, 0.3233087837593141, 0.5937653911656046, 0.5710705916267047, 0.6970382843114454, 0.6231529216312597, 0.5183235721269117, 0.4942673177970804, 0.3606244835754585, 0.4442907128460567, 0.4486518915167283, 0.6124181498729744, 0.7800254116084083, 0.4397788685315933, 0.6067780184135694, 0.6704277905315636, 0.3352874341404729, 0.7080200770120788, 0.6751426237253167, 0.38909275035174373, 0.8779287458501489, 0.5974128626391462, 0.6409536720228658, 0.5958782825170146, 0.3720620235367875, 0.37026413974862893, 0.5140251874095134, 0.3725314762072199, 0.5714823552289722, 0.6489057054013676, 0.658616414191656, 0.9438745445535803, 0.3633675055231219, 0.6360579880004503, 0.3417481118922001, 0.49258321132427735, 0.38620991721845993, 0.6377397989467691, 0.8268872882441598, 0.8155039387539991, 0.6481572473364685, 0.5298507317270976, 0.6097924131645924, 0.5886550982033696, 0.3540446318304372, 0.4913121278842228, 0.624975446195495, 0.7015527115032368, 0.5284116188794113, 0.4816706614431474, 0.52237825496866, 0.5154534276770508, 0.5504315907837002, 0.5668061241058525, 0.5009228288168853, 0.29883728405962956, 0.7521691546089709, 0.512306354487972, 0.49294584945977565, 0.6726409023108089)
val predNew = lm.predict(DenseMatrix((1.1, 1.6, 1.0), (1.4, 2.2, 3.0)))
// predNew: PredictLm = PredictLm(
//   Lm(
//     DenseVector(4.420700178888261, 3.7712393676806677, -3.3462977183269325, 2.3463423670369514, 8.758921475886272, 1.9975200769094226, -0.33537203849328856, 1.54158150032378, -1.932319809599254, 8.204372017816699, 3.2406225241366537, 0.7008433238838103, 4.366195171013448, 2.086151386075197, 1.4145473462242908, 2.4090895302481212, 3.068297448652758, -0.6647333990378144, 7.920301199834173, 5.438365982727912, -6.097615979067272, 5.477948951816051, 4.4143752570757755, 0.4392587714516347, -3.4080518215964863, 4.168886814733634, 5.196228426415306, 1.720991148492923, 0.7343029137768395, 5.013620051435342, 4.383462910117319, 3.2957748334904484, 0.01467342751801581, 3.2418929416448137, 0.4987166876625113, -4.514062145933807, 4.152935887582348, 0.7550527043132309, 0.5886643525360482, 7.895934504200002, 4.305254545527123, 2.9692563409557784, 4.1718185049958585, 4.685002756218229, 0.6385577018553781, -0.3656481357363648, 1.7053992233532522, 3.0544947373712708, -0.1848831549920158, 8.335632305598583, -3.0103895560452694, 5.162815163093277, -5.999257087572662, 1.3642297458709365, 6.102410601250599, 1.414761100295729, 1.720151753307305, 3.4882592927205147, 11.515833949831828, 2.4809569877358237, -2.156691941734713, 6.155612740976608, -0.27987798749626613, 1.1907490088524004, 3.6832118801191056, -0.40900075569968997, 1.8005057375956015, 0.44484585510248176, 0.4326643773047708, 2.6990564590203423, 4.2335114471616455, -1.4826709791077766, -0.5316879690243086, 0.5437143005673523, -3.02313883649606, 3.2991389618611326, 1.7859548167012087, 3.8704262728982375, 4.894585152486359, 1.1711548640122285, 3.6161138867908003, 0.27217514416589106, 3.6321122098223055, 6.958621789406761, -0.5692137820317549, 0.4750774266439344, 0.6303745320035765, -1.117912653575662, -0.6274030304751621, 5.64691923098446, 1.1779007193045297, 3.9165470439243784, -2.9574488590825916, -6.80986036492828, 4.840337792732876, 5.404258278614403, 3.8117528260627775, 5.258523203649584, 2.6473253101564063, 4.252480616630265),
//     -0.10936824406994151   2.435610223993747      -0.08467008567043788  
// 1.2762364890814737     -0.871181729809368     3.7063604019117724    
// -0.3392674540742309    2.5648218783502386     -1.6252667376883085   
// -0.1767578312932579    -3.9585850872681654    0.21729078021686732   
// 3.4753504967422053     1.7651463392994247     -0.09099649048116198  
// 0.670232160164772      0.1927746819235805     -1.5646122617751939   
// 0.27781747469444157    -2.750018985965504     2.0900210647930084    
// 0.5429596903821884     2.2685000932385626     -1.0524899827931389   
// -0.15328894049473368   4.884841026707763      2.9749324890491993    
// -0.13546236841716378   1.149441719509026      -2.23914524049317     
// -0.4961704358317257    3.5104605912066824     -0.9556149113622308   
// -0.35864394442778785   1.9278924290657216     -4.392028180062066    
// 0.5854947469389007     -1.1609968488544675    -0.5777290645865465   
// -0.057582688594291935  3.7192644815810256     0.23965396836570108   
// 1.5359380360491417     0.46846893364770226    2.693423446363454     
// 1.1354431320779632     -0.4312139383253557    2.054482740282793     
// 0.44603386295735475    -0.9878702648078816    -1.1780964148265447   
// 0.913573956243816      2.6504266155664955     4.350425825685236     
// -0.6114929431810942    1.6925314746194453     1.7533872526171892    
// 2.051589040333827      0.2795342325247866     0.054328888961374666  
// 0.4507663696341628     0.06970255652714963    -0.13624864304620843  
// 0.5755928219655799     2.250212027391071      1.1532089972546145    
// ...
predNew.fitted
// res15: DenseVector[Double] = DenseVector(3.698972016983137, 3.711341284948996)
predNew.se
// res16: DenseVector[Double] = DenseVector(0.40264895898309166, 0.4814607777456525)
lm.plots
// res17: Figure = breeze.plot.Figure@50dc7396
lm.summary
// Estimate	 S.E.	 t-stat	p-value		Variable
// ---------------------------------------------------------
//   2.0513	 0.357	 5.745	0.0000 *	(Intercept)
//   1.0917	 0.240	 4.555	0.0000 *	V1
//   0.4649	 0.149	 3.122	0.0024 *	V2
//  -0.2970	 0.102	-2.900	0.0046 *	V3
// 
// Residual standard error:   2.8810 on 96 degrees of freedom
// Multiple R-squared: 0.2529, Adjusted R-squared: 0.2296
// F-statistic: 10.8344 on 3 and 96 DF, p-value: 0.00000
//
```
The plots include a plot of studentised residuals against fitted values and a normal Q-Q plot for the studentised residuals.

![Linear model plots](lm-plots.png)


## Generalised linear models

The current implementation supports only simple one-parameter exponential family observation models. This includes the most commonly used cases of **logistic regression** (`LogisticGlm`) and **Poisson regression** (`PoissonGlm`).

### Logistic regression

Again, we start by creating an appropriate response variable.
```scala
val ylb = (0 until 100) map (i => Bernoulli(sigmoid(1.0 + X(i,0))).sample())
val yl = DenseVector(ylb.toArray map {b => if (b) 1.0 else 0.0})
```

Then we can do logistic regression in a typical way.
```scala
import scalaglm.{Glm, LogisticGlm}
val glm = Glm(yl, X, List("V1","V2","V3"), LogisticGlm)
```
```scala
glm.coefficients
// res20: DenseVector[Double] = DenseVector(1.1899863867406855, 0.8848383526979424, 0.3019087676043668, -0.09280743030164965)
glm.fitted
// res21: DenseVector[Double] = DenseVector(0.8625227722318376, 0.8471284347915974, 0.8599612997828715, 0.45469622511454616, 0.9918896279926618, 0.8793661583099998, 0.601468018847298, 0.9207788736035303, 0.904911657970239, 0.8354780302873448, 0.8698329720299304, 0.8655653821615406, 0.8039483713255916, 0.9037559237690128, 0.9198645746987004, 0.8668986823530734, 0.8015076031832944, 0.9164289101706542, 0.7305031230836546, 0.9562556471830634, 0.8351438153166404, 0.9064996417839276, 0.843761917467482, 0.605559269806555, 0.2247588566511239, 0.7613813535335341, 0.7728075351319367, 0.9487381353364188, 0.8057325034257623, 0.8574758343712544, 0.9155848484984898, 0.8337468006037966, 0.470702056996491, 0.9664841865111237, 0.6111857622439911, 0.7068732299180794, 0.9208398051577332, 0.9102043288198505, 0.7968474596173579, 0.9802869432447404, 0.5878199568898749, 0.8714810000208545, 0.7799981017633801, 0.8516736673500647, 0.7744668054489773, 0.5868379463604706, 0.7664576007417185, 0.5670302181313283, 0.6511211996868929, 0.8655242175828934, 0.7601403848342615, 0.97237578480385, 0.19030892084264192, 0.9334099243072351, 0.8598442489992018, 0.8141267087787348, 0.7829853389030297, 0.49567448532793285, 0.9408844879050138, 0.7876523627529529, 0.5126945048150907, 0.5581240507323431, 0.3048817011322649, 0.6710548532666314, 0.815662593592658, 0.7403946610801573, 0.843698509427998, 0.6581477106488437, 0.4965047814960335, 0.894448123357986, 0.9712784412192249, 0.12440827366486526, 0.8869427933675924, 0.4058939329057471, 0.7969614117520746, 0.8747589075796915, 0.8578276232763046, 0.29997220157550114, 0.9153410208817213, 0.8504538606693324, 0.48145574878111036, 0.7431000158906065, 0.948969132176355, 0.8963754372241695, 0.813659496912332, 0.7096478348832854, 0.7861838736334787, 0.5806007212406309, 0.811280897666694, 0.9167768661348225, 0.6706255405260957, 0.5898713573247344, 0.4110905795741472, 0.5429894607715071, 0.769899485434058, 0.8223705177970895, 0.9757228101451182, 0.874072603153795, 0.9507511815359516, 0.9179165479939152)
glm.predict(response=true).fitted
// res22: DenseVector[Double] = DenseVector(0.8625227722318376, 0.8471284347915974, 0.8599612997828715, 0.45469622511454616, 0.9918896279926618, 0.8793661583099998, 0.601468018847298, 0.9207788736035303, 0.904911657970239, 0.8354780302873448, 0.8698329720299304, 0.8655653821615406, 0.8039483713255916, 0.9037559237690128, 0.9198645746987004, 0.8668986823530734, 0.8015076031832944, 0.9164289101706542, 0.7305031230836546, 0.9562556471830634, 0.8351438153166404, 0.9064996417839276, 0.843761917467482, 0.605559269806555, 0.2247588566511239, 0.7613813535335341, 0.7728075351319367, 0.9487381353364188, 0.8057325034257623, 0.8574758343712544, 0.9155848484984898, 0.8337468006037966, 0.470702056996491, 0.9664841865111237, 0.6111857622439911, 0.7068732299180794, 0.9208398051577332, 0.9102043288198505, 0.7968474596173579, 0.9802869432447404, 0.5878199568898749, 0.8714810000208545, 0.7799981017633801, 0.8516736673500647, 0.7744668054489773, 0.5868379463604706, 0.7664576007417185, 0.5670302181313283, 0.6511211996868929, 0.8655242175828934, 0.7601403848342615, 0.97237578480385, 0.19030892084264192, 0.9334099243072351, 0.8598442489992018, 0.8141267087787348, 0.7829853389030297, 0.49567448532793285, 0.9408844879050138, 0.7876523627529529, 0.5126945048150907, 0.5581240507323431, 0.3048817011322649, 0.6710548532666314, 0.815662593592658, 0.7403946610801573, 0.843698509427998, 0.6581477106488437, 0.4965047814960335, 0.894448123357986, 0.9712784412192249, 0.12440827366486526, 0.8869427933675924, 0.4058939329057471, 0.7969614117520746, 0.8747589075796915, 0.8578276232763046, 0.29997220157550114, 0.9153410208817213, 0.8504538606693324, 0.48145574878111036, 0.7431000158906065, 0.948969132176355, 0.8963754372241695, 0.813659496912332, 0.7096478348832854, 0.7861838736334787, 0.5806007212406309, 0.811280897666694, 0.9167768661348225, 0.6706255405260957, 0.5898713573247344, 0.4110905795741472, 0.5429894607715071, 0.769899485434058, 0.8223705177970895, 0.9757228101451182, 0.874072603153795, 0.9507511815359516, 0.9179165479939152)
glm.summary
// Estimate	 S.E.	 z-stat	p-value		Variable
// ---------------------------------------------------------
//   1.1900	 0.320	 3.718	0.0002 *	(Intercept)
//   0.8848	 0.259	 3.419	0.0006 *	V1
//   0.3019	 0.137	 2.196	0.0281 *	V2
//  -0.0928	 0.094	-0.989	0.3226  	V3
glm.plots
// res24: Figure = breeze.plot.Figure@4a0abf27
```

![Logistic regression plots](glm-plots.png)


### Poisson regression

We first create an appropriate response, and then do Poisson regression.
```scala
val yp = DenseVector.tabulate(100)(i => Poisson(math.exp(-0.5 + X(i,0))).sample().toDouble)

import scalaglm.PoissonGlm
val pglm = Glm(yp, X, List("V1","V2","V3"), PoissonGlm)
```
```scala
pglm.coefficients
// res26: DenseVector[Double] = DenseVector(-0.6555047315405408, 0.9770726794132564, 0.0058271682120362624, 0.024159865845065458)
pglm.summary
// Estimate	 S.E.	 z-stat	p-value		Variable
// ---------------------------------------------------------
//  -0.6555	 0.165	-3.971	0.0001 *	(Intercept)
//   0.9771	 0.074	13.156	0.0000 *	V1
//   0.0058	 0.050	 0.117	0.9070  	V2
//   0.0242	 0.037	 0.662	0.5081  	V3
pglm.plots
// res28: Figure = breeze.plot.Figure@62310518
```
![Poisson regression plots](pglm-plots.png)


## Non-linear response

The above covers the main functionality of the library based on a linear reponse to variation in covariate values. For flexible modelling of a nonlinear response, see the documentation on [flexible regression modelling](FlexibleRegression.md).


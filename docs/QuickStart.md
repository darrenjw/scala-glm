# scala-glm - Quickstart Guide

## PCA

This library contains code for principal components analysis based on a thin SVD of the centred data matrix. This is more numerically stable than a construction from the spectral decomposition of the covariance matrix. It is analogous to the R function `prcomp` rather than the R function `princomp`. First create some synthetic data.

```scala
import breeze.linalg.*
import breeze.numerics.*
import breeze.stats.distributions.*
import breeze.stats.distributions.Rand.VariableSeed.randBasis

val X = DenseMatrix.tabulate(100, 3)((i, j) => 
	Gaussian(j, j+1).sample())
```
Now we can do PCA.
```scala
import scalaglm.Pca
val pca = Pca(X, List("V1", "V2", "V3"))
```
```scala
pca.sdev
// res0: DenseVector[Double] = DenseVector(3.30084639100221, 1.9424981362596132, 1.0919094900471362)
pca.loadings
// res1: DenseMatrix[Double] = 0.008033201974845246  -0.06570294516093664  0.997806890466893     
// 0.03218798057125416   -0.9973050163963649   -0.06592903895394712  
// -0.9994495492883952   -0.03264701009013632  0.005896707504923944  
pca.scores
// res2: DenseMatrix[Double] = 4.574356980583796     0.685305670282456     -0.49305852270013123   
// -5.426347861652786    -0.36300355979678167  -0.3662631352737414    
// -0.6215463240454228   0.954422898048827     -1.5665694876207206    
// -1.8938033535540981   0.6017705333265653    0.28962054767610795    
// -5.314713571753082    0.5647202712538245    1.265460904443579      
// -0.28071136331326446  1.365798301071926     -0.014122792443829435  
// 3.1792195671226113    3.0568489778554073    0.9569648108127294     
// 1.5675936369711223    0.7691994303496601    -0.36183364335949053   
// -1.9858416812736839   -0.8115043412685791   -2.409961044717997     
// 4.228677881176502     0.9833122462811078    -0.016016321959374077  
// -0.474360989247108    2.769567912126118     -1.0052826524233591    
// -1.0328757717318369   -0.807834451323063    0.005805526618658688   
// 2.2792060190110117    -1.7277478771671066   -1.7051751013745255    
// 2.811615159881374     1.9282726507889867    -0.8584088936085245    
// -0.8031836864544762   -1.411113853155709    -1.152114833730392     
// 3.0706914281840754    3.0381141511905687    -1.3945375215128784    
// -6.931791376700184    -2.0824765725556764   0.34909997059528564    
// -4.172952087735766    0.14780811237136696   -0.8219740572848999    
// -0.38696789096387846  0.8772056421399895    -1.8056589745495755    
// 0.17993031530434392   -0.5316384520968226   -0.5142413843319444    
// 1.0960327341641638    -3.225813904600183    0.4299079505027599     
// -0.315996122459905    -0.7041022854207764   1.235642217238022      
// -4.536084364661431    -0.9511871190711112   -0.7103917369010578    
// 2.77595477584788      0.1160297332108026    0.8477819171849631     
// 5.2422804307324       0.4001920958657168    -0.5191274601474168    
// 1.7205673475458994    0.408309266874041     1.6298878285944463     
// -4.950863332904489    -1.3319524560153257   -2.6699101289539016    
// -3.1384381126538425   -1.6758301641818725   -1.346725166335937     
// -5.465952570973358    1.0729840792631569    1.0947317576234867     
// -0.8603683081953164   -2.5919670798269143   1.4325195258966674     
// 1.7760531146807585    -1.5267982708254697   -0.26259020529238064   
// 1.748338013914117     0.7418194388119611    -0.550491232550444     
// 2.3136097831396287    -1.2955968044322352   -0.04902384713871738   
// 0.3590243397373637    -1.0127250297258694   0.3938300259491305     
// -3.5848644950825923   -1.946294296667631    -1.0892141498899583    
// 0.7412461060182096    2.5341335624785293    0.5208317417378578     
// -0.9322253166579297   0.20584316902653008   0.4189461402175948     
// -3.357108253516099    1.790003853022116     0.5594606634366331     
// 1.4167047578510619    -3.640000701966375    -1.3395714763523165    
// 2.480667620646914     -0.1258710874920339   0.32780910692758164    
// -1.857361987985005    2.275580865275613     0.9822027601385979     
// 2.8192470278988133    0.18424723469101406   1.1852457834042454     
// -0.459099986540912    -0.8754301904609587   -1.4688553567269766    
// 2.6776170375517685    -0.03049280400403387  -0.0432467186372898    
// 2.1246418605460518    -2.8536633430016662   1.4407523977398133     
// -0.8253265192152816   -0.41146669155797133  -0.6261133622788171    
// -3.0316262271931387   -0.44113222525943746  0.8764310578399056     
// -3.9348520656647312   1.5458038728596755    -0.40578763399841256   
// -3.3222296381909944   1.8989715480057403    -0.7019673055646072    
// ...
pca.plots
// res3: Figure = breeze.plot.Figure@63e5ec9a
pca.summary
// Standard deviations:
// V1	V2	V3
//  3.301	 1.942	 1.092
// Cumulative proportion of variance explained:
// V1	V2	V3
//  0.687	 0.925	 1.000
// Loadings:
// PC01	PC02	PC03	
//  0.008	-0.066	 0.998	V1
//  0.032	-0.997	-0.066	V2
// -0.999	-0.033	 0.006	V3
```
The final line prints a readable summary of the PCA to the console. `plots` produces some diagnostic plots, including a "scree plot".

![PCA Plots](pca-plots.png)

Note that there is also a utility function `pairs` for producing a "scatterplot matrix":
```scala
import scalaglm.Utils.pairs
pairs(X, List("V1", "V2", "V3"))
// res6: Figure = breeze.plot.Figure@ed9d614
```

![Pairs plots](pairs-plots.png)


## Linear regression

This code computes regression coefficients and associated diagnostics via the QR decomposition of the covariate matrix. The diagnostics are analogous to those produced by the R function `lm`. We start by creating a synthetic response variable.

```scala
val y = DenseVector.tabulate(100)(i => 
	Gaussian(2.0 + 1.5*X(i,0) + 0.5*X(i,1), 3.0).sample())
```
So we can now do linear regression and generate all of the usual diagnostics.
```scala
import scalaglm.Lm
val lm = Lm(y,X,List("V1", "V2", "V3"))
```
```scala
lm.coefficients
// res8: DenseVector[Double] = DenseVector(1.775153902650946, 1.8201389075293557, 0.6058451353466445, 0.024709222814364915)
lm.se
// res9: DenseVector[Double] = DenseVector(0.4273996673405467, 0.29324479476176174, 0.165805523866737, 0.09726218992259464)
lm.fitted
// res10: DenseVector[Double] = DenseVector(0.9728763621649836, 1.8634469737241606, -1.178040300262604, 2.362744168331728, 4.090776724977109, 1.2847757518625444, 1.8170354269658235, 1.1168433144386096, -1.4094557236867271, 1.6010738190596705, -1.494878705651375, 2.888115607839523, 0.5466138019056341, -0.5933941723773554, 1.2705497973218316, -2.3475035617429887, 4.365933821121167, 0.6956224283221174, -1.5445833804879185, 1.7756294823707748, 5.413625077660635, 5.0043288933556465, 1.686748750012174, 3.7502267316922, 1.139460671945116, 4.917783670928861, -1.5220464795617483, 1.0946550612701476, 3.417784488449144, 6.716881301001672, 2.958796814377304, 0.8032649943704757, 3.175702564329098, 3.738969450749724, 1.7438567300973447, 1.3980915483738834, 2.8884283094405427, 1.9672774647354931, 2.5735560067023178, 2.999072534646701, 2.3805005263535772, 4.300657882680772, 0.3229909444759874, 2.272692284809316, 6.949272107536158, 1.4803519126305782, 4.150094188408958, 0.42416144059845684, -0.3520902026910461, 1.1428046732214598, 3.8569539419175807, -2.4933565860801616, 4.946314320263527, 2.6023793182463666, -0.3091489859951435, 7.411486571114171, 3.268954611394962, 1.150675731662191, 2.0931387203090805, 6.895649672761271, -2.096456018581695, 3.8055389735068803, 0.6782177287846448, 5.736989161870093, -0.989580231663053, -1.151779349056303, 5.504063616276453, 1.1259309036297167, 0.7897705944070101, 2.127720373678353, 4.700415715214471, 3.926574019338691, 3.6519979690340403, 1.6395175011749692, 5.993132748739948, 1.8322441575800406, 7.730388536188487, 7.632423195801781, 5.714948890100881, 0.525995858909118, 1.9964483695804467, 5.115188397354407, -0.7755386492750375, 1.137963224846155, 2.059830047957024, 4.0594118245360455, 2.1120678721285273, 3.6818503568122134, 4.557124425745638, -2.120795534969936, 2.1747575139751256, -1.158876751194802, 1.2315216485075808, 4.517521544854563, 3.715791176276855, 4.377902851787628, 3.3695650758012716, -1.1158958057726338, 3.5159293905390188, 2.4427270442357036)
lm.residuals
// res11: DenseVector[Double] = DenseVector(5.822664707796456, 1.0548859120693734, 1.5451662900061913, 2.7005063728637215, -4.200551164121594, 0.9681773503490492, -0.6947714659799382, 1.0186793166467836, 3.022589458581076, 1.7541680314232553, 5.440472943668821, 5.0819323115745085, 1.3110179895363745, -5.706819818009729, 0.8973051341750797, 3.3178009954552623, 1.8573934688570057, 0.5540468889260669, -1.2503035686905346, 0.7074768173396229, 1.1934412533280092, 3.1002252602525733, -0.6088171055208209, -0.20342430114074173, 0.04784453771313113, 0.9402300377830244, 1.742386990307926, 3.2236976570570235, 2.490958421569276, 3.2968740797923193, -0.24453820277851523, -3.226706656868638, -3.2674969412121206, 1.0864116466344211, -1.113941095562964, -1.6009847951065728, 1.9295022863036033, -1.8141851239810765, -1.0664249672976283, 3.320309077656588, 0.9931420239541544, 0.7817068502090248, -0.013595551339875889, -0.20249206717374202, 3.6929194582174656, -1.4045343177291818, 0.39866438983442265, -4.701178817380576, 0.5015742961625225, -2.142969012255932, 0.12844416965061844, -4.124560830555547, 3.4764666594899882, 5.081189963901936, 3.7155653247471383, 4.108367150191402, -6.170766256752989, 1.4138645606205316, 0.19368908276535013, -3.839805282831355, 0.2056403275452523, -6.921715048740445, 1.56080947166968, -3.2348049821841505, 0.08701863902390694, 3.781734478063739, 1.123502562924398, -5.665634201770075, -5.706611201951937, 2.818308560522083, 3.627826797237426, -6.278826027818052, 2.576696835419183, -2.68445177200431, 0.8270679051294794, -2.111374210988954, -5.072230219383594, 1.8153109408745713, -4.42796194734375, -5.9247499998760595, 3.5677964740223174, -0.30674721052029863, -5.952991213950792, -1.4093206407009558, -4.35042263461661, -1.197095530951139, 4.188765845866401, -4.3989991317697905, -3.4908298453879807, 3.906772331172702, 5.23195046416733, -0.14519708841458767, -4.2834874713649835, 2.5509081939734255, -3.465658615906476, 0.29019247012102056, 2.1809121016035684, -2.4070332373266154, 2.3822039401769954, 0.39983206833711904)
lm.studentised
// res12: DenseVector[Double] = DenseVector(1.8554765775752307, 0.3372146986630293, 0.4926119452691736, 0.8527838584023344, -1.351120498340289, 0.30574731949295303, -0.22365645683796392, 0.321679814093429, 0.9794829109665991, 0.5579688810303286, 1.7396203754235078, 1.6029614282603275, 0.42099158914192447, -1.8193223337210853, 0.28512374454831074, 1.0724576900822607, 0.6027226158134862, 0.17648307854279704, -0.3998988919021616, 0.22318775561773313, 0.38185406861504734, 0.9836897006572352, -0.19431574411198888, -0.06450987053222187, 0.015289677894658507, 0.30008078683121453, 0.5749363328468786, 1.032252047903316, 0.8013621928741319, 1.0579176100571552, -0.0774085285853473, -1.0199191338151754, -1.0341818640731804, 0.3429305506631239, -0.3567091360490486, -0.5094620201587003, 0.6085088169614772, -0.5778063816098498, -0.34519374936101827, 1.0493900587723493, 0.3168918251124347, 0.2486714048531656, -0.004327524037234309, -0.06399824586097833, 1.1896974175792392, -0.44339837293612594, 0.12657217763606757, -1.4976576310525893, 0.15994514785316213, -0.684307999151981, 0.04074076086262209, -1.3436892765641282, 1.1256275732880288, 1.6150628551516617, 1.1936104604950455, 1.3278000955334142, -1.9570017371253632, 0.44733674241512306, 0.061322356557926616, -1.2428444983182014, 0.06795673567496727, -2.200807315804838, 0.4983595437189624, -1.0311317002434024, 0.028917149741337262, 1.2559588516557196, 0.3617277917629284, -1.7894062020285235, -1.8622313862617415, 0.8925852542447782, 1.1583762575193883, -2.014814291583264, 0.828352740118793, -0.8534875774314648, 0.26415838745055137, -0.6778733834745524, -1.663609898028862, 0.5912414788463657, -1.4318295277750104, -1.9331855745999103, 1.1295224427562973, -0.09805230068236595, -1.8911588231938532, -0.4505498161365819, -1.4103469512669073, -0.37983552714034313, 1.334790592703015, -1.3915750355089924, -1.1167102302280292, 1.2687754492869414, 1.6647143008386678, -0.04673607288824761, -1.3803053332992437, 0.8126297935248828, -1.0967363693127083, 0.09257484183897936, 0.6931670959544203, -0.7766602403164494, 0.758869206255016, 0.12596571394434422)
val pred = lm.predict()
// pred: PredictLm = PredictLm(
//   mod = Lm(
//     y = DenseVector(6.795541069961439, 2.918332885793534, 0.3671259897435872, 5.063250541195449, -0.10977443914448459, 2.2529531022115936, 1.1222639609858853, 2.135522631085393, 1.613133734894349, 3.355241850482926, 3.9455942380174465, 7.970047919414032, 1.8576317914420086, -6.300213990387084, 2.1678549314969113, 0.9702974337122738, 6.223327289978172, 1.2496693172481843, -2.794886949178453, 2.4831062997103976, 6.607066330988644, 8.10455415360822, 1.0779316444913531, 3.5468024305514585, 1.187305209658247, 5.858013708711885, 0.22034051074617778, 4.318352718327171, 5.90874291001842, 10.013755380793992, 2.7142586115987886, -2.423441662498162, -0.09179437688302272, 4.825381097384145, 0.6299156345343806, -0.20289324673268938, 4.817930595744146, 0.1530923407544167, 1.5071310394046895, 6.319381612303289, 3.3736425503077316, 5.082364732889797, 0.30939539313611153, 2.070200217635574, 10.642191565753624, 0.07581759490139639, 4.548758578243381, -4.277017376782119, 0.14948409347147637, -1.0001643390344725, 3.985398111568199, -6.617917416635708, 8.422780979753515, 7.683569282148303, 3.406416338751995, 11.519853721305573, -2.901811645358027, 2.5645402922827225, 2.2868278030744307, 3.0558443899299164, -1.8908156910364429, -3.1161760752335645, 2.239027200454325, 2.5021841796859423, -0.902561592639146, 2.629955129007436, 6.627566179200851, -4.539703298140358, -4.916840607544926, 4.946028934200436, 8.328242512451897, -2.352252008479361, 6.228694804453223, -1.0449342708293408, 6.820200653869428, -0.2791300534089136, 2.658158316804893, 9.447734136676353, 1.2869869427571312, -5.3987541409669415, 5.564244843602764, 4.808441186834108, -6.7285298632258295, -0.27135741585480067, -2.2905925866595864, 2.8623162935849065, 6.300833717994928, -0.7171487749575771, 1.0662945803576571, 1.7859767962027655, 7.406707978142455, -1.3040738396093896, -3.0519658228574027, 7.068429738827988, 0.25013256037037923, 4.668095321908648, 5.55047717740484, -3.522929043099249, 5.898133330716014, 2.8425591125728227),
//     Xmat = -0.5854143897089161    0.5303543914603723    -2.3495138338166077    
// -0.47035775648834455   1.245576454155434     7.680657950647619      
// -1.715992562644093     0.16549234181450634   2.828413329127363      
// 0.14907664588932967    0.35386610450557854   4.1224284988698985     
// 1.0977303264841427     0.21636810819597307   7.548419500040026      
// -0.19124113257976952   -0.33615494078869945  2.4834901283869946     
// 0.6944040832987413     -1.9753029465813787   -1.0240178095559385    
// -0.4841433052489801    0.34125355343265695   0.6536293490733738     
// -2.45246750927224      1.93835051854612      4.244636720081515      
// -0.1317752145107572    0.1905732923268878    -2.0109410590838497    
// -1.274014694752708     -1.6770283891368294   2.625359699305207      
// -0.0345847335842888    1.806095398689937     3.306320629239975      
// -1.6547653502979751    2.942942205737814     0.016005246861451328   
// -1.0457905596682306    -0.7419147140552813   -0.6304758354321325    
// -1.1484832513840901    2.4914828733475325    3.089622329174233      
// -1.651582042015808     -1.805079622726614    -0.9288038953844167    
// 0.34431738897847963    2.8647951266515284    9.245626733033259      
// -0.9485623044098367    0.8065302730162699    6.408588441496941      
// -1.9475998830775554    0.2658150446284274    2.5950750916721024     
// -0.5618952990341718    1.6039677149691625    2.0820985940811334     
// 0.5645579106637452     4.258123037387588     1.2600245901006417     
// 1.191498120671267      1.6446357464137815    2.5937010290576428     
// ...
pred.fitted
// res13: DenseVector[Double] = DenseVector(0.9728763621649843, 1.8634469737241597, -1.1780403002626025, 2.3627441683317274, 4.090776724977109, 1.284775751862545, 1.8170354269658238, 1.1168433144386096, -1.4094557236867267, 1.6010738190596712, -1.4948787056513748, 2.888115607839523, 0.546613801905635, -0.5933941723773553, 1.2705497973218316, -2.3475035617429882, 4.365933821121167, 0.6956224283221174, -1.544583380487918, 1.7756294823707748, 5.413625077660634, 5.004328893355646, 1.686748750012174, 3.7502267316921998, 1.1394606719451161, 4.917783670928862, -1.5220464795617483, 1.0946550612701478, 3.417784488449144, 6.7168813010016715, 2.958796814377304, 0.803264994370476, 3.175702564329098, 3.7389694507497238, 1.7438567300973444, 1.3980915483738838, 2.8884283094405423, 1.9672774647354934, 2.5735560067023173, 2.9990725346467015, 2.3805005263535772, 4.300657882680771, 0.32299094447598753, 2.2726922848093163, 6.9492721075361565, 1.4803519126305782, 4.150094188408958, 0.42416144059845706, -0.35209020269104563, 1.14280467322146, 3.8569539419175802, -2.4933565860801608, 4.946314320263528, 2.602379318246366, -0.30914898599514296, 7.41148657111417, 3.268954611394962, 1.150675731662191, 2.0931387203090805, 6.8956496727612695, -2.0964560185816943, 3.8055389735068803, 0.6782177287846449, 5.736989161870091, -0.9895802316630529, -1.1517793490563026, 5.5040636162764525, 1.1259309036297167, 0.7897705944070101, 2.127720373678353, 4.700415715214471, 3.926574019338691, 3.65199796903404, 1.6395175011749692, 5.993132748739948, 1.8322441575800408, 7.730388536188487, 7.632423195801782, 5.714948890100881, 0.5259958589091186, 1.9964483695804465, 5.115188397354408, -0.7755386492750372, 1.1379632248461555, 2.0598300479570235, 4.0594118245360455, 2.1120678721285273, 3.6818503568122134, 4.557124425745637, -2.1207955349699357, 2.174757513975126, -1.1588767511948015, 1.2315216485075806, 4.517521544854564, 3.715791176276855, 4.377902851787628, 3.369565075801272, -1.1158958057726336, 3.515929390539019, 2.4427270442357036)
pred.se
// res14: DenseVector[Double] = DenseVector(0.5771209216535138, 0.6283958984918628, 0.584768390963024, 0.3908472279222904, 0.717786341453053, 0.3916719295740381, 0.7285997006722867, 0.39040719661813283, 0.8111227427099649, 0.5449342543652826, 0.6325700254115543, 0.36008982104559084, 0.6949678760056665, 0.5842170666242936, 0.5259777081129664, 0.7810845274446224, 0.8270524732517813, 0.5701155991380754, 0.6367171230753851, 0.36417652686328833, 0.6424039388882462, 0.4979474080936436, 0.6034858659680266, 0.4867207697042519, 0.6235337201129709, 0.6028459359190778, 0.9981688884281169, 0.6540213671636045, 0.7200942471680659, 0.6847552228403297, 0.4483941285000345, 0.4144784891278496, 0.44528922565372636, 0.3799383576208068, 0.6547268110859776, 0.5526369308954657, 0.35539112869439166, 0.5678891317910035, 0.7978869136811122, 0.4118105825208164, 0.5989177837812812, 0.5467329367013958, 0.5574720869053696, 0.41190145600198513, 0.7385037716581963, 0.3829657145487395, 0.5100083683153991, 0.5720713423626314, 0.5888628438688445, 0.6114662184484474, 0.49100082898640257, 0.8708624765352979, 0.8012949530517822, 0.531615355938667, 0.7005005561166363, 0.7792089744588644, 0.48807256446034103, 0.4372139635319653, 0.45204781002731154, 0.7971972774250028, 1.0118071436206881, 0.5377644320248954, 0.6098820335695809, 0.5822958193054831, 1.060751768823364, 1.0556488716150605, 0.7306806118821341, 0.3947640465499316, 0.8889355651213275, 0.4594783252347607, 0.6102602106400371, 0.6849866068754612, 0.7104330445105415, 0.5366320712052113, 0.6146888052978342, 0.692347026110361, 0.9406084394020124, 0.8681853304437082, 0.7855167907690855, 0.8876735318729204, 0.451086264127743, 0.6275405008028514, 0.5216023269022614, 0.6295422099091075, 0.8158866246972007, 0.49803466326272905, 0.5768599500264224, 0.43330217256567194, 0.6394358334801973, 0.8363284306884989, 0.5506367265420096, 0.727221115645567, 0.7418295598226311, 0.5717594818866724, 0.44190707806698015, 0.5954010382105799, 0.5305759013541783, 0.7586933948959534, 0.5713656608616414, 0.32494833949686885)
val predNew = lm.predict(DenseMatrix((1.1, 1.6, 1.0), (1.4, 2.2, 3.0)))
// predNew: PredictLm = PredictLm(
//   mod = Lm(
//     y = DenseVector(6.795541069961439, 2.918332885793534, 0.3671259897435872, 5.063250541195449, -0.10977443914448459, 2.2529531022115936, 1.1222639609858853, 2.135522631085393, 1.613133734894349, 3.355241850482926, 3.9455942380174465, 7.970047919414032, 1.8576317914420086, -6.300213990387084, 2.1678549314969113, 0.9702974337122738, 6.223327289978172, 1.2496693172481843, -2.794886949178453, 2.4831062997103976, 6.607066330988644, 8.10455415360822, 1.0779316444913531, 3.5468024305514585, 1.187305209658247, 5.858013708711885, 0.22034051074617778, 4.318352718327171, 5.90874291001842, 10.013755380793992, 2.7142586115987886, -2.423441662498162, -0.09179437688302272, 4.825381097384145, 0.6299156345343806, -0.20289324673268938, 4.817930595744146, 0.1530923407544167, 1.5071310394046895, 6.319381612303289, 3.3736425503077316, 5.082364732889797, 0.30939539313611153, 2.070200217635574, 10.642191565753624, 0.07581759490139639, 4.548758578243381, -4.277017376782119, 0.14948409347147637, -1.0001643390344725, 3.985398111568199, -6.617917416635708, 8.422780979753515, 7.683569282148303, 3.406416338751995, 11.519853721305573, -2.901811645358027, 2.5645402922827225, 2.2868278030744307, 3.0558443899299164, -1.8908156910364429, -3.1161760752335645, 2.239027200454325, 2.5021841796859423, -0.902561592639146, 2.629955129007436, 6.627566179200851, -4.539703298140358, -4.916840607544926, 4.946028934200436, 8.328242512451897, -2.352252008479361, 6.228694804453223, -1.0449342708293408, 6.820200653869428, -0.2791300534089136, 2.658158316804893, 9.447734136676353, 1.2869869427571312, -5.3987541409669415, 5.564244843602764, 4.808441186834108, -6.7285298632258295, -0.27135741585480067, -2.2905925866595864, 2.8623162935849065, 6.300833717994928, -0.7171487749575771, 1.0662945803576571, 1.7859767962027655, 7.406707978142455, -1.3040738396093896, -3.0519658228574027, 7.068429738827988, 0.25013256037037923, 4.668095321908648, 5.55047717740484, -3.522929043099249, 5.898133330716014, 2.8425591125728227),
//     Xmat = -0.5854143897089161    0.5303543914603723    -2.3495138338166077    
// -0.47035775648834455   1.245576454155434     7.680657950647619      
// -1.715992562644093     0.16549234181450634   2.828413329127363      
// 0.14907664588932967    0.35386610450557854   4.1224284988698985     
// 1.0977303264841427     0.21636810819597307   7.548419500040026      
// -0.19124113257976952   -0.33615494078869945  2.4834901283869946     
// 0.6944040832987413     -1.9753029465813787   -1.0240178095559385    
// -0.4841433052489801    0.34125355343265695   0.6536293490733738     
// -2.45246750927224      1.93835051854612      4.244636720081515      
// -0.1317752145107572    0.1905732923268878    -2.0109410590838497    
// -1.274014694752708     -1.6770283891368294   2.625359699305207      
// -0.0345847335842888    1.806095398689937     3.306320629239975      
// -1.6547653502979751    2.942942205737814     0.016005246861451328   
// -1.0457905596682306    -0.7419147140552813   -0.6304758354321325    
// -1.1484832513840901    2.4914828733475325    3.089622329174233      
// -1.651582042015808     -1.805079622726614    -0.9288038953844167    
// 0.34431738897847963    2.8647951266515284    9.245626733033259      
// -0.9485623044098367    0.8065302730162699    6.408588441496941      
// -1.9475998830775554    0.2658150446284274    2.5950750916721024     
// -0.5618952990341718    1.6039677149691625    2.0820985940811334     
// 0.5645579106637452     4.258123037387588     1.2600245901006417     
// 1.191498120671267      1.6446357464137815    2.5937010290576428     
// ...
predNew.fitted
// res15: DenseVector[Double] = DenseVector(4.771368140302234, 5.730335339397756)
predNew.se
// res16: DenseVector[Double] = DenseVector(0.4885515382463733, 0.5681644339769742)
lm.plots
// res17: Figure = breeze.plot.Figure@7d2b832
lm.summary
// Estimate	 S.E.	 t-stat	p-value		Variable
// ---------------------------------------------------------
//   1.7752	 0.427	 4.153	0.0001 *	(Intercept)
//   1.8201	 0.293	 6.207	0.0000 *	V1
//   0.6058	 0.166	 3.654	0.0004 *	V2
//   0.0247	 0.097	 0.254	0.8000  	V3
// 
// Residual standard error:   3.1907 on 96 degrees of freedom
// Multiple R-squared: 0.3678, Adjusted R-squared: 0.3481
// F-statistic: 18.6196 on 3 and 96 DF, p-value: 0.00000
//
```
The plots include a plot of studentised residuals against fitted values and a normal Q-Q plot for the studentised residuals.

![Linear model plots](lm-plots.png)


## Generalised linear models

The current implementation supports only simple one-parameter exponential family observation models. This includes the most commonly used cases of **logistic regression** (`LogisticGlm`) and **Poisson regression** (`PoissonGlm`).

### Logistic regression

Again, we start by creating an appropriate response variable.
```scala
val ylb = (0 until 100) map (i => Bernoulli(sigmoid(1.0 + X(i,0))).sample())
val yl = DenseVector(ylb.toArray map {b => if (b) 1.0 else 0.0})
```

Then we can do logistic regression in a typical way.
```scala
import scalaglm.{Glm, LogisticGlm}
val glm = Glm(yl, X, List("V1","V2","V3"), LogisticGlm)
```
```scala
glm.coefficients
// res20: DenseVector[Double] = DenseVector(1.0245475413236769, 1.562205425832173, -0.16196516335622105, 0.0368022952228094)
glm.fitted
// res21: DenseVector[Double] = DenseVector(0.4844159413214702, 0.5916227847921287, 0.17095171607035736, 0.7944297497738193, 0.9517626872398367, 0.705085405370416, 0.9161840098937218, 0.5589742430476304, 0.04905829892525839, 0.6712433892383574, 0.35491913924606294, 0.6899048993799829, 0.11541329784309781, 0.37467072785494066, 0.2574150594016448, 0.2146054486354446, 0.8082540809690477, 0.41287795245927444, 0.12286748969569494, 0.49089869804058345, 0.7795777112024487, 0.9379055608300214, 0.4428418788413015, 0.8871989008265875, 0.46520863138966667, 0.9657107345415353, 0.0350536195151604, 0.21224779808035016, 0.9397984077702146, 0.9493651225868599, 0.5632088958061962, 0.4834978684960029, 0.642661220693327, 0.7950993704197057, 0.2870659097807792, 0.8517813689820802, 0.8181229908557793, 0.8684165475433068, 0.1754281428269708, 0.775737298488178, 0.9265216948377548, 0.9305269386063514, 0.17713827039225086, 0.6588697547770361, 0.9448559417218978, 0.4562424806167628, 0.9043293340486538, 0.592625522055706, 0.4780784819187816, 0.35706769682678124, 0.6517574814550282, 0.028767735096596882, 0.5712569129694848, 0.4446618716552877, 0.3918728309689071, 0.9837857394221662, 0.6845207013074696, 0.3666166444595242, 0.6062238388778974, 0.9745165178734877, 0.7057441156849904, 0.6679880280630047, 0.3768911241521578, 0.949460904463029, 0.29895122478452996, 0.6276599081974141, 0.9857535351695417, 0.49897391542935, 0.8680312483347341, 0.8518014995501066, 0.9686003268593119, 0.9745537896681884, 0.9434437494881264, 0.847871111846178, 0.9625138085281675, 0.18335259160081194, 0.9959497720895142, 0.9428923854928547, 0.7018335506810194, 0.11769796451635257, 0.6082843118844118, 0.8252112434101209, 0.27753695464722994, 0.8144198459350259, 0.648228385776218, 0.6816144494543555, 0.28310400030709915, 0.7026807824845298, 0.7727694800408412, 0.38719237765498266, 0.8929460447629428, 0.3500788962878746, 0.8634715826175163, 0.8040987639766412, 0.719550711627184, 0.963673006499771, 0.8780000036331365, 0.6630572820875804, 0.9351098951519458, 0.7172880385981368)
glm.predict(response=true).fitted
// res22: DenseVector[Double] = DenseVector(0.4844159413214702, 0.5916227847921287, 0.17095171607035736, 0.7944297497738193, 0.9517626872398367, 0.705085405370416, 0.9161840098937218, 0.5589742430476304, 0.04905829892525839, 0.6712433892383574, 0.35491913924606294, 0.6899048993799829, 0.11541329784309781, 0.37467072785494066, 0.2574150594016448, 0.2146054486354446, 0.8082540809690477, 0.41287795245927444, 0.12286748969569494, 0.49089869804058345, 0.7795777112024487, 0.9379055608300214, 0.4428418788413015, 0.8871989008265875, 0.46520863138966667, 0.9657107345415353, 0.0350536195151604, 0.21224779808035016, 0.9397984077702146, 0.9493651225868599, 0.5632088958061962, 0.4834978684960029, 0.642661220693327, 0.7950993704197057, 0.2870659097807792, 0.8517813689820802, 0.8181229908557793, 0.8684165475433068, 0.1754281428269708, 0.775737298488178, 0.9265216948377548, 0.9305269386063514, 0.17713827039225086, 0.6588697547770361, 0.9448559417218978, 0.4562424806167628, 0.9043293340486538, 0.592625522055706, 0.4780784819187816, 0.35706769682678124, 0.6517574814550282, 0.028767735096596882, 0.5712569129694848, 0.4446618716552877, 0.3918728309689071, 0.9837857394221662, 0.6845207013074696, 0.3666166444595242, 0.6062238388778974, 0.9745165178734877, 0.7057441156849904, 0.6679880280630047, 0.3768911241521578, 0.949460904463029, 0.29895122478452996, 0.6276599081974141, 0.9857535351695417, 0.49897391542935, 0.8680312483347341, 0.8518014995501066, 0.9686003268593119, 0.9745537896681884, 0.9434437494881264, 0.847871111846178, 0.9625138085281675, 0.18335259160081194, 0.9959497720895142, 0.9428923854928547, 0.7018335506810194, 0.11769796451635257, 0.6082843118844118, 0.8252112434101209, 0.27753695464722994, 0.8144198459350259, 0.648228385776218, 0.6816144494543555, 0.28310400030709915, 0.7026807824845298, 0.7727694800408412, 0.38719237765498266, 0.8929460447629428, 0.3500788962878746, 0.8634715826175163, 0.8040987639766412, 0.719550711627184, 0.963673006499771, 0.8780000036331365, 0.6630572820875804, 0.9351098951519458, 0.7172880385981368)
glm.summary
// Estimate	 S.E.	 z-stat	p-value		Variable
// ---------------------------------------------------------
//   1.0245	 0.357	 2.874	0.0041 *	(Intercept)
//   1.5622	 0.342	 4.569	0.0000 *	V1
//  -0.1620	 0.130	-1.247	0.2124  	V2
//   0.0368	 0.074	 0.500	0.6171  	V3
glm.plots
// res24: Figure = breeze.plot.Figure@20795bd2
```

![Logistic regression plots](glm-plots.png)


### Poisson regression

We first create an appropriate response, and then do Poisson regression.
```scala
val yp = DenseVector.tabulate(100)(i => Poisson(math.exp(-0.5 + X(i,0))).sample().toDouble)

import scalaglm.PoissonGlm
val pglm = Glm(yp, X, List("V1","V2","V3"), PoissonGlm)
```
```scala
pglm.coefficients
// res26: DenseVector[Double] = DenseVector(-0.597355713890973, 1.0138643187740608, 0.010611809080526008, -0.0211943215575063)
pglm.summary
// Estimate	 S.E.	 z-stat	p-value		Variable
// ---------------------------------------------------------
//  -0.5974	 0.184	-3.248	0.0012 *	(Intercept)
//   1.0139	 0.103	 9.865	0.0000 *	V1
//   0.0106	 0.061	 0.175	0.8613  	V2
//  -0.0212	 0.039	-0.540	0.5892  	V3
pglm.plots
// res28: Figure = breeze.plot.Figure@6a6f92a0
```
![Poisson regression plots](pglm-plots.png)


## Non-linear response

The above covers the main functionality of the library based on a linear reponse to variation in covariate values. For flexible modelling of a nonlinear response, see the documentation on [flexible regression modelling](FlexibleRegression.md).


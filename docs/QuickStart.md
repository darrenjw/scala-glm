# scala-glm - Quickstart Guide

## PCA

This library contains code for principal components analysis based on a thin SVD of the centred data matrix. This is more numerically stable than a construction from the spectral decomposition of the covariance matrix. It is analogous to the R function `prcomp` rather than the R function `princomp`. First create some synthetic data.

```scala
import breeze.linalg.*
import breeze.numerics.*
import breeze.stats.distributions.*
import breeze.stats.distributions.Rand.VariableSeed.randBasis

val X = DenseMatrix.tabulate(100, 3)((i, j) => 
	Gaussian(j, j+1).sample())
```
Now we can do PCA.
```scala
import scalaglm.Pca
val pca = Pca(X, List("V1", "V2", "V3"))
```
```scala
pca.sdev
// res0: DenseVector[Double] = DenseVector(2.961876966137905, 1.9305957653768677, 0.9540497651089239)
pca.loadings
// res1: DenseMatrix[Double] = -0.10227877867891211  0.021960449114124796  -0.9945133433527457   
// 0.20837194289349692   -0.9771037048179436   -0.04300562109583088  
// -0.9726870950345439   -0.2116272399899285   0.09536103212269553   
pca.scores
// res2: DenseMatrix[Double] = 4.880239738185153     -2.6573031548998607   -0.742096441322211    
// -1.9060184904604625   -1.0539625195818416   0.26833876428684544   
// -3.933958658295784    -0.14114509965030558  -1.292453588434682    
// -0.7745674352283763   -1.9662533620110232   -0.38118001115128597  
// 3.742438318321416     2.427775067658866     -0.2923909878986715   
// -4.014384506920042    -0.30452978517375207  0.4651253986501327    
// 2.614890785767644     2.6276888471721644    -1.5498157409946758   
// -4.1451879504569      -1.3232587123942163   1.3412723583130604    
// 1.0502649385264677    -2.284564656542113    -1.0549104906037559   
// 3.4740346140847356    -0.5155349637405369   1.5253641721963493    
// -0.9498947933687734   -0.5143964357184345   -0.5664442470531312   
// 0.7676435492629019    0.2994699032138784    -0.23699077593658202  
// 2.9689011145881015    0.7987535505244104    0.8018026355266452    
// -2.114264673020844    0.5223448198690062    0.7230347839820817    
// -2.2014312870780897   -3.474096233614154    1.369570611302612     
// 0.034166990791842385  -2.6693535399272816   0.15320110697936534   
// 3.5672664039939415    -3.359800164416963    0.7350912126911222    
// -6.2909350819244905   3.1716523471566895    -1.064016148529257    
// -1.9290208530679163   -0.7320182561580393   -0.7723273031174912   
// 3.101353672649301     0.6606153725452755    -1.683556536095587    
// 1.513757228744105     -0.5620559900984906   0.8322976074359555    
// 0.7101073299740296    -0.5858935320638174   0.3357399887854041    
// 0.09422925012803783   3.210969048416559     1.165234768993629     
// -2.731896831090967    1.4601200084244206    -0.6769080791962353   
// 3.0855430819600054    1.670053862956184     -1.6588865420737613   
// 2.1435872492847463    0.013998451563336624  -0.828983230875243    
// -0.8415905094149849   3.2268840822543177    -1.3828476809247419   
// -3.6136452539691697   -0.5487535568876435   -0.9731777644586677   
// 5.283252233651588     -2.297147736716342    1.6950965634057111    
// -0.34118029586374604  -1.4866191363624455   0.5918029369743627    
// -3.785235732575174    -0.01017436592988495  0.8123862971880715    
// 3.079148871548224     3.2525700673454923    1.1227751906519021    
// 5.291443269417435     1.3445795470020674    -1.5880366035555218   
// -3.119731940935863    -1.4999774662682124   0.47380945589401785   
// -2.9250568157618018   1.1419467438734767    0.5097246001379903    
// 4.450228833307756     -0.16759693851526591  0.4009168265825444    
// 2.064523214642194     1.0561702939174606    1.5202398876836458    
// 1.1258814053874133    -2.980401848601265    -1.0030933500295511   
// 3.394081174276236     2.804131510676588     1.3893406895531044    
// 0.8263302639014537    -0.0789859450913651   -0.5348655387702985   
// 5.497381763801478     -3.886711187221048    -0.9252427951977712   
// -0.6741569554219206   -2.5322170486654025   0.14030317333528183   
// 2.743460708145179     1.6552501664157138    0.053371654630707935  
// -5.949097610450309    0.29024257887717003   1.0230209922362503    
// -4.01897222061102     4.25399136572102      0.3851555356260153    
// -2.1870785154263483   0.7842313750207371    -0.7075915279935812   
// -2.951440203917305    -2.0973089758743293   1.1902032801563434    
// 2.6493182109134112    -0.9174008597999516   0.07455981664740416   
// -1.6711647815188548   0.10469801380638875   -0.37661584567755335  
// ...
pca.plots
// res3: Figure = breeze.plot.Figure@372ee174
pca.summary
// Standard deviations:
// V1	V2	V3
//  2.962	 1.931	 0.954
// Cumulative proportion of variance explained:
// V1	V2	V3
//  0.654	 0.932	 1.000
// Loadings:
// PC01	PC02	PC03	
// -0.102	 0.022	-0.995	V1
//  0.208	-0.977	-0.043	V2
// -0.973	-0.212	 0.095	V3
```
The final line prints a readable summary of the PCA to the console. `plots` produces some diagnostic plots, including a "scree plot".

![PCA Plots](pca-plots.png)

Note that there is also a utility function `pairs` for producing a "scatterplot matrix":
```scala
import scalaglm.Utils.pairs
pairs(X, List("V1", "V2", "V3"))
// res6: Figure = breeze.plot.Figure@1941c105
```

![Pairs plots](pairs-plots.png)


## Linear regression

This code computes regression coefficients and associated diagnostics via the QR decomposition of the covariate matrix. The diagnostics are analogous to those produced by the R function `lm`. We start by creating a synthetic response variable.

```scala
val y = DenseVector.tabulate(100)(i => 
	Gaussian(2.0 + 1.5*X(i,0) + 0.5*X(i,1), 3.0).sample())
```
So we can now do linear regression and generate all of the usual diagnostics.
```scala
import scalaglm.Lm
val lm = Lm(y,X,List("V1", "V2", "V3"))
```
```scala
lm.coefficients
// res8: DenseVector[Double] = DenseVector(1.8159032363011332, 1.3289781234187432, 0.38854552939864656, 0.17732957007488484)
lm.se
// res9: DenseVector[Double] = DenseVector(0.47163909386200337, 0.35533033231748845, 0.17474991927934064, 0.12276025843956849)
lm.fitted
// res10: DenseVector[Double] = DenseVector(3.422478749589292, 3.008657040737556, 5.178311934091179, 3.9635994400927146, 1.114022723356487, 2.937381142990365, 2.954587900569872, 2.204575453668301, 4.562367999916133, -0.08508533852367473, 3.6849927832387617, 2.543196123085729, 0.47605025003094226, 1.8435536274741127, 2.5595793126866533, 3.3462726781630723, 2.0415959247316615, 4.127191272077296, 4.264202529732847, 3.7838871979520623, 1.29470805378179, 2.1429412039307043, -0.2862952462685686, 3.4701895885371066, 3.363228130652237, 3.12330737993424, 3.287637221975994, 4.8416868963014785, -0.02963999683637697, 2.393147915221674, 2.312153233995178, -0.9252477147184281, 2.894149397597233, 3.186240390930216, 2.06945440331307, 1.0438228259660096, -0.3675288611332932, 4.746672709716352, -1.1751511175339702, 3.0703229431769676, 4.001135406232889, 3.4712178458547145, 1.1840537680784649, 2.4094144533346844, 1.275433521680207, 3.649057596886663, 2.4330180004821487, 2.1756349086575106, 3.357986689336573, 3.086032986977056, 1.7204106034587505, -1.451803523890067, 5.029475669591558, 3.4857528137322573, 5.759378790424221, 2.859444073645542, 3.2155660249654687, 3.581258496295701, 2.7297737986516926, 3.2499292912288027, 3.0844107639662792, 1.7275601386047468, 3.755866566190351, 3.9546566032786377, 2.7946572624851345, 5.253600435844204, 1.7249146070126549, 4.625995523518625, 2.0232339369902173, 0.05012687498089452, -0.4644697899665031, 2.571271449043199, 3.7069288853886935, 3.7639094252033836, 1.8626684788826993, -1.047516624234483, 2.4683464739277556, 1.0658243884200038, 4.1861789719561635, 0.5203736492844011, 0.8709666424088177, 2.4010656774850694, 3.2105358006247604, 1.783595965025486, 2.617004120949737, 0.42744497396358994, 5.674587846749949, 0.31184094595282863, 1.926762246931593, 5.220727510118786, 0.6241063148846229, 2.7908294457584173, 0.5921492269794235, 5.471007691531586, 1.4797633691070857, 1.4182542621644505, 3.4062108505133275, 3.7054652964247294, 2.6349667969895116, 2.275688642979041)
lm.residuals
// res11: DenseVector[Double] = DenseVector(0.7214405783747715, 3.040228030380825, -4.841455791305118, -1.572426581263441, 0.09840775283037706, 3.7130114557360847, 6.150427198292161, -0.5165900848861402, 0.8435417359604864, 1.4723448987627274, 3.5665471356691234, -3.1254429636516052, -3.8422277418944386, -2.137506281374649, 5.028497422044559, -3.342983790141727, 3.2840699950400922, -0.14488041303816246, -4.988610363967541, 1.765676388340942, -0.08935236857438711, -0.9209767457549527, -1.1851033051484512, 5.095742410876987, 0.6380140212891732, 0.37694171893036055, -4.502101102924118, 3.2230153874622083, -1.1300866659381683, -4.360466641499461, 1.0283522574753285, 0.861976859179012, -2.1935440354776095, -0.9919718455685875, 4.716315146706737, -0.30501749665472866, 3.8894390560377374, -1.8307418515455094, -4.147226593782708, 3.6606964366121764, -0.31210624985513125, -1.3432427932464939, -2.5397060246970815, 3.721385198565917, 0.4761150730070922, -0.019359782984021745, -1.3442691227032253, -2.3865871383072657, -9.341992670917783, 0.7284993526818462, -0.32009607356394, -7.253551994285461, -0.029546750476869832, 0.7568892183874381, 1.6720931056237553, 4.289653133389051, -5.925195405557398, 1.0064014891218336, -4.228630731672935, 3.8511526624781585, -5.054326467627473, 0.9740194040840615, -1.2616327028985532, 3.9991400656313836, -0.5289472069259786, 4.057054996233962, -6.574528896204313, -0.1086549095679823, 1.7499382954453084, 1.8223327804382556, 7.926681625539548, 2.2580654373974434, -2.8218222979846854, -0.1921415161520308, 0.928068721959505, 3.4299202396444444, -1.7522629093677673, 4.22220740654411, -2.284384731760446, 2.590692006199276, -0.5587617729391858, 0.7663348220307267, 8.950296506274725, 4.074877836071429, 2.230408917945933, -1.1797732855805672, -2.730412147594393, 1.0080059920402689, 4.083375670643218, 0.762457492630503, 0.6439878555522103, -3.1989000228070785, -3.170926469766014, 1.047123254774851, -1.1239049811254782, -5.075797487237512, 3.133737784826955, -2.9179915776822, -2.04855337592163, -6.538882069362733)
lm.studentised
// res12: DenseVector[Double] = DenseVector(0.21984075750768328, 0.9051122737092666, -1.4626789596690812, -0.4692757152931076, 0.029678236654600402, 1.1129216744864356, 1.8747568817783096, -0.15673559139945287, 0.2536994505507463, 0.44576036119358875, 1.0603601170393295, -0.927442054710705, -1.1503499139614968, -0.6375619344441675, 1.537593413928968, -1.0011666717491425, 0.9999746923495343, -0.04494004905636057, -1.4884798706595699, 0.5354920778971768, -0.026644574089872374, -0.2734584750139525, -0.35928530857206115, 1.5259964892446956, 0.19404520416125182, 0.1125025310773791, -1.3701377065854135, 0.9686325916989068, -0.3491771641666447, -1.2994987238948248, 0.30865048648715604, 0.26279267166217224, -0.6729122358980487, -0.29711277973887706, 1.4100579919033933, -0.09158808573958784, 1.1733186090101542, -0.5531790726499919, -1.266009074705501, 1.0876122349228765, -0.09680299375208323, -0.40197745509662874, -0.7592505159692802, 1.133950878332509, 0.14638731546813752, -0.005777594265344638, -0.4063932350510688, -0.7113968967130624, -2.776740508769526, 0.21642581158132312, -0.0952661800647143, -2.33576689282552, -0.008871377858272866, 0.2253496572780913, 0.5153662286680543, 1.2755324489703783, -1.7676776622112593, 0.3010930549270841, -1.2579673962456102, 1.1594205132081867, -1.5053031562099621, 0.29238328846702905, -0.3756654146757353, 1.2164810054363933, -0.1572160238202777, 1.2272148267733227, -1.9539415505123798, -0.03269132134599879, 0.5314653356460262, 0.5513801780935208, 2.4057187418017585, 0.671343404457798, -0.8423330917490752, -0.057661085070652165, 0.27629670314497107, 1.0705494563586049, -0.5248178651841595, 1.2623027863337772, -0.6969190726832473, 0.7748632487447407, -0.17143247855867166, 0.22779929030185805, 2.666963543639293, 1.2162565058095112, 0.6637209197989355, -0.35511711410868824, -0.8342710398922177, 0.30194599811290174, 1.2328159627339887, 0.23388130912524296, 0.1924169272848409, -0.9536395410114451, -0.9514833443755643, 0.3202676167987867, -0.3355942171139989, -1.5362281123760018, 0.9503320395198177, -0.8687807055030523, -0.6084011931904635, -1.939328971136227)
val pred = lm.predict()
// pred: PredictLm = PredictLm(
//   Lm(
//     DenseVector(4.143919327964063, 6.048885071118381, 0.33685614278606124, 2.3911728588292736, 1.212430476186864, 6.65039259872645, 9.105015098862033, 1.6879853687821607, 5.4059097358766195, 1.3872595602390527, 7.251539918907885, -0.5822468405658761, -3.366177491863496, -0.29395265390053615, 7.588076734731213, 0.0032888880213453042, 5.325665919771754, 3.982310859039133, -0.724407834234694, 5.549563586293004, 1.205355685207403, 1.2219644581757516, -1.4713985514170198, 8.565931999414094, 4.00124215194141, 3.5002490988646007, -1.2144638809481236, 8.064702283763687, -1.1597266627745453, -1.9673187262777874, 3.3405054914705063, -0.06327085553941614, 0.7006053621196235, 2.1942685453616284, 6.785769550019808, 0.738805329311281, 3.5219101949044442, 2.9159308581708423, -5.322377711316679, 6.731019379789144, 3.6890291563777575, 2.1279750526082206, -1.3556522566186164, 6.130799651900602, 1.7515485946872993, 3.6296978139026415, 1.0887488777789234, -0.21095222964975502, -5.98400598158121, 3.814532339658902, 1.4003145298948105, -8.705355518175528, 4.999928919114688, 4.242642032119695, 7.431471896047976, 7.149097207034593, -2.709629380591929, 4.587659985417535, -1.4988569330212416, 7.101081953706961, -1.969915703661194, 2.7015795426888083, 2.494233863291798, 7.953796668910021, 2.265710055559156, 9.310655432078166, -4.849614289191658, 4.517340613950643, 3.7731722324355257, 1.8724596554191502, 7.4622118355730445, 4.829336886440642, 0.885106587404008, 3.5717679090513528, 2.7907372008422042, 2.3824036154099613, 0.7160835645599883, 5.288031794964114, 1.901794240195717, 3.111065655483677, 0.3122048694696319, 3.167400499515796, 12.160832306899486, 5.858473801096915, 4.84741303889567, -0.7523283116169771, 2.944175699155556, 1.3198469379930975, 6.010137917574811, 5.983185002749289, 1.2680941704368331, -0.40807057704866123, -2.5787772427865905, 6.518130946306437, 0.3558583879816075, -3.657543225073062, 6.5399486353402825, 0.7874737187425294, 0.5864134210678817, -4.263193426383692),
//     0.19630126693390682   4.3319917019972145    -1.9031263941311325   
// -0.07928974377757422  1.3078414214686451    4.454824999128375     
// 1.7004002013079076    0.060481150317987176  6.085360429004405     
// 0.4309075964672309    2.4629397964964084    3.4854039712834335    
// -0.02289326592365961  -0.8930828233726089   -1.829658329501016    
// -0.04289769684530429  0.1277806655522027    6.365770810367941     
// 1.3473468102065829    -1.2692922555540425   -0.8951239192141358   
// -0.9232308672833915   1.0582494627060646    6.7921427014125095    
// 0.9073096626387684    3.183181006562426     1.7135287775569736    
// -1.8678594346958801   1.8487348217439195    -0.7723579235377867   
// 0.6649710493281048    1.015759116224033     3.331023167030513     
// 0.17953032259206986   0.5642457515273476    1.51957652193879      
// -1.0677410283039277   0.49040020983079824   -0.6281599130732336   
// -0.4755754202008161   -0.2953214662375505   4.367154083611434     
// -1.197412272991955    3.563648141666189     5.359350037951445     
// -0.19869832099766263  3.2954777569441367    2.8985127168440625    
// -1.1539194063895608   4.68128995547119      -0.3364805332879661   
// 1.787035308940363     -3.6774173589989063   7.69866682930012      
// 0.965089240399189     1.0332299325267873    4.309827934210237     
// 1.3874011685988827    0.7598593469972712    -0.9647674214622182   
// -0.9791223339975585   1.515529639634873     1.078132165335452     
// -0.403616309501822    1.392718068189998     1.8175244769862835    
// ...
pred.fitted
// res13: DenseVector[Double] = DenseVector(3.4224787495892905, 3.008657040737557, 5.1783119340911785, 3.963599440092714, 1.1140227233564863, 2.9373811429903647, 2.9545879005698708, 2.204575453668301, 4.562367999916132, -0.08508533852367473, 3.6849927832387603, 2.5431961230857283, 0.47605025003094115, 1.843553627474112, 2.559579312686653, 3.3462726781630723, 2.0415959247316615, 4.127191272077296, 4.264202529732847, 3.783887197952062, 1.2947080537817899, 2.142941203930704, -0.28629524626856906, 3.470189588537106, 3.363228130652236, 3.12330737993424, 3.2876372219759933, 4.841686896301477, -0.029639996836378302, 2.3931479152216735, 2.3121532339951774, -0.925247714718429, 2.894149397597232, 3.1862403909302155, 2.0694544033130695, 1.043822825966009, -0.36752886113329386, 4.746672709716352, -1.1751511175339708, 3.0703229431769667, 4.001135406232889, 3.4712178458547145, 1.1840537680784644, 2.4094144533346844, 1.2754335216802066, 3.6490575968866623, 2.4330180004821482, 2.1756349086575106, 3.3579866893365726, 3.0860329869770555, 1.7204106034587499, -1.4518035238900668, 5.029475669591557, 3.485752813732257, 5.759378790424221, 2.8594440736455415, 3.2155660249654687, 3.5812584962956997, 2.729773798651692, 3.249929291228802, 3.084410763966279, 1.7275601386047463, 3.7558665661903508, 3.9546566032786377, 2.7946572624851345, 5.253600435844204, 1.7249146070126546, 4.6259955235186245, 2.023233936990217, 0.05012687498089452, -0.46446978996650357, 2.571271449043199, 3.7069288853886926, 3.7639094252033827, 1.862668478882699, -1.047516624234484, 2.468346473927755, 1.0658243884200036, 4.186178971956162, 0.5203736492844004, 0.8709666424088168, 2.401065677485069, 3.2105358006247595, 1.7835959650254853, 2.617004120949737, 0.42744497396358905, 5.674587846749949, 0.3118409459528282, 1.9267622469315924, 5.220727510118786, 0.6241063148846224, 2.7908294457584173, 0.592149226979423, 5.471007691531586, 1.4797633691070857, 1.41825426216445, 3.406210850513327, 3.7054652964247294, 2.634966796989511, 2.2756886429790404)
pred.se
// res14: DenseVector[Double] = DenseVector(0.8485535775546598, 0.45466566494245525, 0.7302238780712897, 0.51160046559479, 0.7032769050655008, 0.5987917084871962, 0.8524019169725114, 0.791262910347662, 0.658698586890568, 0.7612416821665027, 0.4194974622754521, 0.364200107626896, 0.5773489303604283, 0.49917738847083565, 0.8910459760583694, 0.5828934376645172, 0.8388163826620005, 1.046901718339285, 0.5068106817320234, 0.7855618859968758, 0.49332072751707484, 0.38291509892212433, 0.7804865108028102, 0.5817451273953376, 0.8237442404719032, 0.5131333880088579, 0.8320460891159714, 0.646352108967733, 1.0073777581827876, 0.47948010317565476, 0.6233674598194662, 0.8546653102832767, 0.9290460076603583, 0.5850856673944698, 0.5493720716076053, 0.6310730804163114, 0.7075896987458685, 0.7324859335718071, 0.8707655436039128, 0.4007440014347122, 1.0460430753457175, 0.5683909861578901, 0.5478454083624336, 0.8480265088710148, 0.9544359820750222, 0.5110367932283991, 0.7400729771040474, 0.48441630909486844, 0.4126309992168073, 0.39875469623376825, 0.4467147287969376, 1.3585293220012906, 0.6297411345377424, 0.4562790194606908, 0.9811489482088327, 0.4234475025002064, 0.5035857112472787, 0.5630397556736055, 0.43558564719254494, 0.6753701947199965, 0.46395996101152903, 0.6258174954089357, 0.45875944521427325, 0.8257367714288909, 0.41191701412837234, 0.7485119401135845, 0.4095338925658494, 0.6652398355347976, 0.8047481273502057, 0.7523259390622876, 0.7954195840608564, 0.41967048428423687, 0.5164526496430014, 0.6207594301685191, 0.45462402452781353, 1.1065162219974158, 0.5845306978572619, 0.548894530776612, 0.8631811272941513, 0.5575197680576567, 0.9304760894824646, 0.415026092371351, 0.47604830452081903, 0.5142653279019559, 0.4433619663499334, 0.67245943013748, 0.882030127936062, 0.5870202806724849, 0.7199837583415384, 0.9281978314080168, 0.5366235904720914, 0.4870256462063053, 0.6188377883283153, 0.8941337870369143, 0.5229479958675246, 0.7565905520054889, 0.7846299800660207, 0.45636726222751833, 0.3896778981101965, 0.3474934821375442)
val predNew = lm.predict(DenseMatrix((1.1, 1.6, 1.0), (1.4, 2.2, 3.0)))
// predNew: PredictLm = PredictLm(
//   Lm(
//     DenseVector(4.143919327964063, 6.048885071118381, 0.33685614278606124, 2.3911728588292736, 1.212430476186864, 6.65039259872645, 9.105015098862033, 1.6879853687821607, 5.4059097358766195, 1.3872595602390527, 7.251539918907885, -0.5822468405658761, -3.366177491863496, -0.29395265390053615, 7.588076734731213, 0.0032888880213453042, 5.325665919771754, 3.982310859039133, -0.724407834234694, 5.549563586293004, 1.205355685207403, 1.2219644581757516, -1.4713985514170198, 8.565931999414094, 4.00124215194141, 3.5002490988646007, -1.2144638809481236, 8.064702283763687, -1.1597266627745453, -1.9673187262777874, 3.3405054914705063, -0.06327085553941614, 0.7006053621196235, 2.1942685453616284, 6.785769550019808, 0.738805329311281, 3.5219101949044442, 2.9159308581708423, -5.322377711316679, 6.731019379789144, 3.6890291563777575, 2.1279750526082206, -1.3556522566186164, 6.130799651900602, 1.7515485946872993, 3.6296978139026415, 1.0887488777789234, -0.21095222964975502, -5.98400598158121, 3.814532339658902, 1.4003145298948105, -8.705355518175528, 4.999928919114688, 4.242642032119695, 7.431471896047976, 7.149097207034593, -2.709629380591929, 4.587659985417535, -1.4988569330212416, 7.101081953706961, -1.969915703661194, 2.7015795426888083, 2.494233863291798, 7.953796668910021, 2.265710055559156, 9.310655432078166, -4.849614289191658, 4.517340613950643, 3.7731722324355257, 1.8724596554191502, 7.4622118355730445, 4.829336886440642, 0.885106587404008, 3.5717679090513528, 2.7907372008422042, 2.3824036154099613, 0.7160835645599883, 5.288031794964114, 1.901794240195717, 3.111065655483677, 0.3122048694696319, 3.167400499515796, 12.160832306899486, 5.858473801096915, 4.84741303889567, -0.7523283116169771, 2.944175699155556, 1.3198469379930975, 6.010137917574811, 5.983185002749289, 1.2680941704368331, -0.40807057704866123, -2.5787772427865905, 6.518130946306437, 0.3558583879816075, -3.657543225073062, 6.5399486353402825, 0.7874737187425294, 0.5864134210678817, -4.263193426383692),
//     0.19630126693390682   4.3319917019972145    -1.9031263941311325   
// -0.07928974377757422  1.3078414214686451    4.454824999128375     
// 1.7004002013079076    0.060481150317987176  6.085360429004405     
// 0.4309075964672309    2.4629397964964084    3.4854039712834335    
// -0.02289326592365961  -0.8930828233726089   -1.829658329501016    
// -0.04289769684530429  0.1277806655522027    6.365770810367941     
// 1.3473468102065829    -1.2692922555540425   -0.8951239192141358   
// -0.9232308672833915   1.0582494627060646    6.7921427014125095    
// 0.9073096626387684    3.183181006562426     1.7135287775569736    
// -1.8678594346958801   1.8487348217439195    -0.7723579235377867   
// 0.6649710493281048    1.015759116224033     3.331023167030513     
// 0.17953032259206986   0.5642457515273476    1.51957652193879      
// -1.0677410283039277   0.49040020983079824   -0.6281599130732336   
// -0.4755754202008161   -0.2953214662375505   4.367154083611434     
// -1.197412272991955    3.563648141666189     5.359350037951445     
// -0.19869832099766263  3.2954777569441367    2.8985127168440625    
// -1.1539194063895608   4.68128995547119      -0.3364805332879661   
// 1.787035308940363     -3.6774173589989063   7.69866682930012      
// 0.965089240399189     1.0332299325267873    4.309827934210237     
// 1.3874011685988827    0.7598593469972712    -0.9647674214622182   
// -0.9791223339975585   1.515529639634873     1.078132165335452     
// -0.403616309501822    1.392718068189998     1.8175244769862835    
// ...
predNew.fitted
// res15: DenseVector[Double] = DenseVector(4.0767815891744705, 5.06326148398905)
predNew.se
// res16: DenseVector[Double] = DenseVector(0.591011180520521, 0.6623397714670441)
lm.plots
// res17: Figure = breeze.plot.Figure@50dc7396
lm.summary
// Estimate	 S.E.	 t-stat	p-value		Variable
// ---------------------------------------------------------
//   1.8159	 0.472	 3.850	0.0002 *	(Intercept)
//   1.3290	 0.355	 3.740	0.0003 *	V1
//   0.3885	 0.175	 2.223	0.0285 *	V2
//   0.1773	 0.123	 1.445	0.1518  	V3
// 
// Residual standard error:   3.3896 on 96 degrees of freedom
// Multiple R-squared: 0.1895, Adjusted R-squared: 0.1641
// F-statistic: 7.4806 on 3 and 96 DF, p-value: 0.00015
//
```
The plots include a plot of studentised residuals against fitted values and a normal Q-Q plot for the studentised residuals.

![Linear model plots](lm-plots.png)


## Generalised linear models

The current implementation supports only simple one-parameter exponential family observation models. This includes the most commonly used cases of **logistic regression** (`LogisticGlm`) and **Poisson regression** (`PoissonGlm`).

### Logistic regression

Again, we start by creating an appropriate response variable.
```scala
val ylb = (0 until 100) map (i => Bernoulli(sigmoid(1.0 + X(i,0))).sample())
val yl = DenseVector(ylb.toArray map {b => if (b) 1.0 else 0.0})
```

Then we can do logistic regression in a typical way.
```scala
import scalaglm.{Glm, LogisticGlm}
val glm = Glm(yl, X, List("V1","V2","V3"), LogisticGlm)
```
```scala
glm.coefficients
// res20: DenseVector[Double] = DenseVector(1.9411663879569483, 1.3683569581699215, -0.37208312835349905, -0.023059431866785923)
glm.fitted
// res21: DenseVector[Double] = DenseVector(0.6551603709987186, 0.7761410762704131, 0.9837789566904589, 0.8225925618876203, 0.9075710958689078, 0.843978201859804, 0.9863158856831827, 0.5318262334787764, 0.8763996607546679, 0.21673342191669884, 0.9165466994006637, 0.8745542636732601, 0.5774053015322078, 0.7857658877136755, 0.24105980135011243, 0.592967468990519, 0.2023167222230185, 0.9962312899165003, 0.941471119480126, 0.9728576511567043, 0.5031533093665348, 0.6960920874470441, 0.7932363768530045, 0.9753867200259598, 0.9811321846008134, 0.9134999177559625, 0.9930759753822181, 0.9692342447485585, 0.07067922771525394, 0.58174844813086, 0.7846471432558847, 0.6976413950410588, 0.9642857559672648, 0.7360517995259308, 0.8799530292969692, 0.5444117774248126, 0.40693408272904197, 0.8315892596300266, 0.5589461200847444, 0.8985150394341966, 0.5691095004572541, 0.6425459139030388, 0.8462626476861109, 0.8250595374232553, 0.9737449270115619, 0.9659496901399655, 0.4476111707505975, 0.6615526263500222, 0.9260823322588051, 0.9334957825912723, 0.8206974924314641, 0.13914696456965306, 0.9538528259226381, 0.9129077956313237, 0.8494153147506964, 0.7949034997852176, 0.6666995402614985, 0.973180788623541, 0.7308410260936757, 0.9861483171691102, 0.9278133997786516, 0.959784734165846, 0.9518822817980701, 0.607797292817832, 0.7288001710226661, 0.890681408852271, 0.6479285984221986, 0.9848759008067273, 0.1929579862328609, 0.3048741118260484, 0.4977525391727939, 0.6715045634322698, 0.9404753353270654, 0.9387308343833659, 0.852293886694371, 0.6597821149180051, 0.8284195455131379, 0.6513094818906134, 0.9946007120967787, 0.7339329331239836, 0.9755504796294809, 0.7653737762979862, 0.8682084575154966, 0.6442249550703962, 0.6662227044608044, 0.7122297109233928, 0.9728525869458674, 0.693604399513545, 0.9396943706640064, 0.6495620743777295, 0.6117464011296574, 0.9584344958460935, 0.8191497368052464, 0.9600718874780527, 0.4848800779986514, 0.5725416691462505, 0.9902312583165017, 0.9182267412647669, 0.920770874900545, 0.8091302503670956)
glm.predict(response=true).fitted
// res22: DenseVector[Double] = DenseVector(0.6551603709987186, 0.7761410762704131, 0.9837789566904589, 0.8225925618876203, 0.9075710958689078, 0.843978201859804, 0.9863158856831827, 0.5318262334787764, 0.8763996607546679, 0.21673342191669884, 0.9165466994006637, 0.8745542636732601, 0.5774053015322078, 0.7857658877136755, 0.24105980135011243, 0.592967468990519, 0.2023167222230185, 0.9962312899165003, 0.941471119480126, 0.9728576511567043, 0.5031533093665348, 0.6960920874470441, 0.7932363768530045, 0.9753867200259598, 0.9811321846008134, 0.9134999177559625, 0.9930759753822181, 0.9692342447485585, 0.07067922771525394, 0.58174844813086, 0.7846471432558847, 0.6976413950410588, 0.9642857559672648, 0.7360517995259308, 0.8799530292969692, 0.5444117774248126, 0.40693408272904197, 0.8315892596300266, 0.5589461200847444, 0.8985150394341966, 0.5691095004572541, 0.6425459139030388, 0.8462626476861109, 0.8250595374232553, 0.9737449270115619, 0.9659496901399655, 0.4476111707505975, 0.6615526263500222, 0.9260823322588051, 0.9334957825912723, 0.8206974924314641, 0.13914696456965306, 0.9538528259226381, 0.9129077956313237, 0.8494153147506964, 0.7949034997852176, 0.6666995402614985, 0.973180788623541, 0.7308410260936757, 0.9861483171691102, 0.9278133997786516, 0.959784734165846, 0.9518822817980701, 0.607797292817832, 0.7288001710226661, 0.890681408852271, 0.6479285984221986, 0.9848759008067273, 0.1929579862328609, 0.3048741118260484, 0.4977525391727939, 0.6715045634322698, 0.9404753353270654, 0.9387308343833659, 0.852293886694371, 0.6597821149180051, 0.8284195455131379, 0.6513094818906134, 0.9946007120967787, 0.7339329331239836, 0.9755504796294809, 0.7653737762979862, 0.8682084575154966, 0.6442249550703962, 0.6662227044608044, 0.7122297109233928, 0.9728525869458674, 0.693604399513545, 0.9396943706640064, 0.6495620743777295, 0.6117464011296574, 0.9584344958460935, 0.8191497368052464, 0.9600718874780527, 0.4848800779986514, 0.5725416691462505, 0.9902312583165017, 0.9182267412647669, 0.920770874900545, 0.8091302503670956)
glm.summary
// Estimate	 S.E.	 z-stat	p-value		Variable
// ---------------------------------------------------------
//   1.9412	 0.472	 4.113	0.0000 *	(Intercept)
//   1.3684	 0.372	 3.678	0.0002 *	V1
//  -0.3721	 0.154	-2.416	0.0157 *	V2
//  -0.0231	 0.101	-0.228	0.8195  	V3
glm.plots
// res24: Figure = breeze.plot.Figure@4a0abf27
```

![Logistic regression plots](glm-plots.png)


### Poisson regression

We first create an appropriate response, and then do Poisson regression.
```scala
val yp = DenseVector.tabulate(100)(i => Poisson(math.exp(-0.5 + X(i,0))).sample().toDouble)

import scalaglm.PoissonGlm
val pglm = Glm(yp, X, List("V1","V2","V3"), PoissonGlm)
```
```scala
pglm.coefficients
// res26: DenseVector[Double] = DenseVector(-0.4955344728547629, 1.0992446911773623, -0.013786134718111312, 0.006886002439514373)
pglm.summary
// Estimate	 S.E.	 z-stat	p-value		Variable
// ---------------------------------------------------------
//  -0.4955	 0.178	-2.782	0.0054 *	(Intercept)
//   1.0992	 0.142	 7.741	0.0000 *	V1
//  -0.0138	 0.051	-0.271	0.7864  	V2
//   0.0069	 0.034	 0.201	0.8405  	V3
pglm.plots
// res28: Figure = breeze.plot.Figure@10af5cee
```
![Poisson regression plots](pglm-plots.png)


## Non-linear response

The above covers the main functionality of the library based on a linear reponse to variation in covariate values. For flexible modelling of a nonlinear response, see the documentation on [flexible regression modelling](FlexibleRegression.md).

